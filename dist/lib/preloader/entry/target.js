/*!
 * @architect Mark Jivko <mark@oglama.com>
 * @copyright © 2024-2026 Oglama™ (https://oglama.com)
 * 
 * Licensed under the Oglama™ Source-Available License, Version 1.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     https://github.com/oglama/oglama/blob/main/LICENSE.txt
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var He=Object.defineProperty;var pe=p=>{throw TypeError(p)};var je=(p,r,e)=>r in p?He(p,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):p[r]=e;var M=(p,r)=>()=>(r||p((r={exports:{}}).exports,r),r.exports);var n=(p,r,e)=>je(p,typeof r!="symbol"?r+"":r,e),fe=(p,r,e)=>r.has(p)||pe("Cannot "+e);var s=(p,r,e)=>(fe(p,r,"read from private field"),e?e.call(p):r.get(p)),f=(p,r,e)=>r.has(p)?pe("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(p):r.set(p,e),C=(p,r,e,t)=>(fe(p,r,"write to private field"),t?t.call(p,e):r.set(p,e),e);var ne=M((gt,de)=>{var S;de.exports=(S=class{static getSourceChannelName(r){return"".concat(S.WINDOW_SOURCE,"/").concat(r)}static getTargetChannelName(r){return"".concat(S.WINDOW_TARGET,"/").concat(r)}static getWorkerChannelName(r){return"".concat(S.WINDOW_WORKER,"/").concat(r)}static generateKey(){return"".concat(Date.now().toString(36)).concat(Math.random().toString(36).substring(2,13))}},n(S,"WINDOW_MAIN_LOGIN","@main/login"),n(S,"WINDOW_MAIN","@main"),n(S,"WINDOW_SOURCE","@source"),n(S,"WINDOW_TARGET","@target"),n(S,"WINDOW_WORKER","@worker"),S)});var T=M((yt,me)=>{var L,P,z,R;me.exports=(L=class{constructor(){f(this,P,{});f(this,z,!1);f(this,R,null)}_useRPC(r){C(this,z,Number.isInteger(r)&&r>0?r:!1)}_register(r){if(typeof r=="string")for(let e of Object.getOwnPropertyNames(this))["_","#"].includes(e[0])||typeof this[e]!="function"||(s(this,P)[e]="ipc:".concat(r,":").concat(e))}_runner(r,...e){let t=s(this,z),i=function(o,a,l){this.run=async function(){let c=null;if(typeof s(o,P)[a]=="string")if(t)try{let h=await fetch("http://0.0.0.0:".concat(t,"/ipc"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({channel:s(o,P)[a],args:l})});c=h.ok?await h.json():new Error(await h.json())}catch(h){c=new Error("".concat(h.message??h))}else{if(s(o,R)===null)try{C(o,R,require("electron").ipcRenderer)}catch{}c=typeof s(o,R)?.invoke=="function"?await s(o,R).invoke(s(o,P)[a],...l):null}if(c instanceof Error)throw new Error("".concat(L.devMode?"".concat(t?"rpc:":"").concat(s(o,P)[a]," "):"").concat(c.message??c));return c}};return new i(this,r,e)}async _promise(r,...e){return await this._runner(r,...e).run()}},P=new WeakMap,z=new WeakMap,R=new WeakMap,n(L,"devMode",!1),L)});var we=M((kt,ge)=>{var Ve=T();ge.exports=class extends Ve{constructor(){super();n(this,"openAgentFiles",e=>this._promise("openAgentFiles",e));n(this,"purge",e=>this._promise("purge",e));n(this,"runInit",(e,t=null,i=null,o=null)=>this._promise("runInit",e,t,i,o));n(this,"runDelete",(e,t)=>this._promise("runDelete",e,t));n(this,"envGet",e=>this._promise("envGet",e));n(this,"envSet",(e,t)=>this._promise("envSet",e,t));n(this,"sourceGet",e=>this._promise("sourceGet",e));n(this,"sourceSet",(e,t)=>this._promise("sourceSet",e,t));n(this,"inputsGet",(e,t="session",i=null)=>this._promise("inputsGet",e,t,i));n(this,"inputScalarsSet",(e,t,i=null)=>this._promise("inputScalarsSet",e,t,i));n(this,"inputFilesAdd",(e,t,i,o=null)=>this._promise("inputFilesAdd",e,t,i,o));n(this,"inputFilesDelete",(e,t,i,o=null)=>this._promise("inputFilesDelete",e,t,i,o));n(this,"inputTableQuery",(e,t,i=1,o=5e3,a=null)=>this._promise("inputTableQuery",e,t,i,o,a));n(this,"inputTableAdd",(e,t,i=[],o=null)=>this._promise("inputTableAdd",e,t,i,o));n(this,"inputTableGet",(e,t,i,o="session",a=null)=>this._promise("inputTableGet",e,t,i,o,a));n(this,"inputTableUpdate",(e,t,i,o,a=null)=>this._promise("inputTableUpdate",e,t,i,o,a));n(this,"inputTableDelete",(e,t,i=null,o=null)=>this._promise("inputTableDelete",e,t,i,o));n(this,"outputTableQuery",(e,t,i,o=1,a=5e3)=>this._promise("outputTableQuery",e,t,i,o,a));n(this,"outputTableAdd",(e,t,i,o)=>this._promise("outputTableAdd",e,t,i,o));n(this,"outputsGet",(e,t)=>this._promise("outputsGet",e,t));n(this,"outputsQuery",(e,t,i=null,o=null,a=null)=>this._promise("outputsQuery",e,t,i,o,a));n(this,"outputScalarSet",async(e,t,i,o)=>this._promise("outputScalarSet",e,t,i,o));n(this,"outputFilesInit",async(e,t,i,o=null)=>this._promise("outputFilesInit",e,t,i,o));n(this,"outputFilesAppend",async(e,t,i,o,a=null)=>this._promise("outputFilesAppend",e,t,i,o,a));n(this,"outputFilesDelete",async(e,t,i)=>this._promise("outputFilesDelete",e,t,i));this._register("diskStorage")}}});var _e=M((Mt,ye)=>{var ze=T();ye.exports=class extends ze{constructor(){super();n(this,"getAt",(e,t)=>this._promise("getAt",e,t));n(this,"create",(e,t,i)=>this._promise("create",e,t,i));n(this,"readAll",(e,t)=>this._promise("readAll",e,t));n(this,"read",(e,t)=>this._promise("read",e,t));n(this,"updateName",(e,t,i)=>this._promise("updateName",e,t,i));n(this,"updateInfo",(e,t,i)=>this._promise("updateInfo",e,t,i));n(this,"updateReady",(e,t,i)=>this._promise("updateReady",e,t,i));n(this,"updateEnabled",(e,t,i)=>this._promise("updateEnabled",e,t,i));n(this,"delete",(e,t=null,i=null)=>this._promise("delete",e,t,i));this._register("session")}}});var ke=M((vt,be)=>{var Je=T();be.exports=class extends Je{constructor(){super();n(this,"install",()=>this._promise("install"));n(this,"check",()=>this._promise("check"));this._register("updater")}}});var Ie=M((Tt,Ee)=>{var Qe=T();Ee.exports=class extends Qe{constructor(){super();n(this,"getOS",()=>this._promise("getOS"));n(this,"getName",()=>this._promise("getName"));n(this,"getUUID",()=>this._promise("getUUID"));n(this,"getSerialNumber",()=>this._promise("getSerialNumber"));n(this,"getRam",()=>this._promise("getRam"));n(this,"getCpuArch",()=>this._promise("getCpuArch"));n(this,"getCpuName",()=>this._promise("getCpuName"));n(this,"getFileSize",e=>this._promise("getFileSize",e));n(this,"setPostAuth",e=>this._promise("setPostAuth",!!e));n(this,"getPostAuth",()=>this._promise("getPostAuth"));n(this,"errorLog",(e,t="")=>this._promise("errorLog",e,t));n(this,"showFileInFolder",e=>this._promise("showFileInFolder",e));n(this,"request",(e,t="GET",i={},o={},a=!0,l=60,c=!0)=>this._promise("request",e,t,i,o,a,l,c));this._register("device")}}});var Ce=M((xt,Me)=>{var Xe=T();Me.exports=class extends Xe{constructor(){super();n(this,"list",()=>this._promise("list"));n(this,"closeAll",()=>this._promise("closeAll"));n(this,"open",e=>this._promise("open",e));n(this,"close",e=>this._promise("close",e));n(this,"webContents",(e,t,i)=>this._promise("webContents",e,t,i));this._register("source")}}});var ve=M((Dt,Se)=>{var Ye=T();Se.exports=class extends Ye{constructor(){super();n(this,"list",()=>this._promise("list"));n(this,"removeAll",()=>this._promise("removeAll"));n(this,"add",(e,t,i=!1)=>this._promise("add",e,t,i));n(this,"initWorker",e=>this._promise("initWorker",e));n(this,"remove",e=>this._promise("remove",e));n(this,"select",e=>this._promise("select",e));n(this,"getSelected",()=>this._promise("getSelected"));n(this,"setControlled",(e,t=!0)=>this._promise("setControlled",e,t));n(this,"openDevTools",(e,t=null)=>this._promise("openDevTools",e,t));n(this,"setDevToolsTitle",(e,t=null)=>this._promise("setDevToolsTitle",e,t));n(this,"getBounds",e=>this._promise("getBounds",e));n(this,"getMouse",e=>this._promise("getMouse",e));n(this,"moveMouse",(e,t,i,o=null,a=!1,l=[])=>this._promise("moveMouse",e,t,i,o,a,l));n(this,"jiggleMouse",(e,t=50,i=[])=>this._promise("jiggleMouse",e,t,i));n(this,"typeAt",(e,t,i,o,a=!1,l=5,c=250)=>this._promise("typeAt",e,t,i,o,a,l,c));n(this,"loadUrl",(e,t,i=60)=>this._promise("loadUrl",e,t,i));n(this,"getUrl",e=>this._promise("getUrl",e));n(this,"getTitle",e=>this._promise("getTitle",e));n(this,"reload",(e,t=!1,i=60)=>this._promise("reload",e,t,i));n(this,"goHome",e=>this._promise("goHome",e));n(this,"goBack",(e,t=60)=>this._promise("goBack",e,t));n(this,"goForward",(e,t=60)=>this._promise("goForward",e,t));n(this,"setFileInput",(e,t,i)=>this._promise("setFileInput",e,t,i));n(this,"openInNewWindow",(e,t)=>this._promise("openInNewWindow",e,t));n(this,"waitForDomReady",(e,t=60)=>this._promise("waitForDomReady",e,t));n(this,"saveDownload",(e,t,i,o=600,a=null)=>this._promise("saveDownload",e,t,i,o,a));n(this,"saveScreenshot",async(e,t,i,o="png",a=null,l=!1,c=100)=>this._promise("saveScreenshot",e,t,i,o,a,l,c));n(this,"captureFrame",(e,t=null,i=null,o=!1,a=null)=>this._promise("captureFrame",e,t,i,o,a));n(this,"getPreview",e=>this._promise("getPreview",e));n(this,"smoothScroll",(e,t,i=100,o=!0)=>this._promise("smoothScroll",e,t,i,o));n(this,"webContents",(e,t,i=[],o=null,a=[])=>this._promise("webContents",e,t,i,o,a));n(this,"sendKeys",(e,t,i={})=>this._promise("sendKeys",e,t,i));this._register("target")}}});var Ne=M((qt,Ae)=>{var Ze=T();Ae.exports=class extends Ze{constructor(){super();n(this,"openExternal",e=>this._promise("openExternal","".concat(e)));this._register("main/login")}}});var Oe=M((Kt,$e)=>{var et=T(),tt=Ne(),K,Te;$e.exports=(Te=class extends et{constructor(e=!0){super();n(this,"login",null);f(this,K,null);n(this,"focus",()=>this._promise("focus"));n(this,"setOnTop",(e=!0)=>this._promise("setOnTop",!!e));n(this,"getOnTop",()=>this._promise("getOnTop"));n(this,"setDarkMode",e=>this._promise("setDarkMode",!!e));n(this,"getDarkMode",()=>this._promise("getDarkMode"));n(this,"getProcessVersions",()=>this._promise("getProcessVersions"));n(this,"getPathForFile",e=>{if(s(this,K)===null)try{C(this,K,require("electron").webUtils)}catch{}return s(this,K)?.getPathForFile(e)||""});n(this,"quit",()=>this._promise("quit"));n(this,"openExternal",e=>this._promise("openExternal","".concat(e)));n(this,"showOpenDialog",(e,t=[],i=!1)=>this._promise("showOpenDialog",e,t,i));this._register("main"),e&&(this.login=new tt)}},K=new WeakMap,Te)});var We=M((Ht,xe)=>{var it=T();xe.exports=class extends it{constructor(){super();n(this,"init",e=>this._promise("init",e));n(this,"getPort",()=>this._promise("getPort"));this._register("llm")}}});var Le=M((zt,De)=>{var{ipcRenderer:Z,contextBridge:st}=require("electron"),rt=we(),nt=_e(),ot=ke(),at=Ie(),lt=Ce(),ct=ve(),ht=Oe(),ut=We(),pt=T(),v=ne(),k,G,E,U,Pe;De.exports=(Pe=class{constructor(r,e=!0){f(this,k,"");f(this,G,{});f(this,E,{});f(this,U,{});n(this,"source",{send:(r,e,t)=>{this.send(v.getSourceChannelName(r),e,t)},invoke:async(r,e,t,i=0)=>await this.invoke(v.getSourceChannelName(r),e,t,i)});n(this,"target",{send:(r,e,t)=>{(async()=>this.send(v.getTargetChannelName(r),e,t))()},invoke:async(r,e,t,i=0)=>await this.invoke(v.getTargetChannelName(r),e,t,i)});n(this,"worker",{send:(r,e,t)=>{(async()=>this.send(v.getWorkerChannelName(r),e,t))()},invoke:async(r,e,t,i=0)=>await this.invoke(v.getWorkerChannelName(r),e,t,i)});let t=this;C(this,k,r),pt.devMode=!1,C(this,U,{irc:{handle:(...i)=>this.handle.call(this,...i),send:(...i)=>this.send.call(this,...i),invoke:async(...i)=>await this.invoke.call(this,...i),source:{send:(...i)=>this.source.send.call(this,...i),invoke:async(...i)=>await this.source.invoke.call(this,...i)},target:{send:(...i)=>this.target.send.call(this,...i),invoke:async(...i)=>await this.target.invoke.call(this,...i)},worker:{send:(...i)=>this.worker.send.call(this,...i),invoke:async(...i)=>await this.worker.invoke.call(this,...i)},winName:s(this,k)},ipc:{diskStorage:new rt,session:new nt,updater:new ot,device:new at,source:new lt,target:new ct,main:new ht,llm:new ut},devMode:!1}),Z.on(s(this,k),(i,o)=>{if(o[0]==="irc-target:cancel-promises"&&typeof o[1]=="string"){for(let y of Object.keys(s(this,E)))if(s(this,E)[y].toWinName===v.getTargetChannelName(o[1])){try{typeof o[2]=="string"?s(this,E)[y].reject(new Error(o[2])):s(this,E)[y].resolve(null)}catch{}delete s(t,E)[y]}return}if(o.length<3)return;let[a,l,c]=o,{type:h,fromWin:w,promiseId:_}=c??{};if(h==="req")(async()=>{let y=null;try{if(typeof a!="string"||typeof s(t,G)[a]!="function")throw new Error('Inter-Renderer Communication: handle "'.concat(a,'" not declared yet'));Array.isArray(l)||(l=[]),y=await s(t,G)[a](...l)}catch(x){let ie=s(t,k).indexOf(v.WINDOW_TARGET)===0?"irc.target.invoke":s(t,k).indexOf(v.WINDOW_WORKER)===0?"irc.worker.invoke":s(t,k).indexOf(v.WINDOW_SOURCE)===0?"irc.source.invoke":s(t,k);y=new Error("".concat(ie,"(").concat(JSON.stringify(a),") ").concat(x.message??x)),s(t,k).indexOf(v.WINDOW_TARGET)===0||s(t,k).indexOf(v.WINDOW_WORKER)}typeof w=="string"&&typeof _=="string"&&Z.send(w,a,y,{type:"res",promiseId:_})})();else{let y=typeof _=="string"?"".concat(a,":").concat(_):null;if(y!==null){let x=s(t,E)[y]??null;x!==null&&(l instanceof Error?x.reject(l):x.resolve(l),delete s(t,E)[y])}}}),e&&st.exposeInMainWorld("sdk",s(this,U))}getSdk(){return s(this,U)}handle(r,e){typeof r=="string"&&typeof e=="function"&&(s(this,G)[r]=e)}send(r,e,t){do{if(typeof r!="string"||typeof e!="string")break;Array.isArray(t)||(t=[]),Z.send(r,e,t,{type:"req",fromWin:s(this,k)})}while(!1)}async invoke(r,e,t,i=0){let o=this;if(typeof r!="string"||typeof e!="string")return null;Array.isArray(t)||(t=[]),i=parseInt(i,10),(!Number.isInteger(i)||i<0)&&(i=0);let a=v.generateKey(),l=new Promise((c,h)=>{s(this,E)["".concat(e,":").concat(a)]={resolve:c,reject:h,toWinName:r}});return i>0&&setTimeout(()=>{let c=typeof a=="string"?"".concat(e,":").concat(a):null;if(typeof s(o,E)[c]<"u"){try{s(o,E)[c].reject(new Error("".concat(e,"() timed out")))}catch{}delete s(o,E)[c]}},i*1e3),Z.send(r,e,t,{type:"req",fromWin:s(this,k),promiseId:a}),l}},k=new WeakMap,G=new WeakMap,E=new WeakMap,U=new WeakMap,Pe)});var Fe=M((Xt,qe)=>{var J=ne(),ft=Le(),H=150,g,d,q,j,b,u,F,m,ee,$,V,W,te,Q,X,O,B,D,Y,Re;qe.exports=(Re=class{constructor(r){f(this,g);f(this,d);f(this,q,new WeakMap);f(this,j,new Map);f(this,b,new AbortController);f(this,u,async r=>{if(s(this,b).signal.aborted)throw C(this,b,new AbortController),new Error("action aborted");await new Promise(e=>setTimeout(e,r))});f(this,F,r=>{if(!(r instanceof Element)||!r.isConnected)return null;let e=s(this,q).get(r);return typeof e!="string"&&(e=J.generateKey(),s(this,q).set(r,e),s(this,j).set(e,r)),e});f(this,m,r=>{if(typeof r!="string")return null;let e=s(this,j).get(r);return typeof e!="object"?null:!(e instanceof Element)||!e.isConnected||r!==s(this,q).get(e)?(s(this,q).delete(e),s(this,j).delete(r),null):e});f(this,ee,r=>{let e=s(this,m).call(this,r),t=null,i=(a,l)=>typeof l=="string"&&a===document.querySelector(l),o=a=>{let l=a.tagName.toLowerCase();if(i(a,l))return l;for(let h of a.attributes)if((["type","name","role","aria-label","aria-labelledby","for"].includes(h.name.toLowerCase())||h.name.toLowerCase().indexOf("data-")===0)&&(l+="[".concat(h.name,'="').concat(CSS.escape(h.value),'"]'),i(a,l)))return l;let c=l;for(let h of a.classList)if(l+=".".concat(CSS.escape(h)),i(a,l))return l;return c};do{if(!(e instanceof Element))break;let a=e.id?"#".concat(CSS.escape(e.id)):null;if(i(e,a)){t=a;break}let l=o(e);if(i(e,l)){t=l;break}let c=e,h=l;for(;c.parentElement;){c=c.parentElement;let w=o(c),_=Array.from(c.parentElement?.children??[]);if(_.length&&(w+=":nth-child(".concat(_.indexOf(c)+1,")")),h="".concat(w," > ").concat(h),i(e,h)){t=h;break}}}while(!1);return t});f(this,$,async(r,e,t=null,i=!1)=>(await s(this,u).call(this,10),r=parseInt(r,10),e=parseInt(e,10),!Number.isInteger(r)||!Number.isInteger(e)?!1:(r<0&&(r=0),e<0&&(e=0),["click","double-click"].includes(t)||(t=null),await s(this,d).ipc.target.moveMouse(s(this,g),r,e,t,i,this.getSkippedBlocks()))));f(this,V,async(r,e)=>{let t=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,o=r<100?1:r>t-100?0:Math.floor(Math.random()*2),a=e<100?1:e>i-100?0:Math.floor(Math.random()*2),l=Math.abs(r+(o?1:-1)*(10+Math.floor(Math.random()*41))),c=Math.abs(e+(a?1:-1)*(10+Math.floor(Math.random()*41))),h=await s(this,$).call(this,l,c);return await s(this,u).call(this,150),h});f(this,W,r=>{if(!(r instanceof Element))return null;let{left:e,top:t,width:i,height:o}=r.getBoundingClientRect(),a=Math.floor(e+i/2+(i>4?-1+Math.floor(Math.random()*3):0)),l=Math.floor(t+o/2+(o>4?-1+Math.floor(Math.random()*3):0));return{x:a,y:l}});f(this,te,r=>{let e=!1;do{if(!(r instanceof Element))break;let t=r.tagName.toLowerCase();if(r.isContentEditable||t==="textarea"){e=!0;break}if(t==="input"&&["text","search","email","url","tel","password","number"].includes(r.type.toLowerCase())){e=!0;break}}while(!1);return e});f(this,Q,r=>{let e=!1;do{if(!(r instanceof Element))break;let t=getComputedStyle(r),i=r.getBoundingClientRect();e=t.display!=="none"&&t.visibility!=="hidden"&&t.opacity!=="0"&&i.width>0&&i.height>0}while(!1);return e});f(this,X,(r,e=1)=>{let t=!1;do{if(!(r instanceof Element))break;let i=r.getBoundingClientRect();t=i.top+i.height-e>0&&i.top+e<(window.innerHeight||document.documentElement.clientHeight)}while(!1);return t});f(this,O,async(r,e=!0)=>{if(await s(this,u).call(this,50),!(r instanceof Element))return!1;let t=await s(this,d).ipc.target.getMouse(s(this,g));if(await s(this,d).ipc.target.webContents(s(this,g),"sendInputEvent",[{type:"mouseWheel",x:t.x,y:t.y,deltaX:0,deltaY:(Math.floor(Math.random()*2)?1:-1)*(Math.floor(Math.random()*3)+1)}]),await s(this,u).call(this,50+Math.floor(Math.random()*51)),r.scrollIntoView({behavior:"instant",block:"center",inline:"center"}),await s(this,u).call(this,350+Math.floor(Math.random()*51)),e){let i=s(this,W).call(this,r);i!==null&&await s(this,$).call(this,i.x,i.y)}return!0});f(this,B,async(r,e=60)=>{let t=performance.now(),i=!1;do{if(performance.now()-t>=e*1e3){i=!1;break}if(i=await r(),i!==!1)break;await s(this,u).call(this,1e3)}while(!0);return i});f(this,D,(r,e=!1)=>{let t=!1,i=!1;do{if(!(r instanceof Element)||!r.isConnected)break;let o=getComputedStyle(r);t=(o.overflowY==="auto"||o.overflowY==="scroll")&&r.scrollHeight>r.clientHeight,i=(o.overflowX==="auto"||o.overflowX==="scroll")&&r.scrollWidth>r.clientWidth}while(!1);return e?{vertical:t,horizontal:i}:t||i});f(this,Y,(r="GET",e={},t={},i=!0)=>{let o=typeof r=="string"?r.trim().toUpperCase():"GET";o.length||(o="GET");let a;if(!["GET","HEAD"].includes(o)){if(i)a=JSON.stringify(e);else if(a=new FormData,typeof e=="object"&&e!==null)for(let c of Object.keys(e))FormData.append(c,e[c])}let l={};if(typeof t=="object"&&t!==null)for(let c of Object.keys(t)){let h=c.toLowerCase().trim();h.length&&(l[h]=t[c])}return i&&(l["content-type"]="application/json"),{method:o,body:a,headers:l}});n(this,"controlled",async(r=!0)=>{r?s(this,b).signal.aborted&&C(this,b,new AbortController):s(this,b).signal.aborted||s(this,b).abort("Action cancelled"),s(this,d).ipc.target.moveMouse(),await s(this,d).ipc.target.setControlled(s(this,g),!!r)});n(this,"getSkippedBlocks",()=>{let r=[];for(let e of[...document.querySelectorAll("select[multiple]")])if(s(this,X).call(this,e,0)){let{left:t,top:i,width:o,height:a}=e.getBoundingClientRect();r.push({x:parseInt(t,10),y:parseInt(i,10),w:parseInt(o,10),h:parseInt(a,10)})}return r});n(this,"query",async(r,e=null,t=null,i=!1,o=!1)=>{await s(this,u).call(this,10);let a=[],l=[];if(r=typeof r=="string"?r.trim():"",t=typeof t=="string"&&t.length?t.toLowerCase():null,i=!!i,r.length){let c=typeof e=="string"?s(this,m).call(this,e):document;l=typeof c?.querySelectorAll=="function"?[...c.querySelectorAll(r)].filter(h=>h instanceof Element&&h.isConnected):[],l.length&&o&&(l=l.filter(h=>{let{top:w,height:_}=h.getBoundingClientRect();return w+_>0})),l.length&&typeof t=="string"&&(l=l.filter(h=>h.innerText.toLowerCase().indexOf(t)!==-1)),l.length&&i&&(l=l.filter(h=>s(this,D).call(this,h))),a=l.map(h=>s(this,F).call(this,h))}return a});n(this,"queryParent",async(r,e=null,t=null,i=!1)=>{await s(this,u).call(this,10);let o=null,a=null;e=typeof e=="string"?e.trim():"",t=typeof t=="string"&&t.length?t.toLowerCase():null,i=!!i;let l=s(this,m).call(this,r);if(l instanceof Element){for(;a===null&&l&&l!==document;)l=l.parentElement,l&&(e.length&&!l.matches(e)||typeof t=="string"&&l.innerText.toLowerCase().indexOf(t)===-1||i&&!s(this,D).call(this,l)||(a=l));o=s(this,F).call(this,a)}return o});n(this,"querySiblings",async(r,e=null,t=null,i=!1)=>{await s(this,u).call(this,10);let o=[],a=[];e=typeof e=="string"?e.trim():"",t=typeof t=="string"&&t.length?t.toLowerCase():null,i=!!i;let l=s(this,m).call(this,r);if(l instanceof Element){let c=l.parentElement;if(document!==c)for(let h of Array.from(c.children))!h||h===l||e.length&&!h.matches(e)||typeof t=="string"&&h.innerText.toLowerCase().indexOf(t)===-1||i&&!s(this,D).call(this,l)||(a.push(h),o.push(s(this,F).call(this,h)))}return o});n(this,"queryAt",async(r,e,t=null,i=null,o=!1)=>{await s(this,u).call(this,10);let a=null,l=null;t=typeof t=="string"?t.trim():"",i=typeof i=="string"&&i.length?i.toLowerCase():null,o=!!o;let c=[],h=[],w=null;e:for(;(w=document.elementFromPoint(r,e))&&!h.includes(w);){do{if(t.length&&!w.matches(t)||typeof i=="string"&&w.innerText.toLowerCase().indexOf(i)===-1||o&&!s(this,D).call(this,w))break;l=w,a=s(this,F).call(this,w);break e}while(!1);h.push(w),c.push({element:w,display:w.style.display}),w.style.display="none"}return c.forEach(({element:_,display:y})=>{_.style.display=y}),a});n(this,"awaitPresent",async(r,e=null,t=null,i=!1,o=60)=>(await s(this,u).call(this,10),await s(this,B).call(this,async()=>{let a=await this.query(r,e,t,i);return Array.isArray(a)&&a.length?a:!1},o)));n(this,"awaitNotPresent",async(r,e=60)=>(await s(this,u).call(this,10),await s(this,B).call(this,async()=>!(s(this,m).call(this,r)instanceof Element),e)));n(this,"awaitVisible",async(r,e=60)=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r);return t instanceof Element?await s(this,B).call(this,async()=>s(this,Q).call(this,t),e):!1});n(this,"awaitNotVisible",async(r,e=60)=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r);return t instanceof Element?await s(this,B).call(this,async()=>{let i=getComputedStyle(t);return!(t.offsetParent!==null&&i.display!=="none"&&i.visibility!=="hidden"&&i.opacity!=="0")},e):!0});n(this,"scrollIntoView",async(r,e=!0)=>await s(this,O).call(this,s(this,m).call(this,r),e));n(this,"getValue",async r=>{await s(this,u).call(this,10);let e=s(this,m).call(this,r),t=null;if(e instanceof Element){let i=e.closest("form")||document;switch(e.tagName.toLowerCase()){case"input":switch(e.type.toLowerCase()){case"checkbox":if(i){let o=i.querySelectorAll('input[type="checkbox"][name="'.concat(CSS.escape(e.name),'"]'));t=o.length>1?[...o].filter(a=>a.checked).map(a=>a.value):e.checked}break;case"radio":i&&(t=[...i.querySelectorAll('input[type="radio"][name="'.concat(CSS.escape(e.name),'"]'))].reduce((a,l)=>l.checked?l.value:a,null));break;case"file":t=[...e.files].map(o=>({name:o.name,size:o.size,type:o.type,lastModified:o.lastModified}));break;default:t=e.value;break}break;case"textarea":t=e.value;break;case"select":t=e.multiple?Array.from(e.selectedOptions).map(o=>o.value):e.value;break}}return t});n(this,"getAttributes",async(r,e=[])=>{await s(this,u).call(this,10);let t={},i=s(this,m).call(this,r);if(i instanceof Element)for(let o of i.attributes){let a=o.name.toLowerCase();(!e.length||e.includes(a))&&(t[a]="".concat(o.value))}return t});n(this,"getTagName",async r=>{await s(this,u).call(this,10);let e=s(this,m).call(this,r),t=null;return e instanceof Element&&(t=e.tagName.toLowerCase()),t});n(this,"getContent",async(r,e=!1)=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r),i=null;return t instanceof Element&&(i=e?t.innerHTML:t.innerText),i});n(this,"getStyle",async(r,e=[])=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r),i={};e=(Array.isArray(e)?e:[]).filter(a=>typeof a=="string"&&a.trim().length>0),e.map(a=>i[a.toLowerCase().trim()]=!0);let o=null;if(t instanceof Element){let a=getComputedStyle(t);o={};for(let l of a)(!e.length||i[l])&&(o[l]=a.getPropertyValue(l))}return o});n(this,"getVisible",async r=>(await s(this,u).call(this,10),s(this,Q).call(this,s(this,m).call(this,r))));n(this,"getScrollable",async r=>(await s(this,u).call(this,10),s(this,D).call(this,s(this,m).call(this,r),!0)));n(this,"getInViewport",async r=>(await s(this,u).call(this,10),s(this,X).call(this,s(this,m).call(this,r))));n(this,"getViewport",async()=>(await s(this,u).call(this,10),{left:0,top:0,width:Math.ceil(window.innerWidth||document.documentElement.clientWidth),height:Math.ceil(window.innerHeight||document.documentElement.clientHeight),scrollLeft:Math.ceil(document.documentElement.scrollLeft),scrollTop:Math.ceil(document.documentElement.scrollTop),scrollWidth:Math.ceil(document.documentElement.scrollWidth),scrollHeight:Math.ceil(document.documentElement.scrollHeight)}));n(this,"getBox",async r=>{await s(this,u).call(this,10);let e=s(this,m).call(this,r);if(!(e instanceof Element))return null;let{top:t,left:i,width:o,height:a}=e.getBoundingClientRect();return{left:Math.ceil(i),top:Math.ceil(t),width:Math.ceil(o),height:Math.ceil(a),scrollLeft:Math.ceil(e.scrollLeft),scrollTop:Math.ceil(e.scrollTop),scrollWidth:Math.ceil(e.scrollWidth),scrollHeight:Math.ceil(e.scrollHeight)}});n(this,"scrollTo",async(r,e=0,t=!0)=>{await s(this,u).call(this,10);let i=s(this,m).call(this,r);if(!(i instanceof Element))return!1;await s(this,O).call(this,i,t),e=parseInt(e,10),Number.isInteger(e)||(e=0);let o=await s(this,d).ipc.target.getMouse(s(this,g)),a=Math.round(e-i.getBoundingClientRect().top);if(await s(this,d).ipc.target.webContents(s(this,g),"sendInputEvent",[{type:"mouseWheel",x:o.x,y:o.y,deltaX:0,deltaY:a}]),t){let l=s(this,W).call(this,i);l!==null&&await s(this,$).call(this,l.x,l.y)}return await s(this,u).call(this,H),!0});n(this,"chooseFiles",async(r,e)=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r);if(!(t instanceof Element)||t.tagName.toLowerCase()!=="input"||t.type.toLowerCase()!=="file"||(e=(Array.isArray(e)?e:[]).map(a=>"".concat(a).trim()).filter(a=>a.length),!e.length))return!1;let i=s(this,ee).call(this,r);if(typeof i!="string")return!1;await s(this,O).call(this,t,!1);let o=await s(this,d).ipc.target.setFileInput(s(this,g),i,e);return await s(this,u).call(this,H),o});n(this,"saveRequest",async(r,e,t,i="GET",o={},a={},l=!0,c=600,h=null)=>{await s(this,u).call(this,10);let w="".concat(r,"-").concat(e),_=performance.now();if(typeof h!="string"||!h.length){h=null;try{let I=new URL(t).pathname.match(/\.([\w]+)$/i);I&&(h=I[1])}catch{}}let{body:y,method:x,headers:ie}=s(this,Y).call(this,i,o,a,l),{fileName:A,filePath:Ke,minSize:oe,maxSize:se}=await s(this,d).ipc.diskStorage.outputFilesInit(s(this,g),r,e,h),N=0,ae=(I=null)=>{s(this,d).irc.send(J.WINDOW_MAIN,"irc-target:download:info",[s(this,g),w,{fileName:A,totalBytes:N,progress:"100",done:!0,error:I}])};try{if(s(this,b).signal.aborted)throw new Error('Download cancelled for "'.concat(A,'"'));s(this,d).irc.send(J.WINDOW_MAIN,"irc-target:download:info",[s(this,g),w,{fileName:A,totalBytes:N,progress:"0",done:!1,error:null}]);let I=await fetch(t,{signal:s(this,b).signal,body:y,method:x,headers:ie,priority:"high",redirect:"follow"});if(!I.ok)throw new Error('HTTP status for "'.concat(A,'": ').concat(I.status));let le=I.headers.get("Content-Length");if(le!==null&&(N=le),N>0){if(Number.isInteger(oe)&&N<oe*1048576)throw new Error('Minimum file size not met for "'.concat(A,'" (').concat((N/1048576).toFixed(3),"MB)"));if(Number.isInteger(se)&&N>se*1048576)throw new Error('Maximum file size exceeded for "'.concat(A,'" (').concat((N/1048576).toFixed(3),"MB)"))}let Ge=I.body.getReader(),ce=!1,he=0;for(;;){let{done:Ue,value:re}=await Ge.read();if(typeof re<"u"){if(!await s(this,d).ipc.diskStorage.outputFilesAppend(s(this,g),r,A,Buffer.from(re),se))throw new Error('Could not save "'.concat(A,'"'));if(performance.now()-_>=c*1e3)throw new Error('Download timed out for "'.concat(A,'" after ').concat(c,"s"));he+=re.length}if(!ce||N>0){ce=!0;let ue=N>0?(he/N*100).toFixed(2):"0";s(this,d).irc.send(J.WINDOW_MAIN,"irc-target:download:info",[s(this,g),w,{fileName:A,totalBytes:N,progress:ue,done:!1,error:null}])}if(s(this,b).signal.aborted)throw new Error('Download cancelled for "'.concat(A,'"'));if(Ue){ae();break}}}catch(I){return ae("".concat(I.message??I)),await s(this,d).ipc.diskStorage.outputFilesDelete(s(this,g),r,A),null}return Ke});n(this,"makeRequest",async(r,e="GET",t={},i={},o=!0,a=60,l=!0)=>{await s(this,u).call(this,10);let{body:c,method:h,headers:w}=s(this,Y).call(this,e,t,i,o),_=setTimeout(()=>s(this,b).abort("Request timed out after ".concat(a,"s")),a*1e3);try{if(s(this,b).signal.aborted)throw new Error("Request cancelled");let y=await fetch(r,{signal:s(this,b).signal,body:c,method:h,headers:w,priority:"high",redirect:"follow"});return!l&&y.body?.cancel?.(),{ok:y.ok,status:y.status,headers:Object.fromEntries(y.headers.entries()),data:l?o?await y.json():await y.text():null}}finally{clearTimeout(_)}});n(this,"saveUrl",async(r,e,t,i=600,o=null)=>(t=new URL(t).toString(),setTimeout(()=>{let a=document.createElement("a");a.href=t,a.style.display="none",a.download=t.replace(/\/+$/g,"").replace(/^.*\//g,"")||e,document.body.appendChild(a),a.click(),document.body.removeChild(a)},250),await s(this,d).ipc.target.saveDownload(s(this,g),r,e,i,o)));n(this,"clickAt",async(r,e,t=!1,i=!1)=>{await s(this,u).call(this,10);let o=await s(this,$).call(this,r,e,t?"double-click":"click");return!i&&await s(this,V).call(this,r,e),o});n(this,"clickOn",async(r,e=!1,t=!1)=>{await s(this,u).call(this,10);let i=s(this,m).call(this,r);if(!(i instanceof Element))return!1;await s(this,O).call(this,i,!1);let o=s(this,W).call(this,i);return await this.clickAt(o.x,o.y,e,t)});n(this,"hoverAt",async(r,e)=>await s(this,$).call(this,r,e));n(this,"hoverOn",async r=>{await s(this,u).call(this,10);let e=s(this,m).call(this,r);if(!(e instanceof Element))return!1;await s(this,O).call(this,e,!1);let t=s(this,W).call(this,e);return await s(this,$).call(this,t.x,t.y)});n(this,"hoverCenter",async()=>{await s(this,u).call(this,10);let r=await s(this,d).ipc.target.getMouse(s(this,g));await s(this,V).call(this,r.x,r.y);let e=Math.round((window.innerWidth||document.documentElement.clientWidth)/2),t=Math.round((window.innerHeight||document.documentElement.clientHeight)/2);return await s(this,$).call(this,e,t)});n(this,"type",async(r,e,t=!1,i=!1,o=5,a=250)=>{await s(this,u).call(this,10),typeof e!="string"&&(e=""),o=parseInt(o,10),a=parseInt(a,10);let l=s(this,m).call(this,r);if(!s(this,te).call(this,l))return!1;await s(this,O).call(this,l);let c=s(this,W).call(this,l),h=await s(this,d).ipc.target.typeAt(s(this,g),c.x,c.y,e,t,o,a);return i&&(await s(this,u).call(this,75+Math.floor(Math.random()*125)),await s(this,d).ipc.target.sendKeys(s(this,g),"enter")),await s(this,u).call(this,H),h});n(this,"typeAt",async(r,e,t,i=!1,o=!1,a=5,l=250)=>{await s(this,u).call(this,10),typeof t!="string"&&(t=""),a=parseInt(a,10),l=parseInt(l,10);let c=await s(this,d).ipc.target.typeAt(s(this,g),r,e,t,i,a,l);return o&&(await s(this,u).call(this,75+Math.floor(Math.random()*125)),await s(this,d).ipc.target.sendKeys(s(this,g),"enter")),await s(this,u).call(this,H),c});n(this,"select",async(r,e)=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r);if(!(t instanceof HTMLSelectElement))return!1;e=(Array.isArray(e)?e:[e]).map(l=>"".concat(l)),await s(this,O).call(this,t),t.focus();let i=process.platform==="darwin"&&!t.multiple;if(i&&(t.multiple=!0),t.multiple){for(let l of t.options)(e.includes(l.value)?!l.selected:l.selected)&&(l.selected=e.includes(l.value));await s(this,u).call(this,25+Math.floor(Math.random()*26));for(let l=0;l<=1;l++)await s(this,d).ipc.target.sendKeys(s(this,g),"space",{ctrl:!0}),await s(this,u).call(this,25+Math.floor(Math.random()*26))}else{let l=Array.from(t.options).map(c=>c.value).indexOf(e[0]);if(l!==-1){t.value=e[0],await s(this,u).call(this,25+Math.floor(Math.random()*26));let c=l===0?["right","left"]:["left","right"];for(let h of c)await s(this,d).ipc.target.sendKeys(s(this,g),h),await s(this,u).call(this,25+Math.floor(Math.random()*26))}}i&&(t.multiple=!1),t.blur();let o=await s(this,d).ipc.target.getMouse(s(this,g));await s(this,V).call(this,o.x,o.y);let{bottom:a}=t.getBoundingClientRect();return await s(this,$).call(this,o.x,a+10),await s(this,u).call(this,H),!0});n(this,"check",async(r,e)=>{await s(this,u).call(this,10);let t=s(this,m).call(this,r);if(!(t instanceof Element)||t.tagName.toLowerCase()!=="input"||!["checkbox","radio"].includes(t.type.toLowerCase()))return!1;e=(Array.isArray(e)?e:[e]).map(o=>"".concat(o));let i=[];do{let o=t.closest("form")||document;if(!o)break;if(t.type.toLowerCase()==="checkbox"){let l=o.querySelectorAll('input[type="checkbox"][name="'.concat(CSS.escape(t.name),'"]'));for(let c of l)(e.includes(c.value)?!c.checked:c.checked)&&i.push(c);break}if(!e.length)break;let a=o.querySelectorAll('input[type="radio"][name="'.concat(CSS.escape(t.name),'"]'));for(let l of a)if(e[0]===l.value&&!l.checked){i.push(l);break}}while(!1);if(await s(this,u).call(this,250),i.length){for(let o of i){await s(this,O).call(this,o);let a=s(this,W).call(this,o);a!==null&&await this.clickAt(a.x,a.y)}await s(this,u).call(this,H)}return!0});C(this,g,r),C(this,d,new ft(J.getTargetChannelName(r),!1).getSdk());for(let e of Object.getOwnPropertyNames(this))typeof this[e]=="function"&&s(this,d).irc.handle(e,this[e])}},g=new WeakMap,d=new WeakMap,q=new WeakMap,j=new WeakMap,b=new WeakMap,u=new WeakMap,F=new WeakMap,m=new WeakMap,ee=new WeakMap,$=new WeakMap,V=new WeakMap,W=new WeakMap,te=new WeakMap,Q=new WeakMap,X=new WeakMap,O=new WeakMap,B=new WeakMap,D=new WeakMap,Y=new WeakMap,Re)});var dt=Fe(),Be=process.argv.filter(p=>p.indexOf("--agent-id=")>=0).shift();if(typeof Be=="string"){let p=Be.split("=")[1];p.length&&new dt(p)}
