/*!
 * @architect Mark Jivko <mark@oglama.com>
 * @copyright Â© 2024-2025 Oglama (https://oglama.com)
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var UO=Object.defineProperty;var ym=t=>{throw TypeError(t)};var BO=(t,e,r)=>e in t?UO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var w=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var _=(t,e,r)=>BO(t,typeof e!="symbol"?e+"":e,r),Ec=(t,e,r)=>e.has(t)||ym("Cannot "+r);var p=(t,e,r)=>(Ec(t,e,"read from private field"),r?r.call(t):e.get(t)),R=(t,e,r)=>e.has(t)?ym("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),U=(t,e,r,i)=>(Ec(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),M=(t,e,r)=>(Ec(t,e,"access private method"),r);var Wt=w((B2,wm)=>{var Ht;wm.exports=(Ht=class{static getSourceChannelName(e){return"".concat(Ht.WINDOW_SOURCE,"/").concat(e)}static getTargetChannelName(e){return"".concat(Ht.WINDOW_TARGET,"/").concat(e)}static generateKey(){return"".concat(Date.now().toString(36)).concat(Math.random().toString(36).substring(2,13))}},_(Ht,"WINDOW_MAIN_LOGIN","@main/login"),_(Ht,"WINDOW_MAIN","@main"),_(Ht,"WINDOW_SOURCE","@source"),_(Ht,"WINDOW_TARGET","@target"),Ht)});var bn=w((W2,Am)=>{Am.exports=class{constructor(e){_(this,"_oglama");this._oglama=e}}});var Sm=w((V2,Em)=>{var Ms=require("path"),jO=require("http"),Sc=require("fs"),HO=bn(),bc;Em.exports=(bc=class extends HO{start(){if(this.constructor._instance===null){let e=Ms.join(this._oglama.rootPath,"ssg"),r=this._oglama.config.getServerPort();this.constructor._instance=new Promise((i,n)=>{try{let s=jO.createServer((o,a)=>{let l=".empty";try{let u=new URL(o.url,"http://0.0.0.0");l=decodeURIComponent(u.pathname).replace(/^\/+|\/+$/g,"")}catch{}let c=Ms.join(e,l);Sc.statSync(c,{throwIfNoEntry:!1})?.isDirectory()&&(c=Ms.join(c,"index.html")),Sc.stat(c,(u,h)=>{let f=u?Ms.join(e,"404/index.html"):c;a.writeHead(u?404:200,{"Content-Length":h.size,"Content-Type":{".js":"application/javascript",".json":"application/json",".woff2":"font/woff2",".html":"text/html",".txt":"text/plain",".css":"text/css",".ico":"image/x-icon",".jpeg":"image/jpeg",".jpg":"image/jpeg",".png":"image/png",".gif":"image/gif",".svg":"image/svg+xml"}[Ms.extname(f)]||"application/octet-stream"}),Sc.createReadStream(f).pipe(a)})});s.listen(r,()=>{this._oglama.log.info("webserver:start","Listening on port ".concat(r)),i(s)})}catch(s){this._oglama.log.error("webserver:start",s),n(s)}})}return this.constructor._instance}},_(bc,"_instance",null),bc)});var _m=w((X2,bm)=>{var{dialog:_c}=require("electron"),WO=require("path"),GO=Wt(),zO=bn();bm.exports=class extends zO{constructor(){super(...arguments);_(this,"_showMessageBox",null)}async start(){let r=WO.join(this._oglama.rootPath,"res","index.html"),i={extraHeaders:"pragma: no-cache"};if(this._oglama.mainWindow().loadFile(r,i),this._oglama.mainLoginWindow().loadFile(r,i),this._oglama.mainWindow().hide(),this._oglama.mainLoginWindow().show(),this._showMessageBox===null){let n=this;this._showMessageBox=_c.showMessageBox,_c.showMessageBox=async function(s,o){if(Array.isArray(o.buttons)&&o.buttons.length){let a=o.buttons.map(l=>l.toLowerCase()).indexOf("ok");if(a!==-1){let l={agentId:null,type:o.buttons.length>1?"confirm":"alert",message:"".concat(o.message??"").trim(),result:o.buttons.length>1?!0:void 0};if(l.message.indexOf("::{")===0)try{let u=JSON.parse(l.message.substring(2));typeof u=="object"&&u!==null&&(l.agentId=u.a??null,l.type=u.t??"alert",l.message=u.m??"",l.result=u.t==="prompt"?u.d??"":u.t==="confirm"?!0:void 0)}catch{}let c=["ipc:oglama:dialog",[l],{type:"req"}];return n._oglama.main?.view.webContents.send(GO.WINDOW_MAIN,c),{response:a}}}return n._showMessageBox.call(_c,s,o)}}}}});var Tm=w((Z2,vm)=>{var VO=bn();vm.exports=class extends VO{error(){console.error("%coglama-error","color:red",...arguments)}info(){console.info("%coglama-info","color:lightblue",...arguments)}}});var Cm=w((tB,Om)=>{var YO=bn();Om.exports=class extends YO{getMainMinWidth(){return 1200}getMainMinHeight(){return 650}getMainLoginWidth(){return 512}getMainLoginHeight(){return 512}getSourceMinWidth(){return 1100}getSourceMinHeight(){return 600}getServerPort(){return 7199}getOllamaPort(){return 7299}}});var _n=w((iB,Rm)=>{var Us;Rm.exports=(Us=class{},_(Us,"WINDOWS","win32"),_(Us,"MACOS","darwin"),_(Us,"LINUX","linux"),Us)});var Xt=w((oB,Im)=>{var{ipcMain:QO}=require("electron"),XO=bn();Im.exports=class extends XO{constructor(e){super(e)}_register(e){if(typeof e=="string")for(let r of Object.getOwnPropertyNames(this)){if(["_","#"].includes(r[0]||typeof this[r]!="function"))continue;let i=this[r];QO.handle("ipc:".concat(e,":").concat(r),async(n,...s)=>{let o=null;try{o=typeof i=="function"?await i(...s):null}catch(a){o=a}return o})}}}});var xm=w((lB,Nm)=>{var vc;Nm.exports=(vc=class{},_(vc,"max",{computersCount:5,agentsCount:9,logsPerAgent:250,logsOnRender:15,sourceCode:{smCodeLength:5120,smCount:64,smEnvSize:256,fnCodeLength:5120,fnCount:128,ioCount:20,ioInputFileCount:500,ioOutputFileCount:50,ioFieldNameLength:32,ioFieldDescLength:512,ioFieldStringLength:1024,ioFieldOptionLength:32,ioFieldOptionCount:25,ioFieldExtensionLength:24,ioFieldExtensionCount:10,ioFieldTableCount:3,ioFieldTableSize:20,ioFieldColumnLength:24,ioFieldColumnCount:6},diskStorage:{outputRunsCount:10}}),vc)});var Pm=w((hB,Dm)=>{var Tc;Dm.exports=(Tc=class{},_(Tc,"ModuleSrc",{K_SRC_STATE_MACHINE:"srcStateMachine",K_SRC_FUNCTIONS:"srcFunctions",K_SRC_INPUTS:"srcInputs",K_SRC_OUTPUTS:"srcOutputs"}),Tc)});var ga=w((dB,$m)=>{var{app:Fm}=require("electron"),Bs=require("path"),Oc=require("os"),Lm=_n(),At,vn,Tn;$m.exports=(At=class{static getPathCache(){if(p(At,vn)===null){let e=process.env.XDG_CACHE_HOME||Bs.join(Oc.homedir(),".cache");switch(process.platform){case Lm.WINDOWS:e=process.env.LOCALAPPDATA||Bs.join(Oc.homedir(),"AppData","Local");break;case Lm.MACOS:e=Bs.join(Oc.homedir(),"Library","Caches");break}U(At,vn,Bs.join(e,"".concat(Fm.name.toLowerCase(),"-updater")))}return p(At,vn)}static getPathConfig(){return p(At,Tn)===null&&U(At,Tn,Bs.join(Fm.getPath("appData"),"oglama")),p(At,Tn)}},vn=new WeakMap,Tn=new WeakMap,R(At,vn,null),R(At,Tn,null),At)});var Um=w((gB,Mm)=>{var j=require("path"),O=require("fs"),KO=Wt(),JO=Xt(),Kt=xm(),{ModuleSrc:Te}=Pm(),ZO=ga(),{shell:eC}=require("electron"),km=150,Cc="default",ya="local",tC="metadata.json",rC="environment.json",iC="source.json",Rc="input.json",wa="input",Ic="output.json",nC="output",On="files",Gt,Oi,Ot,Ci,Et,js,Ri,dr,pr,Ii,Cn,Ni,Rn,Hs,Ws,Nc,xi,Gs,In,te,Ct,St,zs,at,Vs,Ys,ke,Qs,qm;Mm.exports=(qm=class extends JO{constructor(r){super(r);R(this,Gt,{});R(this,Oi,{});R(this,Ot,{});R(this,Ci,{});R(this,Et,null);R(this,js,r=>j.join(p(this,Et),"agents",r,rC));R(this,Ri,r=>j.join(p(this,Et),"agents",r,iC));R(this,dr,(r,i="session",n=null)=>i==="run"?p(this,ke).call(this,r,n,Rc):p(this,Qs).call(this,r,n,Rc));R(this,pr,(r,i,n="session",s=null)=>{let o="".concat(wa,"-").concat(i,".jsonl");return n==="run"?p(this,ke).call(this,r,s,o):p(this,Qs).call(this,r,s,o)});R(this,Ii,async(r,i=[],n={},s="session",o=null)=>{do{if(typeof r!="string"||!Array.isArray(i)||typeof n!="object"||n===null)break;for(let a of i)if(a?.type==="table"){let l=0,c=p(this,pr).call(this,r,a.key,s,o);O.existsSync(c)&&(l=await p(this,Ni).call(this,c)),n[a.key]=l}}while(!1)});R(this,Cn,(r,i,n)=>p(this,ke).call(this,r,n,"".concat(nC,"-").concat(i,".jsonl")));R(this,Ni,async r=>new Promise(i=>{if(!O.existsSync(r)||!O.statSync(r).isFile()){i(0);return}let n=0,s="",o=O.createReadStream(r,{encoding:"utf8"});o.on("error",()=>i(0)),o.on("data",a=>{let l=a.split(/\r\n|\n/);n+=l.length-1,s=l.pop()}),o.on("end",()=>{s.length&&n++,i(n)})}));R(this,Rn,async(r,i,n=null)=>new Promise((s,o)=>{let a=[];if(!O.existsSync(r)||!O.statSync(r).isFile()){s(a);return}let l=0,c="",u=O.createReadStream(r,{encoding:"utf8"});u.on("error",o),u.on("data",h=>{let f=h.split(/\r\n|\n/);c=f.pop();for(let d of f){if(l>=i&&(n===null||a.length<n))try{a.push(JSON.parse(d))}catch{}l++}}),u.on("end",()=>{if(c.length){if(l>=i&&(n===null||a.length<n))try{a.push(JSON.parse(c))}catch{}l++}s(a)})}));R(this,Hs,async(r,i,n,s=!1)=>new Promise(o=>{let a=0;if(!O.existsSync(r)||!O.statSync(r).isFile()){o(a);return}let l=0,c="",u="".concat(r,".temp");O.existsSync(u)&&O.rmSync(u,{force:!0,recursive:!0});let h=O.createReadStream(r,{encoding:"utf8"});h.on("data",f=>{let d=f.split(/\r\n|\n/);c=d.pop();for(let y of d){if(i>=0&&(l!==i||!s)){let A=l!==i?y:JSON.stringify(n);O.writeFileSync(u,"".concat(A,"\n"),{flag:"a",encoding:"utf8"}),a++}l++}}),h.on("close",()=>{if(c.length&&i>=0&&(l!==i||!s)){let f=l!==i?c:JSON.stringify(n);O.writeFileSync(u,"".concat(f,"\n"),{flag:"a",encoding:"utf8"}),a++}O.rmSync(r),O.existsSync(u)&&O.renameSync(u,r),o(a)})}));R(this,Ws,async(r,i)=>new Promise(n=>{let s=-1;if(!O.existsSync(r)||!O.statSync(r).isFile()){n(s);return}let o=0,a="",l=O.createReadStream(r,{encoding:"utf8"});l.on("data",c=>{let u=c.split(/\r\n|\n/);a=u.pop();for(let h of u){if(s===-1)try{let f=JSON.parse(h);if(typeof f=="object"&&f!==null&&f._id===i){s=o;break}}catch{}o++}}),l.on("end",()=>{if(a.length&&s===-1)try{let c=JSON.parse(a);typeof c=="object"&&c!==null&&c._id===i&&(s=o)}catch{}n(s)})}));R(this,Nc,r=>{let i=n=>{let s="";if(typeof n<"u"&&n!==null)try{s=typeof n=="string"?n:JSON.stringify(n),s.includes('"')&&(s=s.replace(/"/g,'""')),(s.includes(",")||s.includes("\n")||s.includes('"'))&&(s='"'.concat(s,'"'))}catch{}return s};return(Array.isArray(r)?r.map(n=>i(n)):[]).join(",")});R(this,xi,(r,i)=>{if(typeof r!="object"||r===null||typeof i!="object"||i===null||i.type!=="table"||!Array.isArray(i.columns)||!i.columns.length)return null;let n={},s=!1;for(let o of i.columns)typeof r[o]<"u"&&(s=!0),n[o]=typeof r[o]=="string"?r[o]:"";return s&&typeof n._id!="string"&&(n={_id:KO.generateKey(),...n}),s?n:null});R(this,Gs,r=>{let i=null;if(typeof r=="object"&&r!==null){i={};for(let n of Object.values(Te))i[n]=(Array.isArray(r[n])?r[n]:[]).filter(s=>typeof s=="object"&&s!==null).map(s=>{for(let o of Object.keys(s))(typeof s[o]>"u"||s[o]===null)&&delete s[o];return s})}return i});R(this,In,(r,i)=>{if(typeof i!="object"||i===null)return null;let n=i.default??null;if(["int","string"].includes(i.type)){let s=o=>{switch(i.type){case"int":o=parseInt(o,10),Number.isInteger(o)?(Number.isInteger(i.min)&&o<i.min&&(o=n),Number.isInteger(i.max)&&o>i.max&&(o=n)):o=n;break;case"string":o="".concat(o||""),(!o.length||i.min!==null&&o.length<i.min)&&(o=n),i.max!==null&&o!==null&&o.length>i.max&&(o=o.substring(0,i.max));break}return Array.isArray(i.options)&&i.options.length&&!i.options.includes(o)&&(o=n),o};r=i.isList?(o=>(o=[...new Set((Array.isArray(o)?o:[o]).map(a=>s(a)).filter(a=>a!==null))],o.length?o:n!==null?[n]:null))(r):s(r)}return i.type==="boolean"&&(r=!!(typeof r>"u"?n:r)),r});R(this,te,r=>"".concat(r??"").replace(/\W+/g,""));R(this,Ct,r=>"".concat(r??"").replace(/[^\w\-]+/gi,""));R(this,St,r=>(r="".concat(r??"").replace(/[^\w\-]+/gi,""),r.length?r:null));R(this,zs,r=>"".concat(r??"").replace(/[^\w\-\.]+/gi,"").replace(/\.{2,}/g,"."));R(this,at,(r,i=32)=>"".concat(r).trim().toLowerCase().replace(/\s+/g,"-").replace(/\.{2,}/g,".").replace(/\-{2,}/g,"-").replace(/\_{2,}/g,"_").replace(/[^\w\.\-]+|^[\-\._]+|[\-\._]+$/gi,"").substring(0,i));R(this,Vs,(r,i)=>{if(typeof r!="object"||r===null||typeof i!="string"||!i.length||!Array.isArray(r.extensions)||!r.extensions.includes(j.extname(i).replace(/^\./g,"").toLowerCase())||!O.existsSync(i)||!O.statSync(i).isFile())return!1;let n=O.statSync(i).size;return!(Number.isInteger(r.min)&&r.min>0&&n<r.min*1048576||Number.isInteger(r.max)&&r.max>0&&n>r.max*1048576)});R(this,Ys,(r,{agentId:i,runId:n,scalarData:s,srcOutputs:o})=>{let a={};do{if(typeof r!="object"||r===null||typeof i!="string"||typeof n!="string"||typeof s!="object"||s===null||!Array.isArray(o)||!o.length||typeof o[0]!="object"||o[0]===null||typeof o[0].type!="string")break;let l=j.join(p(this,ke).call(this,i,n),On);if(O.existsSync(l)&&O.lstatSync(l).isDirectory()){for(let c of O.readdirSync(l,{withFileTypes:!0}))if(c.isFile()){let u=c.name.replace(/^(.*?)\-\d+\..*$/gi,"$1");typeof a[u]>"u"&&(a[u]=[]),a[u].push(j.join(l,c.name))}}for(let c of o){if(c.type==="files"){r[c.key]=(Array.isArray(a[c.key])?a[c.key]:[]).filter(u=>p(this,Vs).call(this,c,u)).slice(0,Kt.max.sourceCode.ioOutputFileCount);continue}r[c.key]=s[c.key],typeof r[c.key]>"u"&&(r[c.key]=c.default??null)}}while(!1);return a});R(this,ke,(r,i=null,n=null)=>{let s=[];return typeof i=="string"&&i.length&&(s.push(i),typeof n=="string"&&n.length&&s.push(n)),j.join(p(this,Et),"agents",r,"runs",...s)});R(this,Qs,(r,i=null,n=null)=>{let s=[typeof i=="string"&&i.length?i:Cc];return typeof n=="string"&&n.length&&s.push(n),j.join(p(this,Et),"agents",r,"sessions",...s)});_(this,"openAgentFiles",async r=>{let i=!1;if(r=p(this,te).call(this,r),r.length){let n=j.dirname(p(this,Ri).call(this,r));O.existsSync(n)&&(eC.openPath(n),i=n)}return i});_(this,"purge",async r=>{let i=!1;if(r=p(this,te).call(this,r),r.length){let n=j.dirname(p(this,Ri).call(this,r));O.existsSync(n)&&(O.rmSync(n,{recursive:!0,force:!0}),i=!0)}return i});_(this,"runInit",(r,i=null,n=null,s=null)=>{if(r=p(this,te).call(this,r),!r.length)throw new Error("Invalid agent ID");i="".concat(i??ya).toLowerCase().replace(/\W+/gi,""),i.length||(i=ya),n=p(this,St).call(this,n);let o="".concat(n??Cc).toLowerCase().replace(/\W+/gi,"");o.length||(o=Cc),(!Number.isInteger(s)||s<=0)&&(s=Math.floor(new Date().getTime()/1e3));let a="".concat(i,"-").concat(o,"-").concat(s),l=null;do{let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_INPUTS],h=c[Te.K_SRC_OUTPUTS];if((!Array.isArray(u)||!u.length)&&(!Array.isArray(h)||!h.length))break;if(l=p(this,ke).call(this,r,a),!O.existsSync(l)){O.mkdirSync(l,{recursive:!0}),O.mkdirSync(j.join(l,On),{recursive:!0});let f=j.dirname(p(this,dr).call(this,r,"session",n));if(typeof f=="string"&&O.existsSync(f)&&O.statSync(f).isDirectory())for(let d of O.readdirSync(f,{withFileTypes:!0}))d.isFile()&&(Rc===d.name||d.name.indexOf("".concat(wa,"-"))===0&&j.extname(d.name)===".jsonl")&&O.copyFileSync(j.join(f,d.name),j.join(l,d.name))}}while(!1);return typeof n=="string"&&this._oglama.session.incrementRuns(r,n),{runId:a,runPath:l}});_(this,"runDelete",(r,i)=>{let n=!1;do{if(r=p(this,te).call(this,r),!r.length||(i=p(this,Ct).call(this,i),!i.length))break;let s=p(this,ke).call(this,r,i);O.existsSync(s)&&(O.rmSync(s,{recursive:!0}),n=!0)}while(!1);return n});_(this,"envGet",r=>{if(r=p(this,te).call(this,r),!r.length)return{};if(typeof p(this,Gt)[r]>"u"){try{let i=p(this,js).call(this,r);O.existsSync(i)&&O.statSync(i).isFile()&&(p(this,Gt)[r]=JSON.parse(O.readFileSync(i).toString()))}catch{}(typeof p(this,Gt)[r]!="object"||p(this,Gt)[r]===null)&&(p(this,Gt)[r]={})}return p(this,Gt)[r]});_(this,"envSet",(r,i)=>(r=p(this,te).call(this,r),!r.length||typeof i!="object"?!1:(i!==null?p(this,Gt)[r]=i:delete p(this,Gt)[r],typeof p(this,Oi)[r]<"u"&&clearTimeout(p(this,Oi)[r]),p(this,Oi)[r]=setTimeout(()=>{delete p(this,Oi)[r];let n=p(this,js).call(this,r);i!==null?O.writeFileSync(n,JSON.stringify(i,null,2)):O.existsSync(n)&&O.rmSync(n)},km),!0)));_(this,"sourceGet",r=>{if(r=p(this,te).call(this,r),!r.length)return null;if(typeof p(this,Ot)[r]!="object"||p(this,Ot)[r]===null){p(this,Ot)[r]=null;try{let i=p(this,Ri).call(this,r);if(!O.existsSync(i)||!O.statSync(i).isFile())throw new Error('"'.concat(j.basename(i),'" file not found'));p(this,Ot)[r]=p(this,Gs).call(this,JSON.parse(O.readFileSync(i).toString()))}catch{}}return p(this,Ot)[r]});_(this,"sourceSet",(r,i)=>{let n=!1;r=p(this,te).call(this,r);do{if(!r.length||(i=p(this,Gs).call(this,i),JSON.stringify(this.sourceGet(r))===JSON.stringify(i)))break;p(this,Ot)[r]=i,typeof p(this,Ci)[r]<"u"&&clearTimeout(p(this,Ci)[r]),p(this,Ci)[r]=setTimeout(()=>{delete p(this,Ci)[r];let s=p(this,Ri).call(this,r);if(O.existsSync(j.dirname(s))||O.mkdirSync(j.dirname(s),{recursive:!0}),p(this,Ot)[r]!==null){let o=p(this,Ot)[r][Te.K_SRC_INPUTS],a=[];if(Array.isArray(o)&&o.length)for(let u of o)typeof u=="object"&&u!==null&&u.type==="table"&&typeof u.key=="string"&&a.push("".concat(wa,"-").concat(u.key,".jsonl"));let l=j.join(p(this,Et),"agents",r,"sessions");O.existsSync(l)||O.mkdirSync(l,{recursive:!0});let c=O.readdirSync(l,{withFileTypes:!0}).filter(u=>u.isDirectory()).map(u=>u.name);for(let u of c){let h=j.dirname(p(this,dr).call(this,r,"session",u));if(O.existsSync(h)&&O.lstatSync(h).isDirectory())for(let f of O.readdirSync(h,{withFileTypes:!0}))!f.isFile()||f.name.indexOf("".concat(wa,"-"))!==0||a.includes(f.name)||O.rmSync(j.join(h,f.name))}O.writeFileSync(s,JSON.stringify(p(this,Ot)[r],null,2))}else O.existsSync(s)&&O.rmSync(s)},km),n=!0}while(!1);return n});_(this,"inputsGet",async(r,i="session",n=null)=>{let s={};r=p(this,te).call(this,r),n=i==="run"?p(this,Ct).call(this,n):p(this,St).call(this,n);do{if(!r.length||typeof n=="string"&&!n.length)break;let o=this.sourceGet(r);if(typeof o!="object"||o===null)break;let a=o[Te.K_SRC_INPUTS];if(!Array.isArray(a)||!a.length)break;let l=p(this,dr).call(this,r,i,n),c={};if(O.existsSync(l)&&O.statSync(l).isFile())try{if(c=JSON.parse(O.readFileSync(l).toString()),typeof c!="object"||c===null)throw c={},new Error("Corrupted data")}catch{}for(let u of a)["int","string","boolean"].includes(u.type)&&(s[u.key]=p(this,In).call(this,c[u.key],u)),u.type==="files"&&(s[u.key]=(Array.isArray(c[u.key])?c[u.key]:[]).slice(0,Kt.max.sourceCode.ioInputFileCount));i==="session"&&await p(this,Ii).call(this,r,a,s,i,n)}while(!1);return s});_(this,"inputScalarsSet",async(r,i,n=null)=>{let s={};r=p(this,te).call(this,r),n=p(this,St).call(this,n);do{if(!r.length)break;let o=this.sourceGet(r);if(typeof o!="object"||o===null)break;let a=o[Te.K_SRC_INPUTS];if(!Array.isArray(a)||!a.length)break;let l=p(this,dr).call(this,r,"session",n),c={};try{O.existsSync(l)&&O.statSync(l).isFile()&&(c=JSON.parse(O.readFileSync(l).toString()),(typeof c!="object"||c===null)&&(c={}))}catch{}for(let u of a)if(u.type!=="table"){if(s[u.key]=c[u.key],u.type==="files"){s[u.key]=(Array.isArray(s[u.key])?s[u.key]:[]).slice(0,Kt.max.sourceCode.ioInputFileCount);continue}(typeof s[u.key]>"u"||s[u.key]===null)&&(s[u.key]=u.default??null),typeof i=="object"&&i!==null&&typeof i[u.key]<"u"&&(s[u.key]=p(this,In).call(this,i[u.key],u),s[u.key]===null&&delete s[u.key])}O.existsSync(j.dirname(l))||O.mkdirSync(j.dirname(l),{recursive:!0}),O.writeFileSync(l,JSON.stringify(s,null,2)),await p(this,Ii).call(this,r,a,s,"session",n)}while(!1);return s});_(this,"inputFilesAdd",async(r,i,n,s=null)=>{let o={},a=[];r=p(this,te).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s);do{if(!r.length||!i.length)break;let l=this.sourceGet(r);if(typeof l!="object"||l===null)break;let c=l[Te.K_SRC_INPUTS];if(!Array.isArray(c)||!c.length)break;let u=p(this,dr).call(this,r,"session",s),h={};try{O.existsSync(u)&&O.statSync(u).isFile()&&(h=JSON.parse(O.readFileSync(u).toString()),(typeof h!="object"||h===null)&&(h={}))}catch{}for(let f of c)if(f.type!=="table"){if(o[f.key]=h[f.key],f.type!=="files"){typeof o[f.key]>"u"&&(o[f.key]=f.default??null);continue}(typeof o[f.key]>"u"||!Array.isArray(o[f.key]))&&(o[f.key]=[]),f.key===i&&(a=(Array.isArray(n)?n:[]).map(d=>j.normalize("".concat(d).trim())).filter(d=>p(this,Vs).call(this,f,d,"")),o[f.key]=[...new Set([...o[f.key],...a])].slice(0,Kt.max.sourceCode.ioInputFileCount))}O.existsSync(j.dirname(u))||O.mkdirSync(j.dirname(u),{recursive:!0}),O.writeFileSync(u,JSON.stringify(o,null,2)),await p(this,Ii).call(this,r,c,o,"session",s)}while(!1);return o});_(this,"inputFilesDelete",async(r,i,n,s=null)=>{let o={};r=p(this,te).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s);let a=j.basename("".concat(n));do{if(!r.length||!i.length)break;let l=this.sourceGet(r);if(typeof l!="object"||l===null)break;let c=l[Te.K_SRC_INPUTS];if(!Array.isArray(c)||!c.length)break;let u=p(this,dr).call(this,r,"session",s),h={};try{O.existsSync(u)&&O.statSync(u).isFile()&&(h=JSON.parse(O.readFileSync(u).toString()),(typeof h!="object"||h===null)&&(h={}))}catch{}for(let f of c)if(f.type!=="table"){if(o[f.key]=h[f.key],f.type!=="files"){typeof o[f.key]>"u"&&(o[f.key]=f.default??null);continue}(typeof o[f.key]>"u"||!Array.isArray(o[f.key]))&&(o[f.key]=[]),f.key===i&&(o[f.key]=(Array.isArray(o[f.key])?o[f.key]:[]).filter(d=>d!==j.normalize("".concat(n))).slice(0,Kt.max.sourceCode.ioInputFileCount))}O.existsSync(j.dirname(u))||O.mkdirSync(j.dirname(u),{recursive:!0}),O.writeFileSync(u,JSON.stringify(o,null,2)),await p(this,Ii).call(this,r,c,o,"session",s)}while(!1);return o});_(this,"inputTableQuery",async(r,i,n=1,s=5e3,o=null)=>{let a=[],l=0;n=parseInt(n,10),(!Number.isInteger(n)||n<1)&&(n=1),s=parseInt(s,10),(!Number.isInteger(s)||s<1)&&(s=1);do{if(r=p(this,te).call(this,r),i=p(this,at).call(this,i),o=p(this,St).call(this,o),!r.length||!i.length)break;let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_INPUTS];if(!Array.isArray(u)||!u.length||u.reduce((d,y)=>y.type==="table"&&y.key===i?y:d,null)===null)break;let f=p(this,pr).call(this,r,i,"session",o);if(!O.existsSync(f))break;if(l=await p(this,Ni).call(this,f),l>0)try{a=await p(this,Rn).call(this,f,(n-1)*s,s)}catch{}}while(!1);return{rows:a,total:l,pageNumber:n,pageSize:s}});_(this,"inputTableAdd",async(r,i,n=[],s=null)=>{let o=!1;do{if(r=p(this,te).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s),!r.length||!i.length)break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_INPUTS];if(!Array.isArray(l)||!l.length)break;let c=l.reduce((h,f)=>f.type==="table"&&f.key===i?f:h,null);if(c===null||(n=Array.isArray(n)?n.map(h=>p(this,xi).call(this,h,c)).filter(h=>h!==null):[],!n.length))break;let u=p(this,pr).call(this,r,i,"session",s);if(O.existsSync(u)&&O.statSync(u).size/1048576>=Kt.max.sourceCode.ioFieldTableSize)break;O.existsSync(j.dirname(u))||O.mkdirSync(j.dirname(u),{recursive:!0}),O.writeFileSync(u,"".concat(n.map(h=>JSON.stringify(h)).join("\n"),"\n"),{flag:"a",encoding:"utf8"}),o=!0}while(!1);return o});_(this,"inputTableGet",async(r,i,n,s="session",o=null)=>{let a=null,l=null;r=p(this,te).call(this,r),o=s==="run"?p(this,Ct).call(this,o):p(this,St).call(this,o);do{if(!r.length||(i=p(this,at).call(this,i),!i.length)||typeof o=="string"&&!o.length)break;let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_INPUTS];if(!Array.isArray(u)||!u.length)break;let h=u.reduce((y,A)=>A.type==="table"&&A.key===i?A:y,null);if(h===null)break;let f=p(this,pr).call(this,r,i,s,o);if(!O.existsSync(f))break;let d=await p(this,Ni).call(this,f);if(n<d)try{let y=await p(this,Rn).call(this,f,n,1);y.length&&(a=p(this,xi).call(this,y[0],h))}catch{}n<d-1&&(l=n+1)}while(!1);return{row:a,nextIndex:l}});_(this,"inputTableUpdate",async(r,i,n,s,o=null)=>{let a=!1;do{if(r=p(this,te).call(this,r),i=p(this,at).call(this,i),o=p(this,St).call(this,o),!r.length||!i.length)break;let l=this.sourceGet(r);if(typeof l!="object"||l===null)break;let c=l[Te.K_SRC_INPUTS];if(!Array.isArray(c)||!c.length)break;let u=c.reduce((d,y)=>y.type==="table"&&y.key===i?y:d,null);if(u===null||(s=p(this,xi).call(this,s,u),s===null))break;let h=p(this,pr).call(this,r,i,"session",o),f=await p(this,Ws).call(this,h,n);f>=0&&(await p(this,Hs).call(this,h,f,s),a=!0)}while(!1);return a});_(this,"inputTableDelete",async(r,i,n=null,s=null)=>{let o=!1;do{if(r=p(this,te).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s),!r.length||!i.length)break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_INPUTS];if(!Array.isArray(l)||!l.length||l.reduce((h,f)=>f.type==="table"&&f.key===i?f:h,null)===null)break;let u=p(this,pr).call(this,r,i,"session",s);if(typeof n=="string"){let h=await p(this,Ws).call(this,u,n);h>=0&&await p(this,Hs).call(this,u,h,null,!0),o=!0;break}O.existsSync(u)&&(O.rmSync(u),o=!0)}while(!1);return o});_(this,"outputTableQuery",async(r,i,n,s=1,o=5e3)=>{let a=[],l=0;s=parseInt(s,10),(!Number.isInteger(s)||s<1)&&(s=1),o=parseInt(o,10),(!Number.isInteger(o)||o<1)&&(o=1);do{if(r=p(this,te).call(this,r),n=p(this,at).call(this,n),i=Array.isArray(i)?[...new Set(i)].slice(-Kt.max.diskStorage.outputRunsCount):[],!r.length||!n.length||!i.length)break;let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_OUTPUTS];if(!Array.isArray(u)||!u.length||u.reduce((T,I)=>I.type==="table"&&I.key===n?I:T,null)===null)break;let f={};for(let T of i){let I=p(this,Cn).call(this,r,n,T);if(!O.existsSync(I))continue;let L=await p(this,Ni).call(this,I);L>0&&(l+=L,f[T]=L)}let d=[],y=(s-1)*o,A=0,E=0,v=0;for(let T of Object.keys(f)){if(A>=o)break;v+=f[T]-1;let I=y>=E&&y<=v,L=y+o-1>=E&&y+o-1<=v,oe=y<=E&&y+o-1>=v;if(I||oe||L){let B=y-E,z=Math.min(v-y+1,o-A);A+=z,d.push({runId:T,startIndex:B,count:z})}E+=f[T],v=E}if(!d.length)break;for(let T of d){let{runId:I,startIndex:L,count:oe}=T,B=p(this,Cn).call(this,r,n,I),z=parseInt(I.replace(/^.*\-(\d+)$/g,"$1"),10);try{a=a.concat((await p(this,Rn).call(this,B,L,oe)).map(S=>(S._time=z,S)))}catch{}}}while(!1);return{rows:a,total:l,pageNumber:s,pageSize:o}});_(this,"outputTableAdd",(r,i,n,s)=>{let o=!1;do{if(r=p(this,te).call(this,r),!r.length||(n=p(this,at).call(this,n),!n.length)||(i=p(this,Ct).call(this,i),!i.length))break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_OUTPUTS];if(!Array.isArray(l)||!l.length)break;let c=l.reduce((h,f)=>f.type==="table"&&f.key===n?f:h,null);if(c===null||(s=p(this,xi).call(this,s,c),s===null))break;let u=p(this,Cn).call(this,r,n,i);if(O.existsSync(u)&&O.statSync(u).size/1048576>=Kt.max.sourceCode.ioFieldTableSize)break;O.existsSync(j.dirname(u))||O.mkdirSync(j.dirname(u),{recursive:!0}),O.writeFileSync(u,"".concat(JSON.stringify(s),"\n"),{flag:"a",encoding:"utf8"}),o=!0}while(!1);return o});_(this,"outputsGet",(r,i,n=null)=>{let s={},o={};do{if(r=p(this,te).call(this,r),!r.length||(i=p(this,Ct).call(this,i),!i.length))break;let a=p(this,ke).call(this,r,i);if(!O.existsSync(a)||!O.statSync(a).isDirectory())break;let l=p(this,ke).call(this,r,i,Ic),c={};try{O.existsSync(l)&&O.statSync(l).isFile()&&(c=JSON.parse(O.readFileSync(l).toString()),(typeof c!="object"||c===null)&&(c={}))}catch{}if(!Array.isArray(n)||!n.length){let u=this.sourceGet(r);if(typeof u!="object"||u===null||(n=u[Te.K_SRC_OUTPUTS],!Array.isArray(n)||!n.length))break}o=p(this,Ys).call(this,s,{agentId:r,runId:i,scalarData:c,srcOutputs:n})}while(!1);return s});_(this,"outputsQuery",(r,i,n=null,s=null)=>{let o=[],a=0,l={};do{if(r=p(this,te).call(this,r),!r.length)break;let c=p(this,ke).call(this,r);if(!O.existsSync(c)||!O.statSync(c).isDirectory())break;i="".concat(i??ya).toLowerCase().replace(/\W+/gi,""),i.length||(i=ya);let u=this.sourceGet(r);if(typeof u!="object"||u===null)break;let h=u[Te.K_SRC_OUTPUTS];if(!Array.isArray(h)||!h.length)break;for(let f of h)l[f.key]=[];(!Number.isInteger(n)||n<=0)&&(n=Math.floor(new Date().setHours(0,0,0,0)/1e3)),(!Number.isInteger(s)||s<=0)&&(s=Math.floor(new Date().getTime()/1e3));for(let f of O.readdirSync(c,{withFileTypes:!0})){let d=f.name;if(!f.isDirectory()||d.indexOf("".concat(i,"-"))!==0)continue;let y=d.match(/\-(\d+)$/);if(!y)continue;let A=parseInt(y[1],10);!Number.isInteger(A)||A<n||A>s||(o.push(d),a++)}o.sort((f,d)=>{let y="".concat(f).trim().split("-").pop(),A="".concat(d).trim().split("-").pop();return y>A?1:y<A?-1:0}),o.length>Kt.max.diskStorage.outputRunsCount&&(o=o.slice(-Kt.max.diskStorage.outputRunsCount));for(let f of o){let d=p(this,ke).call(this,r,f,Ic),y={};try{O.existsSync(d)&&O.statSync(d).isFile()&&(y=JSON.parse(O.readFileSync(d).toString()),(typeof y!="object"||y===null)&&(y={}))}catch{}let A={};p(this,Ys).call(this,A,{agentId:r,runId:f,scalarData:y,srcOutputs:h});for(let E of h)typeof A[E.key]<"u"&&l[E.key].push({runId:f,runData:A[E.key]})}}while(!1);return{runIds:o,runIdsTotal:a,fields:l}});_(this,"outputScalarSet",async(r,i,n,s)=>{let o=!1;do{if(r=p(this,te).call(this,r),!r.length||(i=p(this,Ct).call(this,i),!i.length))break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_OUTPUTS];if(!Array.isArray(l)||!l.length)break;let c=l.reduce((d,y)=>["int","string","boolean"].includes(y.type)&&y.key===n?y:d,null);if(c===null)break;let u=await this.outputsGet(r,i,l);u[n]=p(this,In).call(this,s,c);let h={};for(let d of l)["int","string","boolean"].includes(d.type)&&typeof u[d.key]<"u"&&(h[d.key]=u[d.key]);let f=p(this,ke).call(this,r,i,Ic);O.existsSync(j.dirname(f))||O.mkdirSync(j.dirname(f),{recursive:!0}),O.writeFileSync(f,JSON.stringify(h,null,2)),o=!0}while(!1);return o});_(this,"outputFilesInit",(r,i,n,s=null)=>{if(r=p(this,te).call(this,r),!r.length)throw new Error("Invalid agent ID");if(i=p(this,Ct).call(this,i),!i.length)throw new Error("Invalid run ID");if(n=p(this,at).call(this,n),!n.length)throw new Error("Invalid output key");let o=p(this,ke).call(this,r,i);if(!O.existsSync(o)||!O.statSync(o).isDirectory())throw new Error("Run not initialized");let a=j.join(o,On);O.existsSync(a)||O.mkdirSync(a,{recursive:!0});let l=this.sourceGet(r);if(typeof l!="object"||l===null)throw new Error("Source code not defined for this agent");let c=l[Te.K_SRC_OUTPUTS];if(!Array.isArray(c)||!c.length)throw new Error("Outputs not defined for this agent");let u=c.reduce((v,T)=>T.type==="files"&&T.key===n?T:v,null);if(u===null)throw new Error('Field "'.concat(n,'" is not of type file'));Array.isArray(u.extensions)||(u.extensions=["txt"]),s=typeof s=="string"?p(this,at).call(this,s):null,u.extensions.includes(s)||(s=u.extensions[0]);let h=0,f="".concat(n,"-"),[d,y]=i.split("-");for(let v of O.readdirSync(j.dirname(o),{withFileTypes:!0})){if(!v.isDirectory())continue;let[T,I]=v.name.split("-");if(T!==d||I!==y)continue;let L=j.join(j.dirname(o),v.name,On);if(O.existsSync(L)){for(let oe of O.readdirSync(L,{withFileTypes:!0}))if(oe.isFile()&&oe.name.indexOf(f)===0){let B=parseInt(oe.name.substring(f.length).replace(/^(\d+).*/,"$1"),10);Number.isInteger(B)&&B>0&&B>h&&(h=B)}}}let A="".concat(n,"-").concat(h+1,".").concat(s),E=j.join(a,A);return O.writeFileSync(E,"",{flag:"a"}),{fileName:A,filePath:E,minSize:Number.isInteger(u.min)&&u.min>0?u.min:null,maxSize:Number.isInteger(u.max)&&u.max>0?u.max:null}});_(this,"outputFilesAppend",async(r,i,n,s,o=null)=>{let a=!1;if(r=p(this,te).call(this,r),i=p(this,Ct).call(this,i),n=p(this,zs).call(this,n),r.length&&i.length&&n.length){let l=j.join(p(this,ke).call(this,r,i),On,n);if(O.existsSync(l)){if(Number.isInteger(o)&&O.statSync(l).size+s.length>o*1048576)throw O.rmSync(l),new Error("Maximum file size exceeded for ".concat(n," (").concat(o,"MB)"));O.writeFileSync(l,s,{flag:"a"}),a=!0}}return a});_(this,"outputFilesDelete",async(r,i,n)=>{let s=!1;if(r=p(this,te).call(this,r),i=p(this,Ct).call(this,i),n=p(this,zs).call(this,n),r.length&&i.length&&n.length){let o=j.join(p(this,ke).call(this,r,i),On,n);O.existsSync(o)&&(O.rmSync(o,{force:!0}),s=!0)}return s});this._register("diskStorage"),U(this,Et,ZO.getPathConfig()),O.existsSync(p(this,Et))||O.mkdirSync(p(this,Et),{recursive:!0})}getSessionMetaPath(r){return r=p(this,te).call(this,r),r.length?j.join(p(this,Et),"agents",r,"sessions",tC):null}getStorePath(){return p(this,Et)}},Gt=new WeakMap,Oi=new WeakMap,Ot=new WeakMap,Ci=new WeakMap,Et=new WeakMap,js=new WeakMap,Ri=new WeakMap,dr=new WeakMap,pr=new WeakMap,Ii=new WeakMap,Cn=new WeakMap,Ni=new WeakMap,Rn=new WeakMap,Hs=new WeakMap,Ws=new WeakMap,Nc=new WeakMap,xi=new WeakMap,Gs=new WeakMap,In=new WeakMap,te=new WeakMap,Ct=new WeakMap,St=new WeakMap,zs=new WeakMap,at=new WeakMap,Vs=new WeakMap,Ys=new WeakMap,ke=new WeakMap,Qs=new WeakMap,qm)});var Hm=w((AB,jm)=>{var Xs=require("path"),Rt=require("fs"),sC=Wt(),oC=Xt(),Ce,mr,Di,Bm;jm.exports=(Bm=class extends oC{constructor(r){super(r);R(this,Ce);_(this,"getAt",(r,i)=>{let n=M(this,Ce,mr).call(this,r);if(!Array.isArray(n)||!Number.isInteger(i)||i<=0)return null;let s=null,o=new Date(i*1e3),a=o.getFullYear(),l=o.getMonth()+1,c=o.getDate(),u=o.getHours(),h=o.getMinutes();for(let d of n)if(d.sessionType==="schedule"&&d.sessionReady&&d.sessionInfo.year===a&&d.sessionInfo.month===l&&d.sessionInfo.day===c&&d.sessionInfo.hour===u&&d.sessionInfo.minute===h){s=d;break}if(s!==null)return s;let f=(d,y=!1)=>{if(d="".concat(d??"").trim(),d==="*")return()=>!0;if(d[0]==="%"){let A=Math.abs(parseInt(d.substring(1),10));if(Number.isInteger(A)&&A>=2&&A<=1e3)return E=>E%A===0}if(d.match(/^\d+(?:,\d+)*?$/)){let A=d.split(",").map(E=>Math.abs(parseInt(E.trim(),10))).filter(E=>Number.isInteger(E));if(A.length)return E=>A.includes(E)}if(y&&d.match(/^\d+(?:,\d+)*?$/)){let A=d.substring(1).split(",").map(E=>Math.abs(parseInt(E.trim(),10))).filter(E=>Number.isInteger(E)&&E>=1&&E<=7);if(A.length)return E=>A.includes(E)}return()=>!1};for(let d of n)if(d.sessionType==="cron"&&d.sessionReady&&f(d.sessionInfo.day,!0)(c)&&f(d.sessionInfo.hour)(u)&&f(d.sessionInfo.minute)(h)){s=d;break}return s});_(this,"create",(r,i,n)=>{let s=M(this,Ce,mr).call(this,r);if(!Array.isArray(s))return null;let o=n[0]+sC.generateKey().substring(1);do{if(typeof i=="string"&&(i=i.toLowerCase().trim(),i.length))break;i=null}while(!1);["schedule","cron"].includes(n)||(n="schedule");let a=0,l=!1,c="[ ".concat(n==="schedule"?"scheduled":"recurring"," ]"),u=new Date(new Date().getTime()+864e5),h=n==="schedule"?{year:u.getFullYear(),month:u.getMonth()+1,day:u.getDate(),hour:u.getHours(),minute:u.getMinutes()}:{day:"*",hour:"*",minute:"0"};return s.push({sessionId:o,moduleId:i,sessionRunCount:a,sessionReady:l,sessionName:c,sessionType:n,sessionInfo:h}),M(this,Ce,Di).call(this,r,s),o});_(this,"readAll",(r,i)=>{let n=M(this,Ce,mr).call(this,r,i);return Array.isArray(n)?n:[]});_(this,"updateName",(r,i,n)=>{let s=M(this,Ce,mr).call(this,r);if(!Array.isArray(s))return"";let o=s.reduce((a,l)=>l.sessionId===i?l.sessionType:a,null);return["schedule","cron"].includes(o)?(n="".concat(n??"").replace(/\s+/g," ").substring(0,32).trim(),M(this,Ce,Di).call(this,r,s.map(a=>a.sessionId===i?{...a,sessionName:n}:a)),n):""});_(this,"updateInfo",(r,i,n)=>{let s=M(this,Ce,mr).call(this,r);if(!Array.isArray(s))return!1;let o=s.reduce((l,c)=>c.sessionId===i?c.sessionType:l,null);if(!["schedule","cron"].includes(o)||typeof n!="object"||n===null)return!1;let a={};if(o==="schedule")for(let l of["year","month","day","hour","minute"]){if(!Number.isInteger(n[l])||n[l]<0||n[l]>1e4)return!1;a[l]=n[l]}else for(let l of["day","hour","minute"]){if(typeof n[l]!="string"||!n[l].length)return!1;a[l]=n[l]}return n=a,M(this,Ce,Di).call(this,r,s.map(l=>l.sessionId===i?{...l,sessionInfo:n}:l)),!0});_(this,"updateReady",(r,i,n)=>{let s=M(this,Ce,mr).call(this,r);if(!Array.isArray(s))return!1;let o=s.reduce((l,c)=>c.sessionId===i?c.sessionType:l,null);return["schedule","cron"].includes(o)?(n=!!n,s.reduce((l,c)=>c.sessionId===i?c.sessionReady:l,!1)!==n?(M(this,Ce,Di).call(this,r,s.map(l=>l.sessionId===i?{...l,sessionReady:n}:l)),!0):!1):!1});_(this,"delete",(r,i=null,n=null)=>{let s=M(this,Ce,mr).call(this,r);return Array.isArray(s)?(s=s.filter(o=>typeof i=="string"&&o.sessionType!==i||typeof n=="string"&&o.sessionId!==n),M(this,Ce,Di).call(this,r,s),!0):!1});this._register("session")}incrementRuns(r,i){let n=M(this,Ce,mr).call(this,r);if(!Array.isArray(n))return!1;let s=n.reduce((l,c)=>c.sessionId===i?c.sessionType:l,null);if(!["schedule","cron"].includes(s)||!n.reduce((l,c)=>c.sessionId===i?c.sessionReady:l,!1))return!1;let a=n.reduce((l,c)=>c.sessionId===i?c.sessionRunCount:l,0);return Number.isInteger(a)&&a>0?a++:a=1,M(this,Ce,Di).call(this,r,n.map(l=>l.sessionId===i?{...l,sessionRunCount:a}:l)),!0}},Ce=new WeakSet,mr=function(r,i=null){let n=this._oglama.diskStorage.getSessionMetaPath(r);if(typeof n!="string"||!Rt.lstatSync(Xs.dirname(n)).isDirectory())return null;let s=[];if(!Rt.existsSync(n))Rt.writeFileSync(n,"[]");else try{let l=JSON.parse(Rt.readFileSync(n).toString());Array.isArray(l)&&(s=l)}catch{}let o=Xs.join(this._oglama.diskStorage.getStorePath(),"agents",r,"sessions");Rt.existsSync(o)||Rt.mkdirSync(o,{recursive:!0});let a=Rt.readdirSync(o,{withFileTypes:!0}).filter(l=>l.isDirectory()&&l.name!=="default").map(l=>l.name);return s=s.filter(l=>typeof l=="object"&&typeof l?.sessionId=="string"&&(i===null||l?.sessionType===i)&&a.includes(l.sessionId)),s},Di=function(r,i){if(typeof r!="string"||!Array.isArray(i))return!1;let n=this._oglama.diskStorage.getSessionMetaPath(r);typeof n=="string"&&Rt.writeFileSync(n,JSON.stringify(i,null,2));let s=Xs.dirname(n),o=i.map(l=>l.sessionId),a=Rt.readdirSync(s,{withFileTypes:!0}).filter(l=>l.isDirectory()&&l.name!=="default").map(l=>l.name);for(let l of o){let c=Xs.join(s,l);Rt.existsSync(c)||Rt.mkdirSync(c,{recursive:!0})}for(let l of a)if(!o.includes(l)){let c=Xs.join(s,l);Rt.rmSync(c,{recursive:!0})}return!0},Bm)});var Aa=w(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.CancellationError=Nn.CancellationToken=void 0;var aC=require("events"),xc=class extends aC.EventEmitter{get cancelled(){return this._cancelled||this._parent!=null&&this._parent.cancelled}set parent(e){this.removeParentCancelHandler(),this._parent=e,this.parentCancelHandler=()=>this.cancel(),this._parent.onCancel(this.parentCancelHandler)}constructor(e){super(),this.parentCancelHandler=null,this._parent=null,this._cancelled=!1,e!=null&&(this.parent=e)}cancel(){this._cancelled=!0,this.emit("cancel")}onCancel(e){this.cancelled?e():this.once("cancel",e)}createPromise(e){if(this.cancelled)return Promise.reject(new Ks);let r=()=>{if(i!=null)try{this.removeListener("cancel",i),i=null}catch{}},i=null;return new Promise((n,s)=>{let o=null;if(i=()=>{try{o!=null&&(o(),o=null)}finally{s(new Ks)}},this.cancelled){i();return}this.onCancel(i),e(n,s,a=>{o=a})}).then(n=>(r(),n)).catch(n=>{throw r(),n})}removeParentCancelHandler(){let e=this._parent;e!=null&&this.parentCancelHandler!=null&&(e.removeListener("cancel",this.parentCancelHandler),this.parentCancelHandler=null)}dispose(){try{this.removeParentCancelHandler()}finally{this.removeAllListeners(),this._parent=null}}};Nn.CancellationToken=xc;var Ks=class extends Error{constructor(){super("cancelled")}};Nn.CancellationError=Ks});var Gm=w((bB,Wm)=>{var xn=1e3,Dn=xn*60,Pn=Dn*60,Pi=Pn*24,lC=Pi*7,uC=Pi*365.25;Wm.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return cC(t);if(r==="number"&&isFinite(t))return e.long?fC(t):hC(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function cC(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*uC;case"weeks":case"week":case"w":return r*lC;case"days":case"day":case"d":return r*Pi;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Pn;case"minutes":case"minute":case"mins":case"min":case"m":return r*Dn;case"seconds":case"second":case"secs":case"sec":case"s":return r*xn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function hC(t){var e=Math.abs(t);return e>=Pi?Math.round(t/Pi)+"d":e>=Pn?Math.round(t/Pn)+"h":e>=Dn?Math.round(t/Dn)+"m":e>=xn?Math.round(t/xn)+"s":t+"ms"}function fC(t){var e=Math.abs(t);return e>=Pi?Ea(t,e,Pi,"day"):e>=Pn?Ea(t,e,Pn,"hour"):e>=Dn?Ea(t,e,Dn,"minute"):e>=xn?Ea(t,e,xn,"second"):t+" ms"}function Ea(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var Dc=w((_B,zm)=>{function dC(t){r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=n,r.enabled=a,r.humanize=Gm(),r.destroy=c,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let f=0;f<u.length;f++)h=(h<<5)-h+u.charCodeAt(f),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,f=null,d,y;function A(...E){if(!A.enabled)return;let v=A,T=Number(new Date),I=T-(h||T);v.diff=I,v.prev=h,v.curr=T,h=T,E[0]=r.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let L=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(B,z)=>{if(B==="%%")return"%";L++;let S=r.formatters[z];if(typeof S=="function"){let F=E[L];B=S.call(v,F),E.splice(L,1),L--}return B}),r.formatArgs.call(v,E),(v.log||r.log).apply(v,E)}return A.namespace=u,A.useColors=r.useColors(),A.color=r.selectColor(u),A.extend=i,A.destroy=r.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(d!==r.namespaces&&(d=r.namespaces,y=r.enabled(u)),y),set:E=>{f=E}}),typeof r.init=="function"&&r.init(A),A}function i(u,h){let f=r(this.namespace+(typeof h>"u"?":":h)+u);return f.log=this.log,f}function n(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let f of h)f[0]==="-"?r.skips.push(f.slice(1)):r.names.push(f)}function s(u,h){let f=0,d=0,y=-1,A=0;for(;f<u.length;)if(d<h.length&&(h[d]===u[f]||h[d]==="*"))h[d]==="*"?(y=d,A=f,d++):(f++,d++);else if(y!==-1)d=y+1,A++,f=A;else return!1;for(;d<h.length&&h[d]==="*";)d++;return d===h.length}function o(){let u=[...r.names,...r.skips.map(h=>"-"+h)].join(",");return r.enable(""),u}function a(u){for(let h of r.skips)if(s(u,h))return!1;for(let h of r.names)if(s(u,h))return!0;return!1}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}zm.exports=dC});var Vm=w((lt,Sa)=>{lt.formatArgs=mC;lt.save=gC;lt.load=yC;lt.useColors=pC;lt.storage=wC();lt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();lt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function pC(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function mC(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Sa.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}lt.log=console.debug||console.log||(()=>{});function gC(t){try{t?lt.storage.setItem("debug",t):lt.storage.removeItem("debug")}catch{}}function yC(){let t;try{t=lt.storage.getItem("debug")||lt.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function wC(){try{return localStorage}catch{}}Sa.exports=Dc()(lt);var{formatters:AC}=Sa.exports;AC.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Qm=w((vB,Ym)=>{"use strict";Ym.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",i=e.indexOf(r+t),n=e.indexOf("--");return i!==-1&&(n===-1||i<n)}});var Jm=w((TB,Km)=>{"use strict";var EC=require("os"),Xm=require("tty"),It=Qm(),{env:Re}=process,Gr;It("no-color")||It("no-colors")||It("color=false")||It("color=never")?Gr=0:(It("color")||It("colors")||It("color=true")||It("color=always"))&&(Gr=1);"FORCE_COLOR"in Re&&(Re.FORCE_COLOR==="true"?Gr=1:Re.FORCE_COLOR==="false"?Gr=0:Gr=Re.FORCE_COLOR.length===0?1:Math.min(parseInt(Re.FORCE_COLOR,10),3));function Pc(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function Fc(t,e){if(Gr===0)return 0;if(It("color=16m")||It("color=full")||It("color=truecolor"))return 3;if(It("color=256"))return 2;if(t&&!e&&Gr===void 0)return 0;let r=Gr||0;if(Re.TERM==="dumb")return r;if(process.platform==="win32"){let i=EC.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in Re)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(i=>i in Re)||Re.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in Re)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Re.TEAMCITY_VERSION)?1:0;if(Re.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Re){let i=parseInt((Re.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Re.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Re.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Re.TERM)||"COLORTERM"in Re?1:r}function SC(t){let e=Fc(t,t&&t.isTTY);return Pc(e)}Km.exports={supportsColor:SC,stdout:Pc(Fc(!0,Xm.isatty(1))),stderr:Pc(Fc(!0,Xm.isatty(2)))}});var eg=w((Ie,_a)=>{var bC=require("tty"),ba=require("util");Ie.init=IC;Ie.log=OC;Ie.formatArgs=vC;Ie.save=CC;Ie.load=RC;Ie.useColors=_C;Ie.destroy=ba.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Ie.colors=[6,2,3,4,5,1];try{let t=Jm();t&&(t.stderr||t).level>=2&&(Ie.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Ie.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,s)=>s.toUpperCase()),i=process.env[e];return/^(yes|on|true|enabled)$/i.test(i)?i=!0:/^(no|off|false|disabled)$/i.test(i)?i=!1:i==="null"?i=null:i=Number(i),t[r]=i,t},{});function _C(){return"colors"in Ie.inspectOpts?!!Ie.inspectOpts.colors:bC.isatty(process.stderr.fd)}function vC(t){let{namespace:e,useColors:r}=this;if(r){let i=this.color,n="\x1B[3"+(i<8?i:"8;5;"+i),s="  ".concat(n,";1m").concat(e," \x1B[0m");t[0]=s+t[0].split("\n").join("\n"+s),t.push(n+"m+"+_a.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=TC()+e+" "+t[0]}function TC(){return Ie.inspectOpts.hideDate?"":new Date().toISOString()+" "}function OC(...t){return process.stderr.write(ba.formatWithOptions(Ie.inspectOpts,...t)+"\n")}function CC(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function RC(){return process.env.DEBUG}function IC(t){t.inspectOpts={};let e=Object.keys(Ie.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=Ie.inspectOpts[e[r]]}_a.exports=Dc()(Ie);var{formatters:Zm}=_a.exports;Zm.o=function(t){return this.inspectOpts.colors=this.useColors,ba.inspect(t,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")};Zm.O=function(t){return this.inspectOpts.colors=this.useColors,ba.inspect(t,this.inspectOpts)}});var tg=w((OB,Lc)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Lc.exports=Vm():Lc.exports=eg()});var Js=w($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.newError=NC;function NC(t,e){let r=new Error(t);return r.code=e,r}});var qc=w(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.ProgressCallbackTransform=void 0;var xC=require("stream"),kc=class extends xC.Transform{constructor(e,r,i){super(),this.total=e,this.cancellationToken=r,this.onProgress=i,this.start=Date.now(),this.transferred=0,this.delta=0,this.nextUpdate=this.start+1e3}_transform(e,r,i){if(this.cancellationToken.cancelled){i(new Error("cancelled"),null);return}this.transferred+=e.length,this.delta+=e.length;let n=Date.now();n>=this.nextUpdate&&this.transferred!==this.total&&(this.nextUpdate=n+1e3,this.onProgress({total:this.total,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.total*100,bytesPerSecond:Math.round(this.transferred/((n-this.start)/1e3))}),this.delta=0),i(null,e)}_flush(e){if(this.cancellationToken.cancelled){e(new Error("cancelled"));return}this.onProgress({total:this.total,delta:this.delta,transferred:this.total,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,e(null)}};va.ProgressCallbackTransform=kc});var sg=w(Xe=>{"use strict";Object.defineProperty(Xe,"__esModule",{value:!0});Xe.DigestTransform=Xe.HttpExecutor=Xe.HttpError=void 0;Xe.createHttpError=Mc;Xe.parseJson=MC;Xe.configureRequestOptionsFromUrl=ng;Xe.configureRequestUrl=Bc;Xe.safeGetHeader=Fn;Xe.configureRequestOptions=Ta;Xe.safeStringifyJson=Oa;var DC=require("crypto"),PC=tg(),FC=require("fs"),LC=require("stream"),ig=require("url"),$C=Aa(),rg=Js(),kC=qc(),Zs=(0,PC.default)("electron-builder");function Mc(t,e=null){return new eo(t.statusCode||-1,"".concat(t.statusCode," ").concat(t.statusMessage)+(e==null?"":"\n"+JSON.stringify(e,null,"  "))+"\nHeaders: "+Oa(t.headers),e)}var qC=new Map([[429,"Too many requests"],[400,"Bad request"],[403,"Forbidden"],[404,"Not found"],[405,"Method not allowed"],[406,"Not acceptable"],[408,"Request timeout"],[413,"Request entity too large"],[500,"Internal server error"],[502,"Bad gateway"],[503,"Service unavailable"],[504,"Gateway timeout"],[505,"HTTP version not supported"]]),eo=class extends Error{constructor(e,r="HTTP error: ".concat(qC.get(e)||e),i=null){super(r),this.statusCode=e,this.description=i,this.name="HttpError",this.code="HTTP_ERROR_".concat(e)}isServerError(){return this.statusCode>=500&&this.statusCode<=599}};Xe.HttpError=eo;function MC(t){return t.then(e=>e==null||e.length===0?null:JSON.parse(e))}var Uc=class t{constructor(){this.maxRedirects=10}request(e,r=new $C.CancellationToken,i){Ta(e);let n=i==null?void 0:JSON.stringify(i),s=n?Buffer.from(n):void 0;if(s!=null){Zs(n);let{headers:o,...a}=e;e={method:"post",headers:{"Content-Type":"application/json","Content-Length":s.length,...o},...a}}return this.doApiRequest(e,r,o=>o.end(s))}doApiRequest(e,r,i,n=0){return Zs.enabled&&Zs("Request: ".concat(Oa(e))),r.createPromise((s,o,a)=>{let l=this.createRequest(e,c=>{try{this.handleResponse(c,e,r,s,o,n,i)}catch(u){o(u)}});this.addErrorAndTimeoutHandlers(l,o,e.timeout),this.addRedirectHandlers(l,e,o,n,c=>{this.doApiRequest(c,r,i,n).then(s).catch(o)}),i(l,o),a(()=>l.abort())})}addRedirectHandlers(e,r,i,n,s){}addErrorAndTimeoutHandlers(e,r,i=60*1e3){this.addTimeOutHandler(e,r,i),e.on("error",r),e.on("aborted",()=>{r(new Error("Request has been aborted by the server"))})}handleResponse(e,r,i,n,s,o,a){var l;if(Zs.enabled&&Zs("Response: ".concat(e.statusCode," ").concat(e.statusMessage,", request options: ").concat(Oa(r))),e.statusCode===404){s(Mc(e,"method: ".concat(r.method||"GET"," url: ").concat(r.protocol||"https:","//").concat(r.hostname).concat(r.port?":".concat(r.port):"").concat(r.path,"\n\nPlease double check that your authentication token is correct. Due to security reasons, actual status maybe not reported, but 404.\n")));return}else if(e.statusCode===204){n();return}let c=(l=e.statusCode)!==null&&l!==void 0?l:0,u=c>=300&&c<400,h=Fn(e,"location");if(u&&h!=null){if(o>this.maxRedirects){s(this.createMaxRedirectError());return}this.doApiRequest(t.prepareRedirectUrlOptions(h,r),i,a,o).then(n).catch(s);return}e.setEncoding("utf8");let f="";e.on("error",s),e.on("data",d=>f+=d),e.on("end",()=>{try{if(e.statusCode!=null&&e.statusCode>=400){let d=Fn(e,"content-type"),y=d!=null&&(Array.isArray(d)?d.find(A=>A.includes("json"))!=null:d.includes("json"));s(Mc(e,"method: ".concat(r.method||"GET"," url: ").concat(r.protocol||"https:","//").concat(r.hostname).concat(r.port?":".concat(r.port):"").concat(r.path,"\n\n          Data:\n          ").concat(y?JSON.stringify(JSON.parse(f)):f,"\n          ")))}else n(f.length===0?null:f)}catch(d){s(d)}})}async downloadToBuffer(e,r){return await r.cancellationToken.createPromise((i,n,s)=>{let o=[],a={headers:r.headers||void 0,redirect:"manual"};Bc(e,a),Ta(a),this.doDownload(a,{destination:null,options:r,onCancel:s,callback:l=>{l==null?i(Buffer.concat(o)):n(l)},responseHandler:(l,c)=>{let u=0;l.on("data",h=>{if(u+=h.length,u>524288e3){c(new Error("Maximum allowed size is 500 MB"));return}o.push(h)}),l.on("end",()=>{c(null)})}},0)})}doDownload(e,r,i){let n=this.createRequest(e,s=>{if(s.statusCode>=400){r.callback(new Error('Cannot download "'.concat(e.protocol||"https:","//").concat(e.hostname).concat(e.path,'", status ').concat(s.statusCode,": ").concat(s.statusMessage)));return}s.on("error",r.callback);let o=Fn(s,"location");if(o!=null){i<this.maxRedirects?this.doDownload(t.prepareRedirectUrlOptions(o,e),r,i++):r.callback(this.createMaxRedirectError());return}r.responseHandler==null?BC(r,s):r.responseHandler(s,r.callback)});this.addErrorAndTimeoutHandlers(n,r.callback,e.timeout),this.addRedirectHandlers(n,e,r.callback,i,s=>{this.doDownload(s,r,i++)}),n.end()}createMaxRedirectError(){return new Error("Too many redirects (> ".concat(this.maxRedirects,")"))}addTimeOutHandler(e,r,i){e.on("socket",n=>{n.setTimeout(i,()=>{e.abort(),r(new Error("Request timed out"))})})}static prepareRedirectUrlOptions(e,r){let i=ng(e,{...r}),n=i.headers;if(n?.authorization){let s=new ig.URL(e);(s.hostname.endsWith(".amazonaws.com")||s.searchParams.has("X-Amz-Credential"))&&delete n.authorization}return i}static retryOnServerError(e,r=3){for(let i=0;;i++)try{return e()}catch(n){if(i<r&&(n instanceof eo&&n.isServerError()||n.code==="EPIPE"))continue;throw n}}};Xe.HttpExecutor=Uc;function ng(t,e){let r=Ta(e);return Bc(new ig.URL(t),r),r}function Bc(t,e){e.protocol=t.protocol,e.hostname=t.hostname,t.port?e.port=t.port:e.port&&delete e.port,e.path=t.pathname+t.search}var to=class extends LC.Transform{get actual(){return this._actual}constructor(e,r="sha512",i="base64"){super(),this.expected=e,this.algorithm=r,this.encoding=i,this._actual=null,this.isValidateOnEnd=!0,this.digester=(0,DC.createHash)(r)}_transform(e,r,i){this.digester.update(e),i(null,e)}_flush(e){if(this._actual=this.digester.digest(this.encoding),this.isValidateOnEnd)try{this.validate()}catch(r){e(r);return}e(null)}validate(){if(this._actual==null)throw(0,rg.newError)("Not finished yet","ERR_STREAM_NOT_FINISHED");if(this._actual!==this.expected)throw(0,rg.newError)("".concat(this.algorithm," checksum mismatch, expected ").concat(this.expected,", got ").concat(this._actual),"ERR_CHECKSUM_MISMATCH");return null}};Xe.DigestTransform=to;function UC(t,e,r){return t!=null&&e!=null&&t!==e?(r(new Error("checksum mismatch: expected ".concat(e," but got ").concat(t," (X-Checksum-Sha2 header)"))),!1):!0}function Fn(t,e){let r=t.headers[e];return r==null?null:Array.isArray(r)?r.length===0?null:r[r.length-1]:r}function BC(t,e){if(!UC(Fn(e,"X-Checksum-Sha2"),t.options.sha2,t.callback))return;let r=[];if(t.options.onProgress!=null){let o=Fn(e,"content-length");o!=null&&r.push(new kC.ProgressCallbackTransform(parseInt(o,10),t.options.cancellationToken,t.options.onProgress))}let i=t.options.sha512;i!=null?r.push(new to(i,"sha512",i.length===128&&!i.includes("+")&&!i.includes("Z")&&!i.includes("=")?"hex":"base64")):t.options.sha2!=null&&r.push(new to(t.options.sha2,"sha256","hex"));let n=(0,FC.createWriteStream)(t.destination);r.push(n);let s=e;for(let o of r)o.on("error",a=>{n.close(),t.options.cancellationToken.cancelled||t.callback(a)}),s=s.pipe(o);n.on("finish",()=>{n.close(t.callback)})}function Ta(t,e,r){r!=null&&(t.method=r),t.headers={...t.headers};let i=t.headers;return e!=null&&(i.authorization=e.startsWith("Basic")||e.startsWith("Bearer")?e:"token ".concat(e)),i["User-Agent"]==null&&(i["User-Agent"]="electron-builder"),(r==null||r==="GET"||i["Cache-Control"]==null)&&(i["Cache-Control"]="no-cache"),t.protocol==null&&process.versions.electron!=null&&(t.protocol="https:"),t}function Oa(t,e){return JSON.stringify(t,(r,i)=>r.endsWith("Authorization")||r.endsWith("authorization")||r.endsWith("Password")||r.endsWith("PASSWORD")||r.endsWith("Token")||r.includes("password")||r.includes("token")||e!=null&&e.has(r)?"<stripped sensitive data>":i,2)}});var ag=w(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.githubUrl=jC;Ca.getS3LikeProviderBaseUrl=HC;function jC(t,e="github.com"){return"".concat(t.protocol||"https","://").concat(t.host||e)}function HC(t){let e=t.provider;if(e==="s3")return WC(t);if(e==="spaces")return GC(t);throw new Error("Not supported provider: ".concat(e))}function WC(t){let e;if(t.accelerate==!0)e="https://".concat(t.bucket,".s3-accelerate.amazonaws.com");else if(t.endpoint!=null)e="".concat(t.endpoint,"/").concat(t.bucket);else if(t.bucket.includes(".")){if(t.region==null)throw new Error('Bucket name "'.concat(t.bucket,'" includes a dot, but S3 region is missing'));t.region==="us-east-1"?e="https://s3.amazonaws.com/".concat(t.bucket):e="https://s3-".concat(t.region,".amazonaws.com/").concat(t.bucket)}else t.region==="cn-north-1"?e="https://".concat(t.bucket,".s3.").concat(t.region,".amazonaws.com.cn"):e="https://".concat(t.bucket,".s3.amazonaws.com");return og(e,t.path)}function og(t,e){return e!=null&&e.length>0&&(e.startsWith("/")||(t+="/"),t+=e),t}function GC(t){if(t.name==null)throw new Error("name is missing");if(t.region==null)throw new Error("region is missing");return og("https://".concat(t.name,".").concat(t.region,".digitaloceanspaces.com"),t.path)}});var lg=w(jc=>{"use strict";Object.defineProperty(jc,"__esModule",{value:!0});jc.parseDn=zC;function zC(t){let e=!1,r=null,i="",n=0;t=t.trim();let s=new Map;for(let o=0;o<=t.length;o++){if(o===t.length){r!==null&&s.set(r,i);break}let a=t[o];if(e){if(a==='"'){e=!1;continue}}else{if(a==='"'){e=!0;continue}if(a==="\\"){o++;let l=parseInt(t.slice(o,o+2),16);Number.isNaN(l)?i+=t[o]:(o++,i+=String.fromCharCode(l));continue}if(r===null&&a==="="){r=i,i="";continue}if(a===","||a===";"||a==="+"){r!==null&&s.set(r,i),r=null,i="";continue}}if(a===" "&&!e){if(i.length===0)continue;if(o>n){let l=o;for(;t[l]===" ";)l++;n=l}if(n>=t.length||t[n]===","||t[n]===";"||r===null&&t[n]==="="||r!==null&&t[n]==="+"){o=n-1;continue}}i+=a}return s}});var dg=w(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.nil=Ln.UUID=void 0;var hg=require("crypto"),fg=Js(),VC="options.name must be either a string or a Buffer",ug=(0,hg.randomBytes)(16);ug[0]=ug[0]|1;var Ra={},Y=[];for(let t=0;t<256;t++){let e=(t+256).toString(16).substr(1);Ra[e]=t,Y[t]=e}var Fi=class t{constructor(e){this.ascii=null,this.binary=null;let r=t.check(e);if(!r)throw new Error("not a UUID");this.version=r.version,r.format==="ascii"?this.ascii=e:this.binary=e}static v5(e,r){return YC(e,"sha1",80,r)}toString(){return this.ascii==null&&(this.ascii=QC(this.binary)),this.ascii}inspect(){return"UUID v".concat(this.version," ").concat(this.toString())}static check(e,r=0){if(typeof e=="string")return e=e.toLowerCase(),/^[a-f0-9]{8}(-[a-f0-9]{4}){3}-([a-f0-9]{12})$/.test(e)?e==="00000000-0000-0000-0000-000000000000"?{version:void 0,variant:"nil",format:"ascii"}:{version:(Ra[e[14]+e[15]]&240)>>4,variant:cg((Ra[e[19]+e[20]]&224)>>5),format:"ascii"}:!1;if(Buffer.isBuffer(e)){if(e.length<r+16)return!1;let i=0;for(;i<16&&e[r+i]===0;i++);return i===16?{version:void 0,variant:"nil",format:"binary"}:{version:(e[r+6]&240)>>4,variant:cg((e[r+8]&224)>>5),format:"binary"}}throw(0,fg.newError)("Unknown type of uuid","ERR_UNKNOWN_UUID_TYPE")}static parse(e){let r=Buffer.allocUnsafe(16),i=0;for(let n=0;n<16;n++)r[n]=Ra[e[i++]+e[i++]],(n===3||n===5||n===7||n===9)&&(i+=1);return r}};Ln.UUID=Fi;Fi.OID=Fi.parse("6ba7b812-9dad-11d1-80b4-00c04fd430c8");function cg(t){switch(t){case 0:case 1:case 3:return"ncs";case 4:case 5:return"rfc4122";case 6:return"microsoft";default:return"future"}}var ro;(function(t){t[t.ASCII=0]="ASCII",t[t.BINARY=1]="BINARY",t[t.OBJECT=2]="OBJECT"})(ro||(ro={}));function YC(t,e,r,i,n=ro.ASCII){let s=(0,hg.createHash)(e);if(typeof t!="string"&&!Buffer.isBuffer(t))throw(0,fg.newError)(VC,"ERR_INVALID_UUID_NAME");s.update(i),s.update(t);let a=s.digest(),l;switch(n){case ro.BINARY:a[6]=a[6]&15|r,a[8]=a[8]&63|128,l=a;break;case ro.OBJECT:a[6]=a[6]&15|r,a[8]=a[8]&63|128,l=new Fi(a);break;default:l=Y[a[0]]+Y[a[1]]+Y[a[2]]+Y[a[3]]+"-"+Y[a[4]]+Y[a[5]]+"-"+Y[a[6]&15|r]+Y[a[7]]+"-"+Y[a[8]&63|128]+Y[a[9]]+"-"+Y[a[10]]+Y[a[11]]+Y[a[12]]+Y[a[13]]+Y[a[14]]+Y[a[15]];break}return l}function QC(t){return Y[t[0]]+Y[t[1]]+Y[t[2]]+Y[t[3]]+"-"+Y[t[4]]+Y[t[5]]+"-"+Y[t[6]]+Y[t[7]]+"-"+Y[t[8]]+Y[t[9]]+"-"+Y[t[10]]+Y[t[11]]+Y[t[12]]+Y[t[13]]+Y[t[14]]+Y[t[15]]}Ln.nil=new Fi("00000000-0000-0000-0000-000000000000")});var pg=w(Ia=>{(function(t){t.parser=function(g,m){return new r(g,m)},t.SAXParser=r,t.SAXStream=c,t.createStream=l,t.MAX_BUFFER_LENGTH=64*1024;var e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function r(g,m){if(!(this instanceof r))return new r(g,m);var C=this;n(C),C.q=C.c="",C.bufferCheckPosition=t.MAX_BUFFER_LENGTH,C.opt=m||{},C.opt.lowercase=C.opt.lowercase||C.opt.lowercasetags,C.looseCase=C.opt.lowercase?"toLowerCase":"toUpperCase",C.tags=[],C.closed=C.closedRoot=C.sawRoot=!1,C.tag=C.error=null,C.strict=!!g,C.noscript=!!(g||C.opt.noscript),C.state=S.BEGIN,C.strictEntities=C.opt.strictEntities,C.ENTITIES=C.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),C.attribList=[],C.opt.xmlns&&(C.ns=Object.create(y)),C.opt.unquotedAttributeValues===void 0&&(C.opt.unquotedAttributeValues=!g),C.trackPosition=C.opt.position!==!1,C.trackPosition&&(C.position=C.line=C.column=0),G(C,"onready")}Object.create||(Object.create=function(g){function m(){}m.prototype=g;var C=new m;return C}),Object.keys||(Object.keys=function(g){var m=[];for(var C in g)g.hasOwnProperty(C)&&m.push(C);return m});function i(g){for(var m=Math.max(t.MAX_BUFFER_LENGTH,10),C=0,b=0,ee=e.length;b<ee;b++){var _e=g[e[b]].length;if(_e>m)switch(e[b]){case"textNode":J(g);break;case"cdata":D(g,"oncdata",g.cdata),g.cdata="";break;case"script":D(g,"onscript",g.script),g.script="";break;default:Z(g,"Max buffer length exceeded: "+e[b])}C=Math.max(C,_e)}var ve=t.MAX_BUFFER_LENGTH-C;g.bufferCheckPosition=ve+g.position}function n(g){for(var m=0,C=e.length;m<C;m++)g[e[m]]=""}function s(g){J(g),g.cdata!==""&&(D(g,"oncdata",g.cdata),g.cdata=""),g.script!==""&&(D(g,"onscript",g.script),g.script="")}r.prototype={end:function(){V(this)},write:qO,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){s(this)}};var o;try{o=require("stream").Stream}catch{o=function(){}}o||(o=function(){});var a=t.EVENTS.filter(function(g){return g!=="error"&&g!=="end"});function l(g,m){return new c(g,m)}function c(g,m){if(!(this instanceof c))return new c(g,m);o.apply(this),this._parser=new r(g,m),this.writable=!0,this.readable=!0;var C=this;this._parser.onend=function(){C.emit("end")},this._parser.onerror=function(b){C.emit("error",b),C._parser.error=null},this._decoder=null,a.forEach(function(b){Object.defineProperty(C,"on"+b,{get:function(){return C._parser["on"+b]},set:function(ee){if(!ee)return C.removeAllListeners(b),C._parser["on"+b]=ee,ee;C.on(b,ee)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(o.prototype,{constructor:{value:c}}),c.prototype.write=function(g){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(g)){if(!this._decoder){var m=require("string_decoder").StringDecoder;this._decoder=new m("utf8")}g=this._decoder.write(g)}return this._parser.write(g.toString()),this.emit("data",g),!0},c.prototype.end=function(g){return g&&g.length&&this.write(g),this._parser.end(),!0},c.prototype.on=function(g,m){var C=this;return!C._parser["on"+g]&&a.indexOf(g)!==-1&&(C._parser["on"+g]=function(){var b=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);b.splice(0,0,g),C.emit.apply(C,b)}),o.prototype.on.call(C,g,m)};var u="[CDATA[",h="DOCTYPE",f="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/2000/xmlns/",y={xml:f,xmlns:d},A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function I(g){return g===" "||g==="\n"||g==="\r"||g==="	"}function L(g){return g==='"'||g==="'"}function oe(g){return g===">"||I(g)}function B(g,m){return g.test(m)}function z(g,m){return!B(g,m)}var S=0;t.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(g){var m=t.ENTITIES[g],C=typeof m=="number"?String.fromCharCode(m):m;t.ENTITIES[g]=C});for(var F in t.STATE)t.STATE[t.STATE[F]]=F;S=t.STATE;function G(g,m,C){g[m]&&g[m](C)}function D(g,m,C){g.textNode&&J(g),G(g,m,C)}function J(g){g.textNode=pe(g.opt,g.textNode),g.textNode&&G(g,"ontext",g.textNode),g.textNode=""}function pe(g,m){return g.trim&&(m=m.trim()),g.normalize&&(m=m.replace(/\s+/g," ")),m}function Z(g,m){return J(g),g.trackPosition&&(m+="\nLine: "+g.line+"\nColumn: "+g.column+"\nChar: "+g.c),m=new Error(m),g.error=m,G(g,"onerror",m),g}function V(g){return g.sawRoot&&!g.closedRoot&&q(g,"Unclosed root tag"),g.state!==S.BEGIN&&g.state!==S.BEGIN_WHITESPACE&&g.state!==S.TEXT&&Z(g,"Unexpected end"),J(g),g.c="",g.closed=!0,G(g,"onend"),r.call(g,g.strict,g.opt),g}function q(g,m){if(typeof g!="object"||!(g instanceof r))throw new Error("bad call to strictFail");g.strict&&Z(g,m)}function re(g){g.strict||(g.tagName=g.tagName[g.looseCase]());var m=g.tags[g.tags.length-1]||g,C=g.tag={name:g.tagName,attributes:{}};g.opt.xmlns&&(C.ns=m.ns),g.attribList.length=0,D(g,"onopentagstart",C)}function we(g,m){var C=g.indexOf(":"),b=C<0?["",g]:g.split(":"),ee=b[0],_e=b[1];return m&&g==="xmlns"&&(ee="xmlns",_e=""),{prefix:ee,local:_e}}function ie(g){if(g.strict||(g.attribName=g.attribName[g.looseCase]()),g.attribList.indexOf(g.attribName)!==-1||g.tag.attributes.hasOwnProperty(g.attribName)){g.attribName=g.attribValue="";return}if(g.opt.xmlns){var m=we(g.attribName,!0),C=m.prefix,b=m.local;if(C==="xmlns")if(b==="xml"&&g.attribValue!==f)q(g,"xml: prefix must be bound to "+f+"\nActual: "+g.attribValue);else if(b==="xmlns"&&g.attribValue!==d)q(g,"xmlns: prefix must be bound to "+d+"\nActual: "+g.attribValue);else{var ee=g.tag,_e=g.tags[g.tags.length-1]||g;ee.ns===_e.ns&&(ee.ns=Object.create(_e.ns)),ee.ns[b]=g.attribValue}g.attribList.push([g.attribName,g.attribValue])}else g.tag.attributes[g.attribName]=g.attribValue,D(g,"onattribute",{name:g.attribName,value:g.attribValue});g.attribName=g.attribValue=""}function Wr(g,m){if(g.opt.xmlns){var C=g.tag,b=we(g.tagName);C.prefix=b.prefix,C.local=b.local,C.uri=C.ns[b.prefix]||"",C.prefix&&!C.uri&&(q(g,"Unbound namespace prefix: "+JSON.stringify(g.tagName)),C.uri=b.prefix);var ee=g.tags[g.tags.length-1]||g;C.ns&&ee.ns!==C.ns&&Object.keys(C.ns).forEach(function(gm){D(g,"onopennamespace",{prefix:gm,uri:C.ns[gm]})});for(var _e=0,ve=g.attribList.length;_e<ve;_e++){var st=g.attribList[_e],ot=st[0],Sn=st[1],$e=we(ot,!0),fr=$e.prefix,MO=$e.local,mm=fr===""?"":C.ns[fr]||"",Ac={name:ot,value:Sn,prefix:fr,local:MO,uri:mm};fr&&fr!=="xmlns"&&!mm&&(q(g,"Unbound namespace prefix: "+JSON.stringify(fr)),Ac.uri=fr),g.tag.attributes[ot]=Ac,D(g,"onattribute",Ac)}g.attribList.length=0}g.tag.isSelfClosing=!!m,g.sawRoot=!0,g.tags.push(g.tag),D(g,"onopentag",g.tag),m||(!g.noscript&&g.tagName.toLowerCase()==="script"?g.state=S.SCRIPT:g.state=S.TEXT,g.tag=null,g.tagName=""),g.attribName=g.attribValue="",g.attribList.length=0}function wc(g){if(!g.tagName){q(g,"Weird empty close tag."),g.textNode+="</>",g.state=S.TEXT;return}if(g.script){if(g.tagName!=="script"){g.script+="</"+g.tagName+">",g.tagName="",g.state=S.SCRIPT;return}D(g,"onscript",g.script),g.script=""}var m=g.tags.length,C=g.tagName;g.strict||(C=C[g.looseCase]());for(var b=C;m--;){var ee=g.tags[m];if(ee.name!==b)q(g,"Unexpected close tag");else break}if(m<0){q(g,"Unmatched closing tag: "+g.tagName),g.textNode+="</"+g.tagName+">",g.state=S.TEXT;return}g.tagName=C;for(var _e=g.tags.length;_e-- >m;){var ve=g.tag=g.tags.pop();g.tagName=g.tag.name,D(g,"onclosetag",g.tagName);var st={};for(var ot in ve.ns)st[ot]=ve.ns[ot];var Sn=g.tags[g.tags.length-1]||g;g.opt.xmlns&&ve.ns!==Sn.ns&&Object.keys(ve.ns).forEach(function($e){var fr=ve.ns[$e];D(g,"onclosenamespace",{prefix:$e,uri:fr})})}m===0&&(g.closedRoot=!0),g.tagName=g.attribValue=g.attribName="",g.attribList.length=0,g.state=S.TEXT}function kO(g){var m=g.entity,C=m.toLowerCase(),b,ee="";return g.ENTITIES[m]?g.ENTITIES[m]:g.ENTITIES[C]?g.ENTITIES[C]:(m=C,m.charAt(0)==="#"&&(m.charAt(1)==="x"?(m=m.slice(2),b=parseInt(m,16),ee=b.toString(16)):(m=m.slice(1),b=parseInt(m,10),ee=b.toString(10))),m=m.replace(/^0+/,""),isNaN(b)||ee.toLowerCase()!==m?(q(g,"Invalid character entity"),"&"+g.entity+";"):String.fromCodePoint(b))}function dm(g,m){m==="<"?(g.state=S.OPEN_WAKA,g.startTagPosition=g.position):I(m)||(q(g,"Non-whitespace before first tag."),g.textNode=m,g.state=S.TEXT)}function pm(g,m){var C="";return m<g.length&&(C=g.charAt(m)),C}function qO(g){var m=this;if(this.error)throw this.error;if(m.closed)return Z(m,"Cannot write after close. Assign an onready handler.");if(g===null)return V(m);typeof g=="object"&&(g=g.toString());for(var C=0,b="";b=pm(g,C++),m.c=b,!!b;)switch(m.trackPosition&&(m.position++,b==="\n"?(m.line++,m.column=0):m.column++),m.state){case S.BEGIN:if(m.state=S.BEGIN_WHITESPACE,b==="\uFEFF")continue;dm(m,b);continue;case S.BEGIN_WHITESPACE:dm(m,b);continue;case S.TEXT:if(m.sawRoot&&!m.closedRoot){for(var ee=C-1;b&&b!=="<"&&b!=="&";)b=pm(g,C++),b&&m.trackPosition&&(m.position++,b==="\n"?(m.line++,m.column=0):m.column++);m.textNode+=g.substring(ee,C-1)}b==="<"&&!(m.sawRoot&&m.closedRoot&&!m.strict)?(m.state=S.OPEN_WAKA,m.startTagPosition=m.position):(!I(b)&&(!m.sawRoot||m.closedRoot)&&q(m,"Text data outside of root node."),b==="&"?m.state=S.TEXT_ENTITY:m.textNode+=b);continue;case S.SCRIPT:b==="<"?m.state=S.SCRIPT_ENDING:m.script+=b;continue;case S.SCRIPT_ENDING:b==="/"?m.state=S.CLOSE_TAG:(m.script+="<"+b,m.state=S.SCRIPT);continue;case S.OPEN_WAKA:if(b==="!")m.state=S.SGML_DECL,m.sgmlDecl="";else if(!I(b))if(B(A,b))m.state=S.OPEN_TAG,m.tagName=b;else if(b==="/")m.state=S.CLOSE_TAG,m.tagName="";else if(b==="?")m.state=S.PROC_INST,m.procInstName=m.procInstBody="";else{if(q(m,"Unencoded <"),m.startTagPosition+1<m.position){var _e=m.position-m.startTagPosition;b=new Array(_e).join(" ")+b}m.textNode+="<"+b,m.state=S.TEXT}continue;case S.SGML_DECL:if(m.sgmlDecl+b==="--"){m.state=S.COMMENT,m.comment="",m.sgmlDecl="";continue}m.doctype&&m.doctype!==!0&&m.sgmlDecl?(m.state=S.DOCTYPE_DTD,m.doctype+="<!"+m.sgmlDecl+b,m.sgmlDecl=""):(m.sgmlDecl+b).toUpperCase()===u?(D(m,"onopencdata"),m.state=S.CDATA,m.sgmlDecl="",m.cdata=""):(m.sgmlDecl+b).toUpperCase()===h?(m.state=S.DOCTYPE,(m.doctype||m.sawRoot)&&q(m,"Inappropriately located doctype declaration"),m.doctype="",m.sgmlDecl=""):b===">"?(D(m,"onsgmldeclaration",m.sgmlDecl),m.sgmlDecl="",m.state=S.TEXT):(L(b)&&(m.state=S.SGML_DECL_QUOTED),m.sgmlDecl+=b);continue;case S.SGML_DECL_QUOTED:b===m.q&&(m.state=S.SGML_DECL,m.q=""),m.sgmlDecl+=b;continue;case S.DOCTYPE:b===">"?(m.state=S.TEXT,D(m,"ondoctype",m.doctype),m.doctype=!0):(m.doctype+=b,b==="["?m.state=S.DOCTYPE_DTD:L(b)&&(m.state=S.DOCTYPE_QUOTED,m.q=b));continue;case S.DOCTYPE_QUOTED:m.doctype+=b,b===m.q&&(m.q="",m.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:b==="]"?(m.doctype+=b,m.state=S.DOCTYPE):b==="<"?(m.state=S.OPEN_WAKA,m.startTagPosition=m.position):L(b)?(m.doctype+=b,m.state=S.DOCTYPE_DTD_QUOTED,m.q=b):m.doctype+=b;continue;case S.DOCTYPE_DTD_QUOTED:m.doctype+=b,b===m.q&&(m.state=S.DOCTYPE_DTD,m.q="");continue;case S.COMMENT:b==="-"?m.state=S.COMMENT_ENDING:m.comment+=b;continue;case S.COMMENT_ENDING:b==="-"?(m.state=S.COMMENT_ENDED,m.comment=pe(m.opt,m.comment),m.comment&&D(m,"oncomment",m.comment),m.comment=""):(m.comment+="-"+b,m.state=S.COMMENT);continue;case S.COMMENT_ENDED:b!==">"?(q(m,"Malformed comment"),m.comment+="--"+b,m.state=S.COMMENT):m.doctype&&m.doctype!==!0?m.state=S.DOCTYPE_DTD:m.state=S.TEXT;continue;case S.CDATA:b==="]"?m.state=S.CDATA_ENDING:m.cdata+=b;continue;case S.CDATA_ENDING:b==="]"?m.state=S.CDATA_ENDING_2:(m.cdata+="]"+b,m.state=S.CDATA);continue;case S.CDATA_ENDING_2:b===">"?(m.cdata&&D(m,"oncdata",m.cdata),D(m,"onclosecdata"),m.cdata="",m.state=S.TEXT):b==="]"?m.cdata+="]":(m.cdata+="]]"+b,m.state=S.CDATA);continue;case S.PROC_INST:b==="?"?m.state=S.PROC_INST_ENDING:I(b)?m.state=S.PROC_INST_BODY:m.procInstName+=b;continue;case S.PROC_INST_BODY:if(!m.procInstBody&&I(b))continue;b==="?"?m.state=S.PROC_INST_ENDING:m.procInstBody+=b;continue;case S.PROC_INST_ENDING:b===">"?(D(m,"onprocessinginstruction",{name:m.procInstName,body:m.procInstBody}),m.procInstName=m.procInstBody="",m.state=S.TEXT):(m.procInstBody+="?"+b,m.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:B(E,b)?m.tagName+=b:(re(m),b===">"?Wr(m):b==="/"?m.state=S.OPEN_TAG_SLASH:(I(b)||q(m,"Invalid character in tag name"),m.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:b===">"?(Wr(m,!0),wc(m)):(q(m,"Forward-slash in opening tag not followed by >"),m.state=S.ATTRIB);continue;case S.ATTRIB:if(I(b))continue;b===">"?Wr(m):b==="/"?m.state=S.OPEN_TAG_SLASH:B(A,b)?(m.attribName=b,m.attribValue="",m.state=S.ATTRIB_NAME):q(m,"Invalid attribute name");continue;case S.ATTRIB_NAME:b==="="?m.state=S.ATTRIB_VALUE:b===">"?(q(m,"Attribute without value"),m.attribValue=m.attribName,ie(m),Wr(m)):I(b)?m.state=S.ATTRIB_NAME_SAW_WHITE:B(E,b)?m.attribName+=b:q(m,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if(b==="=")m.state=S.ATTRIB_VALUE;else{if(I(b))continue;q(m,"Attribute without value"),m.tag.attributes[m.attribName]="",m.attribValue="",D(m,"onattribute",{name:m.attribName,value:""}),m.attribName="",b===">"?Wr(m):B(A,b)?(m.attribName=b,m.state=S.ATTRIB_NAME):(q(m,"Invalid attribute name"),m.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(I(b))continue;L(b)?(m.q=b,m.state=S.ATTRIB_VALUE_QUOTED):(m.opt.unquotedAttributeValues||Z(m,"Unquoted attribute value"),m.state=S.ATTRIB_VALUE_UNQUOTED,m.attribValue=b);continue;case S.ATTRIB_VALUE_QUOTED:if(b!==m.q){b==="&"?m.state=S.ATTRIB_VALUE_ENTITY_Q:m.attribValue+=b;continue}ie(m),m.q="",m.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:I(b)?m.state=S.ATTRIB:b===">"?Wr(m):b==="/"?m.state=S.OPEN_TAG_SLASH:B(A,b)?(q(m,"No whitespace between attributes"),m.attribName=b,m.attribValue="",m.state=S.ATTRIB_NAME):q(m,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(!oe(b)){b==="&"?m.state=S.ATTRIB_VALUE_ENTITY_U:m.attribValue+=b;continue}ie(m),b===">"?Wr(m):m.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(m.tagName)b===">"?wc(m):B(E,b)?m.tagName+=b:m.script?(m.script+="</"+m.tagName,m.tagName="",m.state=S.SCRIPT):(I(b)||q(m,"Invalid tagname in closing tag"),m.state=S.CLOSE_TAG_SAW_WHITE);else{if(I(b))continue;z(A,b)?m.script?(m.script+="</"+b,m.state=S.SCRIPT):q(m,"Invalid tagname in closing tag."):m.tagName=b}continue;case S.CLOSE_TAG_SAW_WHITE:if(I(b))continue;b===">"?wc(m):q(m,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var ve,st;switch(m.state){case S.TEXT_ENTITY:ve=S.TEXT,st="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:ve=S.ATTRIB_VALUE_QUOTED,st="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:ve=S.ATTRIB_VALUE_UNQUOTED,st="attribValue";break}if(b===";"){var ot=kO(m);m.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(ot)?(m.entity="",m.state=ve,m.write(ot)):(m[st]+=ot,m.entity="",m.state=ve)}else B(m.entity.length?T:v,b)?m.entity+=b:(q(m,"Invalid character in entity name"),m[st]+="&"+m.entity+b,m.entity="",m.state=ve);continue;default:throw new Error(m,"Unknown state: "+m.state)}return m.position>=m.bufferCheckPosition&&i(m),m}String.fromCodePoint||function(){var g=String.fromCharCode,m=Math.floor,C=function(){var b=16384,ee=[],_e,ve,st=-1,ot=arguments.length;if(!ot)return"";for(var Sn="";++st<ot;){var $e=Number(arguments[st]);if(!isFinite($e)||$e<0||$e>1114111||m($e)!==$e)throw RangeError("Invalid code point: "+$e);$e<=65535?ee.push($e):($e-=65536,_e=($e>>10)+55296,ve=$e%1024+56320,ee.push(_e,ve)),(st+1===ot||ee.length>b)&&(Sn+=g.apply(null,ee),ee.length=0)}return Sn};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C}()})(typeof Ia>"u"?Ia.sax={}:Ia)});var gg=w(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.XElement=void 0;io.parseXml=ZC;var XC=pg(),Na=Js(),xa=class{constructor(e){if(this.name=e,this.value="",this.attributes=null,this.isCData=!1,this.elements=null,!e)throw(0,Na.newError)("Element name cannot be empty","ERR_XML_ELEMENT_NAME_EMPTY");if(!JC(e))throw(0,Na.newError)("Invalid element name: ".concat(e),"ERR_XML_ELEMENT_INVALID_NAME")}attribute(e){let r=this.attributes===null?null:this.attributes[e];if(r==null)throw(0,Na.newError)('No attribute "'.concat(e,'"'),"ERR_XML_MISSED_ATTRIBUTE");return r}removeAttribute(e){this.attributes!==null&&delete this.attributes[e]}element(e,r=!1,i=null){let n=this.elementOrNull(e,r);if(n===null)throw(0,Na.newError)(i||'No element "'.concat(e,'"'),"ERR_XML_MISSED_ELEMENT");return n}elementOrNull(e,r=!1){if(this.elements===null)return null;for(let i of this.elements)if(mg(i,e,r))return i;return null}getElements(e,r=!1){return this.elements===null?[]:this.elements.filter(i=>mg(i,e,r))}elementValueOrEmpty(e,r=!1){let i=this.elementOrNull(e,r);return i===null?"":i.value}};io.XElement=xa;var KC=new RegExp(/^[A-Za-z_][:A-Za-z0-9_-]*$/i);function JC(t){return KC.test(t)}function mg(t,e,r){let i=t.name;return i===e||r===!0&&i.length===e.length&&i.toLowerCase()===e.toLowerCase()}function ZC(t){let e=null,r=XC.parser(!0,{}),i=[];return r.onopentag=n=>{let s=new xa(n.name);if(s.attributes=n.attributes,e===null)e=s;else{let o=i[i.length-1];o.elements==null&&(o.elements=[]),o.elements.push(s)}i.push(s)},r.onclosetag=()=>{i.pop()},r.ontext=n=>{i.length>0&&(i[i.length-1].value=n)},r.oncdata=n=>{let s=i[i.length-1];s.value=n,s.isCData=!0},r.onerror=n=>{throw n},r.write(t),e}});var wg=w(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.MemoLazy=void 0;var Hc=class{constructor(e,r){this.selector=e,this.creator=r,this.selected=void 0,this._value=void 0}get hasValue(){return this._value!==void 0}get value(){let e=this.selector();if(this._value!==void 0&&yg(this.selected,e))return this._value;this.selected=e;let r=this.creator(e);return this.value=r,r}set value(e){this._value=e}};Da.MemoLazy=Hc;function yg(t,e){if(typeof t=="object"&&t!==null&&(typeof e=="object"&&e!==null)){let n=Object.keys(t),s=Object.keys(e);return n.length===s.length&&n.every(o=>yg(t[o],e[o]))}return t===e}});var Eg=w(Wc=>{"use strict";Object.defineProperty(Wc,"__esModule",{value:!0});Wc.retry=Ag;var eR=Aa();async function Ag(t,e,r,i=0,n=0,s){var o;let a=new eR.CancellationToken;try{return await t()}catch(l){if((!((o=s?.(l))!==null&&o!==void 0)||o)&&e>0&&!a.cancelled)return await new Promise(c=>setTimeout(c,r+i*n)),await Ag(t,e-1,r,i,n+1,s);throw l}}});var Ne=w(k=>{"use strict";Object.defineProperty(k,"__esModule",{value:!0});k.CURRENT_APP_PACKAGE_FILE_NAME=k.CURRENT_APP_INSTALLER_FILE_NAME=k.retry=k.MemoLazy=k.newError=k.XElement=k.parseXml=k.ProgressCallbackTransform=k.UUID=k.parseDn=k.githubUrl=k.getS3LikeProviderBaseUrl=k.configureRequestUrl=k.parseJson=k.safeStringifyJson=k.configureRequestOptionsFromUrl=k.configureRequestOptions=k.safeGetHeader=k.DigestTransform=k.HttpExecutor=k.createHttpError=k.HttpError=k.CancellationError=k.CancellationToken=void 0;k.asArray=aR;var Sg=Aa();Object.defineProperty(k,"CancellationToken",{enumerable:!0,get:function(){return Sg.CancellationToken}});Object.defineProperty(k,"CancellationError",{enumerable:!0,get:function(){return Sg.CancellationError}});var Jt=sg();Object.defineProperty(k,"HttpError",{enumerable:!0,get:function(){return Jt.HttpError}});Object.defineProperty(k,"createHttpError",{enumerable:!0,get:function(){return Jt.createHttpError}});Object.defineProperty(k,"HttpExecutor",{enumerable:!0,get:function(){return Jt.HttpExecutor}});Object.defineProperty(k,"DigestTransform",{enumerable:!0,get:function(){return Jt.DigestTransform}});Object.defineProperty(k,"safeGetHeader",{enumerable:!0,get:function(){return Jt.safeGetHeader}});Object.defineProperty(k,"configureRequestOptions",{enumerable:!0,get:function(){return Jt.configureRequestOptions}});Object.defineProperty(k,"configureRequestOptionsFromUrl",{enumerable:!0,get:function(){return Jt.configureRequestOptionsFromUrl}});Object.defineProperty(k,"safeStringifyJson",{enumerable:!0,get:function(){return Jt.safeStringifyJson}});Object.defineProperty(k,"parseJson",{enumerable:!0,get:function(){return Jt.parseJson}});Object.defineProperty(k,"configureRequestUrl",{enumerable:!0,get:function(){return Jt.configureRequestUrl}});var bg=ag();Object.defineProperty(k,"getS3LikeProviderBaseUrl",{enumerable:!0,get:function(){return bg.getS3LikeProviderBaseUrl}});Object.defineProperty(k,"githubUrl",{enumerable:!0,get:function(){return bg.githubUrl}});var tR=lg();Object.defineProperty(k,"parseDn",{enumerable:!0,get:function(){return tR.parseDn}});var rR=dg();Object.defineProperty(k,"UUID",{enumerable:!0,get:function(){return rR.UUID}});var iR=qc();Object.defineProperty(k,"ProgressCallbackTransform",{enumerable:!0,get:function(){return iR.ProgressCallbackTransform}});var _g=gg();Object.defineProperty(k,"parseXml",{enumerable:!0,get:function(){return _g.parseXml}});Object.defineProperty(k,"XElement",{enumerable:!0,get:function(){return _g.XElement}});var nR=Js();Object.defineProperty(k,"newError",{enumerable:!0,get:function(){return nR.newError}});var sR=wg();Object.defineProperty(k,"MemoLazy",{enumerable:!0,get:function(){return sR.MemoLazy}});var oR=Eg();Object.defineProperty(k,"retry",{enumerable:!0,get:function(){return oR.retry}});k.CURRENT_APP_INSTALLER_FILE_NAME="installer.exe";k.CURRENT_APP_PACKAGE_FILE_NAME="package.7z";function aR(t){return t==null?[]:Array.isArray(t)?t:[t]}});var ut=w(Gc=>{"use strict";Gc.fromCallback=function(t){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")t.apply(this,e);else return new Promise((r,i)=>{e.push((n,s)=>n!=null?i(n):r(s)),t.apply(this,e)})},"name",{value:t.name})};Gc.fromPromise=function(t){return Object.defineProperty(function(...e){let r=e[e.length-1];if(typeof r!="function")return t.apply(this,e);e.pop(),t.apply(this,e).then(i=>r(null,i),r)},"name",{value:t.name})}});var Tg=w((MB,vg)=>{var zr=require("constants"),lR=process.cwd,Pa=null,uR=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Pa||(Pa=lR.call(process)),Pa};try{process.cwd()}catch{}typeof process.chdir=="function"&&(zc=process.chdir,process.chdir=function(t){Pa=null,zc.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,zc));var zc;vg.exports=cR;function cR(t){zr.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=s(t.chown),t.fchown=s(t.fchown),t.lchown=s(t.lchown),t.chmod=i(t.chmod),t.fchmod=i(t.fchmod),t.lchmod=i(t.lchmod),t.chownSync=o(t.chownSync),t.fchownSync=o(t.fchownSync),t.lchownSync=o(t.lchownSync),t.chmodSync=n(t.chmodSync),t.fchmodSync=n(t.fchmodSync),t.lchmodSync=n(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=l(t.statSync),t.fstatSync=l(t.fstatSync),t.lstatSync=l(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(u,h,f){f&&process.nextTick(f)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(u,h,f,d){d&&process.nextTick(d)},t.lchownSync=function(){}),uR==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(u){function h(f,d,y){var A=Date.now(),E=0;u(f,d,function v(T){if(T&&(T.code==="EACCES"||T.code==="EPERM"||T.code==="EBUSY")&&Date.now()-A<6e4){setTimeout(function(){t.stat(d,function(I,L){I&&I.code==="ENOENT"?u(f,d,v):y(T)})},E),E<100&&(E+=10);return}y&&y(T)})}return Object.setPrototypeOf&&Object.setPrototypeOf(h,u),h}(t.rename)),t.read=typeof t.read!="function"?t.read:function(u){function h(f,d,y,A,E,v){var T;if(v&&typeof v=="function"){var I=0;T=function(L,oe,B){if(L&&L.code==="EAGAIN"&&I<10)return I++,u.call(t,f,d,y,A,E,T);v.apply(this,arguments)}}return u.call(t,f,d,y,A,E,T)}return Object.setPrototypeOf&&Object.setPrototypeOf(h,u),h}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(u){return function(h,f,d,y,A){for(var E=0;;)try{return u.call(t,h,f,d,y,A)}catch(v){if(v.code==="EAGAIN"&&E<10){E++;continue}throw v}}}(t.readSync);function e(u){u.lchmod=function(h,f,d){u.open(h,zr.O_WRONLY|zr.O_SYMLINK,f,function(y,A){if(y){d&&d(y);return}u.fchmod(A,f,function(E){u.close(A,function(v){d&&d(E||v)})})})},u.lchmodSync=function(h,f){var d=u.openSync(h,zr.O_WRONLY|zr.O_SYMLINK,f),y=!0,A;try{A=u.fchmodSync(d,f),y=!1}finally{if(y)try{u.closeSync(d)}catch{}else u.closeSync(d)}return A}}function r(u){zr.hasOwnProperty("O_SYMLINK")&&u.futimes?(u.lutimes=function(h,f,d,y){u.open(h,zr.O_SYMLINK,function(A,E){if(A){y&&y(A);return}u.futimes(E,f,d,function(v){u.close(E,function(T){y&&y(v||T)})})})},u.lutimesSync=function(h,f,d){var y=u.openSync(h,zr.O_SYMLINK),A,E=!0;try{A=u.futimesSync(y,f,d),E=!1}finally{if(E)try{u.closeSync(y)}catch{}else u.closeSync(y)}return A}):u.futimes&&(u.lutimes=function(h,f,d,y){y&&process.nextTick(y)},u.lutimesSync=function(){})}function i(u){return u&&function(h,f,d){return u.call(t,h,f,function(y){c(y)&&(y=null),d&&d.apply(this,arguments)})}}function n(u){return u&&function(h,f){try{return u.call(t,h,f)}catch(d){if(!c(d))throw d}}}function s(u){return u&&function(h,f,d,y){return u.call(t,h,f,d,function(A){c(A)&&(A=null),y&&y.apply(this,arguments)})}}function o(u){return u&&function(h,f,d){try{return u.call(t,h,f,d)}catch(y){if(!c(y))throw y}}}function a(u){return u&&function(h,f,d){typeof f=="function"&&(d=f,f=null);function y(A,E){E&&(E.uid<0&&(E.uid+=4294967296),E.gid<0&&(E.gid+=4294967296)),d&&d.apply(this,arguments)}return f?u.call(t,h,f,y):u.call(t,h,y)}}function l(u){return u&&function(h,f){var d=f?u.call(t,h,f):u.call(t,h);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function c(u){if(!u||u.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(u.code==="EINVAL"||u.code==="EPERM"))}}});var Rg=w((UB,Cg)=>{var Og=require("stream").Stream;Cg.exports=hR;function hR(t){return{ReadStream:e,WriteStream:r};function e(i,n){if(!(this instanceof e))return new e(i,n);Og.call(this);var s=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var o=Object.keys(n),a=0,l=o.length;a<l;a++){var c=o[a];this[c]=n[c]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}t.open(this.path,this.flags,this.mode,function(u,h){if(u){s.emit("error",u),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function r(i,n){if(!(this instanceof r))return new r(i,n);Og.call(this),this.path=i,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),o=0,a=s.length;o<a;o++){var l=s[o];this[l]=n[l]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Ng=w((BB,Ig)=>{"use strict";Ig.exports=dR;var fR=Object.getPrototypeOf||function(t){return t.__proto__};function dR(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:fR(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var Ke=w((jB,Qc)=>{var me=require("fs"),pR=Tg(),mR=Rg(),gR=Ng(),Fa=require("util"),qe,$a;typeof Symbol=="function"&&typeof Symbol.for=="function"?(qe=Symbol.for("graceful-fs.queue"),$a=Symbol.for("graceful-fs.previous")):(qe="___graceful-fs.queue",$a="___graceful-fs.previous");function yR(){}function Pg(t,e){Object.defineProperty(t,qe,{get:function(){return e}})}var Li=yR;Fa.debuglog?Li=Fa.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Li=function(){var t=Fa.format.apply(Fa,arguments);t="GFS4: "+t.split(/\n/).join("\nGFS4: "),console.error(t)});me[qe]||(xg=global[qe]||[],Pg(me,xg),me.close=function(t){function e(r,i){return t.call(me,r,function(n){n||Dg(),typeof i=="function"&&i.apply(this,arguments)})}return Object.defineProperty(e,$a,{value:t}),e}(me.close),me.closeSync=function(t){function e(r){t.apply(me,arguments),Dg()}return Object.defineProperty(e,$a,{value:t}),e}(me.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Li(me[qe]),require("assert").equal(me[qe].length,0)}));var xg;global[qe]||Pg(global,me[qe]);Qc.exports=Vc(gR(me));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!me.__patched&&(Qc.exports=Vc(me),me.__patched=!0);function Vc(t){pR(t),t.gracefulify=Vc,t.createReadStream=oe,t.createWriteStream=B;var e=t.readFile;t.readFile=r;function r(F,G,D){return typeof G=="function"&&(D=G,G=null),J(F,G,D);function J(pe,Z,V,q){return e(pe,Z,function(re){re&&(re.code==="EMFILE"||re.code==="ENFILE")?$n([J,[pe,Z,V],re,q||Date.now(),Date.now()]):typeof V=="function"&&V.apply(this,arguments)})}}var i=t.writeFile;t.writeFile=n;function n(F,G,D,J){return typeof D=="function"&&(J=D,D=null),pe(F,G,D,J);function pe(Z,V,q,re,we){return i(Z,V,q,function(ie){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?$n([pe,[Z,V,q,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}var s=t.appendFile;s&&(t.appendFile=o);function o(F,G,D,J){return typeof D=="function"&&(J=D,D=null),pe(F,G,D,J);function pe(Z,V,q,re,we){return s(Z,V,q,function(ie){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?$n([pe,[Z,V,q,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=l);function l(F,G,D,J){return typeof D=="function"&&(J=D,D=0),pe(F,G,D,J);function pe(Z,V,q,re,we){return a(Z,V,q,function(ie){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?$n([pe,[Z,V,q,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}var c=t.readdir;t.readdir=h;var u=/^v[0-5]\./;function h(F,G,D){typeof G=="function"&&(D=G,G=null);var J=u.test(process.version)?function(V,q,re,we){return c(V,pe(V,q,re,we))}:function(V,q,re,we){return c(V,q,pe(V,q,re,we))};return J(F,G,D);function pe(Z,V,q,re){return function(we,ie){we&&(we.code==="EMFILE"||we.code==="ENFILE")?$n([J,[Z,V,q],we,re||Date.now(),Date.now()]):(ie&&ie.sort&&ie.sort(),typeof q=="function"&&q.call(this,we,ie))}}}if(process.version.substr(0,4)==="v0.8"){var f=mR(t);v=f.ReadStream,I=f.WriteStream}var d=t.ReadStream;d&&(v.prototype=Object.create(d.prototype),v.prototype.open=T);var y=t.WriteStream;y&&(I.prototype=Object.create(y.prototype),I.prototype.open=L),Object.defineProperty(t,"ReadStream",{get:function(){return v},set:function(F){v=F},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return I},set:function(F){I=F},enumerable:!0,configurable:!0});var A=v;Object.defineProperty(t,"FileReadStream",{get:function(){return A},set:function(F){A=F},enumerable:!0,configurable:!0});var E=I;Object.defineProperty(t,"FileWriteStream",{get:function(){return E},set:function(F){E=F},enumerable:!0,configurable:!0});function v(F,G){return this instanceof v?(d.apply(this,arguments),this):v.apply(Object.create(v.prototype),arguments)}function T(){var F=this;S(F.path,F.flags,F.mode,function(G,D){G?(F.autoClose&&F.destroy(),F.emit("error",G)):(F.fd=D,F.emit("open",D),F.read())})}function I(F,G){return this instanceof I?(y.apply(this,arguments),this):I.apply(Object.create(I.prototype),arguments)}function L(){var F=this;S(F.path,F.flags,F.mode,function(G,D){G?(F.destroy(),F.emit("error",G)):(F.fd=D,F.emit("open",D))})}function oe(F,G){return new t.ReadStream(F,G)}function B(F,G){return new t.WriteStream(F,G)}var z=t.open;t.open=S;function S(F,G,D,J){return typeof D=="function"&&(J=D,D=null),pe(F,G,D,J);function pe(Z,V,q,re,we){return z(Z,V,q,function(ie,Wr){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?$n([pe,[Z,V,q,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}return t}function $n(t){Li("ENQUEUE",t[0].name,t[1]),me[qe].push(t),Yc()}var La;function Dg(){for(var t=Date.now(),e=0;e<me[qe].length;++e)me[qe][e].length>2&&(me[qe][e][3]=t,me[qe][e][4]=t);Yc()}function Yc(){if(clearTimeout(La),La=void 0,me[qe].length!==0){var t=me[qe].shift(),e=t[0],r=t[1],i=t[2],n=t[3],s=t[4];if(n===void 0)Li("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-n>=6e4){Li("TIMEOUT",e.name,r);var o=r.pop();typeof o=="function"&&o.call(null,i)}else{var a=Date.now()-s,l=Math.max(s-n,1),c=Math.min(l*1.2,100);a>=c?(Li("RETRY",e.name,r),e.apply(null,r.concat([n]))):me[qe].push(t)}La===void 0&&(La=setTimeout(Yc,0))}}});var $i=w(Vr=>{"use strict";var Fg=ut().fromCallback,ct=Ke(),wR=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>typeof ct[t]=="function");Object.assign(Vr,ct);wR.forEach(t=>{Vr[t]=Fg(ct[t])});Vr.exists=function(t,e){return typeof e=="function"?ct.exists(t,e):new Promise(r=>ct.exists(t,r))};Vr.read=function(t,e,r,i,n,s){return typeof s=="function"?ct.read(t,e,r,i,n,s):new Promise((o,a)=>{ct.read(t,e,r,i,n,(l,c,u)=>{if(l)return a(l);o({bytesRead:c,buffer:u})})})};Vr.write=function(t,e,...r){return typeof r[r.length-1]=="function"?ct.write(t,e,...r):new Promise((i,n)=>{ct.write(t,e,...r,(s,o,a)=>{if(s)return n(s);i({bytesWritten:o,buffer:a})})})};typeof ct.writev=="function"&&(Vr.writev=function(t,e,...r){return typeof r[r.length-1]=="function"?ct.writev(t,e,...r):new Promise((i,n)=>{ct.writev(t,e,...r,(s,o,a)=>{if(s)return n(s);i({bytesWritten:o,buffers:a})})})});typeof ct.realpath.native=="function"?Vr.realpath.native=Fg(ct.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var $g=w((WB,Lg)=>{"use strict";var AR=require("path");Lg.exports.checkPath=function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(AR.parse(e).root,""))){let i=new Error("Path contains invalid characters: ".concat(e));throw i.code="EINVAL",i}}});var Ug=w((GB,Xc)=>{"use strict";var kg=$i(),{checkPath:qg}=$g(),Mg=t=>{let e={mode:511};return typeof t=="number"?t:{...e,...t}.mode};Xc.exports.makeDir=async(t,e)=>(qg(t),kg.mkdir(t,{mode:Mg(e),recursive:!0}));Xc.exports.makeDirSync=(t,e)=>(qg(t),kg.mkdirSync(t,{mode:Mg(e),recursive:!0}))});var zt=w((zB,Bg)=>{"use strict";var ER=ut().fromPromise,{makeDir:SR,makeDirSync:Kc}=Ug(),Jc=ER(SR);Bg.exports={mkdirs:Jc,mkdirsSync:Kc,mkdirp:Jc,mkdirpSync:Kc,ensureDir:Jc,ensureDirSync:Kc}});var Yr=w((VB,Hg)=>{"use strict";var bR=ut().fromPromise,jg=$i();function _R(t){return jg.access(t).then(()=>!0).catch(()=>!1)}Hg.exports={pathExists:bR(_R),pathExistsSync:jg.existsSync}});var Zc=w((YB,Wg)=>{"use strict";var kn=Ke();function vR(t,e,r,i){kn.open(t,"r+",(n,s)=>{if(n)return i(n);kn.futimes(s,e,r,o=>{kn.close(s,a=>{i&&i(o||a)})})})}function TR(t,e,r){let i=kn.openSync(t,"r+");return kn.futimesSync(i,e,r),kn.closeSync(i)}Wg.exports={utimesMillis:vR,utimesMillisSync:TR}});var ki=w((QB,Vg)=>{"use strict";var qn=$i(),xe=require("path"),OR=require("util");function CR(t,e,r){let i=r.dereference?n=>qn.stat(n,{bigint:!0}):n=>qn.lstat(n,{bigint:!0});return Promise.all([i(t),i(e).catch(n=>{if(n.code==="ENOENT")return null;throw n})]).then(([n,s])=>({srcStat:n,destStat:s}))}function RR(t,e,r){let i,n=r.dereference?o=>qn.statSync(o,{bigint:!0}):o=>qn.lstatSync(o,{bigint:!0}),s=n(t);try{i=n(e)}catch(o){if(o.code==="ENOENT")return{srcStat:s,destStat:null};throw o}return{srcStat:s,destStat:i}}function IR(t,e,r,i,n){OR.callbackify(CR)(t,e,i,(s,o)=>{if(s)return n(s);let{srcStat:a,destStat:l}=o;if(l){if(no(a,l)){let c=xe.basename(t),u=xe.basename(e);return r==="move"&&c!==u&&c.toLowerCase()===u.toLowerCase()?n(null,{srcStat:a,destStat:l,isChangingCase:!0}):n(new Error("Source and destination must not be the same."))}if(a.isDirectory()&&!l.isDirectory())return n(new Error("Cannot overwrite non-directory '".concat(e,"' with directory '").concat(t,"'.")));if(!a.isDirectory()&&l.isDirectory())return n(new Error("Cannot overwrite directory '".concat(e,"' with non-directory '").concat(t,"'.")))}return a.isDirectory()&&eh(t,e)?n(new Error(ka(t,e,r))):n(null,{srcStat:a,destStat:l})})}function NR(t,e,r,i){let{srcStat:n,destStat:s}=RR(t,e,i);if(s){if(no(n,s)){let o=xe.basename(t),a=xe.basename(e);if(r==="move"&&o!==a&&o.toLowerCase()===a.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error("Cannot overwrite non-directory '".concat(e,"' with directory '").concat(t,"'."));if(!n.isDirectory()&&s.isDirectory())throw new Error("Cannot overwrite directory '".concat(e,"' with non-directory '").concat(t,"'."))}if(n.isDirectory()&&eh(t,e))throw new Error(ka(t,e,r));return{srcStat:n,destStat:s}}function Gg(t,e,r,i,n){let s=xe.resolve(xe.dirname(t)),o=xe.resolve(xe.dirname(r));if(o===s||o===xe.parse(o).root)return n();qn.stat(o,{bigint:!0},(a,l)=>a?a.code==="ENOENT"?n():n(a):no(e,l)?n(new Error(ka(t,r,i))):Gg(t,e,o,i,n))}function zg(t,e,r,i){let n=xe.resolve(xe.dirname(t)),s=xe.resolve(xe.dirname(r));if(s===n||s===xe.parse(s).root)return;let o;try{o=qn.statSync(s,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(no(e,o))throw new Error(ka(t,r,i));return zg(t,e,s,i)}function no(t,e){return e.ino&&e.dev&&e.ino===t.ino&&e.dev===t.dev}function eh(t,e){let r=xe.resolve(t).split(xe.sep).filter(n=>n),i=xe.resolve(e).split(xe.sep).filter(n=>n);return r.reduce((n,s,o)=>n&&i[o]===s,!0)}function ka(t,e,r){return"Cannot ".concat(r," '").concat(t,"' to a subdirectory of itself, '").concat(e,"'.")}Vg.exports={checkPaths:IR,checkPathsSync:NR,checkParentPaths:Gg,checkParentPathsSync:zg,isSrcSubdir:eh,areIdentical:no}});var ty=w((XB,ey)=>{"use strict";var ht=Ke(),so=require("path"),xR=zt().mkdirs,DR=Yr().pathExists,PR=Zc().utimesMillis,oo=ki();function FR(t,e,r,i){typeof r=="function"&&!i?(i=r,r={}):typeof r=="function"&&(r={filter:r}),i=i||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n	see https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0001"),oo.checkPaths(t,e,"copy",r,(n,s)=>{if(n)return i(n);let{srcStat:o,destStat:a}=s;oo.checkParentPaths(t,o,e,"copy",l=>l?i(l):r.filter?Xg(Yg,a,t,e,r,i):Yg(a,t,e,r,i))})}function Yg(t,e,r,i,n){let s=so.dirname(r);DR(s,(o,a)=>{if(o)return n(o);if(a)return qa(t,e,r,i,n);xR(s,l=>l?n(l):qa(t,e,r,i,n))})}function Xg(t,e,r,i,n,s){Promise.resolve(n.filter(r,i)).then(o=>o?t(e,r,i,n,s):s(),o=>s(o))}function LR(t,e,r,i,n){return i.filter?Xg(qa,t,e,r,i,n):qa(t,e,r,i,n)}function qa(t,e,r,i,n){(i.dereference?ht.stat:ht.lstat)(e,(o,a)=>o?n(o):a.isDirectory()?jR(a,t,e,r,i,n):a.isFile()||a.isCharacterDevice()||a.isBlockDevice()?$R(a,t,e,r,i,n):a.isSymbolicLink()?GR(t,e,r,i,n):a.isSocket()?n(new Error("Cannot copy a socket file: ".concat(e))):a.isFIFO()?n(new Error("Cannot copy a FIFO pipe: ".concat(e))):n(new Error("Unknown file: ".concat(e))))}function $R(t,e,r,i,n,s){return e?kR(t,r,i,n,s):Kg(t,r,i,n,s)}function kR(t,e,r,i,n){if(i.overwrite)ht.unlink(r,s=>s?n(s):Kg(t,e,r,i,n));else return i.errorOnExist?n(new Error("'".concat(r,"' already exists"))):n()}function Kg(t,e,r,i,n){ht.copyFile(e,r,s=>s?n(s):i.preserveTimestamps?qR(t.mode,e,r,n):Ma(r,t.mode,n))}function qR(t,e,r,i){return MR(t)?UR(r,t,n=>n?i(n):Qg(t,e,r,i)):Qg(t,e,r,i)}function MR(t){return(t&128)===0}function UR(t,e,r){return Ma(t,e|128,r)}function Qg(t,e,r,i){BR(e,r,n=>n?i(n):Ma(r,t,i))}function Ma(t,e,r){return ht.chmod(t,e,r)}function BR(t,e,r){ht.stat(t,(i,n)=>i?r(i):PR(e,n.atime,n.mtime,r))}function jR(t,e,r,i,n,s){return e?Jg(r,i,n,s):HR(t.mode,r,i,n,s)}function HR(t,e,r,i,n){ht.mkdir(r,s=>{if(s)return n(s);Jg(e,r,i,o=>o?n(o):Ma(r,t,n))})}function Jg(t,e,r,i){ht.readdir(t,(n,s)=>n?i(n):Zg(s,t,e,r,i))}function Zg(t,e,r,i,n){let s=t.pop();return s?WR(t,s,e,r,i,n):n()}function WR(t,e,r,i,n,s){let o=so.join(r,e),a=so.join(i,e);oo.checkPaths(o,a,"copy",n,(l,c)=>{if(l)return s(l);let{destStat:u}=c;LR(u,o,a,n,h=>h?s(h):Zg(t,r,i,n,s))})}function GR(t,e,r,i,n){ht.readlink(e,(s,o)=>{if(s)return n(s);if(i.dereference&&(o=so.resolve(process.cwd(),o)),t)ht.readlink(r,(a,l)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?ht.symlink(o,r,n):n(a):(i.dereference&&(l=so.resolve(process.cwd(),l)),oo.isSrcSubdir(o,l)?n(new Error("Cannot copy '".concat(o,"' to a subdirectory of itself, '").concat(l,"'."))):t.isDirectory()&&oo.isSrcSubdir(l,o)?n(new Error("Cannot overwrite '".concat(l,"' with '").concat(o,"'."))):zR(o,r,n)));else return ht.symlink(o,r,n)})}function zR(t,e,r){ht.unlink(e,i=>i?r(i):ht.symlink(t,e,r))}ey.exports=FR});var oy=w((KB,sy)=>{"use strict";var Be=Ke(),ao=require("path"),VR=zt().mkdirsSync,YR=Zc().utimesMillisSync,lo=ki();function QR(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n	see https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0002");let{srcStat:i,destStat:n}=lo.checkPathsSync(t,e,"copy",r);return lo.checkParentPathsSync(t,i,e,"copy"),XR(n,t,e,r)}function XR(t,e,r,i){if(i.filter&&!i.filter(e,r))return;let n=ao.dirname(r);return Be.existsSync(n)||VR(n),ry(t,e,r,i)}function KR(t,e,r,i){if(!(i.filter&&!i.filter(e,r)))return ry(t,e,r,i)}function ry(t,e,r,i){let s=(i.dereference?Be.statSync:Be.lstatSync)(e);if(s.isDirectory())return nI(s,t,e,r,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return JR(s,t,e,r,i);if(s.isSymbolicLink())return aI(t,e,r,i);throw s.isSocket()?new Error("Cannot copy a socket file: ".concat(e)):s.isFIFO()?new Error("Cannot copy a FIFO pipe: ".concat(e)):new Error("Unknown file: ".concat(e))}function JR(t,e,r,i,n){return e?ZR(t,r,i,n):iy(t,r,i,n)}function ZR(t,e,r,i){if(i.overwrite)return Be.unlinkSync(r),iy(t,e,r,i);if(i.errorOnExist)throw new Error("'".concat(r,"' already exists"))}function iy(t,e,r,i){return Be.copyFileSync(e,r),i.preserveTimestamps&&eI(t.mode,e,r),th(r,t.mode)}function eI(t,e,r){return tI(t)&&rI(r,t),iI(e,r)}function tI(t){return(t&128)===0}function rI(t,e){return th(t,e|128)}function th(t,e){return Be.chmodSync(t,e)}function iI(t,e){let r=Be.statSync(t);return YR(e,r.atime,r.mtime)}function nI(t,e,r,i,n){return e?ny(r,i,n):sI(t.mode,r,i,n)}function sI(t,e,r,i){return Be.mkdirSync(r),ny(e,r,i),th(r,t)}function ny(t,e,r){Be.readdirSync(t).forEach(i=>oI(i,t,e,r))}function oI(t,e,r,i){let n=ao.join(e,t),s=ao.join(r,t),{destStat:o}=lo.checkPathsSync(n,s,"copy",i);return KR(o,n,s,i)}function aI(t,e,r,i){let n=Be.readlinkSync(e);if(i.dereference&&(n=ao.resolve(process.cwd(),n)),t){let s;try{s=Be.readlinkSync(r)}catch(o){if(o.code==="EINVAL"||o.code==="UNKNOWN")return Be.symlinkSync(n,r);throw o}if(i.dereference&&(s=ao.resolve(process.cwd(),s)),lo.isSrcSubdir(n,s))throw new Error("Cannot copy '".concat(n,"' to a subdirectory of itself, '").concat(s,"'."));if(Be.statSync(r).isDirectory()&&lo.isSrcSubdir(s,n))throw new Error("Cannot overwrite '".concat(s,"' with '").concat(n,"'."));return lI(n,r)}else return Be.symlinkSync(n,r)}function lI(t,e){return Be.unlinkSync(e),Be.symlinkSync(t,e)}sy.exports=QR});var Ua=w((JB,ay)=>{"use strict";var uI=ut().fromCallback;ay.exports={copy:uI(ty()),copySync:oy()}});var gy=w((ZB,my)=>{"use strict";var ly=Ke(),fy=require("path"),ae=require("assert"),uo=process.platform==="win32";function dy(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||ly[r],r=r+"Sync",t[r]=t[r]||ly[r]}),t.maxBusyTries=t.maxBusyTries||3}function rh(t,e,r){let i=0;typeof e=="function"&&(r=e,e={}),ae(t,"rimraf: missing path"),ae.strictEqual(typeof t,"string","rimraf: path should be a string"),ae.strictEqual(typeof r,"function","rimraf: callback function required"),ae(e,"rimraf: invalid options argument provided"),ae.strictEqual(typeof e,"object","rimraf: options should be object"),dy(e),uy(t,e,function n(s){if(s){if((s.code==="EBUSY"||s.code==="ENOTEMPTY"||s.code==="EPERM")&&i<e.maxBusyTries){i++;let o=i*100;return setTimeout(()=>uy(t,e,n),o)}s.code==="ENOENT"&&(s=null)}r(s)})}function uy(t,e,r){ae(t),ae(e),ae(typeof r=="function"),e.lstat(t,(i,n)=>{if(i&&i.code==="ENOENT")return r(null);if(i&&i.code==="EPERM"&&uo)return cy(t,e,i,r);if(n&&n.isDirectory())return Ba(t,e,i,r);e.unlink(t,s=>{if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return uo?cy(t,e,s,r):Ba(t,e,s,r);if(s.code==="EISDIR")return Ba(t,e,s,r)}return r(s)})})}function cy(t,e,r,i){ae(t),ae(e),ae(typeof i=="function"),e.chmod(t,438,n=>{n?i(n.code==="ENOENT"?null:r):e.stat(t,(s,o)=>{s?i(s.code==="ENOENT"?null:r):o.isDirectory()?Ba(t,e,r,i):e.unlink(t,i)})})}function hy(t,e,r){let i;ae(t),ae(e);try{e.chmodSync(t,438)}catch(n){if(n.code==="ENOENT")return;throw r}try{i=e.statSync(t)}catch(n){if(n.code==="ENOENT")return;throw r}i.isDirectory()?ja(t,e,r):e.unlinkSync(t)}function Ba(t,e,r,i){ae(t),ae(e),ae(typeof i=="function"),e.rmdir(t,n=>{n&&(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")?cI(t,e,i):n&&n.code==="ENOTDIR"?i(r):i(n)})}function cI(t,e,r){ae(t),ae(e),ae(typeof r=="function"),e.readdir(t,(i,n)=>{if(i)return r(i);let s=n.length,o;if(s===0)return e.rmdir(t,r);n.forEach(a=>{rh(fy.join(t,a),e,l=>{if(!o){if(l)return r(o=l);--s===0&&e.rmdir(t,r)}})})})}function py(t,e){let r;e=e||{},dy(e),ae(t,"rimraf: missing path"),ae.strictEqual(typeof t,"string","rimraf: path should be a string"),ae(e,"rimraf: missing options"),ae.strictEqual(typeof e,"object","rimraf: options should be object");try{r=e.lstatSync(t)}catch(i){if(i.code==="ENOENT")return;i.code==="EPERM"&&uo&&hy(t,e,i)}try{r&&r.isDirectory()?ja(t,e,null):e.unlinkSync(t)}catch(i){if(i.code==="ENOENT")return;if(i.code==="EPERM")return uo?hy(t,e,i):ja(t,e,i);if(i.code!=="EISDIR")throw i;ja(t,e,i)}}function ja(t,e,r){ae(t),ae(e);try{e.rmdirSync(t)}catch(i){if(i.code==="ENOTDIR")throw r;if(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")hI(t,e);else if(i.code!=="ENOENT")throw i}}function hI(t,e){if(ae(t),ae(e),e.readdirSync(t).forEach(r=>py(fy.join(t,r),e)),uo){let r=Date.now();do try{return e.rmdirSync(t,e)}catch{}while(Date.now()-r<500)}else return e.rmdirSync(t,e)}my.exports=rh;rh.sync=py});var co=w((ej,wy)=>{"use strict";var Ha=Ke(),fI=ut().fromCallback,yy=gy();function dI(t,e){if(Ha.rm)return Ha.rm(t,{recursive:!0,force:!0},e);yy(t,e)}function pI(t){if(Ha.rmSync)return Ha.rmSync(t,{recursive:!0,force:!0});yy.sync(t)}wy.exports={remove:fI(dI),removeSync:pI}});var Oy=w((tj,Ty)=>{"use strict";var mI=ut().fromPromise,Sy=$i(),by=require("path"),_y=zt(),vy=co(),Ay=mI(async function(e){let r;try{r=await Sy.readdir(e)}catch{return _y.mkdirs(e)}return Promise.all(r.map(i=>vy.remove(by.join(e,i))))});function Ey(t){let e;try{e=Sy.readdirSync(t)}catch{return _y.mkdirsSync(t)}e.forEach(r=>{r=by.join(t,r),vy.removeSync(r)})}Ty.exports={emptyDirSync:Ey,emptydirSync:Ey,emptyDir:Ay,emptydir:Ay}});var Ny=w((rj,Iy)=>{"use strict";var gI=ut().fromCallback,Cy=require("path"),Qr=Ke(),Ry=zt();function yI(t,e){function r(){Qr.writeFile(t,"",i=>{if(i)return e(i);e()})}Qr.stat(t,(i,n)=>{if(!i&&n.isFile())return e();let s=Cy.dirname(t);Qr.stat(s,(o,a)=>{if(o)return o.code==="ENOENT"?Ry.mkdirs(s,l=>{if(l)return e(l);r()}):e(o);a.isDirectory()?r():Qr.readdir(s,l=>{if(l)return e(l)})})})}function wI(t){let e;try{e=Qr.statSync(t)}catch{}if(e&&e.isFile())return;let r=Cy.dirname(t);try{Qr.statSync(r).isDirectory()||Qr.readdirSync(r)}catch(i){if(i&&i.code==="ENOENT")Ry.mkdirsSync(r);else throw i}Qr.writeFileSync(t,"")}Iy.exports={createFile:gI(yI),createFileSync:wI}});var Ly=w((ij,Fy)=>{"use strict";var AI=ut().fromCallback,xy=require("path"),Xr=Ke(),Dy=zt(),EI=Yr().pathExists,{areIdentical:Py}=ki();function SI(t,e,r){function i(n,s){Xr.link(n,s,o=>{if(o)return r(o);r(null)})}Xr.lstat(e,(n,s)=>{Xr.lstat(t,(o,a)=>{if(o)return o.message=o.message.replace("lstat","ensureLink"),r(o);if(s&&Py(a,s))return r(null);let l=xy.dirname(e);EI(l,(c,u)=>{if(c)return r(c);if(u)return i(t,e);Dy.mkdirs(l,h=>{if(h)return r(h);i(t,e)})})})})}function bI(t,e){let r;try{r=Xr.lstatSync(e)}catch{}try{let s=Xr.lstatSync(t);if(r&&Py(s,r))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let i=xy.dirname(e);return Xr.existsSync(i)||Dy.mkdirsSync(i),Xr.linkSync(t,e)}Fy.exports={createLink:AI(SI),createLinkSync:bI}});var ky=w((nj,$y)=>{"use strict";var Kr=require("path"),ho=Ke(),_I=Yr().pathExists;function vI(t,e,r){if(Kr.isAbsolute(t))return ho.lstat(t,i=>i?(i.message=i.message.replace("lstat","ensureSymlink"),r(i)):r(null,{toCwd:t,toDst:t}));{let i=Kr.dirname(e),n=Kr.join(i,t);return _I(n,(s,o)=>s?r(s):o?r(null,{toCwd:n,toDst:t}):ho.lstat(t,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:t,toDst:Kr.relative(i,t)})))}}function TI(t,e){let r;if(Kr.isAbsolute(t)){if(r=ho.existsSync(t),!r)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}else{let i=Kr.dirname(e),n=Kr.join(i,t);if(r=ho.existsSync(n),r)return{toCwd:n,toDst:t};if(r=ho.existsSync(t),!r)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:Kr.relative(i,t)}}}$y.exports={symlinkPaths:vI,symlinkPathsSync:TI}});var Uy=w((sj,My)=>{"use strict";var qy=Ke();function OI(t,e,r){if(r=typeof e=="function"?e:r,e=typeof e=="function"?!1:e,e)return r(null,e);qy.lstat(t,(i,n)=>{if(i)return r(null,"file");e=n&&n.isDirectory()?"dir":"file",r(null,e)})}function CI(t,e){let r;if(e)return e;try{r=qy.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}My.exports={symlinkType:OI,symlinkTypeSync:CI}});var Yy=w((oj,Vy)=>{"use strict";var RI=ut().fromCallback,jy=require("path"),Vt=$i(),Hy=zt(),II=Hy.mkdirs,NI=Hy.mkdirsSync,Wy=ky(),xI=Wy.symlinkPaths,DI=Wy.symlinkPathsSync,Gy=Uy(),PI=Gy.symlinkType,FI=Gy.symlinkTypeSync,LI=Yr().pathExists,{areIdentical:zy}=ki();function $I(t,e,r,i){i=typeof r=="function"?r:i,r=typeof r=="function"?!1:r,Vt.lstat(e,(n,s)=>{!n&&s.isSymbolicLink()?Promise.all([Vt.stat(t),Vt.stat(e)]).then(([o,a])=>{if(zy(o,a))return i(null);By(t,e,r,i)}):By(t,e,r,i)})}function By(t,e,r,i){xI(t,e,(n,s)=>{if(n)return i(n);t=s.toDst,PI(s.toCwd,r,(o,a)=>{if(o)return i(o);let l=jy.dirname(e);LI(l,(c,u)=>{if(c)return i(c);if(u)return Vt.symlink(t,e,a,i);II(l,h=>{if(h)return i(h);Vt.symlink(t,e,a,i)})})})})}function kI(t,e,r){let i;try{i=Vt.lstatSync(e)}catch{}if(i&&i.isSymbolicLink()){let a=Vt.statSync(t),l=Vt.statSync(e);if(zy(a,l))return}let n=DI(t,e);t=n.toDst,r=FI(n.toCwd,r);let s=jy.dirname(e);return Vt.existsSync(s)||NI(s),Vt.symlinkSync(t,e,r)}Vy.exports={createSymlink:RI($I),createSymlinkSync:kI}});var rw=w((aj,tw)=>{"use strict";var{createFile:Qy,createFileSync:Xy}=Ny(),{createLink:Ky,createLinkSync:Jy}=Ly(),{createSymlink:Zy,createSymlinkSync:ew}=Yy();tw.exports={createFile:Qy,createFileSync:Xy,ensureFile:Qy,ensureFileSync:Xy,createLink:Ky,createLinkSync:Jy,ensureLink:Ky,ensureLinkSync:Jy,createSymlink:Zy,createSymlinkSync:ew,ensureSymlink:Zy,ensureSymlinkSync:ew}});var Wa=w((lj,iw)=>{function qI(t,{EOL:e="\n",finalEOL:r=!0,replacer:i=null,spaces:n}={}){let s=r?e:"";return JSON.stringify(t,i,n).replace(/\n/g,e)+s}function MI(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t.replace(/^\uFEFF/,"")}iw.exports={stringify:qI,stripBom:MI}});var aw=w((uj,ow)=>{var Mn;try{Mn=Ke()}catch{Mn=require("fs")}var Ga=ut(),{stringify:nw,stripBom:sw}=Wa();async function UI(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||Mn,i="throws"in e?e.throws:!0,n=await Ga.fromCallback(r.readFile)(t,e);n=sw(n);let s;try{s=JSON.parse(n,e?e.reviver:null)}catch(o){if(i)throw o.message="".concat(t,": ").concat(o.message),o;return null}return s}var BI=Ga.fromPromise(UI);function jI(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||Mn,i="throws"in e?e.throws:!0;try{let n=r.readFileSync(t,e);return n=sw(n),JSON.parse(n,e.reviver)}catch(n){if(i)throw n.message="".concat(t,": ").concat(n.message),n;return null}}async function HI(t,e,r={}){let i=r.fs||Mn,n=nw(e,r);await Ga.fromCallback(i.writeFile)(t,n,r)}var WI=Ga.fromPromise(HI);function GI(t,e,r={}){let i=r.fs||Mn,n=nw(e,r);return i.writeFileSync(t,n,r)}var zI={readFile:BI,readFileSync:jI,writeFile:WI,writeFileSync:GI};ow.exports=zI});var uw=w((cj,lw)=>{"use strict";var za=aw();lw.exports={readJson:za.readFile,readJsonSync:za.readFileSync,writeJson:za.writeFile,writeJsonSync:za.writeFileSync}});var Va=w((hj,fw)=>{"use strict";var VI=ut().fromCallback,fo=Ke(),cw=require("path"),hw=zt(),YI=Yr().pathExists;function QI(t,e,r,i){typeof r=="function"&&(i=r,r="utf8");let n=cw.dirname(t);YI(n,(s,o)=>{if(s)return i(s);if(o)return fo.writeFile(t,e,r,i);hw.mkdirs(n,a=>{if(a)return i(a);fo.writeFile(t,e,r,i)})})}function XI(t,...e){let r=cw.dirname(t);if(fo.existsSync(r))return fo.writeFileSync(t,...e);hw.mkdirsSync(r),fo.writeFileSync(t,...e)}fw.exports={outputFile:VI(QI),outputFileSync:XI}});var pw=w((fj,dw)=>{"use strict";var{stringify:KI}=Wa(),{outputFile:JI}=Va();async function ZI(t,e,r={}){let i=KI(e,r);await JI(t,i,r)}dw.exports=ZI});var gw=w((dj,mw)=>{"use strict";var{stringify:eN}=Wa(),{outputFileSync:tN}=Va();function rN(t,e,r){let i=eN(e,r);tN(t,i,r)}mw.exports=rN});var ww=w((pj,yw)=>{"use strict";var iN=ut().fromPromise,Je=uw();Je.outputJson=iN(pw());Je.outputJsonSync=gw();Je.outputJSON=Je.outputJson;Je.outputJSONSync=Je.outputJsonSync;Je.writeJSON=Je.writeJson;Je.writeJSONSync=Je.writeJsonSync;Je.readJSON=Je.readJson;Je.readJSONSync=Je.readJsonSync;yw.exports=Je});var _w=w((mj,bw)=>{"use strict";var nN=Ke(),nh=require("path"),sN=Ua().copy,Sw=co().remove,oN=zt().mkdirp,aN=Yr().pathExists,Aw=ki();function lN(t,e,r,i){typeof r=="function"&&(i=r,r={}),r=r||{};let n=r.overwrite||r.clobber||!1;Aw.checkPaths(t,e,"move",r,(s,o)=>{if(s)return i(s);let{srcStat:a,isChangingCase:l=!1}=o;Aw.checkParentPaths(t,a,e,"move",c=>{if(c)return i(c);if(uN(e))return Ew(t,e,n,l,i);oN(nh.dirname(e),u=>u?i(u):Ew(t,e,n,l,i))})})}function uN(t){let e=nh.dirname(t);return nh.parse(e).root===e}function Ew(t,e,r,i,n){if(i)return ih(t,e,r,n);if(r)return Sw(e,s=>s?n(s):ih(t,e,r,n));aN(e,(s,o)=>s?n(s):o?n(new Error("dest already exists.")):ih(t,e,r,n))}function ih(t,e,r,i){nN.rename(t,e,n=>n?n.code!=="EXDEV"?i(n):cN(t,e,r,i):i())}function cN(t,e,r,i){sN(t,e,{overwrite:r,errorOnExist:!0},s=>s?i(s):Sw(t,i))}bw.exports=lN});var Rw=w((gj,Cw)=>{"use strict";var Tw=Ke(),oh=require("path"),hN=Ua().copySync,Ow=co().removeSync,fN=zt().mkdirpSync,vw=ki();function dN(t,e,r){r=r||{};let i=r.overwrite||r.clobber||!1,{srcStat:n,isChangingCase:s=!1}=vw.checkPathsSync(t,e,"move",r);return vw.checkParentPathsSync(t,n,e,"move"),pN(e)||fN(oh.dirname(e)),mN(t,e,i,s)}function pN(t){let e=oh.dirname(t);return oh.parse(e).root===e}function mN(t,e,r,i){if(i)return sh(t,e,r);if(r)return Ow(e),sh(t,e,r);if(Tw.existsSync(e))throw new Error("dest already exists.");return sh(t,e,r)}function sh(t,e,r){try{Tw.renameSync(t,e)}catch(i){if(i.code!=="EXDEV")throw i;return gN(t,e,r)}}function gN(t,e,r){return hN(t,e,{overwrite:r,errorOnExist:!0}),Ow(t)}Cw.exports=dN});var Nw=w((yj,Iw)=>{"use strict";var yN=ut().fromCallback;Iw.exports={move:yN(_w()),moveSync:Rw()}});var gr=w((wj,xw)=>{"use strict";xw.exports={...$i(),...Ua(),...Oy(),...rw(),...ww(),...zt(),...Nw(),...Va(),...Yr(),...co()}});var Un=w((Aj,qi)=>{"use strict";function Dw(t){return typeof t>"u"||t===null}function wN(t){return typeof t=="object"&&t!==null}function AN(t){return Array.isArray(t)?t:Dw(t)?[]:[t]}function EN(t,e){var r,i,n,s;if(e)for(s=Object.keys(e),r=0,i=s.length;r<i;r+=1)n=s[r],t[n]=e[n];return t}function SN(t,e){var r="",i;for(i=0;i<e;i+=1)r+=t;return r}function bN(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}qi.exports.isNothing=Dw;qi.exports.isObject=wN;qi.exports.toArray=AN;qi.exports.repeat=SN;qi.exports.isNegativeZero=bN;qi.exports.extend=EN});var Bn=w((Ej,Fw)=>{"use strict";function Pw(t,e){var r="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+="\n\n"+t.mark.snippet),i+" "+r):i}function po(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=Pw(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}po.prototype=Object.create(Error.prototype);po.prototype.constructor=po;po.prototype.toString=function(e){return this.name+": "+Pw(this,e)};Fw.exports=po});var $w=w((Sj,Lw)=>{"use strict";var mo=Un();function ah(t,e,r,i,n){var s="",o="",a=Math.floor(n/2)-1;return i-e>a&&(s=" ... ",e=i-a+s.length),r-i>a&&(o=" ...",r=i+a-o.length),{str:s+t.slice(e,r).replace(/\t/g,"\u2192")+o,pos:i-e+s.length}}function lh(t,e){return mo.repeat(" ",e-t.length)+t}function _N(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,i=[0],n=[],s,o=-1;s=r.exec(t.buffer);)n.push(s.index),i.push(s.index+s[0].length),t.position<=s.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var a="",l,c,u=Math.min(t.line+e.linesAfter,n.length).toString().length,h=e.maxLength-(e.indent+u+3);for(l=1;l<=e.linesBefore&&!(o-l<0);l++)c=ah(t.buffer,i[o-l],n[o-l],t.position-(i[o]-i[o-l]),h),a=mo.repeat(" ",e.indent)+lh((t.line-l+1).toString(),u)+" | "+c.str+"\n"+a;for(c=ah(t.buffer,i[o],n[o],t.position,h),a+=mo.repeat(" ",e.indent)+lh((t.line+1).toString(),u)+" | "+c.str+"\n",a+=mo.repeat("-",e.indent+u+3+c.pos)+"^\n",l=1;l<=e.linesAfter&&!(o+l>=n.length);l++)c=ah(t.buffer,i[o+l],n[o+l],t.position-(i[o]-i[o+l]),h),a+=mo.repeat(" ",e.indent)+lh((t.line+l+1).toString(),u)+" | "+c.str+"\n";return a.replace(/\n$/,"")}Lw.exports=_N});var je=w((bj,qw)=>{"use strict";var kw=Bn(),vN=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],TN=["scalar","sequence","mapping"];function ON(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(i){e[String(i)]=r})}),e}function CN(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(vN.indexOf(r)===-1)throw new kw('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=ON(e.styleAliases||null),TN.indexOf(this.kind)===-1)throw new kw('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}qw.exports=CN});var hh=w((_j,Uw)=>{"use strict";var go=Bn(),uh=je();function Mw(t,e){var r=[];return t[e].forEach(function(i){var n=r.length;r.forEach(function(s,o){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(n=o)}),r[n]=i}),r}function RN(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function i(n){n.multi?(t.multi[n.kind].push(n),t.multi.fallback.push(n)):t[n.kind][n.tag]=t.fallback[n.tag]=n}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(i);return t}function ch(t){return this.extend(t)}ch.prototype.extend=function(e){var r=[],i=[];if(e instanceof uh)i.push(e);else if(Array.isArray(e))i=i.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(i=i.concat(e.explicit));else throw new go("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof uh))throw new go("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new go("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new go("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof uh))throw new go("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var n=Object.create(ch.prototype);return n.implicit=(this.implicit||[]).concat(r),n.explicit=(this.explicit||[]).concat(i),n.compiledImplicit=Mw(n,"implicit"),n.compiledExplicit=Mw(n,"explicit"),n.compiledTypeMap=RN(n.compiledImplicit,n.compiledExplicit),n};Uw.exports=ch});var fh=w((vj,Bw)=>{"use strict";var IN=je();Bw.exports=new IN("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}})});var dh=w((Tj,jw)=>{"use strict";var NN=je();jw.exports=new NN("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}})});var ph=w((Oj,Hw)=>{"use strict";var xN=je();Hw.exports=new xN("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}})});var mh=w((Cj,Ww)=>{"use strict";var DN=hh();Ww.exports=new DN({explicit:[fh(),dh(),ph()]})});var gh=w((Rj,Gw)=>{"use strict";var PN=je();function FN(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}function LN(){return null}function $N(t){return t===null}Gw.exports=new PN("tag:yaml.org,2002:null",{kind:"scalar",resolve:FN,construct:LN,predicate:$N,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"})});var yh=w((Ij,zw)=>{"use strict";var kN=je();function qN(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}function MN(t){return t==="true"||t==="True"||t==="TRUE"}function UN(t){return Object.prototype.toString.call(t)==="[object Boolean]"}zw.exports=new kN("tag:yaml.org,2002:bool",{kind:"scalar",resolve:qN,construct:MN,predicate:UN,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"})});var wh=w((Nj,Vw)=>{"use strict";var BN=Un(),jN=je();function HN(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function WN(t){return 48<=t&&t<=55}function GN(t){return 48<=t&&t<=57}function zN(t){if(t===null)return!1;var e=t.length,r=0,i=!1,n;if(!e)return!1;if(n=t[r],(n==="-"||n==="+")&&(n=t[++r]),n==="0"){if(r+1===e)return!0;if(n=t[++r],n==="b"){for(r++;r<e;r++)if(n=t[r],n!=="_"){if(n!=="0"&&n!=="1")return!1;i=!0}return i&&n!=="_"}if(n==="x"){for(r++;r<e;r++)if(n=t[r],n!=="_"){if(!HN(t.charCodeAt(r)))return!1;i=!0}return i&&n!=="_"}if(n==="o"){for(r++;r<e;r++)if(n=t[r],n!=="_"){if(!WN(t.charCodeAt(r)))return!1;i=!0}return i&&n!=="_"}}if(n==="_")return!1;for(;r<e;r++)if(n=t[r],n!=="_"){if(!GN(t.charCodeAt(r)))return!1;i=!0}return!(!i||n==="_")}function VN(t){var e=t,r=1,i;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),i=e[0],(i==="-"||i==="+")&&(i==="-"&&(r=-1),e=e.slice(1),i=e[0]),e==="0")return 0;if(i==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}function YN(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!BN.isNegativeZero(t)}Vw.exports=new jN("tag:yaml.org,2002:int",{kind:"scalar",resolve:zN,construct:VN,predicate:YN,represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})});var Ah=w((xj,Qw)=>{"use strict";var Yw=Un(),QN=je(),XN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function KN(t){return!(t===null||!XN.test(t)||t[t.length-1]==="_")}function JN(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}var ZN=/^[-+]?[0-9]+e/;function ex(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Yw.isNegativeZero(t))return"-0.0";return r=t.toString(10),ZN.test(r)?r.replace("e",".e"):r}function tx(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||Yw.isNegativeZero(t))}Qw.exports=new QN("tag:yaml.org,2002:float",{kind:"scalar",resolve:KN,construct:JN,predicate:tx,represent:ex,defaultStyle:"lowercase"})});var Eh=w((Dj,Xw)=>{"use strict";Xw.exports=mh().extend({implicit:[gh(),yh(),wh(),Ah()]})});var Sh=w((Pj,Kw)=>{"use strict";Kw.exports=Eh()});var bh=w((Fj,e0)=>{"use strict";var rx=je(),Jw=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Zw=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function ix(t){return t===null?!1:Jw.exec(t)!==null||Zw.exec(t)!==null}function nx(t){var e,r,i,n,s,o,a,l=0,c=null,u,h,f;if(e=Jw.exec(t),e===null&&(e=Zw.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],i=+e[2]-1,n=+e[3],!e[4])return new Date(Date.UTC(r,i,n));if(s=+e[4],o=+e[5],a=+e[6],e[7]){for(l=e[7].slice(0,3);l.length<3;)l+="0";l=+l}return e[9]&&(u=+e[10],h=+(e[11]||0),c=(u*60+h)*6e4,e[9]==="-"&&(c=-c)),f=new Date(Date.UTC(r,i,n,s,o,a,l)),c&&f.setTime(f.getTime()-c),f}function sx(t){return t.toISOString()}e0.exports=new rx("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:ix,construct:nx,instanceOf:Date,represent:sx})});var _h=w((Lj,t0)=>{"use strict";var ox=je();function ax(t){return t==="<<"||t===null}t0.exports=new ox("tag:yaml.org,2002:merge",{kind:"scalar",resolve:ax})});var Th=w(($j,r0)=>{"use strict";var lx=je(),vh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function ux(t){if(t===null)return!1;var e,r,i=0,n=t.length,s=vh;for(r=0;r<n;r++)if(e=s.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;i+=6}return i%8===0}function cx(t){var e,r,i=t.replace(/[\r\n=]/g,""),n=i.length,s=vh,o=0,a=[];for(e=0;e<n;e++)e%4===0&&e&&(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)),o=o<<6|s.indexOf(i.charAt(e));return r=n%4*6,r===0?(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)):r===18?(a.push(o>>10&255),a.push(o>>2&255)):r===12&&a.push(o>>4&255),new Uint8Array(a)}function hx(t){var e="",r=0,i,n,s=t.length,o=vh;for(i=0;i<s;i++)i%3===0&&i&&(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]),r=(r<<8)+t[i];return n=s%3,n===0?(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]):n===2?(e+=o[r>>10&63],e+=o[r>>4&63],e+=o[r<<2&63],e+=o[64]):n===1&&(e+=o[r>>2&63],e+=o[r<<4&63],e+=o[64],e+=o[64]),e}function fx(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}r0.exports=new lx("tag:yaml.org,2002:binary",{kind:"scalar",resolve:ux,construct:cx,predicate:fx,represent:hx})});var Oh=w((kj,i0)=>{"use strict";var dx=je(),px=Object.prototype.hasOwnProperty,mx=Object.prototype.toString;function gx(t){if(t===null)return!0;var e=[],r,i,n,s,o,a=t;for(r=0,i=a.length;r<i;r+=1){if(n=a[r],o=!1,mx.call(n)!=="[object Object]")return!1;for(s in n)if(px.call(n,s))if(!o)o=!0;else return!1;if(!o)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}function yx(t){return t!==null?t:[]}i0.exports=new dx("tag:yaml.org,2002:omap",{kind:"sequence",resolve:gx,construct:yx})});var Ch=w((qj,n0)=>{"use strict";var wx=je(),Ax=Object.prototype.toString;function Ex(t){if(t===null)return!0;var e,r,i,n,s,o=t;for(s=new Array(o.length),e=0,r=o.length;e<r;e+=1){if(i=o[e],Ax.call(i)!=="[object Object]"||(n=Object.keys(i),n.length!==1))return!1;s[e]=[n[0],i[n[0]]]}return!0}function Sx(t){if(t===null)return[];var e,r,i,n,s,o=t;for(s=new Array(o.length),e=0,r=o.length;e<r;e+=1)i=o[e],n=Object.keys(i),s[e]=[n[0],i[n[0]]];return s}n0.exports=new wx("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Ex,construct:Sx})});var Rh=w((Mj,s0)=>{"use strict";var bx=je(),_x=Object.prototype.hasOwnProperty;function vx(t){if(t===null)return!0;var e,r=t;for(e in r)if(_x.call(r,e)&&r[e]!==null)return!1;return!0}function Tx(t){return t!==null?t:{}}s0.exports=new bx("tag:yaml.org,2002:set",{kind:"mapping",resolve:vx,construct:Tx})});var Ya=w((Uj,o0)=>{"use strict";o0.exports=Sh().extend({implicit:[bh(),_h()],explicit:[Th(),Oh(),Ch(),Rh()]})});var b0=w((Bj,Dh)=>{"use strict";var Ui=Un(),d0=Bn(),Ox=$w(),Cx=Ya(),Zr=Object.prototype.hasOwnProperty,Qa=1,p0=2,m0=3,Xa=4,Ih=1,Rx=2,a0=3,Ix=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Nx=/[\x85\u2028\u2029]/,xx=/[,\[\]\{\}]/,g0=/^(?:!|!!|![a-z\-]+!)$/i,y0=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function l0(t){return Object.prototype.toString.call(t)}function Zt(t){return t===10||t===13}function Bi(t){return t===9||t===32}function ft(t){return t===9||t===32||t===10||t===13}function jn(t){return t===44||t===91||t===93||t===123||t===125}function Dx(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}function Px(t){return t===120?2:t===117?4:t===85?8:0}function Fx(t){return 48<=t&&t<=57?t-48:-1}function u0(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?"\n":t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}function Lx(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}var w0=new Array(256),A0=new Array(256);for(Mi=0;Mi<256;Mi++)w0[Mi]=u0(Mi)?1:0,A0[Mi]=u0(Mi);var Mi;function $x(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||Cx,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function E0(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=Ox(r),new d0(e,r)}function $(t,e){throw E0(t,e)}function Ka(t,e){t.onWarning&&t.onWarning.call(null,E0(t,e))}var c0={YAML:function(e,r,i){var n,s,o;e.version!==null&&$(e,"duplication of %YAML directive"),i.length!==1&&$(e,"YAML directive accepts exactly one argument"),n=/^([0-9]+)\.([0-9]+)$/.exec(i[0]),n===null&&$(e,"ill-formed argument of the YAML directive"),s=parseInt(n[1],10),o=parseInt(n[2],10),s!==1&&$(e,"unacceptable YAML version of the document"),e.version=i[0],e.checkLineBreaks=o<2,o!==1&&o!==2&&Ka(e,"unsupported YAML version of the document")},TAG:function(e,r,i){var n,s;i.length!==2&&$(e,"TAG directive accepts exactly two arguments"),n=i[0],s=i[1],g0.test(n)||$(e,"ill-formed tag handle (first argument) of the TAG directive"),Zr.call(e.tagMap,n)&&$(e,'there is a previously declared suffix for "'+n+'" tag handle'),y0.test(s)||$(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{$(e,"tag prefix is malformed: "+s)}e.tagMap[n]=s}};function Jr(t,e,r,i){var n,s,o,a;if(e<r){if(a=t.input.slice(e,r),i)for(n=0,s=a.length;n<s;n+=1)o=a.charCodeAt(n),o===9||32<=o&&o<=1114111||$(t,"expected valid JSON character");else Ix.test(a)&&$(t,"the stream contains non-printable characters");t.result+=a}}function h0(t,e,r,i){var n,s,o,a;for(Ui.isObject(r)||$(t,"cannot merge mappings; the provided source object is unacceptable"),n=Object.keys(r),o=0,a=n.length;o<a;o+=1)s=n[o],Zr.call(e,s)||(e[s]=r[s],i[s]=!0)}function Hn(t,e,r,i,n,s,o,a,l){var c,u;if(Array.isArray(n))for(n=Array.prototype.slice.call(n),c=0,u=n.length;c<u;c+=1)Array.isArray(n[c])&&$(t,"nested arrays are not supported inside keys"),typeof n=="object"&&l0(n[c])==="[object Object]"&&(n[c]="[object Object]");if(typeof n=="object"&&l0(n)==="[object Object]"&&(n="[object Object]"),n=String(n),e===null&&(e={}),i==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(c=0,u=s.length;c<u;c+=1)h0(t,e,s[c],r);else h0(t,e,s,r);else!t.json&&!Zr.call(r,n)&&Zr.call(e,n)&&(t.line=o||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,$(t,"duplicated mapping key")),n==="__proto__"?Object.defineProperty(e,n,{configurable:!0,enumerable:!0,writable:!0,value:s}):e[n]=s,delete r[n];return e}function Nh(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):$(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function be(t,e,r){for(var i=0,n=t.input.charCodeAt(t.position);n!==0;){for(;Bi(n);)n===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),n=t.input.charCodeAt(++t.position);if(e&&n===35)do n=t.input.charCodeAt(++t.position);while(n!==10&&n!==13&&n!==0);if(Zt(n))for(Nh(t),n=t.input.charCodeAt(t.position),i++,t.lineIndent=0;n===32;)t.lineIndent++,n=t.input.charCodeAt(++t.position);else break}return r!==-1&&i!==0&&t.lineIndent<r&&Ka(t,"deficient indentation"),i}function Ja(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||ft(r)))}function xh(t,e){e===1?t.result+=" ":e>1&&(t.result+=Ui.repeat("\n",e-1))}function kx(t,e,r){var i,n,s,o,a,l,c,u,h=t.kind,f=t.result,d;if(d=t.input.charCodeAt(t.position),ft(d)||jn(d)||d===35||d===38||d===42||d===33||d===124||d===62||d===39||d===34||d===37||d===64||d===96||(d===63||d===45)&&(n=t.input.charCodeAt(t.position+1),ft(n)||r&&jn(n)))return!1;for(t.kind="scalar",t.result="",s=o=t.position,a=!1;d!==0;){if(d===58){if(n=t.input.charCodeAt(t.position+1),ft(n)||r&&jn(n))break}else if(d===35){if(i=t.input.charCodeAt(t.position-1),ft(i))break}else{if(t.position===t.lineStart&&Ja(t)||r&&jn(d))break;if(Zt(d))if(l=t.line,c=t.lineStart,u=t.lineIndent,be(t,!1,-1),t.lineIndent>=e){a=!0,d=t.input.charCodeAt(t.position);continue}else{t.position=o,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(Jr(t,s,o,!1),xh(t,t.line-l),s=o=t.position,a=!1),Bi(d)||(o=t.position+1),d=t.input.charCodeAt(++t.position)}return Jr(t,s,o,!1),t.result?!0:(t.kind=h,t.result=f,!1)}function qx(t,e){var r,i,n;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,i=n=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(Jr(t,i,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)i=t.position,t.position++,n=t.position;else return!0;else Zt(r)?(Jr(t,i,n,!0),xh(t,be(t,!1,e)),i=n=t.position):t.position===t.lineStart&&Ja(t)?$(t,"unexpected end of the document within a single quoted scalar"):(t.position++,n=t.position);$(t,"unexpected end of the stream within a single quoted scalar")}function Mx(t,e){var r,i,n,s,o,a;if(a=t.input.charCodeAt(t.position),a!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=i=t.position;(a=t.input.charCodeAt(t.position))!==0;){if(a===34)return Jr(t,r,t.position,!0),t.position++,!0;if(a===92){if(Jr(t,r,t.position,!0),a=t.input.charCodeAt(++t.position),Zt(a))be(t,!1,e);else if(a<256&&w0[a])t.result+=A0[a],t.position++;else if((o=Px(a))>0){for(n=o,s=0;n>0;n--)a=t.input.charCodeAt(++t.position),(o=Dx(a))>=0?s=(s<<4)+o:$(t,"expected hexadecimal character");t.result+=Lx(s),t.position++}else $(t,"unknown escape sequence");r=i=t.position}else Zt(a)?(Jr(t,r,i,!0),xh(t,be(t,!1,e)),r=i=t.position):t.position===t.lineStart&&Ja(t)?$(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}$(t,"unexpected end of the stream within a double quoted scalar")}function Ux(t,e){var r=!0,i,n,s,o=t.tag,a,l=t.anchor,c,u,h,f,d,y=Object.create(null),A,E,v,T;if(T=t.input.charCodeAt(t.position),T===91)u=93,d=!1,a=[];else if(T===123)u=125,d=!0,a={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=a),T=t.input.charCodeAt(++t.position);T!==0;){if(be(t,!0,e),T=t.input.charCodeAt(t.position),T===u)return t.position++,t.tag=o,t.anchor=l,t.kind=d?"mapping":"sequence",t.result=a,!0;r?T===44&&$(t,"expected the node content, but found ','"):$(t,"missed comma between flow collection entries"),E=A=v=null,h=f=!1,T===63&&(c=t.input.charCodeAt(t.position+1),ft(c)&&(h=f=!0,t.position++,be(t,!0,e))),i=t.line,n=t.lineStart,s=t.position,Wn(t,e,Qa,!1,!0),E=t.tag,A=t.result,be(t,!0,e),T=t.input.charCodeAt(t.position),(f||t.line===i)&&T===58&&(h=!0,T=t.input.charCodeAt(++t.position),be(t,!0,e),Wn(t,e,Qa,!1,!0),v=t.result),d?Hn(t,a,y,E,A,v,i,n,s):h?a.push(Hn(t,null,y,E,A,v,i,n,s)):a.push(A),be(t,!0,e),T=t.input.charCodeAt(t.position),T===44?(r=!0,T=t.input.charCodeAt(++t.position)):r=!1}$(t,"unexpected end of the stream within a flow collection")}function Bx(t,e){var r,i,n=Ih,s=!1,o=!1,a=e,l=0,c=!1,u,h;if(h=t.input.charCodeAt(t.position),h===124)i=!1;else if(h===62)i=!0;else return!1;for(t.kind="scalar",t.result="";h!==0;)if(h=t.input.charCodeAt(++t.position),h===43||h===45)Ih===n?n=h===43?a0:Rx:$(t,"repeat of a chomping mode identifier");else if((u=Fx(h))>=0)u===0?$(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?$(t,"repeat of an indentation width identifier"):(a=e+u-1,o=!0);else break;if(Bi(h)){do h=t.input.charCodeAt(++t.position);while(Bi(h));if(h===35)do h=t.input.charCodeAt(++t.position);while(!Zt(h)&&h!==0)}for(;h!==0;){for(Nh(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!o||t.lineIndent<a)&&h===32;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!o&&t.lineIndent>a&&(a=t.lineIndent),Zt(h)){l++;continue}if(t.lineIndent<a){n===a0?t.result+=Ui.repeat("\n",s?1+l:l):n===Ih&&s&&(t.result+="\n");break}for(i?Bi(h)?(c=!0,t.result+=Ui.repeat("\n",s?1+l:l)):c?(c=!1,t.result+=Ui.repeat("\n",l+1)):l===0?s&&(t.result+=" "):t.result+=Ui.repeat("\n",l):t.result+=Ui.repeat("\n",s?1+l:l),s=!0,o=!0,l=0,r=t.position;!Zt(h)&&h!==0;)h=t.input.charCodeAt(++t.position);Jr(t,r,t.position,!1)}return!0}function f0(t,e){var r,i=t.tag,n=t.anchor,s=[],o,a=!1,l;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=s),l=t.input.charCodeAt(t.position);l!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,$(t,"tab characters must not be used in indentation")),!(l!==45||(o=t.input.charCodeAt(t.position+1),!ft(o))));){if(a=!0,t.position++,be(t,!0,-1)&&t.lineIndent<=e){s.push(null),l=t.input.charCodeAt(t.position);continue}if(r=t.line,Wn(t,e,m0,!1,!0),s.push(t.result),be(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&l!==0)$(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return a?(t.tag=i,t.anchor=n,t.kind="sequence",t.result=s,!0):!1}function jx(t,e,r){var i,n,s,o,a,l,c=t.tag,u=t.anchor,h={},f=Object.create(null),d=null,y=null,A=null,E=!1,v=!1,T;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=h),T=t.input.charCodeAt(t.position);T!==0;){if(!E&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,$(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),s=t.line,(T===63||T===58)&&ft(i))T===63?(E&&(Hn(t,h,f,d,y,null,o,a,l),d=y=A=null),v=!0,E=!0,n=!0):E?(E=!1,n=!0):$(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,T=i;else{if(o=t.line,a=t.lineStart,l=t.position,!Wn(t,r,p0,!1,!0))break;if(t.line===s){for(T=t.input.charCodeAt(t.position);Bi(T);)T=t.input.charCodeAt(++t.position);if(T===58)T=t.input.charCodeAt(++t.position),ft(T)||$(t,"a whitespace character is expected after the key-value separator within a block mapping"),E&&(Hn(t,h,f,d,y,null,o,a,l),d=y=A=null),v=!0,E=!1,n=!1,d=t.tag,y=t.result;else if(v)$(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=c,t.anchor=u,!0}else if(v)$(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=c,t.anchor=u,!0}if((t.line===s||t.lineIndent>e)&&(E&&(o=t.line,a=t.lineStart,l=t.position),Wn(t,e,Xa,!0,n)&&(E?y=t.result:A=t.result),E||(Hn(t,h,f,d,y,A,o,a,l),d=y=A=null),be(t,!0,-1),T=t.input.charCodeAt(t.position)),(t.line===s||t.lineIndent>e)&&T!==0)$(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return E&&Hn(t,h,f,d,y,null,o,a,l),v&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=h),v}function Hx(t){var e,r=!1,i=!1,n,s,o;if(o=t.input.charCodeAt(t.position),o!==33)return!1;if(t.tag!==null&&$(t,"duplication of a tag property"),o=t.input.charCodeAt(++t.position),o===60?(r=!0,o=t.input.charCodeAt(++t.position)):o===33?(i=!0,n="!!",o=t.input.charCodeAt(++t.position)):n="!",e=t.position,r){do o=t.input.charCodeAt(++t.position);while(o!==0&&o!==62);t.position<t.length?(s=t.input.slice(e,t.position),o=t.input.charCodeAt(++t.position)):$(t,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!ft(o);)o===33&&(i?$(t,"tag suffix cannot contain exclamation marks"):(n=t.input.slice(e-1,t.position+1),g0.test(n)||$(t,"named tag handle cannot contain such characters"),i=!0,e=t.position+1)),o=t.input.charCodeAt(++t.position);s=t.input.slice(e,t.position),xx.test(s)&&$(t,"tag suffix cannot contain flow indicator characters")}s&&!y0.test(s)&&$(t,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{$(t,"tag name is malformed: "+s)}return r?t.tag=s:Zr.call(t.tagMap,n)?t.tag=t.tagMap[n]+s:n==="!"?t.tag="!"+s:n==="!!"?t.tag="tag:yaml.org,2002:"+s:$(t,'undeclared tag handle "'+n+'"'),!0}function Wx(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&$(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!ft(r)&&!jn(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&$(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function Gx(t){var e,r,i;if(i=t.input.charCodeAt(t.position),i!==42)return!1;for(i=t.input.charCodeAt(++t.position),e=t.position;i!==0&&!ft(i)&&!jn(i);)i=t.input.charCodeAt(++t.position);return t.position===e&&$(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),Zr.call(t.anchorMap,r)||$(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],be(t,!0,-1),!0}function Wn(t,e,r,i,n){var s,o,a,l=1,c=!1,u=!1,h,f,d,y,A,E;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,s=o=a=Xa===r||m0===r,i&&be(t,!0,-1)&&(c=!0,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)),l===1)for(;Hx(t)||Wx(t);)be(t,!0,-1)?(c=!0,a=s,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)):a=!1;if(a&&(a=c||n),(l===1||Xa===r)&&(Qa===r||p0===r?A=e:A=e+1,E=t.position-t.lineStart,l===1?a&&(f0(t,E)||jx(t,E,A))||Ux(t,A)?u=!0:(o&&Bx(t,A)||qx(t,A)||Mx(t,A)?u=!0:Gx(t)?(u=!0,(t.tag!==null||t.anchor!==null)&&$(t,"alias node should not have any properties")):kx(t,A,Qa===r)&&(u=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):l===0&&(u=a&&f0(t,E))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&$(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),h=0,f=t.implicitTypes.length;h<f;h+=1)if(y=t.implicitTypes[h],y.resolve(t.result)){t.result=y.construct(t.result),t.tag=y.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(Zr.call(t.typeMap[t.kind||"fallback"],t.tag))y=t.typeMap[t.kind||"fallback"][t.tag];else for(y=null,d=t.typeMap.multi[t.kind||"fallback"],h=0,f=d.length;h<f;h+=1)if(t.tag.slice(0,d[h].tag.length)===d[h].tag){y=d[h];break}y||$(t,"unknown tag !<"+t.tag+">"),t.result!==null&&y.kind!==t.kind&&$(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+y.kind+'", not "'+t.kind+'"'),y.resolve(t.result,t.tag)?(t.result=y.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):$(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||u}function zx(t){var e=t.position,r,i,n,s=!1,o;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(o=t.input.charCodeAt(t.position))!==0&&(be(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||o!==37));){for(s=!0,o=t.input.charCodeAt(++t.position),r=t.position;o!==0&&!ft(o);)o=t.input.charCodeAt(++t.position);for(i=t.input.slice(r,t.position),n=[],i.length<1&&$(t,"directive name must not be less than one character in length");o!==0;){for(;Bi(o);)o=t.input.charCodeAt(++t.position);if(o===35){do o=t.input.charCodeAt(++t.position);while(o!==0&&!Zt(o));break}if(Zt(o))break;for(r=t.position;o!==0&&!ft(o);)o=t.input.charCodeAt(++t.position);n.push(t.input.slice(r,t.position))}o!==0&&Nh(t),Zr.call(c0,i)?c0[i](t,i,n):Ka(t,'unknown document directive "'+i+'"')}if(be(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,be(t,!0,-1)):s&&$(t,"directives end mark is expected"),Wn(t,t.lineIndent-1,Xa,!1,!0),be(t,!0,-1),t.checkLineBreaks&&Nx.test(t.input.slice(e,t.position))&&Ka(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Ja(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,be(t,!0,-1));return}if(t.position<t.length-1)$(t,"end of the stream or a document separator is expected");else return}function S0(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+="\n"),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new $x(t,e),i=t.indexOf("\0");for(i!==-1&&(r.position=i,$(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)zx(r);return r.documents}function Vx(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var i=S0(t,r);if(typeof e!="function")return i;for(var n=0,s=i.length;n<s;n+=1)e(i[n])}function Yx(t,e){var r=S0(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new d0("expected a single document in the stream, but found more")}}Dh.exports.loadAll=Vx;Dh.exports.load=Yx});var H0=w((jj,j0)=>{"use strict";var tl=Un(),So=Bn(),Qx=Ya(),x0=Object.prototype.toString,D0=Object.prototype.hasOwnProperty,kh=65279,Xx=9,wo=10,Kx=13,Jx=32,Zx=33,eD=34,Ph=35,tD=37,rD=38,iD=39,nD=42,P0=44,sD=45,Za=58,oD=61,aD=62,lD=63,uD=64,F0=91,L0=93,cD=96,$0=123,hD=124,k0=125,He={};He[0]="\\0";He[7]="\\a";He[8]="\\b";He[9]="\\t";He[10]="\\n";He[11]="\\v";He[12]="\\f";He[13]="\\r";He[27]="\\e";He[34]='\\"';He[92]="\\\\";He[133]="\\N";He[160]="\\_";He[8232]="\\L";He[8233]="\\P";var fD=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],dD=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function pD(t,e){var r,i,n,s,o,a,l;if(e===null)return{};for(r={},i=Object.keys(e),n=0,s=i.length;n<s;n+=1)o=i[n],a=String(e[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),l=t.compiledTypeMap.fallback[o],l&&D0.call(l.styleAliases,a)&&(a=l.styleAliases[a]),r[o]=a;return r}function mD(t){var e,r,i;if(e=t.toString(16).toUpperCase(),t<=255)r="x",i=2;else if(t<=65535)r="u",i=4;else if(t<=4294967295)r="U",i=8;else throw new So("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+tl.repeat("0",i-e.length)+e}var gD=1,Ao=2;function yD(t){this.schema=t.schema||Qx,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=tl.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=pD(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?Ao:gD,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function _0(t,e){for(var r=tl.repeat(" ",e),i=0,n=-1,s="",o,a=t.length;i<a;)n=t.indexOf("\n",i),n===-1?(o=t.slice(i),i=a):(o=t.slice(i,n+1),i=n+1),o.length&&o!=="\n"&&(s+=r),s+=o;return s}function Fh(t,e){return"\n"+tl.repeat(" ",t.indent*e)}function wD(t,e){var r,i,n;for(r=0,i=t.implicitTypes.length;r<i;r+=1)if(n=t.implicitTypes[r],n.resolve(e))return!0;return!1}function el(t){return t===Jx||t===Xx}function Eo(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==kh||65536<=t&&t<=1114111}function v0(t){return Eo(t)&&t!==kh&&t!==Kx&&t!==wo}function T0(t,e,r){var i=v0(t),n=i&&!el(t);return(r?i:i&&t!==P0&&t!==F0&&t!==L0&&t!==$0&&t!==k0)&&t!==Ph&&!(e===Za&&!n)||v0(e)&&!el(e)&&t===Ph||e===Za&&n}function AD(t){return Eo(t)&&t!==kh&&!el(t)&&t!==sD&&t!==lD&&t!==Za&&t!==P0&&t!==F0&&t!==L0&&t!==$0&&t!==k0&&t!==Ph&&t!==rD&&t!==nD&&t!==Zx&&t!==hD&&t!==oD&&t!==aD&&t!==iD&&t!==eD&&t!==tD&&t!==uD&&t!==cD}function ED(t){return!el(t)&&t!==Za}function yo(t,e){var r=t.charCodeAt(e),i;return r>=55296&&r<=56319&&e+1<t.length&&(i=t.charCodeAt(e+1),i>=56320&&i<=57343)?(r-55296)*1024+i-56320+65536:r}function q0(t){var e=/^\n* /;return e.test(t)}var M0=1,Lh=2,U0=3,B0=4,Gn=5;function SD(t,e,r,i,n,s,o,a){var l,c=0,u=null,h=!1,f=!1,d=i!==-1,y=-1,A=AD(yo(t,0))&&ED(yo(t,t.length-1));if(e||o)for(l=0;l<t.length;c>=65536?l+=2:l++){if(c=yo(t,l),!Eo(c))return Gn;A=A&&T0(c,u,a),u=c}else{for(l=0;l<t.length;c>=65536?l+=2:l++){if(c=yo(t,l),c===wo)h=!0,d&&(f=f||l-y-1>i&&t[y+1]!==" ",y=l);else if(!Eo(c))return Gn;A=A&&T0(c,u,a),u=c}f=f||d&&l-y-1>i&&t[y+1]!==" "}return!h&&!f?A&&!o&&!n(t)?M0:s===Ao?Gn:Lh:r>9&&q0(t)?Gn:o?s===Ao?Gn:Lh:f?B0:U0}function bD(t,e,r,i,n){t.dump=function(){if(e.length===0)return t.quotingType===Ao?'""':"''";if(!t.noCompatMode&&(fD.indexOf(e)!==-1||dD.test(e)))return t.quotingType===Ao?'"'+e+'"':"'"+e+"'";var s=t.indent*Math.max(1,r),o=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-s),a=i||t.flowLevel>-1&&r>=t.flowLevel;function l(c){return wD(t,c)}switch(SD(e,a,t.indent,o,l,t.quotingType,t.forceQuotes&&!i,n)){case M0:return e;case Lh:return"'"+e.replace(/'/g,"''")+"'";case U0:return"|"+O0(e,t.indent)+C0(_0(e,s));case B0:return">"+O0(e,t.indent)+C0(_0(_D(e,o),s));case Gn:return'"'+vD(e,o)+'"';default:throw new So("impossible error: invalid scalar style")}}()}function O0(t,e){var r=q0(t)?String(e):"",i=t[t.length-1]==="\n",n=i&&(t[t.length-2]==="\n"||t==="\n"),s=n?"+":i?"":"-";return r+s+"\n"}function C0(t){return t[t.length-1]==="\n"?t.slice(0,-1):t}function _D(t,e){for(var r=/(\n+)([^\n]*)/g,i=function(){var c=t.indexOf("\n");return c=c!==-1?c:t.length,r.lastIndex=c,R0(t.slice(0,c),e)}(),n=t[0]==="\n"||t[0]===" ",s,o;o=r.exec(t);){var a=o[1],l=o[2];s=l[0]===" ",i+=a+(!n&&!s&&l!==""?"\n":"")+R0(l,e),n=s}return i}function R0(t,e){if(t===""||t[0]===" ")return t;for(var r=/ [^ ]/g,i,n=0,s,o=0,a=0,l="";i=r.exec(t);)a=i.index,a-n>e&&(s=o>n?o:a,l+="\n"+t.slice(n,s),n=s+1),o=a;return l+="\n",t.length-n>e&&o>n?l+=t.slice(n,o)+"\n"+t.slice(o+1):l+=t.slice(n),l.slice(1)}function vD(t){for(var e="",r=0,i,n=0;n<t.length;r>=65536?n+=2:n++)r=yo(t,n),i=He[r],!i&&Eo(r)?(e+=t[n],r>=65536&&(e+=t[n+1])):e+=i||mD(r);return e}function TD(t,e,r){var i="",n=t.tag,s,o,a;for(s=0,o=r.length;s<o;s+=1)a=r[s],t.replacer&&(a=t.replacer.call(r,String(s),a)),(yr(t,e,a,!1,!1)||typeof a>"u"&&yr(t,e,null,!1,!1))&&(i!==""&&(i+=","+(t.condenseFlow?"":" ")),i+=t.dump);t.tag=n,t.dump="["+i+"]"}function I0(t,e,r,i){var n="",s=t.tag,o,a,l;for(o=0,a=r.length;o<a;o+=1)l=r[o],t.replacer&&(l=t.replacer.call(r,String(o),l)),(yr(t,e+1,l,!0,!0,!1,!0)||typeof l>"u"&&yr(t,e+1,null,!0,!0,!1,!0))&&((!i||n!=="")&&(n+=Fh(t,e)),t.dump&&wo===t.dump.charCodeAt(0)?n+="-":n+="- ",n+=t.dump);t.tag=s,t.dump=n||"[]"}function OD(t,e,r){var i="",n=t.tag,s=Object.keys(r),o,a,l,c,u;for(o=0,a=s.length;o<a;o+=1)u="",i!==""&&(u+=", "),t.condenseFlow&&(u+='"'),l=s[o],c=r[l],t.replacer&&(c=t.replacer.call(r,l,c)),yr(t,e,l,!1,!1)&&(t.dump.length>1024&&(u+="? "),u+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),yr(t,e,c,!1,!1)&&(u+=t.dump,i+=u));t.tag=n,t.dump="{"+i+"}"}function CD(t,e,r,i){var n="",s=t.tag,o=Object.keys(r),a,l,c,u,h,f;if(t.sortKeys===!0)o.sort();else if(typeof t.sortKeys=="function")o.sort(t.sortKeys);else if(t.sortKeys)throw new So("sortKeys must be a boolean or a function");for(a=0,l=o.length;a<l;a+=1)f="",(!i||n!=="")&&(f+=Fh(t,e)),c=o[a],u=r[c],t.replacer&&(u=t.replacer.call(r,c,u)),yr(t,e+1,c,!0,!0,!0)&&(h=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,h&&(t.dump&&wo===t.dump.charCodeAt(0)?f+="?":f+="? "),f+=t.dump,h&&(f+=Fh(t,e)),yr(t,e+1,u,!0,h)&&(t.dump&&wo===t.dump.charCodeAt(0)?f+=":":f+=": ",f+=t.dump,n+=f));t.tag=s,t.dump=n||"{}"}function N0(t,e,r){var i,n,s,o,a,l;for(n=r?t.explicitTypes:t.implicitTypes,s=0,o=n.length;s<o;s+=1)if(a=n[s],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof e=="object"&&e instanceof a.instanceOf)&&(!a.predicate||a.predicate(e))){if(r?a.multi&&a.representName?t.tag=a.representName(e):t.tag=a.tag:t.tag="?",a.represent){if(l=t.styleMap[a.tag]||a.defaultStyle,x0.call(a.represent)==="[object Function]")i=a.represent(e,l);else if(D0.call(a.represent,l))i=a.represent[l](e,l);else throw new So("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');t.dump=i}return!0}return!1}function yr(t,e,r,i,n,s,o){t.tag=null,t.dump=r,N0(t,r,!1)||N0(t,r,!0);var a=x0.call(t.dump),l=i,c;i&&(i=t.flowLevel<0||t.flowLevel>e);var u=a==="[object Object]"||a==="[object Array]",h,f;if(u&&(h=t.duplicates.indexOf(r),f=h!==-1),(t.tag!==null&&t.tag!=="?"||f||t.indent!==2&&e>0)&&(n=!1),f&&t.usedDuplicates[h])t.dump="*ref_"+h;else{if(u&&f&&!t.usedDuplicates[h]&&(t.usedDuplicates[h]=!0),a==="[object Object]")i&&Object.keys(t.dump).length!==0?(CD(t,e,t.dump,n),f&&(t.dump="&ref_"+h+t.dump)):(OD(t,e,t.dump),f&&(t.dump="&ref_"+h+" "+t.dump));else if(a==="[object Array]")i&&t.dump.length!==0?(t.noArrayIndent&&!o&&e>0?I0(t,e-1,t.dump,n):I0(t,e,t.dump,n),f&&(t.dump="&ref_"+h+t.dump)):(TD(t,e,t.dump),f&&(t.dump="&ref_"+h+" "+t.dump));else if(a==="[object String]")t.tag!=="?"&&bD(t,t.dump,e,s,l);else{if(a==="[object Undefined]")return!1;if(t.skipInvalid)return!1;throw new So("unacceptable kind of an object to dump "+a)}t.tag!==null&&t.tag!=="?"&&(c=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",t.dump=c+" "+t.dump)}return!0}function RD(t,e){var r=[],i=[],n,s;for($h(t,r,i),n=0,s=i.length;n<s;n+=1)e.duplicates.push(r[i[n]]);e.usedDuplicates=new Array(s)}function $h(t,e,r){var i,n,s;if(t!==null&&typeof t=="object")if(n=e.indexOf(t),n!==-1)r.indexOf(n)===-1&&r.push(n);else if(e.push(t),Array.isArray(t))for(n=0,s=t.length;n<s;n+=1)$h(t[n],e,r);else for(i=Object.keys(t),n=0,s=i.length;n<s;n+=1)$h(t[i[n]],e,r)}function ID(t,e){e=e||{};var r=new yD(e);r.noRefs||RD(t,r);var i=t;return r.replacer&&(i=r.replacer.call({"":i},"",i)),yr(r,0,i,!0,!0)?r.dump+"\n":""}j0.exports.dump=ID});var rl=w((Hj,Ze)=>{"use strict";var W0=b0(),ND=H0();function qh(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}Ze.exports.Type=je();Ze.exports.Schema=hh();Ze.exports.FAILSAFE_SCHEMA=mh();Ze.exports.JSON_SCHEMA=Eh();Ze.exports.CORE_SCHEMA=Sh();Ze.exports.DEFAULT_SCHEMA=Ya();Ze.exports.load=W0.load;Ze.exports.loadAll=W0.loadAll;Ze.exports.dump=ND.dump;Ze.exports.YAMLException=Bn();Ze.exports.types={binary:Th(),float:Ah(),map:ph(),null:gh(),pairs:Ch(),set:Rh(),timestamp:bh(),bool:yh(),int:wh(),merge:_h(),omap:Oh(),seq:dh(),str:fh()};Ze.exports.safeLoad=qh("safeLoad","load");Ze.exports.safeLoadAll=qh("safeLoadAll","loadAll");Ze.exports.safeDump=qh("safeDump","dump")});var G0=w(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});il.Lazy=void 0;var Mh=class{constructor(e){this._value=null,this.creator=e}get hasValue(){return this.creator==null}get value(){if(this.creator==null)return this._value;let e=this.creator();return this.value=e,e}set value(e){this._value=e,this.creator=null}};il.Lazy=Mh});var bo=w((Gj,z0)=>{"use strict";var xD="2.0.0",DD=Number.MAX_SAFE_INTEGER||9007199254740991,PD=16,FD=250,LD=["major","premajor","minor","preminor","patch","prepatch","prerelease"];z0.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:PD,MAX_SAFE_BUILD_LENGTH:FD,MAX_SAFE_INTEGER:DD,RELEASE_TYPES:LD,SEMVER_SPEC_VERSION:xD,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var _o=w((zj,V0)=>{"use strict";var $D=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};V0.exports=$D});var zn=w((er,Y0)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Uh,MAX_SAFE_BUILD_LENGTH:kD,MAX_LENGTH:qD}=bo(),MD=_o();er=Y0.exports={};var UD=er.re=[],BD=er.safeRe=[],N=er.src=[],jD=er.safeSrc=[],x=er.t={},HD=0,Bh="[a-zA-Z0-9-]",WD=[["\\s",1],["\\d",qD],[Bh,kD]],GD=t=>{for(let[e,r]of WD)t=t.split("".concat(e,"*")).join("".concat(e,"{0,").concat(r,"}")).split("".concat(e,"+")).join("".concat(e,"{1,").concat(r,"}"));return t},H=(t,e,r)=>{let i=GD(e),n=HD++;MD(t,n,e),x[t]=n,N[n]=e,jD[n]=i,UD[n]=new RegExp(e,r?"g":void 0),BD[n]=new RegExp(i,r?"g":void 0)};H("NUMERICIDENTIFIER","0|[1-9]\\d*");H("NUMERICIDENTIFIERLOOSE","\\d+");H("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(Bh,"*"));H("MAINVERSION","(".concat(N[x.NUMERICIDENTIFIER],")\\.")+"(".concat(N[x.NUMERICIDENTIFIER],")\\.")+"(".concat(N[x.NUMERICIDENTIFIER],")"));H("MAINVERSIONLOOSE","(".concat(N[x.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(N[x.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(N[x.NUMERICIDENTIFIERLOOSE],")"));H("PRERELEASEIDENTIFIER","(?:".concat(N[x.NONNUMERICIDENTIFIER],"|").concat(N[x.NUMERICIDENTIFIER],")"));H("PRERELEASEIDENTIFIERLOOSE","(?:".concat(N[x.NONNUMERICIDENTIFIER],"|").concat(N[x.NUMERICIDENTIFIERLOOSE],")"));H("PRERELEASE","(?:-(".concat(N[x.PRERELEASEIDENTIFIER],"(?:\\.").concat(N[x.PRERELEASEIDENTIFIER],")*))"));H("PRERELEASELOOSE","(?:-?(".concat(N[x.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(N[x.PRERELEASEIDENTIFIERLOOSE],")*))"));H("BUILDIDENTIFIER","".concat(Bh,"+"));H("BUILD","(?:\\+(".concat(N[x.BUILDIDENTIFIER],"(?:\\.").concat(N[x.BUILDIDENTIFIER],")*))"));H("FULLPLAIN","v?".concat(N[x.MAINVERSION]).concat(N[x.PRERELEASE],"?").concat(N[x.BUILD],"?"));H("FULL","^".concat(N[x.FULLPLAIN],"$"));H("LOOSEPLAIN","[v=\\s]*".concat(N[x.MAINVERSIONLOOSE]).concat(N[x.PRERELEASELOOSE],"?").concat(N[x.BUILD],"?"));H("LOOSE","^".concat(N[x.LOOSEPLAIN],"$"));H("GTLT","((?:<|>)?=?)");H("XRANGEIDENTIFIERLOOSE","".concat(N[x.NUMERICIDENTIFIERLOOSE],"|x|X|\\*"));H("XRANGEIDENTIFIER","".concat(N[x.NUMERICIDENTIFIER],"|x|X|\\*"));H("XRANGEPLAIN","[v=\\s]*(".concat(N[x.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(N[x.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(N[x.XRANGEIDENTIFIER],")")+"(?:".concat(N[x.PRERELEASE],")?").concat(N[x.BUILD],"?")+")?)?");H("XRANGEPLAINLOOSE","[v=\\s]*(".concat(N[x.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(N[x.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(N[x.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(N[x.PRERELEASELOOSE],")?").concat(N[x.BUILD],"?")+")?)?");H("XRANGE","^".concat(N[x.GTLT],"\\s*").concat(N[x.XRANGEPLAIN],"$"));H("XRANGELOOSE","^".concat(N[x.GTLT],"\\s*").concat(N[x.XRANGEPLAINLOOSE],"$"));H("COERCEPLAIN","(^|[^\\d])(\\d{1,".concat(Uh,"})")+"(?:\\.(\\d{1,".concat(Uh,"}))?")+"(?:\\.(\\d{1,".concat(Uh,"}))?"));H("COERCE","".concat(N[x.COERCEPLAIN],"(?:$|[^\\d])"));H("COERCEFULL",N[x.COERCEPLAIN]+"(?:".concat(N[x.PRERELEASE],")?")+"(?:".concat(N[x.BUILD],")?")+"(?:$|[^\\d])");H("COERCERTL",N[x.COERCE],!0);H("COERCERTLFULL",N[x.COERCEFULL],!0);H("LONETILDE","(?:~>?)");H("TILDETRIM","(\\s*)".concat(N[x.LONETILDE],"\\s+"),!0);er.tildeTrimReplace="$1~";H("TILDE","^".concat(N[x.LONETILDE]).concat(N[x.XRANGEPLAIN],"$"));H("TILDELOOSE","^".concat(N[x.LONETILDE]).concat(N[x.XRANGEPLAINLOOSE],"$"));H("LONECARET","(?:\\^)");H("CARETTRIM","(\\s*)".concat(N[x.LONECARET],"\\s+"),!0);er.caretTrimReplace="$1^";H("CARET","^".concat(N[x.LONECARET]).concat(N[x.XRANGEPLAIN],"$"));H("CARETLOOSE","^".concat(N[x.LONECARET]).concat(N[x.XRANGEPLAINLOOSE],"$"));H("COMPARATORLOOSE","^".concat(N[x.GTLT],"\\s*(").concat(N[x.LOOSEPLAIN],")$|^$"));H("COMPARATOR","^".concat(N[x.GTLT],"\\s*(").concat(N[x.FULLPLAIN],")$|^$"));H("COMPARATORTRIM","(\\s*)".concat(N[x.GTLT],"\\s*(").concat(N[x.LOOSEPLAIN],"|").concat(N[x.XRANGEPLAIN],")"),!0);er.comparatorTrimReplace="$1$2$3";H("HYPHENRANGE","^\\s*(".concat(N[x.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(N[x.XRANGEPLAIN],")")+"\\s*$");H("HYPHENRANGELOOSE","^\\s*(".concat(N[x.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(N[x.XRANGEPLAINLOOSE],")")+"\\s*$");H("STAR","(<|>)?=?\\s*\\*");H("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");H("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var nl=w((Vj,Q0)=>{"use strict";var zD=Object.freeze({loose:!0}),VD=Object.freeze({}),YD=t=>t?typeof t!="object"?zD:t:VD;Q0.exports=YD});var jh=w((Yj,J0)=>{"use strict";var X0=/^[0-9]+$/,K0=(t,e)=>{let r=X0.test(t),i=X0.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1},QD=(t,e)=>K0(e,t);J0.exports={compareIdentifiers:K0,rcompareIdentifiers:QD}});var We=w((Qj,eA)=>{"use strict";var sl=_o(),{MAX_LENGTH:Z0,MAX_SAFE_INTEGER:ol}=bo(),{safeRe:al,t:ll}=zn(),XD=nl(),{compareIdentifiers:Vn}=jh(),Hh=class t{constructor(e,r){if(r=XD(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof e,'".'));if(e.length>Z0)throw new TypeError("version is longer than ".concat(Z0," characters"));sl("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let i=e.trim().match(r.loose?al[ll.LOOSE]:al[ll.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>ol||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ol||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ol||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let s=+n;if(s>=0&&s<ol)return s}return n}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(e){if(sl("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),Vn(this.major,e.major)||Vn(this.minor,e.minor)||Vn(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let i=this.prerelease[r],n=e.prerelease[r];if(sl("prerelease compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return Vn(i,n)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let i=this.build[r],n=e.build[r];if(sl("build compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return Vn(i,n)}while(++r)}inc(e,r,i){if(e.startsWith("pre")){if(!r&&i===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n="-".concat(r).match(this.options.loose?al[ll.PRERELEASELOOSE]:al[ll.PRERELEASE]);if(!n||n[1]!==r)throw new Error("invalid identifier: ".concat(r))}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,i),this.inc("pre",r,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,i),this.inc("pre",r,i);break;case"release":if(this.prerelease.length===0)throw new Error("version ".concat(this.raw," is not a prerelease"));this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(i)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&i===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let s=[r,n];i===!1&&(s=[r]),Vn(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error("invalid increment argument: ".concat(e))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}};eA.exports=Hh});var ji=w((Xj,rA)=>{"use strict";var tA=We(),KD=(t,e,r=!1)=>{if(t instanceof tA)return t;try{return new tA(t,e)}catch(i){if(!r)return null;throw i}};rA.exports=KD});var nA=w((Kj,iA)=>{"use strict";var JD=ji(),ZD=(t,e)=>{let r=JD(t,e);return r?r.version:null};iA.exports=ZD});var oA=w((Jj,sA)=>{"use strict";var e1=ji(),t1=(t,e)=>{let r=e1(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};sA.exports=t1});var uA=w((Zj,lA)=>{"use strict";var aA=We(),r1=(t,e,r,i,n)=>{typeof r=="string"&&(n=i,i=r,r=void 0);try{return new aA(t instanceof aA?t.version:t,r).inc(e,i,n).version}catch{return null}};lA.exports=r1});var fA=w((eH,hA)=>{"use strict";var cA=ji(),i1=(t,e)=>{let r=cA(t,null,!0),i=cA(e,null,!0),n=r.compare(i);if(n===0)return null;let s=n>0,o=s?r:i,a=s?i:r,l=!!o.prerelease.length;if(!!a.prerelease.length&&!l){if(!a.patch&&!a.minor)return"major";if(a.compareMain(o)===0)return a.minor&&!a.patch?"minor":"patch"}let u=l?"pre":"";return r.major!==i.major?u+"major":r.minor!==i.minor?u+"minor":r.patch!==i.patch?u+"patch":"prerelease"};hA.exports=i1});var pA=w((tH,dA)=>{"use strict";var n1=We(),s1=(t,e)=>new n1(t,e).major;dA.exports=s1});var gA=w((rH,mA)=>{"use strict";var o1=We(),a1=(t,e)=>new o1(t,e).minor;mA.exports=a1});var wA=w((iH,yA)=>{"use strict";var l1=We(),u1=(t,e)=>new l1(t,e).patch;yA.exports=u1});var EA=w((nH,AA)=>{"use strict";var c1=ji(),h1=(t,e)=>{let r=c1(t,e);return r&&r.prerelease.length?r.prerelease:null};AA.exports=h1});var Nt=w((sH,bA)=>{"use strict";var SA=We(),f1=(t,e,r)=>new SA(t,r).compare(new SA(e,r));bA.exports=f1});var vA=w((oH,_A)=>{"use strict";var d1=Nt(),p1=(t,e,r)=>d1(e,t,r);_A.exports=p1});var OA=w((aH,TA)=>{"use strict";var m1=Nt(),g1=(t,e)=>m1(t,e,!0);TA.exports=g1});var ul=w((lH,RA)=>{"use strict";var CA=We(),y1=(t,e,r)=>{let i=new CA(t,r),n=new CA(e,r);return i.compare(n)||i.compareBuild(n)};RA.exports=y1});var NA=w((uH,IA)=>{"use strict";var w1=ul(),A1=(t,e)=>t.sort((r,i)=>w1(r,i,e));IA.exports=A1});var DA=w((cH,xA)=>{"use strict";var E1=ul(),S1=(t,e)=>t.sort((r,i)=>E1(i,r,e));xA.exports=S1});var vo=w((hH,PA)=>{"use strict";var b1=Nt(),_1=(t,e,r)=>b1(t,e,r)>0;PA.exports=_1});var cl=w((fH,FA)=>{"use strict";var v1=Nt(),T1=(t,e,r)=>v1(t,e,r)<0;FA.exports=T1});var Wh=w((dH,LA)=>{"use strict";var O1=Nt(),C1=(t,e,r)=>O1(t,e,r)===0;LA.exports=C1});var Gh=w((pH,$A)=>{"use strict";var R1=Nt(),I1=(t,e,r)=>R1(t,e,r)!==0;$A.exports=I1});var hl=w((mH,kA)=>{"use strict";var N1=Nt(),x1=(t,e,r)=>N1(t,e,r)>=0;kA.exports=x1});var fl=w((gH,qA)=>{"use strict";var D1=Nt(),P1=(t,e,r)=>D1(t,e,r)<=0;qA.exports=P1});var zh=w((yH,MA)=>{"use strict";var F1=Wh(),L1=Gh(),$1=vo(),k1=hl(),q1=cl(),M1=fl(),U1=(t,e,r,i)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return F1(t,r,i);case"!=":return L1(t,r,i);case">":return $1(t,r,i);case">=":return k1(t,r,i);case"<":return q1(t,r,i);case"<=":return M1(t,r,i);default:throw new TypeError("Invalid operator: ".concat(e))}};MA.exports=U1});var BA=w((wH,UA)=>{"use strict";var B1=We(),j1=ji(),{safeRe:dl,t:pl}=zn(),H1=(t,e)=>{if(t instanceof B1)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?dl[pl.COERCEFULL]:dl[pl.COERCE]);else{let l=e.includePrerelease?dl[pl.COERCERTLFULL]:dl[pl.COERCERTL],c;for(;(c=l.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||c.index+c[0].length!==r.index+r[0].length)&&(r=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(r===null)return null;let i=r[2],n=r[3]||"0",s=r[4]||"0",o=e.includePrerelease&&r[5]?"-".concat(r[5]):"",a=e.includePrerelease&&r[6]?"+".concat(r[6]):"";return j1("".concat(i,".").concat(n,".").concat(s).concat(o).concat(a),e)};UA.exports=H1});var HA=w((AH,jA)=>{"use strict";var Vh=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};jA.exports=Vh});var xt=w((EH,VA)=>{"use strict";var W1=/\s+/g,Yh=class t{constructor(e,r){if(r=z1(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Qh)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(W1," "),this.set=this.raw.split("||").map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){let i=this.set[0];if(this.set=this.set.filter(n=>!GA(n[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&Z1(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let i=0;i<r.length;i++)i>0&&(this.formatted+=" "),this.formatted+=r[i].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let i=((this.options.includePrerelease&&K1)|(this.options.loose&&J1))+":"+e,n=WA.get(i);if(n)return n;let s=this.options.loose,o=s?dt[et.HYPHENRANGELOOSE]:dt[et.HYPHENRANGE];e=e.replace(o,uP(this.options.includePrerelease)),ce("hyphen replace",e),e=e.replace(dt[et.COMPARATORTRIM],Y1),ce("comparator trim",e),e=e.replace(dt[et.TILDETRIM],Q1),ce("tilde trim",e),e=e.replace(dt[et.CARETTRIM],X1),ce("caret trim",e);let a=e.split(" ").map(h=>eP(h,this.options)).join(" ").split(/\s+/).map(h=>lP(h,this.options));s&&(a=a.filter(h=>(ce("loose invalid filter",h,this.options),!!h.match(dt[et.COMPARATORLOOSE])))),ce("range list",a);let l=new Map,c=a.map(h=>new Qh(h,this.options));for(let h of c){if(GA(h))return[h];l.set(h.value,h)}l.size>1&&l.has("")&&l.delete("");let u=[...l.values()];return WA.set(i,u),u}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(i=>zA(i,r)&&e.set.some(n=>zA(n,r)&&i.every(s=>n.every(o=>s.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new V1(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(cP(this.set[r],e,this.options))return!0;return!1}};VA.exports=Yh;var G1=HA(),WA=new G1,z1=nl(),Qh=To(),ce=_o(),V1=We(),{safeRe:dt,t:et,comparatorTrimReplace:Y1,tildeTrimReplace:Q1,caretTrimReplace:X1}=zn(),{FLAG_INCLUDE_PRERELEASE:K1,FLAG_LOOSE:J1}=bo(),GA=t=>t.value==="<0.0.0-0",Z1=t=>t.value==="",zA=(t,e)=>{let r=!0,i=t.slice(),n=i.pop();for(;r&&i.length;)r=i.every(s=>n.intersects(s,e)),n=i.pop();return r},eP=(t,e)=>(ce("comp",t,e),t=iP(t,e),ce("caret",t),t=tP(t,e),ce("tildes",t),t=sP(t,e),ce("xrange",t),t=aP(t,e),ce("stars",t),t),tt=t=>!t||t.toLowerCase()==="x"||t==="*",tP=(t,e)=>t.trim().split(/\s+/).map(r=>rP(r,e)).join(" "),rP=(t,e)=>{let r=e.loose?dt[et.TILDELOOSE]:dt[et.TILDE];return t.replace(r,(i,n,s,o,a)=>{ce("tilde",t,i,n,s,o,a);let l;return tt(n)?l="":tt(s)?l=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):tt(o)?l=">=".concat(n,".").concat(s,".0 <").concat(n,".").concat(+s+1,".0-0"):a?(ce("replaceTilde pr",a),l=">=".concat(n,".").concat(s,".").concat(o,"-").concat(a," <").concat(n,".").concat(+s+1,".0-0")):l=">=".concat(n,".").concat(s,".").concat(o," <").concat(n,".").concat(+s+1,".0-0"),ce("tilde return",l),l})},iP=(t,e)=>t.trim().split(/\s+/).map(r=>nP(r,e)).join(" "),nP=(t,e)=>{ce("caret",t,e);let r=e.loose?dt[et.CARETLOOSE]:dt[et.CARET],i=e.includePrerelease?"-0":"";return t.replace(r,(n,s,o,a,l)=>{ce("caret",t,n,s,o,a,l);let c;return tt(s)?c="":tt(o)?c=">=".concat(s,".0.0").concat(i," <").concat(+s+1,".0.0-0"):tt(a)?s==="0"?c=">=".concat(s,".").concat(o,".0").concat(i," <").concat(s,".").concat(+o+1,".0-0"):c=">=".concat(s,".").concat(o,".0").concat(i," <").concat(+s+1,".0.0-0"):l?(ce("replaceCaret pr",l),s==="0"?o==="0"?c=">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):c=">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(+o+1,".0-0"):c=">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(+s+1,".0.0-0")):(ce("no pr"),s==="0"?o==="0"?c=">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):c=">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(+o+1,".0-0"):c=">=".concat(s,".").concat(o,".").concat(a," <").concat(+s+1,".0.0-0")),ce("caret return",c),c})},sP=(t,e)=>(ce("replaceXRanges",t,e),t.split(/\s+/).map(r=>oP(r,e)).join(" ")),oP=(t,e)=>{t=t.trim();let r=e.loose?dt[et.XRANGELOOSE]:dt[et.XRANGE];return t.replace(r,(i,n,s,o,a,l)=>{ce("xRange",t,i,n,s,o,a,l);let c=tt(s),u=c||tt(o),h=u||tt(a),f=h;return n==="="&&f&&(n=""),l=e.includePrerelease?"-0":"",c?n===">"||n==="<"?i="<0.0.0-0":i="*":n&&f?(u&&(o=0),a=0,n===">"?(n=">=",u?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):n==="<="&&(n="<",u?s=+s+1:o=+o+1),n==="<"&&(l="-0"),i="".concat(n+s,".").concat(o,".").concat(a).concat(l)):u?i=">=".concat(s,".0.0").concat(l," <").concat(+s+1,".0.0-0"):h&&(i=">=".concat(s,".").concat(o,".0").concat(l," <").concat(s,".").concat(+o+1,".0-0")),ce("xRange return",i),i})},aP=(t,e)=>(ce("replaceStars",t,e),t.trim().replace(dt[et.STAR],"")),lP=(t,e)=>(ce("replaceGTE0",t,e),t.trim().replace(dt[e.includePrerelease?et.GTE0PRE:et.GTE0],"")),uP=t=>(e,r,i,n,s,o,a,l,c,u,h,f)=>(tt(i)?r="":tt(n)?r=">=".concat(i,".0.0").concat(t?"-0":""):tt(s)?r=">=".concat(i,".").concat(n,".0").concat(t?"-0":""):o?r=">=".concat(r):r=">=".concat(r).concat(t?"-0":""),tt(c)?l="":tt(u)?l="<".concat(+c+1,".0.0-0"):tt(h)?l="<".concat(c,".").concat(+u+1,".0-0"):f?l="<=".concat(c,".").concat(u,".").concat(h,"-").concat(f):t?l="<".concat(c,".").concat(u,".").concat(+h+1,"-0"):l="<=".concat(l),"".concat(r," ").concat(l).trim()),cP=(t,e,r)=>{for(let i=0;i<t.length;i++)if(!t[i].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let i=0;i<t.length;i++)if(ce(t[i].semver),t[i].semver!==Qh.ANY&&t[i].semver.prerelease.length>0){let n=t[i].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var To=w((SH,ZA)=>{"use strict";var Oo=Symbol("SemVer ANY"),Jh=class t{static get ANY(){return Oo}constructor(e,r){if(r=YA(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Kh("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Oo?this.value="":this.value=this.operator+this.semver.version,Kh("comp",this)}parse(e){let r=this.options.loose?QA[XA.COMPARATORLOOSE]:QA[XA.COMPARATOR],i=e.match(r);if(!i)throw new TypeError("Invalid comparator: ".concat(e));this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new KA(i[2],this.options.loose):this.semver=Oo}toString(){return this.value}test(e){if(Kh("Comparator.test",e,this.options.loose),this.semver===Oo||e===Oo)return!0;if(typeof e=="string")try{e=new KA(e,this.options)}catch{return!1}return Xh(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new JA(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new JA(this.value,r).test(e.semver):(r=YA(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Xh(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Xh(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};ZA.exports=Jh;var YA=nl(),{safeRe:QA,t:XA}=zn(),Xh=zh(),Kh=_o(),KA=We(),JA=xt()});var Co=w((bH,eE)=>{"use strict";var hP=xt(),fP=(t,e,r)=>{try{e=new hP(e,r)}catch{return!1}return e.test(t)};eE.exports=fP});var rE=w((_H,tE)=>{"use strict";var dP=xt(),pP=(t,e)=>new dP(t,e).set.map(r=>r.map(i=>i.value).join(" ").trim().split(" "));tE.exports=pP});var nE=w((vH,iE)=>{"use strict";var mP=We(),gP=xt(),yP=(t,e,r)=>{let i=null,n=null,s=null;try{s=new gP(e,r)}catch{return null}return t.forEach(o=>{s.test(o)&&(!i||n.compare(o)===-1)&&(i=o,n=new mP(i,r))}),i};iE.exports=yP});var oE=w((TH,sE)=>{"use strict";var wP=We(),AP=xt(),EP=(t,e,r)=>{let i=null,n=null,s=null;try{s=new AP(e,r)}catch{return null}return t.forEach(o=>{s.test(o)&&(!i||n.compare(o)===1)&&(i=o,n=new wP(i,r))}),i};sE.exports=EP});var uE=w((OH,lE)=>{"use strict";var Zh=We(),SP=xt(),aE=vo(),bP=(t,e)=>{t=new SP(t,e);let r=new Zh("0.0.0");if(t.test(r)||(r=new Zh("0.0.0-0"),t.test(r)))return r;r=null;for(let i=0;i<t.set.length;++i){let n=t.set[i],s=null;n.forEach(o=>{let a=new Zh(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||aE(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(o.operator))}}),s&&(!r||aE(r,s))&&(r=s)}return r&&t.test(r)?r:null};lE.exports=bP});var hE=w((CH,cE)=>{"use strict";var _P=xt(),vP=(t,e)=>{try{return new _P(t,e).range||"*"}catch{return null}};cE.exports=vP});var ml=w((RH,mE)=>{"use strict";var TP=We(),pE=To(),{ANY:OP}=pE,CP=xt(),RP=Co(),fE=vo(),dE=cl(),IP=fl(),NP=hl(),xP=(t,e,r,i)=>{t=new TP(t,i),e=new CP(e,i);let n,s,o,a,l;switch(r){case">":n=fE,s=IP,o=dE,a=">",l=">=";break;case"<":n=dE,s=NP,o=fE,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(RP(t,e,i))return!1;for(let c=0;c<e.set.length;++c){let u=e.set[c],h=null,f=null;if(u.forEach(d=>{d.semver===OP&&(d=new pE(">=0.0.0")),h=h||d,f=f||d,n(d.semver,h.semver,i)?h=d:o(d.semver,f.semver,i)&&(f=d)}),h.operator===a||h.operator===l||(!f.operator||f.operator===a)&&s(t,f.semver))return!1;if(f.operator===l&&o(t,f.semver))return!1}return!0};mE.exports=xP});var yE=w((IH,gE)=>{"use strict";var DP=ml(),PP=(t,e,r)=>DP(t,e,">",r);gE.exports=PP});var AE=w((NH,wE)=>{"use strict";var FP=ml(),LP=(t,e,r)=>FP(t,e,"<",r);wE.exports=LP});var bE=w((xH,SE)=>{"use strict";var EE=xt(),$P=(t,e,r)=>(t=new EE(t,r),e=new EE(e,r),t.intersects(e,r));SE.exports=$P});var vE=w((DH,_E)=>{"use strict";var kP=Co(),qP=Nt();_E.exports=(t,e,r)=>{let i=[],n=null,s=null,o=t.sort((u,h)=>qP(u,h,r));for(let u of o)kP(u,e,r)?(s=u,n||(n=u)):(s&&i.push([n,s]),s=null,n=null);n&&i.push([n,null]);let a=[];for(let[u,h]of i)u===h?a.push(u):!h&&u===o[0]?a.push("*"):h?u===o[0]?a.push("<=".concat(h)):a.push("".concat(u," - ").concat(h)):a.push(">=".concat(u));let l=a.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return l.length<c.length?l:e}});var NE=w((PH,IE)=>{"use strict";var TE=xt(),tf=To(),{ANY:ef}=tf,Ro=Co(),rf=Nt(),MP=(t,e,r={})=>{if(t===e)return!0;t=new TE(t,r),e=new TE(e,r);let i=!1;e:for(let n of t.set){for(let s of e.set){let o=BP(n,s,r);if(i=i||o!==null,o)continue e}if(i)return!1}return!0},UP=[new tf(">=0.0.0-0")],OE=[new tf(">=0.0.0")],BP=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===ef){if(e.length===1&&e[0].semver===ef)return!0;r.includePrerelease?t=UP:t=OE}if(e.length===1&&e[0].semver===ef){if(r.includePrerelease)return!0;e=OE}let i=new Set,n,s;for(let d of t)d.operator===">"||d.operator===">="?n=CE(n,d,r):d.operator==="<"||d.operator==="<="?s=RE(s,d,r):i.add(d.semver);if(i.size>1)return null;let o;if(n&&s){if(o=rf(n.semver,s.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||s.operator!=="<="))return null}for(let d of i){if(n&&!Ro(d,String(n),r)||s&&!Ro(d,String(s),r))return null;for(let y of e)if(!Ro(d,String(y),r))return!1;return!0}let a,l,c,u,h=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,f=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(let d of e){if(u=u||d.operator===">"||d.operator===">=",c=c||d.operator==="<"||d.operator==="<=",n){if(f&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===f.major&&d.semver.minor===f.minor&&d.semver.patch===f.patch&&(f=!1),d.operator===">"||d.operator===">="){if(a=CE(n,d,r),a===d&&a!==n)return!1}else if(n.operator===">="&&!Ro(n.semver,String(d),r))return!1}if(s){if(h&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===h.major&&d.semver.minor===h.minor&&d.semver.patch===h.patch&&(h=!1),d.operator==="<"||d.operator==="<="){if(l=RE(s,d,r),l===d&&l!==s)return!1}else if(s.operator==="<="&&!Ro(s.semver,String(d),r))return!1}if(!d.operator&&(s||n)&&o!==0)return!1}return!(n&&c&&!s&&o!==0||s&&u&&!n&&o!==0||f||h)},CE=(t,e,r)=>{if(!t)return e;let i=rf(t.semver,e.semver,r);return i>0?t:i<0||e.operator===">"&&t.operator===">="?e:t},RE=(t,e,r)=>{if(!t)return e;let i=rf(t.semver,e.semver,r);return i<0?t:i>0||e.operator==="<"&&t.operator==="<="?e:t};IE.exports=MP});var sf=w((FH,PE)=>{"use strict";var nf=zn(),xE=bo(),jP=We(),DE=jh(),HP=ji(),WP=nA(),GP=oA(),zP=uA(),VP=fA(),YP=pA(),QP=gA(),XP=wA(),KP=EA(),JP=Nt(),ZP=vA(),eF=OA(),tF=ul(),rF=NA(),iF=DA(),nF=vo(),sF=cl(),oF=Wh(),aF=Gh(),lF=hl(),uF=fl(),cF=zh(),hF=BA(),fF=To(),dF=xt(),pF=Co(),mF=rE(),gF=nE(),yF=oE(),wF=uE(),AF=hE(),EF=ml(),SF=yE(),bF=AE(),_F=bE(),vF=vE(),TF=NE();PE.exports={parse:HP,valid:WP,clean:GP,inc:zP,diff:VP,major:YP,minor:QP,patch:XP,prerelease:KP,compare:JP,rcompare:ZP,compareLoose:eF,compareBuild:tF,sort:rF,rsort:iF,gt:nF,lt:sF,eq:oF,neq:aF,gte:lF,lte:uF,cmp:cF,coerce:hF,Comparator:fF,Range:dF,satisfies:pF,toComparators:mF,maxSatisfying:gF,minSatisfying:yF,minVersion:wF,validRange:AF,outside:EF,gtr:SF,ltr:bF,intersects:_F,simplifyRange:vF,subset:TF,SemVer:jP,re:nf.re,src:nf.src,tokens:nf.t,SEMVER_SPEC_VERSION:xE.SEMVER_SPEC_VERSION,RELEASE_TYPES:xE.RELEASE_TYPES,compareIdentifiers:DE.compareIdentifiers,rcompareIdentifiers:DE.rcompareIdentifiers}});var pS=w((Io,Qn)=>{var OF=200,gf="__lodash_hash_undefined__",_l=1,GE=2,zE=9007199254740991,gl="[object Arguments]",uf="[object Array]",CF="[object AsyncFunction]",VE="[object Boolean]",YE="[object Date]",QE="[object Error]",XE="[object Function]",RF="[object GeneratorFunction]",yl="[object Map]",KE="[object Number]",IF="[object Null]",Yn="[object Object]",FE="[object Promise]",NF="[object Proxy]",JE="[object RegExp]",wl="[object Set]",ZE="[object String]",xF="[object Symbol]",DF="[object Undefined]",cf="[object WeakMap]",eS="[object ArrayBuffer]",Al="[object DataView]",PF="[object Float32Array]",FF="[object Float64Array]",LF="[object Int8Array]",$F="[object Int16Array]",kF="[object Int32Array]",qF="[object Uint8Array]",MF="[object Uint8ClampedArray]",UF="[object Uint16Array]",BF="[object Uint32Array]",jF=/[\\^$.*+?()[\]{}|]/g,HF=/^\[object .+?Constructor\]$/,WF=/^(?:0|[1-9]\d*)$/,he={};he[PF]=he[FF]=he[LF]=he[$F]=he[kF]=he[qF]=he[MF]=he[UF]=he[BF]=!0;he[gl]=he[uf]=he[eS]=he[VE]=he[Al]=he[YE]=he[QE]=he[XE]=he[yl]=he[KE]=he[Yn]=he[JE]=he[wl]=he[ZE]=he[cf]=!1;var tS=typeof global=="object"&&global&&global.Object===Object&&global,GF=typeof self=="object"&&self&&self.Object===Object&&self,wr=tS||GF||Function("return this")(),rS=typeof Io=="object"&&Io&&!Io.nodeType&&Io,LE=rS&&typeof Qn=="object"&&Qn&&!Qn.nodeType&&Qn,iS=LE&&LE.exports===rS,of=iS&&tS.process,$E=function(){try{return of&&of.binding&&of.binding("util")}catch{}}(),kE=$E&&$E.isTypedArray;function zF(t,e){for(var r=-1,i=t==null?0:t.length,n=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[n++]=o)}return s}function VF(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}function YF(t,e){for(var r=-1,i=t==null?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}function QF(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function XF(t){return function(e){return t(e)}}function KF(t,e){return t.has(e)}function JF(t,e){return t?.[e]}function ZF(t){var e=-1,r=Array(t.size);return t.forEach(function(i,n){r[++e]=[n,i]}),r}function eL(t,e){return function(r){return t(e(r))}}function tL(t){var e=-1,r=Array(t.size);return t.forEach(function(i){r[++e]=i}),r}var rL=Array.prototype,iL=Function.prototype,vl=Object.prototype,af=wr["__core-js_shared__"],nS=iL.toString,tr=vl.hasOwnProperty,qE=function(){var t=/[^.]+$/.exec(af&&af.keys&&af.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),sS=vl.toString,nL=RegExp("^"+nS.call(tr).replace(jF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ME=iS?wr.Buffer:void 0,El=wr.Symbol,UE=wr.Uint8Array,oS=vl.propertyIsEnumerable,sL=rL.splice,Hi=El?El.toStringTag:void 0,BE=Object.getOwnPropertySymbols,oL=ME?ME.isBuffer:void 0,aL=eL(Object.keys,Object),hf=Xn(wr,"DataView"),No=Xn(wr,"Map"),ff=Xn(wr,"Promise"),df=Xn(wr,"Set"),pf=Xn(wr,"WeakMap"),xo=Xn(Object,"create"),lL=zi(hf),uL=zi(No),cL=zi(ff),hL=zi(df),fL=zi(pf),jE=El?El.prototype:void 0,lf=jE?jE.valueOf:void 0;function Wi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function dL(){this.__data__=xo?xo(null):{},this.size=0}function pL(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function mL(t){var e=this.__data__;if(xo){var r=e[t];return r===gf?void 0:r}return tr.call(e,t)?e[t]:void 0}function gL(t){var e=this.__data__;return xo?e[t]!==void 0:tr.call(e,t)}function yL(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=xo&&e===void 0?gf:e,this}Wi.prototype.clear=dL;Wi.prototype.delete=pL;Wi.prototype.get=mL;Wi.prototype.has=gL;Wi.prototype.set=yL;function Ar(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function wL(){this.__data__=[],this.size=0}function AL(t){var e=this.__data__,r=Tl(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():sL.call(e,r,1),--this.size,!0}function EL(t){var e=this.__data__,r=Tl(e,t);return r<0?void 0:e[r][1]}function SL(t){return Tl(this.__data__,t)>-1}function bL(t,e){var r=this.__data__,i=Tl(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}Ar.prototype.clear=wL;Ar.prototype.delete=AL;Ar.prototype.get=EL;Ar.prototype.has=SL;Ar.prototype.set=bL;function Gi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function _L(){this.size=0,this.__data__={hash:new Wi,map:new(No||Ar),string:new Wi}}function vL(t){var e=Ol(this,t).delete(t);return this.size-=e?1:0,e}function TL(t){return Ol(this,t).get(t)}function OL(t){return Ol(this,t).has(t)}function CL(t,e){var r=Ol(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}Gi.prototype.clear=_L;Gi.prototype.delete=vL;Gi.prototype.get=TL;Gi.prototype.has=OL;Gi.prototype.set=CL;function Sl(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Gi;++e<r;)this.add(t[e])}function RL(t){return this.__data__.set(t,gf),this}function IL(t){return this.__data__.has(t)}Sl.prototype.add=Sl.prototype.push=RL;Sl.prototype.has=IL;function ti(t){var e=this.__data__=new Ar(t);this.size=e.size}function NL(){this.__data__=new Ar,this.size=0}function xL(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function DL(t){return this.__data__.get(t)}function PL(t){return this.__data__.has(t)}function FL(t,e){var r=this.__data__;if(r instanceof Ar){var i=r.__data__;if(!No||i.length<OF-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new Gi(i)}return r.set(t,e),this.size=r.size,this}ti.prototype.clear=NL;ti.prototype.delete=xL;ti.prototype.get=DL;ti.prototype.has=PL;ti.prototype.set=FL;function LL(t,e){var r=bl(t),i=!r&&XL(t),n=!r&&!i&&mf(t),s=!r&&!i&&!n&&dS(t),o=r||i||n||s,a=o?QF(t.length,String):[],l=a.length;for(var c in t)(e||tr.call(t,c))&&!(o&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||GL(c,l)))&&a.push(c);return a}function Tl(t,e){for(var r=t.length;r--;)if(uS(t[r][0],e))return r;return-1}function $L(t,e,r){var i=e(t);return bl(t)?i:VF(i,r(t))}function Po(t){return t==null?t===void 0?DF:IF:Hi&&Hi in Object(t)?HL(t):QL(t)}function HE(t){return Do(t)&&Po(t)==gl}function aS(t,e,r,i,n){return t===e?!0:t==null||e==null||!Do(t)&&!Do(e)?t!==t&&e!==e:kL(t,e,r,i,aS,n)}function kL(t,e,r,i,n,s){var o=bl(t),a=bl(e),l=o?uf:ei(t),c=a?uf:ei(e);l=l==gl?Yn:l,c=c==gl?Yn:c;var u=l==Yn,h=c==Yn,f=l==c;if(f&&mf(t)){if(!mf(e))return!1;o=!0,u=!1}if(f&&!u)return s||(s=new ti),o||dS(t)?lS(t,e,r,i,n,s):BL(t,e,l,r,i,n,s);if(!(r&_l)){var d=u&&tr.call(t,"__wrapped__"),y=h&&tr.call(e,"__wrapped__");if(d||y){var A=d?t.value():t,E=y?e.value():e;return s||(s=new ti),n(A,E,r,i,s)}}return f?(s||(s=new ti),jL(t,e,r,i,n,s)):!1}function qL(t){if(!fS(t)||VL(t))return!1;var e=cS(t)?nL:HF;return e.test(zi(t))}function ML(t){return Do(t)&&hS(t.length)&&!!he[Po(t)]}function UL(t){if(!YL(t))return aL(t);var e=[];for(var r in Object(t))tr.call(t,r)&&r!="constructor"&&e.push(r);return e}function lS(t,e,r,i,n,s){var o=r&_l,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t);if(c&&s.get(e))return c==e;var u=-1,h=!0,f=r&GE?new Sl:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var d=t[u],y=e[u];if(i)var A=o?i(y,d,u,e,t,s):i(d,y,u,t,e,s);if(A!==void 0){if(A)continue;h=!1;break}if(f){if(!YF(e,function(E,v){if(!KF(f,v)&&(d===E||n(d,E,r,i,s)))return f.push(v)})){h=!1;break}}else if(!(d===y||n(d,y,r,i,s))){h=!1;break}}return s.delete(t),s.delete(e),h}function BL(t,e,r,i,n,s,o){switch(r){case Al:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case eS:return!(t.byteLength!=e.byteLength||!s(new UE(t),new UE(e)));case VE:case YE:case KE:return uS(+t,+e);case QE:return t.name==e.name&&t.message==e.message;case JE:case ZE:return t==e+"";case yl:var a=ZF;case wl:var l=i&_l;if(a||(a=tL),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=GE,o.set(t,e);var u=lS(a(t),a(e),i,n,s,o);return o.delete(t),u;case xF:if(lf)return lf.call(t)==lf.call(e)}return!1}function jL(t,e,r,i,n,s){var o=r&_l,a=WE(t),l=a.length,c=WE(e),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var f=a[h];if(!(o?f in e:tr.call(e,f)))return!1}var d=s.get(t);if(d&&s.get(e))return d==e;var y=!0;s.set(t,e),s.set(e,t);for(var A=o;++h<l;){f=a[h];var E=t[f],v=e[f];if(i)var T=o?i(v,E,f,e,t,s):i(E,v,f,t,e,s);if(!(T===void 0?E===v||n(E,v,r,i,s):T)){y=!1;break}A||(A=f=="constructor")}if(y&&!A){var I=t.constructor,L=e.constructor;I!=L&&"constructor"in t&&"constructor"in e&&!(typeof I=="function"&&I instanceof I&&typeof L=="function"&&L instanceof L)&&(y=!1)}return s.delete(t),s.delete(e),y}function WE(t){return $L(t,ZL,WL)}function Ol(t,e){var r=t.__data__;return zL(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Xn(t,e){var r=JF(t,e);return qL(r)?r:void 0}function HL(t){var e=tr.call(t,Hi),r=t[Hi];try{t[Hi]=void 0;var i=!0}catch{}var n=sS.call(t);return i&&(e?t[Hi]=r:delete t[Hi]),n}var WL=BE?function(t){return t==null?[]:(t=Object(t),zF(BE(t),function(e){return oS.call(t,e)}))}:e$,ei=Po;(hf&&ei(new hf(new ArrayBuffer(1)))!=Al||No&&ei(new No)!=yl||ff&&ei(ff.resolve())!=FE||df&&ei(new df)!=wl||pf&&ei(new pf)!=cf)&&(ei=function(t){var e=Po(t),r=e==Yn?t.constructor:void 0,i=r?zi(r):"";if(i)switch(i){case lL:return Al;case uL:return yl;case cL:return FE;case hL:return wl;case fL:return cf}return e});function GL(t,e){return e=e??zE,!!e&&(typeof t=="number"||WF.test(t))&&t>-1&&t%1==0&&t<e}function zL(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function VL(t){return!!qE&&qE in t}function YL(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||vl;return t===r}function QL(t){return sS.call(t)}function zi(t){if(t!=null){try{return nS.call(t)}catch{}try{return t+""}catch{}}return""}function uS(t,e){return t===e||t!==t&&e!==e}var XL=HE(function(){return arguments}())?HE:function(t){return Do(t)&&tr.call(t,"callee")&&!oS.call(t,"callee")},bl=Array.isArray;function KL(t){return t!=null&&hS(t.length)&&!cS(t)}var mf=oL||t$;function JL(t,e){return aS(t,e)}function cS(t){if(!fS(t))return!1;var e=Po(t);return e==XE||e==RF||e==CF||e==NF}function hS(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=zE}function fS(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function Do(t){return t!=null&&typeof t=="object"}var dS=kE?XF(kE):ML;function ZL(t){return KL(t)?LL(t):UL(t)}function e$(){return[]}function t$(){return!1}Qn.exports=JL});var gS=w(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.DownloadedUpdateHelper=void 0;Lo.createTempUpdateFile=s$;var r$=require("crypto"),i$=require("fs"),mS=pS(),Vi=gr(),Fo=require("path"),yf=class{constructor(e){this.cacheDir=e,this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,this._downloadedFileInfo=null}get downloadedFileInfo(){return this._downloadedFileInfo}get file(){return this._file}get packageFile(){return this._packageFile}get cacheDirForPendingUpdate(){return Fo.join(this.cacheDir,"pending")}async validateDownloadedPath(e,r,i,n){if(this.versionInfo!=null&&this.file===e&&this.fileInfo!=null)return mS(this.versionInfo,r)&&mS(this.fileInfo.info,i.info)&&await(0,Vi.pathExists)(e)?e:null;let s=await this.getValidCachedUpdateFile(i,n);return s===null?null:(n.info("Update has already been downloaded to ".concat(e,").")),this._file=s,s)}async setDownloadedFile(e,r,i,n,s,o){this._file=e,this._packageFile=r,this.versionInfo=i,this.fileInfo=n,this._downloadedFileInfo={fileName:s,sha512:n.info.sha512,isAdminRightsRequired:n.info.isAdminRightsRequired===!0},o&&await(0,Vi.outputJson)(this.getUpdateInfoFile(),this._downloadedFileInfo)}async clear(){this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,await this.cleanCacheDirForPendingUpdate()}async cleanCacheDirForPendingUpdate(){try{await(0,Vi.emptyDir)(this.cacheDirForPendingUpdate)}catch{}}async getValidCachedUpdateFile(e,r){let i=this.getUpdateInfoFile();if(!await(0,Vi.pathExists)(i))return null;let s;try{s=await(0,Vi.readJson)(i)}catch(c){let u="No cached update info available";return c.code!=="ENOENT"&&(await this.cleanCacheDirForPendingUpdate(),u+=" (error on read: ".concat(c.message,")")),r.info(u),null}if(!(s?.fileName!==null))return r.warn("Cached update info is corrupted: no fileName, directory for cached update will be cleaned"),await this.cleanCacheDirForPendingUpdate(),null;if(e.info.sha512!==s.sha512)return r.info("Cached update sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ".concat(s.sha512,", expected: ").concat(e.info.sha512,". Directory for cached update will be cleaned")),await this.cleanCacheDirForPendingUpdate(),null;let a=Fo.join(this.cacheDirForPendingUpdate,s.fileName);if(!await(0,Vi.pathExists)(a))return r.info("Cached update file doesn't exist"),null;let l=await n$(a);return e.info.sha512!==l?(r.warn("Sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ".concat(l,", expected: ").concat(e.info.sha512)),await this.cleanCacheDirForPendingUpdate(),null):(this._downloadedFileInfo=s,a)}getUpdateInfoFile(){return Fo.join(this.cacheDirForPendingUpdate,"update-info.json")}};Lo.DownloadedUpdateHelper=yf;function n$(t,e="sha512",r="base64",i){return new Promise((n,s)=>{let o=(0,r$.createHash)(e);o.on("error",s).setEncoding(r),(0,i$.createReadStream)(t,{...i,highWaterMark:1024*1024}).on("error",s).on("end",()=>{o.end(),n(o.read())}).pipe(o,{end:!1})})}async function s$(t,e,r){let i=0,n=Fo.join(e,t);for(let s=0;s<3;s++)try{return await(0,Vi.unlink)(n),n}catch(o){if(o.code==="ENOENT")return n;r.warn("Error on remove temp update file: ".concat(o)),n=Fo.join(e,"".concat(i++,"-").concat(t))}return n}});var yS=w(Af=>{"use strict";Object.defineProperty(Af,"__esModule",{value:!0});Af.getAppCacheDir=a$;var wf=require("path"),o$=require("os");function a$(){let t=(0,o$.homedir)(),e;return process.platform==="win32"?e=process.env.LOCALAPPDATA||wf.join(t,"AppData","Local"):process.platform==="darwin"?e=wf.join(t,"Library","Caches"):e=process.env.XDG_CACHE_HOME||wf.join(t,".cache"),e}});var AS=w(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.ElectronAppAdapter=void 0;var wS=require("path"),l$=yS(),Ef=class{constructor(e=require("electron").app){this.app=e}whenReady(){return this.app.whenReady()}get version(){return this.app.getVersion()}get name(){return this.app.getName()}get isPackaged(){return this.app.isPackaged===!0}get appUpdateConfigPath(){return this.isPackaged?wS.join(process.resourcesPath,"app-update.yml"):wS.join(this.app.getAppPath(),"dev-app-update.yml")}get userDataPath(){return this.app.getPath("userData")}get baseCachePath(){return(0,l$.getAppCacheDir)()}quit(){this.app.quit()}relaunch(){this.app.relaunch()}onQuit(e){this.app.once("quit",(r,i)=>e(i))}};Cl.ElectronAppAdapter=Ef});var SS=w(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.ElectronHttpExecutor=ri.NET_SESSION_NAME=void 0;ri.getNetSession=ES;var Rl=Ne();ri.NET_SESSION_NAME="electron-updater";function ES(){return require("electron").session.fromPartition(ri.NET_SESSION_NAME,{cache:!1})}var Sf=class extends Rl.HttpExecutor{constructor(e){super(),this.proxyLoginCallback=e,this.cachedSession=null}async download(e,r,i){return await i.cancellationToken.createPromise((n,s,o)=>{let a={headers:i.headers||void 0,redirect:"manual"};(0,Rl.configureRequestUrl)(e,a),(0,Rl.configureRequestOptions)(a),this.doDownload(a,{destination:r,options:i,onCancel:o,callback:l=>{l==null?n(r):s(l)},responseHandler:null},0)})}createRequest(e,r){e.headers&&e.headers.Host&&(e.host=e.headers.Host,delete e.headers.Host),this.cachedSession==null&&(this.cachedSession=ES());let i=require("electron").net.request({...e,session:this.cachedSession});return i.on("response",r),this.proxyLoginCallback!=null&&i.on("login",this.proxyLoginCallback),i}addRedirectHandlers(e,r,i,n,s){e.on("redirect",(o,a,l)=>{e.abort(),n>this.maxRedirects?i(this.createMaxRedirectError()):s(Rl.HttpExecutor.prepareRedirectUrlOptions(l,r))})}};ri.ElectronHttpExecutor=Sf});var CS=w((MH,OS)=>{var u$=1/0,c$="[object Symbol]",TS=/[\\^$.*+?()[\]{}|]/g,h$=RegExp(TS.source),f$=typeof global=="object"&&global&&global.Object===Object&&global,d$=typeof self=="object"&&self&&self.Object===Object&&self,p$=f$||d$||Function("return this")(),m$=Object.prototype,g$=m$.toString,bS=p$.Symbol,_S=bS?bS.prototype:void 0,vS=_S?_S.toString:void 0;function y$(t){if(typeof t=="string")return t;if(A$(t))return vS?vS.call(t):"";var e=t+"";return e=="0"&&1/t==-u$?"-0":e}function w$(t){return!!t&&typeof t=="object"}function A$(t){return typeof t=="symbol"||w$(t)&&g$.call(t)==c$}function E$(t){return t==null?"":y$(t)}function S$(t){return t=E$(t),t&&h$.test(t)?t.replace(TS,"\\$&"):t}OS.exports=S$});var ii=w(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.newBaseUrl=_$;Kn.newUrlFromBase=bf;Kn.getChannelFilename=v$;Kn.blockmapFiles=T$;var RS=require("url"),b$=CS();function _$(t){let e=new RS.URL(t);return e.pathname.endsWith("/")||(e.pathname+="/"),e}function bf(t,e,r=!1){let i=new RS.URL(t,e),n=e.search;return n!=null&&n.length!==0?i.search=n:r&&(i.search="noCache=".concat(Date.now().toString(32))),i}function v$(t){return"".concat(t,".yml")}function T$(t,e,r){let i=bf("".concat(t.pathname,".blockmap"),t);return[bf("".concat(t.pathname.replace(new RegExp(b$(r),"g"),e),".blockmap"),t),i]}});var Dt=w(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.Provider=void 0;si.findFile=C$;si.parseUpdateInfo=R$;si.getFileList=NS;si.resolveFiles=I$;var ni=Ne(),O$=rl(),IS=ii(),_f=class{constructor(e){this.runtimeOptions=e,this.requestHeaders=null,this.executor=e.executor}get isUseMultipleRangeRequest(){return this.runtimeOptions.isUseMultipleRangeRequest!==!1}getChannelFilePrefix(){if(this.runtimeOptions.platform==="linux"){let e=process.env.TEST_UPDATER_ARCH||process.arch;return"-linux"+(e==="x64"?"":"-".concat(e))}else return this.runtimeOptions.platform==="darwin"?"-mac":""}getDefaultChannelName(){return this.getCustomChannelName("latest")}getCustomChannelName(e){return"".concat(e).concat(this.getChannelFilePrefix())}get fileExtraDownloadHeaders(){return null}setRequestHeaders(e){this.requestHeaders=e}httpRequest(e,r,i){return this.executor.request(this.createRequestOptions(e,r),i)}createRequestOptions(e,r){let i={};return this.requestHeaders==null?r!=null&&(i.headers=r):i.headers=r==null?this.requestHeaders:{...this.requestHeaders,...r},(0,ni.configureRequestUrl)(e,i),i}};si.Provider=_f;function C$(t,e,r){if(t.length===0)throw(0,ni.newError)("No files provided","ERR_UPDATER_NO_FILES_PROVIDED");let i=t.find(n=>n.url.pathname.toLowerCase().endsWith(".".concat(e)));return i??(r==null?t[0]:t.find(n=>!r.some(s=>n.url.pathname.toLowerCase().endsWith(".".concat(s)))))}function R$(t,e,r){if(t==null)throw(0,ni.newError)("Cannot parse update info from ".concat(e," in the latest release artifacts (").concat(r,"): rawData: null"),"ERR_UPDATER_INVALID_UPDATE_INFO");let i;try{i=(0,O$.load)(t)}catch(n){throw(0,ni.newError)("Cannot parse update info from ".concat(e," in the latest release artifacts (").concat(r,"): ").concat(n.stack||n.message,", rawData: ").concat(t),"ERR_UPDATER_INVALID_UPDATE_INFO")}return i}function NS(t){let e=t.files;if(e!=null&&e.length>0)return e;if(t.path!=null)return[{url:t.path,sha2:t.sha2,sha512:t.sha512}];throw(0,ni.newError)("No files provided: ".concat((0,ni.safeStringifyJson)(t)),"ERR_UPDATER_NO_FILES_PROVIDED")}function I$(t,e,r=i=>i){let n=NS(t).map(a=>{if(a.sha2==null&&a.sha512==null)throw(0,ni.newError)("Update info doesn't contain nor sha256 neither sha512 checksum: ".concat((0,ni.safeStringifyJson)(a)),"ERR_UPDATER_NO_CHECKSUM");return{url:(0,IS.newUrlFromBase)(r(a.url),e),info:a}}),s=t.packages,o=s==null?null:s[process.arch]||s.ia32;return o!=null&&(n[0].packageInfo={...o,path:(0,IS.newUrlFromBase)(r(o.path),e).href}),n}});var Cf=w(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.GenericProvider=void 0;var xS=Ne(),vf=ii(),Tf=Dt(),Of=class extends Tf.Provider{constructor(e,r,i){super(i),this.configuration=e,this.updater=r,this.baseUrl=(0,vf.newBaseUrl)(this.configuration.url)}get channel(){let e=this.updater.channel||this.configuration.channel;return e==null?this.getDefaultChannelName():this.getCustomChannelName(e)}async getLatestVersion(){let e=(0,vf.getChannelFilename)(this.channel),r=(0,vf.newUrlFromBase)(e,this.baseUrl,this.updater.isAddNoCacheQuery);for(let i=0;;i++)try{return(0,Tf.parseUpdateInfo)(await this.httpRequest(r),e,r)}catch(n){if(n instanceof xS.HttpError&&n.statusCode===404)throw(0,xS.newError)('Cannot find channel "'.concat(e,'" update info: ').concat(n.stack||n.message),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");if(n.code==="ECONNREFUSED"&&i<3){await new Promise((s,o)=>{try{setTimeout(s,1e3*i)}catch(a){o(a)}});continue}throw n}}resolveFiles(e){return(0,Tf.resolveFiles)(e,this.baseUrl)}};Il.GenericProvider=Of});var PS=w(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});Nl.BitbucketProvider=void 0;var DS=Ne(),Rf=ii(),If=Dt(),Nf=class extends If.Provider{constructor(e,r,i){super({...i,isUseMultipleRangeRequest:!1}),this.configuration=e,this.updater=r;let{owner:n,slug:s}=e;this.baseUrl=(0,Rf.newBaseUrl)("https://api.bitbucket.org/2.0/repositories/".concat(n,"/").concat(s,"/downloads"))}get channel(){return this.updater.channel||this.configuration.channel||"latest"}async getLatestVersion(){let e=new DS.CancellationToken,r=(0,Rf.getChannelFilename)(this.getCustomChannelName(this.channel)),i=(0,Rf.newUrlFromBase)(r,this.baseUrl,this.updater.isAddNoCacheQuery);try{let n=await this.httpRequest(i,void 0,e);return(0,If.parseUpdateInfo)(n,r,i)}catch(n){throw(0,DS.newError)("Unable to find latest version on ".concat(this.toString(),", please ensure release exists: ").concat(n.stack||n.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(e){return(0,If.resolveFiles)(e,this.baseUrl)}toString(){let{owner:e,slug:r}=this.configuration;return"Bitbucket (owner: ".concat(e,", slug: ").concat(r,", channel: ").concat(this.channel,")")}};Nl.BitbucketProvider=Nf});var Ff=w(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.GitHubProvider=Yi.BaseGitHubProvider=void 0;Yi.computeReleaseNotes=LS;var Er=Ne(),Jn=sf(),N$=require("url"),Zn=ii(),Df=Dt(),xf=/\/tag\/([^/]+)$/,xl=class extends Df.Provider{constructor(e,r,i){super({...i,isUseMultipleRangeRequest:!1}),this.options=e,this.baseUrl=(0,Zn.newBaseUrl)((0,Er.githubUrl)(e,r));let n=r==="github.com"?"api.github.com":r;this.baseApiUrl=(0,Zn.newBaseUrl)((0,Er.githubUrl)(e,n))}computeGithubBasePath(e){let r=this.options.host;return r&&!["github.com","api.github.com"].includes(r)?"/api/v3".concat(e):e}};Yi.BaseGitHubProvider=xl;var Pf=class extends xl{constructor(e,r,i){super(e,"github.com",i),this.options=e,this.updater=r}get channel(){let e=this.updater.channel||this.options.channel;return e==null?this.getDefaultChannelName():this.getCustomChannelName(e)}async getLatestVersion(){var e,r,i,n,s;let o=new Er.CancellationToken,a=await this.httpRequest((0,Zn.newUrlFromBase)("".concat(this.basePath,".atom"),this.baseUrl),{accept:"application/xml, application/atom+xml, text/xml, */*"},o),l=(0,Er.parseXml)(a),c=l.element("entry",!1,"No published versions on GitHub"),u=null;try{if(this.updater.allowPrerelease){let E=((e=this.updater)===null||e===void 0?void 0:e.channel)||((r=Jn.prerelease(this.updater.currentVersion))===null||r===void 0?void 0:r[0])||null;if(E===null)u=xf.exec(c.element("link").attribute("href"))[1];else for(let v of l.getElements("entry")){let T=xf.exec(v.element("link").attribute("href"));if(T===null)continue;let I=T[1],L=((i=Jn.prerelease(I))===null||i===void 0?void 0:i[0])||null,oe=!E||["alpha","beta"].includes(E),B=L!==null&&!["alpha","beta"].includes(String(L));if(oe&&!B&&!(E==="beta"&&L==="alpha")){u=I;break}if(L&&L===E){u=I;break}}}else{u=await this.getLatestTagName(o);for(let E of l.getElements("entry"))if(xf.exec(E.element("link").attribute("href"))[1]===u){c=E;break}}}catch(E){throw(0,Er.newError)("Cannot parse releases feed: ".concat(E.stack||E.message,",\nXML:\n").concat(a),"ERR_UPDATER_INVALID_RELEASE_FEED")}if(u==null)throw(0,Er.newError)("No published versions on GitHub","ERR_UPDATER_NO_PUBLISHED_VERSIONS");let h,f="",d="",y=async E=>{f=(0,Zn.getChannelFilename)(E),d=(0,Zn.newUrlFromBase)(this.getBaseDownloadPath(String(u),f),this.baseUrl);let v=this.createRequestOptions(d);try{return await this.executor.request(v,o)}catch(T){throw T instanceof Er.HttpError&&T.statusCode===404?(0,Er.newError)("Cannot find ".concat(f," in the latest release artifacts (").concat(d,"): ").concat(T.stack||T.message),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):T}};try{let E=this.channel;this.updater.allowPrerelease&&(!((n=Jn.prerelease(u))===null||n===void 0)&&n[0])&&(E=this.getCustomChannelName(String((s=Jn.prerelease(u))===null||s===void 0?void 0:s[0]))),h=await y(E)}catch(E){if(this.updater.allowPrerelease)h=await y(this.getDefaultChannelName());else throw E}let A=(0,Df.parseUpdateInfo)(h,f,d);return A.releaseName==null&&(A.releaseName=c.elementValueOrEmpty("title")),A.releaseNotes==null&&(A.releaseNotes=LS(this.updater.currentVersion,this.updater.fullChangelog,l,c)),{tag:u,...A}}async getLatestTagName(e){let r=this.options,i=r.host==null||r.host==="github.com"?(0,Zn.newUrlFromBase)("".concat(this.basePath,"/latest"),this.baseUrl):new N$.URL("".concat(this.computeGithubBasePath("/repos/".concat(r.owner,"/").concat(r.repo,"/releases")),"/latest"),this.baseApiUrl);try{let n=await this.httpRequest(i,{Accept:"application/json"},e);return n==null?null:JSON.parse(n).tag_name}catch(n){throw(0,Er.newError)("Unable to find latest version on GitHub (".concat(i,"), please ensure a production release exists: ").concat(n.stack||n.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return"/".concat(this.options.owner,"/").concat(this.options.repo,"/releases")}resolveFiles(e){return(0,Df.resolveFiles)(e,this.baseUrl,r=>this.getBaseDownloadPath(e.tag,r.replace(/ /g,"-")))}getBaseDownloadPath(e,r){return"".concat(this.basePath,"/download/").concat(e,"/").concat(r)}};Yi.GitHubProvider=Pf;function FS(t){let e=t.elementValueOrEmpty("content");return e==="No content."?"":e}function LS(t,e,r,i){if(!e)return FS(i);let n=[];for(let s of r.getElements("entry")){let o=/\/tag\/v?([^/]+)$/.exec(s.element("link").attribute("href"))[1];Jn.lt(t,o)&&n.push({version:o,note:FS(s)})}return n.sort((s,o)=>Jn.rcompare(s.version,o.version))}});var kS=w(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});Dl.KeygenProvider=void 0;var $S=Ne(),Lf=ii(),$f=Dt(),kf=class extends $f.Provider{constructor(e,r,i){super({...i,isUseMultipleRangeRequest:!1}),this.configuration=e,this.updater=r,this.baseUrl=(0,Lf.newBaseUrl)("https://api.keygen.sh/v1/accounts/".concat(this.configuration.account,"/artifacts?product=").concat(this.configuration.product))}get channel(){return this.updater.channel||this.configuration.channel||"stable"}async getLatestVersion(){let e=new $S.CancellationToken,r=(0,Lf.getChannelFilename)(this.getCustomChannelName(this.channel)),i=(0,Lf.newUrlFromBase)(r,this.baseUrl,this.updater.isAddNoCacheQuery);try{let n=await this.httpRequest(i,{Accept:"application/vnd.api+json","Keygen-Version":"1.1"},e);return(0,$f.parseUpdateInfo)(n,r,i)}catch(n){throw(0,$S.newError)("Unable to find latest version on ".concat(this.toString(),", please ensure release exists: ").concat(n.stack||n.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(e){return(0,$f.resolveFiles)(e,this.baseUrl)}toString(){let{account:e,product:r,platform:i}=this.configuration;return"Keygen (account: ".concat(e,", product: ").concat(r,", platform: ").concat(i,", channel: ").concat(this.channel,")")}};Dl.KeygenProvider=kf});var US=w(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.PrivateGitHubProvider=void 0;var es=Ne(),x$=rl(),D$=require("path"),qS=require("url"),MS=ii(),P$=Ff(),F$=Dt(),qf=class extends P$.BaseGitHubProvider{constructor(e,r,i,n){super(e,"api.github.com",n),this.updater=r,this.token=i}createRequestOptions(e,r){let i=super.createRequestOptions(e,r);return i.redirect="manual",i}async getLatestVersion(){let e=new es.CancellationToken,r=(0,MS.getChannelFilename)(this.getDefaultChannelName()),i=await this.getLatestVersionInfo(e),n=i.assets.find(a=>a.name===r);if(n==null)throw(0,es.newError)("Cannot find ".concat(r," in the release ").concat(i.html_url||i.name),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");let s=new qS.URL(n.url),o;try{o=(0,x$.load)(await this.httpRequest(s,this.configureHeaders("application/octet-stream"),e))}catch(a){throw a instanceof es.HttpError&&a.statusCode===404?(0,es.newError)("Cannot find ".concat(r," in the latest release artifacts (").concat(s,"): ").concat(a.stack||a.message),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):a}return o.assets=i.assets,o}get fileExtraDownloadHeaders(){return this.configureHeaders("application/octet-stream")}configureHeaders(e){return{accept:e,authorization:"token ".concat(this.token)}}async getLatestVersionInfo(e){let r=this.updater.allowPrerelease,i=this.basePath;r||(i="".concat(i,"/latest"));let n=(0,MS.newUrlFromBase)(i,this.baseUrl);try{let s=JSON.parse(await this.httpRequest(n,this.configureHeaders("application/vnd.github.v3+json"),e));return r?s.find(o=>o.prerelease)||s[0]:s}catch(s){throw(0,es.newError)("Unable to find latest version on GitHub (".concat(n,"), please ensure a production release exists: ").concat(s.stack||s.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return this.computeGithubBasePath("/repos/".concat(this.options.owner,"/").concat(this.options.repo,"/releases"))}resolveFiles(e){return(0,F$.getFileList)(e).map(r=>{let i=D$.posix.basename(r.url).replace(/ /g,"-"),n=e.assets.find(s=>s!=null&&s.name===i);if(n==null)throw(0,es.newError)('Cannot find asset "'.concat(i,'" in: ').concat(JSON.stringify(e.assets,null,2)),"ERR_UPDATER_ASSET_NOT_FOUND");return{url:new qS.URL(n.url),info:r}})}};Pl.PrivateGitHubProvider=qf});var HS=w(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});Ll.isUrlProbablySupportMultiRangeRequests=jS;Ll.createClient=M$;var Fl=Ne(),L$=PS(),BS=Cf(),$$=Ff(),k$=kS(),q$=US();function jS(t){return!t.includes("s3.amazonaws.com")}function M$(t,e,r){if(typeof t=="string")throw(0,Fl.newError)("Please pass PublishConfiguration object","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");let i=t.provider;switch(i){case"github":{let n=t,s=(n.private?process.env.GH_TOKEN||process.env.GITHUB_TOKEN:null)||n.token;return s==null?new $$.GitHubProvider(n,e,r):new q$.PrivateGitHubProvider(n,e,s,r)}case"bitbucket":return new L$.BitbucketProvider(t,e,r);case"keygen":return new k$.KeygenProvider(t,e,r);case"s3":case"spaces":return new BS.GenericProvider({provider:"generic",url:(0,Fl.getS3LikeProviderBaseUrl)(t),channel:t.channel||null},e,{...r,isUseMultipleRangeRequest:!1});case"generic":{let n=t;return new BS.GenericProvider(n,e,{...r,isUseMultipleRangeRequest:n.useMultipleRangeRequest!==!1&&jS(n.url)})}case"custom":{let n=t,s=n.updateProvider;if(!s)throw(0,Fl.newError)("Custom provider not specified","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");return new s(n,e,r)}default:throw(0,Fl.newError)("Unsupported provider: ".concat(i),"ERR_UPDATER_UNSUPPORTED_PROVIDER")}}});var $l=w($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.OperationKind=void 0;$o.computeOperations=U$;var Qi;(function(t){t[t.COPY=0]="COPY",t[t.DOWNLOAD=1]="DOWNLOAD"})(Qi||($o.OperationKind=Qi={}));function U$(t,e,r){let i=GS(t.files),n=GS(e.files),s=null,o=e.files[0],a=[],l=o.name,c=i.get(l);if(c==null)throw new Error("no file ".concat(l," in old blockmap"));let u=n.get(l),h=0,{checksumToOffset:f,checksumToOldSize:d}=j$(i.get(l),c.offset,r),y=o.offset;for(let A=0;A<u.checksums.length;y+=u.sizes[A],A++){let E=u.sizes[A],v=u.checksums[A],T=f.get(v);T!=null&&d.get(v)!==E&&(r.warn('Checksum ("'.concat(v,'") matches, but size differs (old: ').concat(d.get(v),", new: ").concat(E,")")),T=void 0),T===void 0?(h++,s!=null&&s.kind===Qi.DOWNLOAD&&s.end===y?s.end+=E:(s={kind:Qi.DOWNLOAD,start:y,end:y+E},WS(s,a,v,A))):s!=null&&s.kind===Qi.COPY&&s.end===T?s.end+=E:(s={kind:Qi.COPY,start:T,end:T+E},WS(s,a,v,A))}return h>0&&r.info("File".concat(o.name==="file"?"":" "+o.name," has ").concat(h," changed blocks")),a}var B$=process.env.DIFFERENTIAL_DOWNLOAD_PLAN_BUILDER_VALIDATE_RANGES==="true";function WS(t,e,r,i){if(B$&&e.length!==0){let n=e[e.length-1];if(n.kind===t.kind&&t.start<n.end&&t.start>n.start){let s=[n.start,n.end,t.start,t.end].reduce((o,a)=>o<a?o:a);throw new Error("operation (block index: ".concat(i,", checksum: ").concat(r,", kind: ").concat(Qi[t.kind],") overlaps previous operation (checksum: ").concat(r,"):\n")+"abs: ".concat(n.start," until ").concat(n.end," and ").concat(t.start," until ").concat(t.end,"\n")+"rel: ".concat(n.start-s," until ").concat(n.end-s," and ").concat(t.start-s," until ").concat(t.end-s))}}e.push(t)}function j$(t,e,r){let i=new Map,n=new Map,s=e;for(let o=0;o<t.checksums.length;o++){let a=t.checksums[o],l=t.sizes[o],c=n.get(a);if(c===void 0)i.set(a,s),n.set(a,l);else if(r.debug!=null){let u=c===l?"(same size)":"(size: ".concat(c,", this size: ").concat(l,")");r.debug("".concat(a," duplicated in blockmap ").concat(u,", it doesn't lead to broken differential downloader, just corresponding block will be skipped)"))}s+=l}return{checksumToOffset:i,checksumToOldSize:n}}function GS(t){let e=new Map;for(let r of t)e.set(r.name,r);return e}});var Uf=w(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.DataSplitter=void 0;ko.copyData=VS;var kl=Ne(),H$=require("fs"),W$=require("stream"),G$=$l(),zS=Buffer.from("\r\n\r\n"),oi;(function(t){t[t.INIT=0]="INIT",t[t.HEADER=1]="HEADER",t[t.BODY=2]="BODY"})(oi||(oi={}));function VS(t,e,r,i,n){let s=(0,H$.createReadStream)("",{fd:r,autoClose:!1,start:t.start,end:t.end-1});s.on("error",i),s.once("end",n),s.pipe(e,{end:!1})}var Mf=class extends W$.Writable{constructor(e,r,i,n,s,o){super(),this.out=e,this.options=r,this.partIndexToTaskIndex=i,this.partIndexToLength=s,this.finishHandler=o,this.partIndex=-1,this.headerListBuffer=null,this.readState=oi.INIT,this.ignoreByteCount=0,this.remainingPartDataCount=0,this.actualPartLength=0,this.boundaryLength=n.length+4,this.ignoreByteCount=this.boundaryLength-2}get isFinished(){return this.partIndex===this.partIndexToLength.length}_write(e,r,i){if(this.isFinished){console.error("Trailing ignored data: ".concat(e.length," bytes"));return}this.handleData(e).then(i).catch(i)}async handleData(e){let r=0;if(this.ignoreByteCount!==0&&this.remainingPartDataCount!==0)throw(0,kl.newError)("Internal error","ERR_DATA_SPLITTER_BYTE_COUNT_MISMATCH");if(this.ignoreByteCount>0){let i=Math.min(this.ignoreByteCount,e.length);this.ignoreByteCount-=i,r=i}else if(this.remainingPartDataCount>0){let i=Math.min(this.remainingPartDataCount,e.length);this.remainingPartDataCount-=i,await this.processPartData(e,0,i),r=i}if(r!==e.length){if(this.readState===oi.HEADER){let i=this.searchHeaderListEnd(e,r);if(i===-1)return;r=i,this.readState=oi.BODY,this.headerListBuffer=null}for(;;){if(this.readState===oi.BODY)this.readState=oi.INIT;else{this.partIndex++;let o=this.partIndexToTaskIndex.get(this.partIndex);if(o==null)if(this.isFinished)o=this.options.end;else throw(0,kl.newError)("taskIndex is null","ERR_DATA_SPLITTER_TASK_INDEX_IS_NULL");let a=this.partIndex===0?this.options.start:this.partIndexToTaskIndex.get(this.partIndex-1)+1;if(a<o)await this.copyExistingData(a,o);else if(a>o)throw(0,kl.newError)("prevTaskIndex must be < taskIndex","ERR_DATA_SPLITTER_TASK_INDEX_ASSERT_FAILED");if(this.isFinished){this.onPartEnd(),this.finishHandler();return}if(r=this.searchHeaderListEnd(e,r),r===-1){this.readState=oi.HEADER;return}}let i=this.partIndexToLength[this.partIndex],n=r+i,s=Math.min(n,e.length);if(await this.processPartStarted(e,r,s),this.remainingPartDataCount=i-(s-r),this.remainingPartDataCount>0)return;if(r=n+this.boundaryLength,r>=e.length){this.ignoreByteCount=this.boundaryLength-(e.length-n);return}}}}copyExistingData(e,r){return new Promise((i,n)=>{let s=()=>{if(e===r){i();return}let o=this.options.tasks[e];if(o.kind!==G$.OperationKind.COPY){n(new Error("Task kind must be COPY"));return}VS(o,this.out,this.options.oldFileFd,n,()=>{e++,s()})};s()})}searchHeaderListEnd(e,r){let i=e.indexOf(zS,r);if(i!==-1)return i+zS.length;let n=r===0?e:e.slice(r);return this.headerListBuffer==null?this.headerListBuffer=n:this.headerListBuffer=Buffer.concat([this.headerListBuffer,n]),-1}onPartEnd(){let e=this.partIndexToLength[this.partIndex-1];if(this.actualPartLength!==e)throw(0,kl.newError)("Expected length: ".concat(e," differs from actual: ").concat(this.actualPartLength),"ERR_DATA_SPLITTER_LENGTH_MISMATCH");this.actualPartLength=0}processPartStarted(e,r,i){return this.partIndex!==0&&this.onPartEnd(),this.processPartData(e,r,i)}processPartData(e,r,i){this.actualPartLength+=i-r;let n=this.out;return n.write(r===0&&e.length===i?e:e.slice(r,i))?Promise.resolve():new Promise((s,o)=>{n.on("error",o),n.once("drain",()=>{n.removeListener("error",o),s()})})}};ko.DataSplitter=Mf});var XS=w(ql=>{"use strict";Object.defineProperty(ql,"__esModule",{value:!0});ql.executeTasksUsingMultipleRangeRequests=z$;ql.checkIsRangesSupported=jf;var Bf=Ne(),YS=Uf(),QS=$l();function z$(t,e,r,i,n){let s=o=>{if(o>=e.length){t.fileMetadataBuffer!=null&&r.write(t.fileMetadataBuffer),r.end();return}let a=o+1e3;V$(t,{tasks:e,start:o,end:Math.min(e.length,a),oldFileFd:i},r,()=>s(a),n)};return s}function V$(t,e,r,i,n){let s="bytes=",o=0,a=new Map,l=[];for(let h=e.start;h<e.end;h++){let f=e.tasks[h];f.kind===QS.OperationKind.DOWNLOAD&&(s+="".concat(f.start,"-").concat(f.end-1,", "),a.set(o,h),o++,l.push(f.end-f.start))}if(o<=1){let h=f=>{if(f>=e.end){i();return}let d=e.tasks[f++];if(d.kind===QS.OperationKind.COPY)(0,YS.copyData)(d,r,e.oldFileFd,n,()=>h(f));else{let y=t.createRequestOptions();y.headers.Range="bytes=".concat(d.start,"-").concat(d.end-1);let A=t.httpExecutor.createRequest(y,E=>{jf(E,n)&&(E.pipe(r,{end:!1}),E.once("end",()=>h(f)))});t.httpExecutor.addErrorAndTimeoutHandlers(A,n),A.end()}};h(e.start);return}let c=t.createRequestOptions();c.headers.Range=s.substring(0,s.length-2);let u=t.httpExecutor.createRequest(c,h=>{if(!jf(h,n))return;let f=(0,Bf.safeGetHeader)(h,"content-type"),d=/^multipart\/.+?(?:; boundary=(?:(?:"(.+)")|(?:([^\s]+))))$/i.exec(f);if(d==null){n(new Error('Content-Type "multipart/byteranges" is expected, but got "'.concat(f,'"')));return}let y=new YS.DataSplitter(r,e,a,d[1]||d[2],l,i);y.on("error",n),h.pipe(y),h.on("end",()=>{setTimeout(()=>{u.abort(),n(new Error("Response ends without calling any handlers"))},1e4)})});t.httpExecutor.addErrorAndTimeoutHandlers(u,n),u.end()}function jf(t,e){if(t.statusCode>=400)return e((0,Bf.createHttpError)(t)),!1;if(t.statusCode!==206){let r=(0,Bf.safeGetHeader)(t,"accept-ranges");if(r==null||r==="none")return e(new Error("Server doesn't support Accept-Ranges (response code ".concat(t.statusCode,")"))),!1}return!0}});var KS=w(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.ProgressDifferentialDownloadCallbackTransform=void 0;var Y$=require("stream"),ts;(function(t){t[t.COPY=0]="COPY",t[t.DOWNLOAD=1]="DOWNLOAD"})(ts||(ts={}));var Hf=class extends Y$.Transform{constructor(e,r,i){super(),this.progressDifferentialDownloadInfo=e,this.cancellationToken=r,this.onProgress=i,this.start=Date.now(),this.transferred=0,this.delta=0,this.expectedBytes=0,this.index=0,this.operationType=ts.COPY,this.nextUpdate=this.start+1e3}_transform(e,r,i){if(this.cancellationToken.cancelled){i(new Error("cancelled"),null);return}if(this.operationType==ts.COPY){i(null,e);return}this.transferred+=e.length,this.delta+=e.length;let n=Date.now();n>=this.nextUpdate&&this.transferred!==this.expectedBytes&&this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&(this.nextUpdate=n+1e3,this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((n-this.start)/1e3))}),this.delta=0),i(null,e)}beginFileCopy(){this.operationType=ts.COPY}beginRangeDownload(){this.operationType=ts.DOWNLOAD,this.expectedBytes+=this.progressDifferentialDownloadInfo.expectedByteCounts[this.index++]}endRangeDownload(){this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))})}_flush(e){if(this.cancellationToken.cancelled){e(new Error("cancelled"));return}this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,this.transferred=0,e(null)}};Ml.ProgressDifferentialDownloadCallbackTransform=Hf});var zf=w(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.DifferentialDownloader=void 0;var qo=Ne(),Wf=gr(),Q$=require("fs"),X$=Uf(),K$=require("url"),Ul=$l(),JS=XS(),J$=KS(),Gf=class{constructor(e,r,i){this.blockAwareFileInfo=e,this.httpExecutor=r,this.options=i,this.fileMetadataBuffer=null,this.logger=i.logger}createRequestOptions(){let e={headers:{...this.options.requestHeaders,accept:"*/*"}};return(0,qo.configureRequestUrl)(this.options.newUrl,e),(0,qo.configureRequestOptions)(e),e}doDownload(e,r){if(e.version!==r.version)throw new Error("version is different (".concat(e.version," - ").concat(r.version,"), full download is required"));let i=this.logger,n=(0,Ul.computeOperations)(e,r,i);i.debug!=null&&i.debug(JSON.stringify(n,null,2));let s=0,o=0;for(let l of n){let c=l.end-l.start;l.kind===Ul.OperationKind.DOWNLOAD?s+=c:o+=c}let a=this.blockAwareFileInfo.size;if(s+o+(this.fileMetadataBuffer==null?0:this.fileMetadataBuffer.length)!==a)throw new Error("Internal error, size mismatch: downloadSize: ".concat(s,", copySize: ").concat(o,", newSize: ").concat(a));return i.info("Full: ".concat(ZS(a),", To download: ").concat(ZS(s)," (").concat(Math.round(s/(a/100)),"%)")),this.downloadFile(n)}downloadFile(e){let r=[],i=()=>Promise.all(r.map(n=>(0,Wf.close)(n.descriptor).catch(s=>{this.logger.error('cannot close file "'.concat(n.path,'": ').concat(s))})));return this.doDownloadFile(e,r).then(i).catch(n=>i().catch(s=>{try{this.logger.error("cannot close files: ".concat(s))}catch(o){try{console.error(o)}catch{}}throw n}).then(()=>{throw n}))}async doDownloadFile(e,r){let i=await(0,Wf.open)(this.options.oldFile,"r");r.push({descriptor:i,path:this.options.oldFile});let n=await(0,Wf.open)(this.options.newFile,"w");r.push({descriptor:n,path:this.options.newFile});let s=(0,Q$.createWriteStream)(this.options.newFile,{fd:n});await new Promise((o,a)=>{let l=[],c;if(!this.options.isUseMultipleRangeRequest&&this.options.onProgress){let v=[],T=0;for(let L of e)L.kind===Ul.OperationKind.DOWNLOAD&&(v.push(L.end-L.start),T+=L.end-L.start);let I={expectedByteCounts:v,grandTotal:T};c=new J$.ProgressDifferentialDownloadCallbackTransform(I,this.options.cancellationToken,this.options.onProgress),l.push(c)}let u=new qo.DigestTransform(this.blockAwareFileInfo.sha512);u.isValidateOnEnd=!1,l.push(u),s.on("finish",()=>{s.close(()=>{r.splice(1,1);try{u.validate()}catch(v){a(v);return}o(void 0)})}),l.push(s);let h=null;for(let v of l)v.on("error",a),h==null?h=v:h=h.pipe(v);let f=l[0],d;if(this.options.isUseMultipleRangeRequest){d=(0,JS.executeTasksUsingMultipleRangeRequests)(this,e,f,i,a),d(0);return}let y=0,A=null;this.logger.info("Differential download: ".concat(this.options.newUrl));let E=this.createRequestOptions();E.redirect="manual",d=v=>{var T,I;if(v>=e.length){this.fileMetadataBuffer!=null&&f.write(this.fileMetadataBuffer),f.end();return}let L=e[v++];if(L.kind===Ul.OperationKind.COPY){c&&c.beginFileCopy(),(0,X$.copyData)(L,f,i,a,()=>d(v));return}let oe="bytes=".concat(L.start,"-").concat(L.end-1);E.headers.range=oe,(I=(T=this.logger)===null||T===void 0?void 0:T.debug)===null||I===void 0||I.call(T,"download range: ".concat(oe)),c&&c.beginRangeDownload();let B=this.httpExecutor.createRequest(E,z=>{z.on("error",a),z.on("aborted",()=>{a(new Error("response has been aborted by the server"))}),z.statusCode>=400&&a((0,qo.createHttpError)(z)),z.pipe(f,{end:!1}),z.once("end",()=>{c&&c.endRangeDownload(),++y===100?(y=0,setTimeout(()=>d(v),1e3)):d(v)})});B.on("redirect",(z,S,F)=>{this.logger.info("Redirect to ".concat(Z$(F))),A=F,(0,qo.configureRequestUrl)(new K$.URL(A),E),B.followRedirect()}),this.httpExecutor.addErrorAndTimeoutHandlers(B,a),B.end()},d(0)})}async readRemoteBytes(e,r){let i=Buffer.allocUnsafe(r+1-e),n=this.createRequestOptions();n.headers.range="bytes=".concat(e,"-").concat(r);let s=0;if(await this.request(n,o=>{o.copy(i,s),s+=o.length}),s!==i.length)throw new Error("Received data length ".concat(s," is not equal to expected ").concat(i.length));return i}request(e,r){return new Promise((i,n)=>{let s=this.httpExecutor.createRequest(e,o=>{(0,JS.checkIsRangesSupported)(o,n)&&(o.on("error",n),o.on("aborted",()=>{n(new Error("response has been aborted by the server"))}),o.on("data",r),o.on("end",()=>i()))});this.httpExecutor.addErrorAndTimeoutHandlers(s,n),s.end()})}};Bl.DifferentialDownloader=Gf;function ZS(t,e=" KB"){return new Intl.NumberFormat("en").format((t/1024).toFixed(2))+e}function Z$(t){let e=t.indexOf("?");return e<0?t:t.substring(0,e)}});var eb=w(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});jl.GenericDifferentialDownloader=void 0;var ek=zf(),Vf=class extends ek.DifferentialDownloader{download(e,r){return this.doDownload(e,r)}};jl.GenericDifferentialDownloader=Vf});var Wl=w(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.NoOpLogger=ns.AppUpdater=void 0;var rt=Ne(),tk=require("crypto"),rk=require("os"),ik=require("events"),rs=gr(),nk=rl(),Yf=G0(),Xi=require("path"),Ki=sf(),tb=gS(),sk=AS(),rb=SS(),ok=Cf(),is=Ji(),Qf=HS(),ak=require("zlib"),lk=ii(),uk=eb(),Xf=class t extends ik.EventEmitter{get channel(){return this._channel}set channel(e){if(this._channel!=null){if(typeof e!="string")throw(0,rt.newError)("Channel must be a string, but got: ".concat(e),"ERR_UPDATER_INVALID_CHANNEL");if(e.length===0)throw(0,rt.newError)("Channel must be not an empty string","ERR_UPDATER_INVALID_CHANNEL")}this._channel=e,this.allowDowngrade=!0}addAuthHeader(e){this.requestHeaders=Object.assign({},this.requestHeaders,{authorization:e})}get netSession(){return(0,rb.getNetSession)()}get logger(){return this._logger}set logger(e){this._logger=e??new Hl}set updateConfigPath(e){this.clientPromise=null,this._appUpdateConfigPath=e,this.configOnDisk=new Yf.Lazy(()=>this.loadUpdateConfig())}constructor(e,r){super(),this.autoDownload=!0,this.autoInstallOnAppQuit=!0,this.autoRunAppAfterInstall=!0,this.allowPrerelease=!1,this.fullChangelog=!1,this.allowDowngrade=!1,this.disableWebInstaller=!1,this.disableDifferentialDownload=!1,this.forceDevUpdateConfig=!1,this._channel=null,this.downloadedUpdateHelper=null,this.requestHeaders=null,this._logger=console,this.signals=new is.UpdaterSignal(this),this._appUpdateConfigPath=null,this.clientPromise=null,this.stagingUserIdPromise=new Yf.Lazy(()=>this.getOrCreateStagingUserId()),this.configOnDisk=new Yf.Lazy(()=>this.loadUpdateConfig()),this.checkForUpdatesPromise=null,this.downloadPromise=null,this.updateInfoAndProvider=null,this._testOnlyOptions=null,this.on("error",s=>{this._logger.error("Error: ".concat(s.stack||s.message))}),r==null?(this.app=new sk.ElectronAppAdapter,this.httpExecutor=new rb.ElectronHttpExecutor((s,o)=>this.emit("login",s,o))):(this.app=r,this.httpExecutor=null);let i=this.app.version,n=(0,Ki.parse)(i);if(n==null)throw(0,rt.newError)('App version is not a valid semver version: "'.concat(i,'"'),"ERR_UPDATER_INVALID_VERSION");this.currentVersion=n,this.allowPrerelease=ck(n),e!=null&&(this.setFeedURL(e),typeof e!="string"&&e.requestHeaders&&(this.requestHeaders=e.requestHeaders))}getFeedURL(){return"Deprecated. Do not use it."}setFeedURL(e){let r=this.createProviderRuntimeOptions(),i;typeof e=="string"?i=new ok.GenericProvider({provider:"generic",url:e},this,{...r,isUseMultipleRangeRequest:(0,Qf.isUrlProbablySupportMultiRangeRequests)(e)}):i=(0,Qf.createClient)(e,this,r),this.clientPromise=Promise.resolve(i)}checkForUpdates(){if(!this.isUpdaterActive())return Promise.resolve(null);let e=this.checkForUpdatesPromise;if(e!=null)return this._logger.info("Checking for update (already in progress)"),e;let r=()=>this.checkForUpdatesPromise=null;return this._logger.info("Checking for update"),e=this.doCheckForUpdates().then(i=>(r(),i)).catch(i=>{throw r(),this.emit("error",i,"Cannot check for updates: ".concat((i.stack||i).toString())),i}),this.checkForUpdatesPromise=e,e}isUpdaterActive(){return this.app.isPackaged||this.forceDevUpdateConfig?!0:(this._logger.info("Skip checkForUpdates because application is not packed and dev update config is not forced"),!1)}checkForUpdatesAndNotify(e){return this.checkForUpdates().then(r=>r?.downloadPromise?(r.downloadPromise.then(()=>{let i=t.formatDownloadNotification(r.updateInfo.version,this.app.name,e);new(require("electron")).Notification(i).show()}),r):(this._logger.debug!=null&&this._logger.debug("checkForUpdatesAndNotify called, downloadPromise is null"),r))}static formatDownloadNotification(e,r,i){return i==null&&(i={title:"A new update is ready to install",body:"{appName} version {version} has been downloaded and will be automatically installed on exit"}),i={title:i.title.replace("{appName}",r).replace("{version}",e),body:i.body.replace("{appName}",r).replace("{version}",e)},i}async isStagingMatch(e){let r=e.stagingPercentage,i=r;if(i==null)return!0;if(i=parseInt(i,10),isNaN(i))return this._logger.warn("Staging percentage is NaN: ".concat(r)),!0;i=i/100;let n=await this.stagingUserIdPromise.value,o=rt.UUID.parse(n).readUInt32BE(12)/4294967295;return this._logger.info("Staging percentage: ".concat(i,", percentage: ").concat(o,", user id: ").concat(n)),o<i}computeFinalHeaders(e){return this.requestHeaders!=null&&Object.assign(e,this.requestHeaders),e}async isUpdateAvailable(e){let r=(0,Ki.parse)(e.version);if(r==null)throw(0,rt.newError)('This file could not be downloaded, or the latest version (from update server) does not have a valid semver version: "'.concat(e.version,'"'),"ERR_UPDATER_INVALID_VERSION");let i=this.currentVersion;if((0,Ki.eq)(r,i))return!1;let n=e?.minimumSystemVersion,s=(0,rk.release)();if(n)try{if((0,Ki.lt)(s,n))return this._logger.info("Current OS version ".concat(s," is less than the minimum OS version required ").concat(n," for version ").concat(s)),!1}catch(c){this._logger.warn("Failed to compare current OS version(".concat(s,") with minimum OS version(").concat(n,"): ").concat((c.message||c).toString()))}if(!await this.isStagingMatch(e))return!1;let a=(0,Ki.gt)(r,i),l=(0,Ki.lt)(r,i);return a?!0:this.allowDowngrade&&l}async getUpdateInfoAndProvider(){await this.app.whenReady(),this.clientPromise==null&&(this.clientPromise=this.configOnDisk.value.then(i=>(0,Qf.createClient)(i,this,this.createProviderRuntimeOptions())));let e=await this.clientPromise,r=await this.stagingUserIdPromise.value;return e.setRequestHeaders(this.computeFinalHeaders({"x-user-staging-id":r})),{info:await e.getLatestVersion(),provider:e}}createProviderRuntimeOptions(){return{isUseMultipleRangeRequest:!0,platform:this._testOnlyOptions==null?process.platform:this._testOnlyOptions.platform,executor:this.httpExecutor}}async doCheckForUpdates(){this.emit("checking-for-update");let e=await this.getUpdateInfoAndProvider(),r=e.info;if(!await this.isUpdateAvailable(r))return this._logger.info("Update for version ".concat(this.currentVersion.format()," is not available (latest version: ").concat(r.version,", downgrade is ").concat(this.allowDowngrade?"allowed":"disallowed",").")),this.emit("update-not-available",r),{versionInfo:r,updateInfo:r};this.updateInfoAndProvider=e,this.onUpdateAvailable(r);let i=new rt.CancellationToken;return{versionInfo:r,updateInfo:r,cancellationToken:i,downloadPromise:this.autoDownload?this.downloadUpdate(i):null}}onUpdateAvailable(e){this._logger.info("Found version ".concat(e.version," (url: ").concat((0,rt.asArray)(e.files).map(r=>r.url).join(", "),")")),this.emit("update-available",e)}downloadUpdate(e=new rt.CancellationToken){let r=this.updateInfoAndProvider;if(r==null){let n=new Error("Please check update first");return this.dispatchError(n),Promise.reject(n)}if(this.downloadPromise!=null)return this._logger.info("Downloading update (already in progress)"),this.downloadPromise;this._logger.info("Downloading update from ".concat((0,rt.asArray)(r.info.files).map(n=>n.url).join(", ")));let i=n=>{if(!(n instanceof rt.CancellationError))try{this.dispatchError(n)}catch(s){this._logger.warn("Cannot dispatch error event: ".concat(s.stack||s))}return n};return this.downloadPromise=this.doDownloadUpdate({updateInfoAndProvider:r,requestHeaders:this.computeRequestHeaders(r.provider),cancellationToken:e,disableWebInstaller:this.disableWebInstaller,disableDifferentialDownload:this.disableDifferentialDownload}).catch(n=>{throw i(n)}).finally(()=>{this.downloadPromise=null}),this.downloadPromise}dispatchError(e){this.emit("error",e,(e.stack||e).toString())}dispatchUpdateDownloaded(e){this.emit(is.UPDATE_DOWNLOADED,e)}async loadUpdateConfig(){return this._appUpdateConfigPath==null&&(this._appUpdateConfigPath=this.app.appUpdateConfigPath),(0,nk.load)(await(0,rs.readFile)(this._appUpdateConfigPath,"utf-8"))}computeRequestHeaders(e){let r=e.fileExtraDownloadHeaders;if(r!=null){let i=this.requestHeaders;return i==null?r:{...r,...i}}return this.computeFinalHeaders({accept:"*/*"})}async getOrCreateStagingUserId(){let e=Xi.join(this.app.userDataPath,".updaterId");try{let i=await(0,rs.readFile)(e,"utf-8");if(rt.UUID.check(i))return i;this._logger.warn("Staging user id file exists, but content was invalid: ".concat(i))}catch(i){i.code!=="ENOENT"&&this._logger.warn("Couldn't read staging user ID, creating a blank one: ".concat(i))}let r=rt.UUID.v5((0,tk.randomBytes)(4096),rt.UUID.OID);this._logger.info("Generated new staging user ID: ".concat(r));try{await(0,rs.outputFile)(e,r)}catch(i){this._logger.warn("Couldn't write out staging user ID: ".concat(i))}return r}get isAddNoCacheQuery(){let e=this.requestHeaders;if(e==null)return!0;for(let r of Object.keys(e)){let i=r.toLowerCase();if(i==="authorization"||i==="private-token")return!1}return!0}async getOrCreateDownloadHelper(){let e=this.downloadedUpdateHelper;if(e==null){let r=(await this.configOnDisk.value).updaterCacheDirName,i=this._logger;r==null&&i.error("updaterCacheDirName is not specified in app-update.yml Was app build using at least electron-builder 20.34.0?");let n=Xi.join(this.app.baseCachePath,r||this.app.name);i.debug!=null&&i.debug("updater cache dir: ".concat(n)),e=new tb.DownloadedUpdateHelper(n),this.downloadedUpdateHelper=e}return e}async executeDownload(e){let r=e.fileInfo,i={headers:e.downloadUpdateOptions.requestHeaders,cancellationToken:e.downloadUpdateOptions.cancellationToken,sha2:r.info.sha2,sha512:r.info.sha512};this.listenerCount(is.DOWNLOAD_PROGRESS)>0&&(i.onProgress=T=>this.emit(is.DOWNLOAD_PROGRESS,T));let n=e.downloadUpdateOptions.updateInfoAndProvider.info,s=n.version,o=r.packageInfo;function a(){let T=decodeURIComponent(e.fileInfo.url.pathname);return T.endsWith(".".concat(e.fileExtension))?Xi.basename(T):e.fileInfo.info.url}let l=await this.getOrCreateDownloadHelper(),c=l.cacheDirForPendingUpdate;await(0,rs.mkdir)(c,{recursive:!0});let u=a(),h=Xi.join(c,u),f=o==null?null:Xi.join(c,"package-".concat(s).concat(Xi.extname(o.path)||".7z")),d=async T=>(await l.setDownloadedFile(h,f,n,r,u,T),await e.done({...n,downloadedFile:h}),f==null?[h]:[h,f]),y=this._logger,A=await l.validateDownloadedPath(h,n,r,y);if(A!=null)return h=A,await d(!1);let E=async()=>(await l.clear().catch(()=>{}),await(0,rs.unlink)(h).catch(()=>{})),v=await(0,tb.createTempUpdateFile)("temp-".concat(u),c,y);try{await e.task(v,i,f,E),await(0,rt.retry)(()=>(0,rs.rename)(v,h),60,500,0,0,T=>T instanceof Error&&/^EBUSY:/.test(T.message))}catch(T){throw await E(),T instanceof rt.CancellationError&&(y.info("cancelled"),this.emit("update-cancelled",n)),T}return y.info("New version ".concat(s," has been downloaded to ").concat(h)),await d(!0)}async differentialDownloadInstaller(e,r,i,n,s){try{if(this._testOnlyOptions!=null&&!this._testOnlyOptions.isUseDifferentialDownload)return!0;let o=(0,lk.blockmapFiles)(e.url,this.app.version,r.updateInfoAndProvider.info.version);this._logger.info('Download block maps (old: "'.concat(o[0],'", new: ').concat(o[1],")"));let a=async u=>{let h=await this.httpExecutor.downloadToBuffer(u,{headers:r.requestHeaders,cancellationToken:r.cancellationToken});if(h==null||h.length===0)throw new Error('Blockmap "'.concat(u.href,'" is empty'));try{return JSON.parse((0,ak.gunzipSync)(h).toString())}catch(f){throw new Error('Cannot parse blockmap "'.concat(u.href,'", error: ').concat(f))}},l={newUrl:e.url,oldFile:Xi.join(this.downloadedUpdateHelper.cacheDir,s),logger:this._logger,newFile:i,isUseMultipleRangeRequest:n.isUseMultipleRangeRequest,requestHeaders:r.requestHeaders,cancellationToken:r.cancellationToken};this.listenerCount(is.DOWNLOAD_PROGRESS)>0&&(l.onProgress=u=>this.emit(is.DOWNLOAD_PROGRESS,u));let c=await Promise.all(o.map(u=>a(u)));return await new uk.GenericDifferentialDownloader(e.info,this.httpExecutor,l).download(c[0],c[1]),!1}catch(o){if(this._logger.error("Cannot download differentially, fallback to full download: ".concat(o.stack||o)),this._testOnlyOptions!=null)throw o;return!0}}};ns.AppUpdater=Xf;function ck(t){let e=(0,Ki.prerelease)(t);return e!=null&&e.length>0}var Hl=class{info(e){}warn(e){}error(e){}};ns.NoOpLogger=Hl});var ss=w(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.BaseUpdater=void 0;var ib=require("child_process"),hk=Wl(),Kf=class extends hk.AppUpdater{constructor(e,r){super(e,r),this.quitAndInstallCalled=!1,this.quitHandlerAdded=!1}quitAndInstall(e=!1,r=!1){this._logger.info("Install on explicit quitAndInstall"),this.install(e,e?r:this.autoRunAppAfterInstall)?setImmediate(()=>{require("electron").autoUpdater.emit("before-quit-for-update"),this.app.quit()}):this.quitAndInstallCalled=!1}executeDownload(e){return super.executeDownload({...e,done:r=>(this.dispatchUpdateDownloaded(r),this.addQuitHandler(),Promise.resolve())})}install(e=!1,r=!1){if(this.quitAndInstallCalled)return this._logger.warn("install call ignored: quitAndInstallCalled is set to true"),!1;let i=this.downloadedUpdateHelper,n=i&&i.file?process.platform==="linux"?i.file.replace(/ /g,"\\ "):i.file:null,s=i==null?null:i.downloadedFileInfo;if(n==null||s==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;this.quitAndInstallCalled=!0;try{return this._logger.info("Install: isSilent: ".concat(e,", isForceRunAfter: ").concat(r)),this.doInstall({installerPath:n,isSilent:e,isForceRunAfter:r,isAdminRightsRequired:s.isAdminRightsRequired})}catch(o){return this.dispatchError(o),!1}}addQuitHandler(){this.quitHandlerAdded||!this.autoInstallOnAppQuit||(this.quitHandlerAdded=!0,this.app.onQuit(e=>{if(this.quitAndInstallCalled){this._logger.info("Update installer has already been triggered. Quitting application.");return}if(!this.autoInstallOnAppQuit){this._logger.info("Update will not be installed on quit because autoInstallOnAppQuit is set to false.");return}if(e!==0){this._logger.info("Update will be not installed on quit because application is quitting with exit code ".concat(e));return}this._logger.info("Auto install update on quit"),this.install(!0,!1)}))}wrapSudo(){let{name:e}=this.app,r='"'.concat(e,' would like to update"'),i=this.spawnSyncLog("which gksudo || which kdesudo || which pkexec || which beesu"),n=[i];return/kdesudo/i.test(i)?(n.push("--comment",r),n.push("-c")):/gksudo/i.test(i)?n.push("--message",r):/pkexec/i.test(i)&&n.push("--disable-internal-agent"),n.join(" ")}spawnSyncLog(e,r=[],i={}){return this._logger.info("Executing: ".concat(e," with args: ").concat(r)),(0,ib.spawnSync)(e,r,{env:{...process.env,...i},encoding:"utf-8",shell:!0}).stdout.trim()}async spawnLog(e,r=[],i=void 0,n="ignore"){return this._logger.info("Executing: ".concat(e," with args: ").concat(r)),new Promise((s,o)=>{try{let a={stdio:n,env:i,detached:!0},l=(0,ib.spawn)(e,r,a);l.on("error",c=>{o(c)}),l.unref(),l.pid!==void 0&&s(!0)}catch(a){o(a)}})}};Gl.BaseUpdater=Kf});var Zf=w(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});zl.FileWithEmbeddedBlockMapDifferentialDownloader=void 0;var os=gr(),fk=zf(),dk=require("zlib"),Jf=class extends fk.DifferentialDownloader{async download(){let e=this.blockAwareFileInfo,r=e.size,i=r-(e.blockMapSize+4);this.fileMetadataBuffer=await this.readRemoteBytes(i,r-1);let n=nb(this.fileMetadataBuffer.slice(0,this.fileMetadataBuffer.length-4));await this.doDownload(await pk(this.options.oldFile),n)}};zl.FileWithEmbeddedBlockMapDifferentialDownloader=Jf;function nb(t){return JSON.parse((0,dk.inflateRawSync)(t).toString())}async function pk(t){let e=await(0,os.open)(t,"r");try{let r=(await(0,os.fstat)(e)).size,i=Buffer.allocUnsafe(4);await(0,os.read)(e,i,0,i.length,r-i.length);let n=Buffer.allocUnsafe(i.readUInt32BE(0));return await(0,os.read)(e,n,0,n.length,r-i.length-n.length),await(0,os.close)(e),nb(n)}catch(r){throw await(0,os.close)(e),r}}});var td=w(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.AppImageUpdater=void 0;var sb=Ne(),ob=require("child_process"),mk=gr(),gk=require("fs"),Mo=require("path"),yk=ss(),wk=Zf(),ab=Ji(),Ak=Dt(),ed=class extends yk.BaseUpdater{constructor(e,r){super(e,r)}isUpdaterActive(){return process.env.APPIMAGE==null?(process.env.SNAP==null?this._logger.warn("APPIMAGE env is not defined, current application is not an AppImage"):this._logger.info("SNAP env is defined, updater is disabled"),!1):super.isUpdaterActive()}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Ak.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"AppImage",["rpm","deb"]);return this.executeDownload({fileExtension:"AppImage",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{let o=process.env.APPIMAGE;if(o==null)throw(0,sb.newError)("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");let a=!1;try{let l={newUrl:i.url,oldFile:o,logger:this._logger,newFile:n,isUseMultipleRangeRequest:r.isUseMultipleRangeRequest,requestHeaders:e.requestHeaders,cancellationToken:e.cancellationToken};this.listenerCount(ab.DOWNLOAD_PROGRESS)>0&&(l.onProgress=c=>this.emit(ab.DOWNLOAD_PROGRESS,c)),await new wk.FileWithEmbeddedBlockMapDifferentialDownloader(i.info,this.httpExecutor,l).download()}catch(l){this._logger.error("Cannot download differentially, fallback to full download: ".concat(l.stack||l)),a=process.platform==="linux"}a&&await this.httpExecutor.download(i.url,n,s),await(0,mk.chmod)(n,493)}})}doInstall(e){let r=process.env.APPIMAGE;if(r==null)throw(0,sb.newError)("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");(0,gk.unlinkSync)(r);let i,n=Mo.basename(r);Mo.basename(e.installerPath)===n||!/\d+\.\d+\.\d+/.test(n)?i=r:i=Mo.join(Mo.dirname(r),Mo.basename(e.installerPath)),(0,ob.execFileSync)("mv",["-f",e.installerPath,i]),i!==r&&this.emit("appimage-filename-updated",i);let s={...process.env,APPIMAGE_SILENT_INSTALL:"true"};return e.isForceRunAfter?this.spawnLog(i,[],s):(s.APPIMAGE_EXIT_AFTER_INSTALL="true",(0,ob.execFileSync)(i,[],{env:s})),!0}};Vl.AppImageUpdater=ed});var id=w(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});Yl.DebUpdater=void 0;var Ek=ss(),lb=Ji(),Sk=Dt(),rd=class extends Ek.BaseUpdater{constructor(e,r){super(e,r)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Sk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"deb",["AppImage","rpm"]);return this.executeDownload({fileExtension:"deb",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{this.listenerCount(lb.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(lb.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(i.url,n,s)}})}doInstall(e){let r=this.wrapSudo(),i=/pkexec/i.test(r)?"":'"',n=["dpkg","-i",e.installerPath,"||","apt-get","install","-f","-y"];return this.spawnSyncLog(r,["".concat(i,"/bin/bash"),"-c","'".concat(n.join(" "),"'").concat(i)]),e.isForceRunAfter&&this.app.relaunch(),!0}};Yl.DebUpdater=rd});var sd=w(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});Ql.RpmUpdater=void 0;var bk=ss(),ub=Ji(),_k=Dt(),nd=class extends bk.BaseUpdater{constructor(e,r){super(e,r)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,_k.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"rpm",["AppImage","deb"]);return this.executeDownload({fileExtension:"rpm",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{this.listenerCount(ub.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(ub.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(i.url,n,s)}})}doInstall(e){let r=e.installerPath,i=this.wrapSudo(),n=/pkexec/i.test(i)?"":'"',s=this.spawnSyncLog("which zypper"),o;return s?o=[s,"--no-refresh","install","--allow-unsigned-rpm","-y","-f",r]:o=[this.spawnSyncLog("which dnf || which yum"),"-y","install",r],this.spawnSyncLog(i,["".concat(n,"/bin/bash"),"-c","'".concat(o.join(" "),"'").concat(n)]),e.isForceRunAfter&&this.app.relaunch(),!0}};Ql.RpmUpdater=nd});var ad=w(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});Xl.MacUpdater=void 0;var cb=Ne(),hb=gr(),fb=require("fs"),db=require("path"),vk=require("http"),Tk=Wl(),Ok=Dt(),pb=require("child_process"),mb=require("crypto"),od=class extends Tk.AppUpdater{constructor(e,r){super(e,r),this.nativeUpdater=require("electron").autoUpdater,this.squirrelDownloadedUpdate=!1,this.nativeUpdater.on("error",i=>{this._logger.warn(i),this.emit("error",i)}),this.nativeUpdater.on("update-downloaded",()=>{this.squirrelDownloadedUpdate=!0,this.debug("nativeUpdater.update-downloaded")})}debug(e){this._logger.debug!=null&&this._logger.debug(e)}closeServerIfExists(){this.server&&(this.debug("Closing proxy server"),this.server.close(e=>{e&&this.debug("proxy server wasn't already open, probably attempted closing again as a safety check before quit")}))}async doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider.resolveFiles(e.updateInfoAndProvider.info),i=this._logger,n="sysctl.proc_translated",s=!1;try{this.debug("Checking for macOS Rosetta environment"),s=(0,pb.execFileSync)("sysctl",[n],{encoding:"utf8"}).includes("".concat(n,": 1")),i.info("Checked for macOS Rosetta environment (isRosetta=".concat(s,")"))}catch(h){i.warn("sysctl shell command to check for macOS Rosetta environment failed: ".concat(h))}let o=!1;try{this.debug("Checking for arm64 in uname");let f=(0,pb.execFileSync)("uname",["-a"],{encoding:"utf8"}).includes("ARM");i.info("Checked 'uname -a': arm64=".concat(f)),o=o||f}catch(h){i.warn("uname shell command to check for arm64 failed: ".concat(h))}o=o||process.arch==="arm64"||s;let a=h=>{var f;return h.url.pathname.includes("arm64")||((f=h.info.url)===null||f===void 0?void 0:f.includes("arm64"))};o&&r.some(a)?r=r.filter(h=>o===a(h)):r=r.filter(h=>!a(h));let l=(0,Ok.findFile)(r,"zip",["pkg","dmg"]);if(l==null)throw(0,cb.newError)("ZIP file not provided: ".concat((0,cb.safeStringifyJson)(r)),"ERR_UPDATER_ZIP_FILE_NOT_FOUND");let c=e.updateInfoAndProvider.provider,u="update.zip";return this.executeDownload({fileExtension:"zip",fileInfo:l,downloadUpdateOptions:e,task:async(h,f)=>{let d=db.join(this.downloadedUpdateHelper.cacheDir,u),y=()=>(0,hb.pathExistsSync)(d)?!e.disableDifferentialDownload:(i.info("Unable to locate previous update.zip for differential download (is this first install?), falling back to full download"),!1),A=!0;y()&&(A=await this.differentialDownloadInstaller(l,e,h,c,u)),A&&await this.httpExecutor.download(l.url,h,f)},done:h=>{if(!e.disableDifferentialDownload)try{let f=db.join(this.downloadedUpdateHelper.cacheDir,u);(0,fb.copyFileSync)(h.downloadedFile,f)}catch(f){this._logger.warn("Unable to copy file for caching for future differential downloads: ".concat(f.message))}return this.updateDownloaded(l,h)}})}async updateDownloaded(e,r){var i;let n=r.downloadedFile,s=(i=e.info.size)!==null&&i!==void 0?i:(await(0,hb.stat)(n)).size,o=this._logger,a="fileToProxy=".concat(e.url.href);this.closeServerIfExists(),this.debug("Creating proxy server for native Squirrel.Mac (".concat(a,")")),this.server=(0,vk.createServer)(),this.debug("Proxy server for native Squirrel.Mac is created (".concat(a,")")),this.server.on("close",()=>{o.info("Proxy server for native Squirrel.Mac is closed (".concat(a,")"))});let l=c=>{let u=c.address();return typeof u=="string"?u:"http://127.0.0.1:".concat(u?.port)};return await new Promise((c,u)=>{let h=(0,mb.randomBytes)(64).toString("base64").replace(/\//g,"_").replace(/\+/g,"-"),f=Buffer.from("autoupdater:".concat(h),"ascii"),d="/".concat((0,mb.randomBytes)(64).toString("hex"),".zip");this.server.on("request",(y,A)=>{let E=y.url;if(o.info("".concat(E," requested")),E==="/"){if(!y.headers.authorization||y.headers.authorization.indexOf("Basic ")===-1){A.statusCode=401,A.statusMessage="Invalid Authentication Credentials",A.end(),o.warn("No authenthication info");return}let I=y.headers.authorization.split(" ")[1],L=Buffer.from(I,"base64").toString("ascii"),[oe,B]=L.split(":");if(oe!=="autoupdater"||B!==h){A.statusCode=401,A.statusMessage="Invalid Authentication Credentials",A.end(),o.warn("Invalid authenthication credentials");return}let z=Buffer.from('{ "url": "'.concat(l(this.server)).concat(d,'" }'));A.writeHead(200,{"Content-Type":"application/json","Content-Length":z.length}),A.end(z);return}if(!E.startsWith(d)){o.warn("".concat(E," requested, but not supported")),A.writeHead(404),A.end();return}o.info("".concat(d," requested by Squirrel.Mac, pipe ").concat(n));let v=!1;A.on("finish",()=>{v||(this.nativeUpdater.removeListener("error",u),c([]))});let T=(0,fb.createReadStream)(n);T.on("error",I=>{try{A.end()}catch(L){o.warn("cannot end response: ".concat(L))}v=!0,this.nativeUpdater.removeListener("error",u),u(new Error('Cannot pipe "'.concat(n,'": ').concat(I)))}),A.writeHead(200,{"Content-Type":"application/zip","Content-Length":s}),T.pipe(A)}),this.debug("Proxy server for native Squirrel.Mac is starting to listen (".concat(a,")")),this.server.listen(0,"127.0.0.1",()=>{this.debug("Proxy server for native Squirrel.Mac is listening (address=".concat(l(this.server),", ").concat(a,")")),this.nativeUpdater.setFeedURL({url:l(this.server),headers:{"Cache-Control":"no-cache",Authorization:"Basic ".concat(f.toString("base64"))}}),this.dispatchUpdateDownloaded(r),this.autoInstallOnAppQuit?(this.nativeUpdater.once("error",u),this.nativeUpdater.checkForUpdates()):c([])})})}quitAndInstall(){this.squirrelDownloadedUpdate?(this.nativeUpdater.quitAndInstall(),this.closeServerIfExists()):(this.nativeUpdater.on("update-downloaded",()=>{this.nativeUpdater.quitAndInstall(),this.closeServerIfExists()}),this.autoInstallOnAppQuit||this.nativeUpdater.checkForUpdates())}};Xl.MacUpdater=od});var Ab=w(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.verifySignature=Rk;var gb=Ne(),wb=require("child_process"),Ck=require("os"),yb=require("path");function Rk(t,e,r){return new Promise((i,n)=>{let s=e.replace(/'/g,"''");r.info("Verifying signature ".concat(s)),(0,wb.execFile)('set "PSModulePath=" & chcp 65001 >NUL & powershell.exe',["-NoProfile","-NonInteractive","-InputFormat","None","-Command","\"Get-AuthenticodeSignature -LiteralPath '".concat(s,"' | ConvertTo-Json -Compress\"")],{shell:!0,timeout:20*1e3},(o,a,l)=>{var c;try{if(o!=null||l){ld(r,o,l,n),i(null);return}let u=Ik(a);if(u.Status===0){try{let y=yb.normalize(u.Path),A=yb.normalize(e);if(r.info("LiteralPath: ".concat(y,". Update Path: ").concat(A)),y!==A){ld(r,new Error("LiteralPath of ".concat(y," is different than ").concat(A)),l,n),i(null);return}}catch(y){r.warn("Unable to verify LiteralPath of update asset due to missing data.Path. Skipping this step of validation. Message: ".concat((c=y.message)!==null&&c!==void 0?c:y.stack))}let f=(0,gb.parseDn)(u.SignerCertificate.Subject),d=!1;for(let y of t){let A=(0,gb.parseDn)(y);if(A.size?d=Array.from(A.keys()).every(v=>A.get(v)===f.get(v)):y===f.get("CN")&&(r.warn("Signature validated using only CN ".concat(y,". Please add your full Distinguished Name (DN) to publisherNames configuration")),d=!0),d){i(null);return}}}let h="publisherNames: ".concat(t.join(" | "),", raw info: ")+JSON.stringify(u,(f,d)=>f==="RawData"?void 0:d,2);r.warn("Sign verification failed, installer signed with incorrect certificate: ".concat(h)),i(h)}catch(u){ld(r,u,null,n),i(null);return}})})}function Ik(t){let e=JSON.parse(t);delete e.PrivateKey,delete e.IsOSBinary,delete e.SignatureType;let r=e.SignerCertificate;return r!=null&&(delete r.Archived,delete r.Extensions,delete r.Handle,delete r.HasPrivateKey,delete r.SubjectName),e}function ld(t,e,r,i){if(Nk()){t.warn("Cannot execute Get-AuthenticodeSignature: ".concat(e||r,". Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher."));return}try{(0,wb.execFileSync)("powershell.exe",["-NoProfile","-NonInteractive","-Command","ConvertTo-Json test"],{timeout:10*1e3})}catch(n){t.warn("Cannot execute ConvertTo-Json: ".concat(n.message,". Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher."));return}e!=null&&i(e),r&&i(new Error("Cannot execute Get-AuthenticodeSignature, stderr: ".concat(r,". Failing signature validation due to unknown stderr.")))}function Nk(){let t=Ck.release();return t.startsWith("6.")&&!t.startsWith("6.3")}});var hd=w(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});Jl.NsisUpdater=void 0;var Kl=Ne(),Eb=require("path"),xk=ss(),Dk=Zf(),Sb=Ji(),Pk=Dt(),Fk=gr(),Lk=Ab(),bb=require("url"),cd=class extends xk.BaseUpdater{constructor(e,r){super(e,r),this._verifyUpdateCodeSignature=(i,n)=>(0,Lk.verifySignature)(i,n,this._logger)}get verifyUpdateCodeSignature(){return this._verifyUpdateCodeSignature}set verifyUpdateCodeSignature(e){e&&(this._verifyUpdateCodeSignature=e)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Pk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"exe");return this.executeDownload({fileExtension:"exe",downloadUpdateOptions:e,fileInfo:i,task:async(n,s,o,a)=>{let l=i.packageInfo,c=l!=null&&o!=null;if(c&&e.disableWebInstaller)throw(0,Kl.newError)("Unable to download new version ".concat(e.updateInfoAndProvider.info.version,". Web Installers are disabled"),"ERR_UPDATER_WEB_INSTALLER_DISABLED");!c&&!e.disableWebInstaller&&this._logger.warn("disableWebInstaller is set to false, you should set it to true if you do not plan on using a web installer. This will default to true in a future version."),(c||e.disableDifferentialDownload||await this.differentialDownloadInstaller(i,e,n,r,Kl.CURRENT_APP_INSTALLER_FILE_NAME))&&await this.httpExecutor.download(i.url,n,s);let u=await this.verifySignature(n);if(u!=null)throw await a(),(0,Kl.newError)("New version ".concat(e.updateInfoAndProvider.info.version," is not signed by the application owner: ").concat(u),"ERR_UPDATER_INVALID_SIGNATURE");if(c&&await this.differentialDownloadWebPackage(e,l,o,r))try{await this.httpExecutor.download(new bb.URL(l.path),o,{headers:e.requestHeaders,cancellationToken:e.cancellationToken,sha512:l.sha512})}catch(h){try{await(0,Fk.unlink)(o)}catch{}throw h}}})}async verifySignature(e){let r;try{if(r=(await this.configOnDisk.value).publisherName,r==null)return null}catch(i){if(i.code==="ENOENT")return null;throw i}return await this._verifyUpdateCodeSignature(Array.isArray(r)?r:[r],e)}doInstall(e){let r=["--updated"];e.isSilent&&r.push("/S"),e.isForceRunAfter&&r.push("--force-run"),this.installDirectory&&r.push("/D=".concat(this.installDirectory));let i=this.downloadedUpdateHelper==null?null:this.downloadedUpdateHelper.packageFile;i!=null&&r.push("--package-file=".concat(i));let n=()=>{this.spawnLog(Eb.join(process.resourcesPath,"elevate.exe"),[e.installerPath].concat(r)).catch(s=>this.dispatchError(s))};return e.isAdminRightsRequired?(this._logger.info("isAdminRightsRequired is set to true, run installer using elevate.exe"),n(),!0):(this.spawnLog(e.installerPath,r).catch(s=>{let o=s.code;this._logger.info("Cannot run installer: error code: ".concat(o,', error message: "').concat(s.message,'", will be executed again using elevate if EACCES, and will try to use electron.shell.openItem if ENOENT')),o==="UNKNOWN"||o==="EACCES"?n():o==="ENOENT"?require("electron").shell.openPath(e.installerPath).catch(a=>this.dispatchError(a)):this.dispatchError(s)}),!0)}async differentialDownloadWebPackage(e,r,i,n){if(r.blockMapSize==null)return!0;try{let s={newUrl:new bb.URL(r.path),oldFile:Eb.join(this.downloadedUpdateHelper.cacheDir,Kl.CURRENT_APP_PACKAGE_FILE_NAME),logger:this._logger,newFile:i,requestHeaders:this.requestHeaders,isUseMultipleRangeRequest:n.isUseMultipleRangeRequest,cancellationToken:e.cancellationToken};this.listenerCount(Sb.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(Sb.DOWNLOAD_PROGRESS,o)),await new Dk.FileWithEmbeddedBlockMapDifferentialDownloader(r,this.httpExecutor,s).download()}catch(s){return this._logger.error("Cannot download differentially, fallback to full download: ".concat(s.stack||s)),process.platform==="win32"}return!1}};Jl.NsisUpdater=cd});var Ji=w(K=>{"use strict";Object.defineProperty(K,"__esModule",{value:!0});K.UpdaterSignal=K.UPDATE_DOWNLOADED=K.DOWNLOAD_PROGRESS=K.NsisUpdater=K.MacUpdater=K.RpmUpdater=K.DebUpdater=K.AppImageUpdater=K.Provider=K.CancellationToken=K.NoOpLogger=K.AppUpdater=K.BaseUpdater=void 0;var $k=Ne();Object.defineProperty(K,"CancellationToken",{enumerable:!0,get:function(){return $k.CancellationToken}});var _b=gr(),kk=require("path"),qk=ss();Object.defineProperty(K,"BaseUpdater",{enumerable:!0,get:function(){return qk.BaseUpdater}});var vb=Wl();Object.defineProperty(K,"AppUpdater",{enumerable:!0,get:function(){return vb.AppUpdater}});Object.defineProperty(K,"NoOpLogger",{enumerable:!0,get:function(){return vb.NoOpLogger}});var Mk=Dt();Object.defineProperty(K,"Provider",{enumerable:!0,get:function(){return Mk.Provider}});var Uk=td();Object.defineProperty(K,"AppImageUpdater",{enumerable:!0,get:function(){return Uk.AppImageUpdater}});var Bk=id();Object.defineProperty(K,"DebUpdater",{enumerable:!0,get:function(){return Bk.DebUpdater}});var jk=sd();Object.defineProperty(K,"RpmUpdater",{enumerable:!0,get:function(){return jk.RpmUpdater}});var Hk=ad();Object.defineProperty(K,"MacUpdater",{enumerable:!0,get:function(){return Hk.MacUpdater}});var Wk=hd();Object.defineProperty(K,"NsisUpdater",{enumerable:!0,get:function(){return Wk.NsisUpdater}});var ai;function Gk(){if(process.platform==="win32")ai=new(hd()).NsisUpdater;else if(process.platform==="darwin")ai=new(ad()).MacUpdater;else{ai=new(td()).AppImageUpdater;try{let t=kk.join(process.resourcesPath,"package-type");if(!(0,_b.existsSync)(t))return ai;console.info("Checking for beta autoupdate feature for deb/rpm distributions");let e=(0,_b.readFileSync)(t).toString().trim();switch(console.info("Found package-type:",e),e){case"deb":ai=new(id()).DebUpdater;break;case"rpm":ai=new(sd()).RpmUpdater;break;default:break}}catch(t){console.warn("Unable to detect 'package-type' for autoUpdater (beta rpm/deb support). If you'd like to expand support, please consider contributing to electron-builder",t.message)}}return ai}Object.defineProperty(K,"autoUpdater",{enumerable:!0,get:()=>ai||Gk()});K.DOWNLOAD_PROGRESS="download-progress";K.UPDATE_DOWNLOADED="update-downloaded";var fd=class{constructor(e){this.emitter=e}login(e){Zl(this.emitter,"login",e)}progress(e){Zl(this.emitter,K.DOWNLOAD_PROGRESS,e)}updateDownloaded(e){Zl(this.emitter,K.UPDATE_DOWNLOADED,e)}updateCancelled(e){Zl(this.emitter,"update-cancelled",e)}};K.UpdaterSignal=fd;var zk=!1;function Zl(t,e,r){zk?t.on(e,(...i)=>{console.log("%s %s",e,i),r(...i)}):t.on(e,r)}});var Nb=w((cW,Ib)=>{var P={child:require("child_process"),crypto:require("crypto"),fs:require("fs"),os:require("os"),path:require("path"),process,util:require("util")};function Vk(t,e){var r=P.process.platform;if(r==="darwin")return Kk(t,e);if(r==="linux")return Qk(t,e);if(r==="win32")return nq(t,e);e(new Error("Platform not yet supported."))}function Pt(t){if(typeof t!="string")throw new Error("Expected a string.");return t.replace(/"/g,'\\"')}function Yk(){if(arguments.length<1||arguments.length>3)throw new Error("Wrong number of arguments.");var t=arguments[0],e={},r=function(){};if(typeof t!="string")throw new Error("Command should be a string.");if(arguments.length===2)if(P.util.isObject(arguments[1]))e=arguments[1];else if(P.util.isFunction(arguments[1]))r=arguments[1];else throw new Error("Expected options or callback.");else if(arguments.length===3){if(P.util.isObject(arguments[1]))e=arguments[1];else throw new Error("Expected options to be an object.");if(P.util.isFunction(arguments[2]))r=arguments[2];else throw new Error("Expected callback to be a function.")}if(/^sudo/i.test(t))return r(new Error('Command should not be prefixed with "sudo".'));if(typeof e.name>"u"){var i=P.process.title;if(Tb(i))e.name=i;else return r(new Error("process.title cannot be used as a valid name."))}else if(!Tb(e.name)){var n="";return n+="options.name must be alphanumeric only ",n+="(spaces are allowed) and <= 70 characters.",r(new Error(n))}if(typeof e.icns<"u"){if(typeof e.icns!="string")return r(new Error("options.icns must be a string if provided."));if(e.icns.trim().length===0)return r(new Error("options.icns must not be empty if provided."))}if(typeof e.env<"u"){if(typeof e.env!="object")return r(new Error("options.env must be an object if provided."));if(Object.keys(e.env).length===0)return r(new Error("options.env must not be empty if provided."));for(var s in e.env){var o=e.env[s];if(typeof s!="string"||typeof o!="string")return r(new Error("options.env environment variables must be strings."));if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(s))return r(new Error("options.env has an invalid environment variable name: "+JSON.stringify(s)));if(/[\r\n]/.test(o))return r(new Error("options.env has an invalid environment variable value: "+JSON.stringify(o)))}}var a=P.process.platform;if(a!=="darwin"&&a!=="linux"&&a!=="win32")return r(new Error("Platform not yet supported."));var l={command:t,options:e,uuid:void 0,path:void 0};Vk(l,r)}function Qk(t,e){Xk(t,function(r,i){if(r)return e(r);var n=[];n.push('cd "'+Pt(P.process.cwd())+'";');for(var s in t.options.env){var o=t.options.env[s];n.push("export "+s+'="'+Pt(o)+'";')}n.push('"'+Pt(i)+'"'),/kdesudo/i.test(i)?(n.push("--comment",'"'+t.options.name+' wants to make changes. Enter your password to allow this."'),n.push("-d"),n.push("--")):/pkexec/i.test(i)&&n.push("--disable-internal-agent");var a="SUDOPROMPT\n";n.push('/bin/bash -c "echo '+Pt(a.trim())+"; "+Pt(t.command)+'"'),n=n.join(" "),P.child.exec(n,{encoding:"utf-8",maxBuffer:hq},function(l,c,u){var h=c&&c.slice(0,a.length)===a;h&&(c=c.slice(a.length)),l&&!h&&(/No authentication agent found/.test(u)?l.message=cq:l.message=eu),e(l,c,u)})})}function Xk(t,e){var r=0,i=["/usr/bin/kdesudo","/usr/bin/pkexec"];function n(){if(r===i.length)return e(new Error("Unable to find pkexec or kdesudo."));var s=i[r++];P.fs.stat(s,function(o){if(o){if(o.code==="ENOTDIR"||o.code==="ENOENT")return n();e(o)}else e(void 0,s)})}n()}function Kk(t,e){var r=P.os.tmpdir();if(!r)return e(new Error("os.tmpdir() not defined."));var i=P.process.env.USER;if(!i)return e(new Error("env['USER'] not defined."));Cb(t,function(n,s){if(n)return e(n);t.uuid=s,t.path=P.path.join(r,t.uuid,t.options.name+".app");function o(a,l,c){Ob(P.path.dirname(t.path),function(u){if(a)return e(a);if(u)return e(u);e(void 0,l,c)})}Jk(t,function(a,l,c){if(a)return o(a,l,c);eq(t,function(u){if(u)return o(u);rq(t,function(h,f,d){if(h)return o(h,f,d);Zk(t,function(y){if(y)return o(y);tq(t,function(A,E,v){if(A)return o(A,E,v);iq(t,o)})})})})})})}function Jk(t,e){var r=P.path.dirname(t.path);P.fs.mkdir(r,function(i){if(i)return e(i);var n=P.path.join(r,"sudo-prompt-applet.zip");P.fs.writeFile(n,uq,"base64",function(s){if(s)return e(s);var o=[];o.push("/usr/bin/unzip"),o.push("-o"),o.push('"'+Pt(n)+'"'),o.push('-d "'+Pt(t.path)+'"'),o=o.join(" "),P.child.exec(o,{encoding:"utf-8"},e)})})}function Zk(t,e){var r=P.path.join(t.path,"Contents","MacOS","sudo-prompt-command"),i=[];i.push('cd "'+Pt(P.process.cwd())+'"');for(var n in t.options.env){var s=t.options.env[n];i.push("export "+n+'="'+Pt(s)+'"')}i.push(t.command),i=i.join("\n"),P.fs.writeFile(r,i,"utf-8",e)}function eq(t,e){if(!t.options.icns)return e();P.fs.readFile(t.options.icns,function(r,i){if(r)return e(r);var n=P.path.join(t.path,"Contents","Resources","applet.icns");P.fs.writeFile(n,i,e)})}function tq(t,e){var r=P.path.join(t.path,"Contents","MacOS","applet"),i={cwd:P.path.dirname(r),encoding:"utf-8"};P.child.exec("./"+P.path.basename(r),i,e)}function rq(t,e){var r=P.path.join(t.path,"Contents","Info.plist"),i=Pt(r),n=Pt("CFBundleName"),s=t.options.name+" Password Prompt";if(/'/.test(s))return e(new Error("Value should not contain single quotes."));var o=[];o.push("/usr/bin/defaults"),o.push("write"),o.push('"'+i+'"'),o.push('"'+n+'"'),o.push("'"+s+"'"),o=o.join(" "),P.child.exec(o,{encoding:"utf-8"},e)}function iq(t,e){var r=P.path.join(t.path,"Contents","MacOS");P.fs.readFile(P.path.join(r,"code"),"utf-8",function(i,n){if(i){if(i.code==="ENOENT")return e(new Error(eu));e(i)}else P.fs.readFile(P.path.join(r,"stdout"),"utf-8",function(s,o){if(s)return e(s);P.fs.readFile(P.path.join(r,"stderr"),"utf-8",function(a,l){if(a)return e(a);n=parseInt(n.trim(),10),n===0?e(void 0,o,l):(a=new Error("Command failed: "+t.command+"\n"+l),a.code=n,e(a,o,l))})})})}function Ob(t,e){if(typeof t!="string"||!t.trim())return e(new Error("Argument path not defined."));var r=[];if(P.process.platform==="win32"){if(/"/.test(t))return e(new Error("Argument path cannot contain double-quotes."));r.push('rmdir /s /q "'+t+'"')}else r.push("/bin/rm"),r.push("-rf"),r.push('"'+Pt(P.path.normalize(t))+'"');r=r.join(" "),P.child.exec(r,{encoding:"utf-8"},e)}function Cb(t,e){P.crypto.randomBytes(256,function(r,i){r&&(i=Date.now()+""+Math.random());var n=P.crypto.createHash("SHA256");n.update("sudo-prompt-3"),n.update(t.options.name),n.update(t.command),n.update(i);var s=n.digest("hex").slice(-32);if(!s||typeof s!="string"||s.length!==32)return e(new Error("Expected a valid UUID."));e(void 0,s)})}function Tb(t){return!(!/^[a-z0-9 ]+$/i.test(t)||t.trim().length===0||t.length>70)}function nq(t,e){var r=P.os.tmpdir();if(!r)return e(new Error("os.tmpdir() not defined."));Cb(t,function(i,n){if(i)return e(i);if(t.uuid=n,t.path=P.path.join(r,t.uuid),/"/.test(t.path))return e(new Error("instance.path cannot contain double-quotes."));t.pathElevate=P.path.join(t.path,"elevate.vbs"),t.pathExecute=P.path.join(t.path,"execute.bat"),t.pathCommand=P.path.join(t.path,"command.bat"),t.pathStdout=P.path.join(t.path,"stdout"),t.pathStderr=P.path.join(t.path,"stderr"),t.pathStatus=P.path.join(t.path,"status"),P.fs.mkdir(t.path,function(s){if(s)return e(s);function o(a,l,c){Ob(t.path,function(u){if(a)return e(a);if(u)return e(u);e(void 0,l,c)})}lq(t,function(a){if(a)return o(a);aq(t,function(l){if(l)return o(l);sq(t,function(c,u,h){if(c)return o(c,u,h);Rb(t,function(f){if(f)return o(f);oq(t,o)})})})})})})}function sq(t,e){var r=[];r.push("powershell.exe"),r.push("Start-Process"),r.push("-FilePath"),r.push("\"'"+t.pathExecute.replace(/'/g,"`'")+"'\""),r.push("-WindowStyle hidden"),r.push("-Verb runAs"),r=r.join(" ");var i=P.child.exec(r,{encoding:"utf-8"},function(n,s,o){if(n)return e(new Error(eu),s,o);e()});i.stdin.end()}function oq(t,e){P.fs.readFile(t.pathStatus,"utf-8",function(r,i){if(r)return e(r);P.fs.readFile(t.pathStdout,"utf-8",function(n,s){if(n)return e(n);P.fs.readFile(t.pathStderr,"utf-8",function(o,a){if(o)return e(o);i=parseInt(i.trim(),10),i===0?e(void 0,s,a):(o=new Error("Command failed: "+t.command+"\r\n"+a),o.code=i,e(o,s,a))})})})}function Rb(t,e){P.fs.stat(t.pathStatus,function(r,i){r&&r.code==="ENOENT"||i.size<2?setTimeout(function(){P.fs.stat(t.pathStdout,function(n){if(n)return e(new Error(eu));Rb(t,e)})},1e3):r?e(r):e()})}function aq(t,e){var r=P.process.cwd();if(/"/.test(r))return e(new Error("process.cwd() cannot contain double-quotes."));var i=[];i.push("@echo off"),i.push("chcp 65001>nul"),i.push('cd /d "'+r+'"');for(var n in t.options.env){var s=t.options.env[n];i.push("set "+n+"="+s.replace(/([<>\\|&^])/g,"^$1"))}i.push(t.command),i=i.join("\r\n"),P.fs.writeFile(t.pathCommand,i,"utf-8",e)}function lq(t,e){var r=[];r.push("@echo off"),r.push('call "'+t.pathCommand+'" > "'+t.pathStdout+'" 2> "'+t.pathStderr+'"'),r.push('(echo %ERRORLEVEL%) > "'+t.pathStatus+'"'),r=r.join("\r\n"),P.fs.writeFile(t.pathExecute,r,"utf-8",e)}Ib.exports.exec=Yk;var uq="UEsDBAoAAAAAAO1YcEcAAAAAAAAAAAAAAAAJABwAQ29udGVudHMvVVQJAAPNnElWLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACACgeXBHlHaGqKEBAAC+AwAAEwAcAENvbnRlbnRzL0luZm8ucGxpc3RVVAkAA1zWSVYtkRBXdXgLAAEE9QEAAAQUAAAAfZNRb5swFIWfl1/BeA9OpSmqJkqVBCJFop1VyKQ9Ta59S6wa27NNCfv1M0naJWTsEXO+c8+9vo7v97UI3sBYruRdeBPNwgAkVYzL6i7cluvpbXifTOLP6bdV+QNngRbcugBvl/lmFYRThBZaC0AoLdMA55uiDLwHQtljGIQ75/RXhNq2jUiviqiqe6FF2CgNxnW5N5t6IGKOhb7M0f0ijj9lnLpk8il+hS5ZrZeNZAIWQqj2ge+B5YoSwX8T5xEbo17ktc40gIZQCm8glK5BuieovP5Dbp3xHSeZrHyCXYxO3wM+2wNtHHkWMAQP/bkxbkOVXPMxKuK0Dz6CMh+Wv3AwQ9gPM7INU1NtVK3Ha8sXlfoB+m6J6b4fRzv0mkezMf6R1Fe5MbG2VYYF+L+lMaGvpIKy01cOC4zzMazYKeNOQYuDYkjfjMcteCWJa8w/Zi2ugubFA5e8buqisw7qU81ltzB0xx3QC5/TFh7J/e385/zL+7+/wWbR/LwIOl/dvHiCXw03YFfEPJ9dwsWu5sV2kwnod3QoeLeL0eGdJJM/UEsDBAoAAAAAAHSBjkgAAAAAAAAAAAAAAAAPABwAQ29udGVudHMvTWFjT1MvVVQJAAMbpQ9XLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACABVHBdH7Dk4KTIIAADIYQAAFQAcAENvbnRlbnRzL01hY09TL2FwcGxldFVUCQADMiPZVVOlD1d1eAsAAQT1AQAABBQAAADtnG9sHEcVwGfti7M1/rONLNVtXHqpzsipis+pHOSWFOzEm25at3XrJI2ozbK+W/suuds79vaSuCKSpaOIxRy1+NSPRPAhlWj7AVRaQCWpTRz+CEo+RSKCCho4K67kVhUyAeV4b3fWt17fXZqKFgHvp8zO3/dmdmfPmtl5L7+8/uPXGWMNELZCaGRMgmjHIlxaBCibdcoGsewCljGCIAiCIAiCIAiCIP7r+M21d67zjb/zEaAdwr1bGHuWMQH2/2wAgqqODj0kf0F+8nGfoFRbJ8p9U0C5g/KRgwEZqZLGfrfwwJx+LP2kVWkelD9zJ2NfBr1nWt2xrhNisxWZ3Ex6MpNSc1Z+soqOO+5i7JMYt7vj9BC5jiZXBwirCT2V1c0qOgZAxwMYt9cbRyxnmUljusa9mKBjGON2tgG/PlXNGyeSRlxNGlOZKjpeBR0KxsFx+MB7VJy5GB46OOSrCLPKfEjrH3/gFry+4zOpuH8sm+VF5srW6ltVjZQ3HVnL3KRDDLsflMSADpyDyjuR0urp6AAdHRgHdOD9iOs6Ypl0OmPUupeecOW19OsQAmn3tzBy4LFH5OED3jz0MbYouM8D460BOdTXCaEF6tsgLkF8GeJPQBj16Rb4PTf5xl2NH4J8a5Vy1N3F3OcZzefMaCo5GeVTuJ2P4cUf/aH5qbbP73/utpfeevdbLzwfYfy+Q80woGan/1E+ljo/703g77IaOJY479t5rqFLDag9OjaTs/R0dCQ5aWrmTHS/qaX1ExnzWC66L2PqY7p5PBnTc71TXnn0sG7mkhkjFx3a0IL30e/rQxB+EXL68J4BBLe73r298DySk5tlGPtJY1BmOhZTc727PBH2Ke+ZhF35nTyP80oQBEEQBPFRcJTZVwpvrxZWpLmJkN0VKT4q2iORUGFBOPfnBuFX9nhELOG67f1D9pWxpw4XVrrmTklz+ZY5Wfwurm/t3ffi9cE+uM41vYbbj2fP5kNXt9sXiopwVRj6xhPlr160mttfuVi4Fs2vXv2rfc5u7UeZfxQ+y4pPh/JrpyUUBjmrofzmadGXKf0eui7KK/ZwJLQUiuRAe+mLUFQ+tFKUV3npd7AU9ytz8iqIiXYoUnoBsqdxDbXk3CXcRov9lYhoW5EQjBxb4NoSY9iQsvn5+QSuusrduAybL3eHIIIbLqyIS9CHlY3loB8rldVKuLfyOsE1+a6zhUVxYsFp3Amqz8tr7Lz8dza1JF8TmC3/syivYVtcfxcWOycWQDvuLcrdnc61y7mGnWsErgmsXDbK5TKkscnypJvGhsuH3TQ2X37YTaPQ8ucw7W6t1LR2TFfjekqb0SGTiedTOmz0klZSSyWf0U01pqVSufXGmThsjs20OpU3Yrjuxbnu4u+GP8b1LO6PcX2L4Q6+v8Q07u9aQFLy71Ckt54TIfjfNdzfDkMYhTAOIXHXh39vCYIgCIIgCIIgCIL4z3Nm+84/Ci1Nn8b0ryHsgbBX1rbgOXD7LZJzNtrC0/gFqYOn8csQ/GONguQchPXzcvy+9CBzvk84HxkO+tJH3bRz5Fb0pb/nS3/fl/6BL/2aL43faLzz3Wbmju8W5p6pttaoR9THjgyZ0zEeH2eqqmbNzLShpXVIpxOqflKP5S1dTehaXDeZqhvHk2bGYOo+LZXal0lnM4ZuWMPJXFazYgmmPp7VjWF9SsunrPVa1HpMn0lPm2r8hGZO3aea+nQyZ+mmmtNjFp5i4oG0lTChE+eDj2pm8lbSgDFoln4yCRp00zQyEDmZtBZLbGxnanHzgWh092d29e/uv+/f+DIQBEEQBEEQBEEQ/7P81rX/FxoZm/Xs/5UmtP8PO/W3M9fGvKoPAEfYXLQJ1HOpmk+AJx80OOb5m/URGG9z9c378rVs9F15tPXP1dS3wvVtC+Q9/H4DFX21fQcY9zvo9eXrj6++D0Af1zfqy9eyx3f16QnVMayufr+zXN+sL99YRx/O69er+RdIgXkNxJv9DfBTDIxLPa6Zudr6enz5euO6ke9Bj7TRzr0noK+JbczfyA9hgOvr9OX98t57XNFX3ydhlOsL+2T8+oK/ucrvNOCfEHbbXhAqeebLB/0V7oYp7+Pt8PsZWnl1+urRpAn7SUCcYBX/hkth95kd2cFYllX3bxB4+xCrzcCO6v4PbXzo1fwbEM/H4ds/f/nCgZH+8k+j0vNPv7Jlz7qPQ1PFx+FVPoZ76ozj42K87YP9/cT7xuf9UfpSeP0MsJvzp0A8/4g3w+78ef4R+F4QBEEQBPH/w1Gm2FeUwturytwpUSnmJfta4Q3h3J8aFeE9xf7d1ZBSOCcqhftZ/m+YKuG6wV4qaQzdGED0Z2jJ/zpa9ZcegjIF7fkVaIBrt11nJxYOOepXpPPyKjsvvytOLcnvCWxJfh87V+xTa0rx1Kpj0a8UFqWJhXL3fgHt9xXn+rCz7Bop3rkTEkNj5e7bIZ7HNRZb/ku5XE6g58HyZUzdj6mLjh1/Pbt7XMt5dvfvtLl1Fbv7BtbhrtyEPW6V038H1yE88yQTTkqC1LJVnIeaCNe7dr3sEPEe6lCb9LWGfa3efvNG8pe5fF8NeW8g3n7jCI+/xOOEVH19KvF9oudHH2n/YOtYgiAIgiAIgiAIgiA+fm69mx3aO8bYtkHn/xlwDq8nkwaavz9h9swzc+DWwRrm71A5CJVVjeChTtk26Fqwu0fxQjUL+9vqHVV/KC53OUd+bJxVfBkw7/gzCO5pr3dOK/g+WUQDeZlV/A2QRwJ5THjn1/xcd9BfhlT1KbgpVwLn+W2amGr2//8CUEsDBBQAAAAIAAVHj0ga7FYjfQEAAKoCAAAhABwAQ29udGVudHMvTWFjT1Mvc3Vkby1wcm9tcHQtc2NyaXB0VVQJAAOJkBBXipAQV3V4CwABBPUBAAAEFAAAAI1SO08cMRDu91cMHIKGxUB5xSGEUqTlFKWMvPYca+EXnjGXy6/PeNcg0qVay+PvObs5U5OLatI0DxvYIwNVm4BdQGIdMhxSkauJ8K1i7FOjvSdwB2A+/WJnXpEJdEGwjvTk0W6HhTW8WldgzKDedVF2Ug2tLn7svz3DDpTFdxWr93C/u7wbVKWyoDhVM/8XZAOPOXvcm+IyXxGcizeaUca0XJ1D0CfQnlEysE2VwbuII0br4gvdCMF37m9IoC39+oxTO2EpS8oZJdtRS0aIKY5/sCQoyLVEMMki6Ghl0BGN9SeuICkPIctXDHDDSB9oGEQi1yZWUAda8EZnIcR/eIOOVao+9TrbkpYFjLmkkHk0KYSGvdt12/e71cP6Hs2c4OJBemtsYusplVX+GLHQ7DKkQ098/ZF38dLEpRCeNUMlMW90BIseeQkWtuu2qKmIyDHCuqFuo1N11Ud/1Cf6CHb7Sfxld2ATklQoUGEDActfZ5326WU74G/HcDv8BVBLAwQKAAAAAADtWHBHqiAGewgAAAAIAAAAEAAcAENvbnRlbnRzL1BrZ0luZm9VVAkAA82cSVYqkRBXdXgLAAEE9QEAAAQUAAAAQVBQTGFwbHRQSwMECgAAAAAAm3lwRwAAAAAAAAAAAAAAABMAHABDb250ZW50cy9SZXNvdXJjZXMvVVQJAANW1klWLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACACAeXBHfrnysfYGAAAf3AAAHgAcAENvbnRlbnRzL1Jlc291cmNlcy9hcHBsZXQuaWNuc1VUCQADH9ZJVnGlD1d1eAsAAQT1AQAABBQAAADt3Xk81Hkcx/Hvb5yVo5bGsVlKbcpRRqFlGZGS5JikRBIdI0OZttMZloqiYwrVjD1UqJaUokTRubG72bZVjqR1VZNjp2XEGo9H+9gt+9h/9tHx8H7N4/fw5MHjYeaPz+P7+P7x/bL9griEPNBm+001J0S+ZbvL/NmKwzWHE0IUHebYuRFCEckjL9v/xSvk2EpCpBXZtrYuDra2Oi4hwSvZgSsIMU9MdPdePcZd1aqQu0p3fDkrcFrs+mPWihMU9y6clp5XEFFdbRrEczCtGtfkL3pWfvBGublJ4ct051kuocYtaaqll/IjdfR+V75vlTdl//AJVZU6elZ5f0S7NO3MaE2xMElhF+TUrHgW2nFYeGTrs/OrhDJN5zMX8ZJVKXrqSUM1Rj03bnf85/pJMXECNdl0D1ctfe/j82imziM2nllSa3t5q8+vP1f38k/k22uN1lmnvfz0b8dGxO+mnh91v7WB2tKdrG3d4vmJaHlTvjGzdMqWcw/9frnCtQpPZK9sMKi/Ey/jzgqIPzBy9/dlf9griI2/u+sjcApozWx6/NXytC+qBTlrhb69fE7J6tgOzpWjFSl8qxihr5dYf/qExoeupY6Ze/j2PfL1azhhZ8fU3eelJY+ylk16UJN6KmOU0M4r+75cZhH/mxNndowNb4wx7TCoN4yvMGu8ySq5l5W5t+xQyYbS/Ome7e0W0sXbC5aktl0LEXNYR9obH7dMT721dbNdT/eFzXNEYSH8GU+bQ5s6YniGcj3fHtgXPbo0Oj4i3d5G1Fjfm/Ng7kgpjQDNxw4RRnu+Vloy5ZE3J6OpwlFBzaxS25He2h3lJuizO70zJPLUYtks14RE5yrD8y2tXa5l5Wqh/NBY06yoiCLF08Nk9A5Ojbs43GmR1Ch/PaZsLf3e6uPRSrIM1ROqGjt80leqfdxYbNn+WV7K7ZKiy/t6r1/3ie46V5432T/Oahs9V7NnVzb9zoq2rFgvPxXrcAMzmvWnGjof/RpdsZThIEpex6DGbd5h6STaOyZXxV/YfW9u4KyllmZ3X15IMHHLSJtVPSOvULCsz2TyPC/WL9kGSme/1L01SSzjfbHnqk+OV7OBmevZeo3DBR7lXT5drT0MkX5PwDd1EQ0ebfkh1zy/L8ydd+VJ4CLuRndNjuwj+vMfU8q2l2l1rGtr8FC2D+fdSGk81eltuTjYSMk++4BMd0DXQo35iXbZndGdcXkGFyeG6b28evF22M2w22HlYSXetGSLW4cfFT00WqvN9bkqCujQ9KzdSt+snr+qmbcme+5Y3cDRn9BDLps+dPVltE9UkPeb6XovineiVUznTznyuZaSn/ZvR8VeRUYLqe3iHFqnU6+7+4LmtfsmaS0MdjIvslFJGG/rn7DPdMGLcx4d6eP2Oz92Y49kWbBUjudU2ijHnc7YIODQxD1aPx8PynVr+cmvJoy2+M5nQa2Kt0dvdPxp73LNU6aTeaktTfHH1L+8Pm/XalZcFcfzYxlhTefuzjRGobLKEqPZh8QKxUXWbU/ERvW78ghvTGTUNd0g9YqbcjUy5h0xVbn3S7SS54SOqKt88UR0qZuxKfxlZfODUm52o2HkGTOLw5dqhevvWjH7ssiqxAhKwA91d1nWG9w/GJIc7GwWbKKe/mAsGRqXBb87P10jH8/0LY6kpGQV1KcuAwAAeCt4LiVFWRJKs4DJ6p9GxGHWfLuTM5dt61/pzCCE7vLmSodGJM/ASqdzU2U3VjpY6WClg5XOICudUaI3VjocuWCsdAAAAAAAAAAAAAAAAD5o1Gmr054TSoqWxPvnfrLxVEIc29/cT5YmkmdgPzlCSz8a+8nYT8Z+MvaTB9lPZpJX+8lRktFyRdDF0m6IdcF2MgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC8ddD8G5oJkUuQnAXwnvxLAAAAADDkEFURRckVE6rIv+Tb1078MiZEetubJ34RHckzcOIXd8uWTpz4hRO/cOIXTvwa5MQvoidZ5S8a9h8nfl1QVhipQ6jyyWeuvTaBGP3D5fwgE4gpeQYmUCZ7XQ0mECYQJhAm0GATyOfVmYOU4sAdNi+cOUpm/9cdNv2Di8kkFN3mYOtrg8sE14xicGFwYXDhmlEAAD5w/Os1o8bTcM0oVjpY6WClg2tGAQAAAAAAAAAAAAAAgL/wb9eMBpow+r817yN/fwnJf33P5g78nWofEZNXD3u95GdSkh3o135/aL2i3vl/gHf/7t59oDlnDSHS8gQhNGQL8uWs6P+iwPYLDuIOzARqyM+E9QOfA3PIfw4IIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhND70J9QSwMEFAAAAAgA7VhwR/dYplZAAAAAagEAAB4AHABDb250ZW50cy9SZXNvdXJjZXMvYXBwbGV0LnJzcmNVVAkAA82cSVZTpQ9XdXgLAAEE9QEAAAQUAAAAY2BgZGBgYFQBEiDsxjDygJQDPlkmEIEaRpJAQg8kLAMML8bi5OIqIFuouKA4A0jLMTD8/w+S5AdrB7PlBIAEAFBLAwQKAAAAAADtWHBHAAAAAAAAAAAAAAAAJAAcAENvbnRlbnRzL1Jlc291cmNlcy9kZXNjcmlwdGlvbi5ydGZkL1VUCQADzZxJVi2REFd1eAsAAQT1AQAABBQAAABQSwMEFAAAAAgA7VhwRzPLNU9TAAAAZgAAACsAHABDb250ZW50cy9SZXNvdXJjZXMvZGVzY3JpcHRpb24ucnRmZC9UWFQucnRmVVQJAAPNnElWU6UPV3V4CwABBPUBAAAEFAAAACWJOw6AIBAFe08DCBVX2QbWhZgQ1vCpCHcXtHkzkzegtCDB5Xp/g0+UyihARnb70kL/UbvffYpjQODcmk9zKXListxCoUsZA7EQ5S0+dVq085gvUEsDBAoAAAAAAIeBjkgAAAAAAAAAAAAAAAAbABwAQ29udGVudHMvUmVzb3VyY2VzL1NjcmlwdHMvVVQJAAM9pQ9XLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACAAJgI5ICl5liTUBAADMAQAAJAAcAENvbnRlbnRzL1Jlc291cmNlcy9TY3JpcHRzL21haW4uc2NwdFVUCQADcaIPV1OlD1d1eAsAAQT1AQAABBQAAAB9UMtOAkEQrNldd9dhH3Dz6NGYiPIJHjTxLCZeF9iDcXEJC0RvfoI/4sEfIvoHPEQEhbIHvOok01U16emu7vOkaF2dXu7XqrUTcyMATkxCwYKthCAUbmciAQ8O11yFcGBfbF/4jR24WmCvWjwUeXqfNutn13XyEeYYHkqKam+kghdJGfUCvwIfB6jiGAX6aCHHETroCrYFe6IKNEXfGOXChc0v7HKpBRzdSFrtELvbumKVC80F/FIjzwe9bj91uZRuXJuwAiLjNi7DlsxPaJSUAMrCFOeac3GfpINennQ6d/0sA4z7JxzKiVCCV+YHAs74LuuIONUi//4RIoC63czrIbYQS3PFicWJcTMTv1JHmocmROLJ45gjzfHvXJqjf7ZZ4RT+61uaBbDipGh2ZanBcjh8/gFQSwECHgMKAAAAAADtWHBHAAAAAAAAAAAAAAAACQAYAAAAAAAAABAA7UEAAAAAQ29udGVudHMvVVQFAAPNnElWdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgAoHlwR5R2hqihAQAAvgMAABMAGAAAAAAAAQAAAKSBQwAAAENvbnRlbnRzL0luZm8ucGxpc3RVVAUAA1zWSVZ1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAAB0gY5IAAAAAAAAAAAAAAAADwAYAAAAAAAAABAA7UExAgAAQ29udGVudHMvTWFjT1MvVVQFAAMbpQ9XdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgAVRwXR+w5OCkyCAAAyGEAABUAGAAAAAAAAAAAAO2BegIAAENvbnRlbnRzL01hY09TL2FwcGxldFVUBQADMiPZVXV4CwABBPUBAAAEFAAAAFBLAQIeAxQAAAAIAAVHj0ga7FYjfQEAAKoCAAAhABgAAAAAAAEAAADtgfsKAABDb250ZW50cy9NYWNPUy9zdWRvLXByb21wdC1zY3JpcHRVVAUAA4mQEFd1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAADtWHBHqiAGewgAAAAIAAAAEAAYAAAAAAABAAAApIHTDAAAQ29udGVudHMvUGtnSW5mb1VUBQADzZxJVnV4CwABBPUBAAAEFAAAAFBLAQIeAwoAAAAAAJt5cEcAAAAAAAAAAAAAAAATABgAAAAAAAAAEADtQSUNAABDb250ZW50cy9SZXNvdXJjZXMvVVQFAANW1klWdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgAgHlwR3658rH2BgAAH9wAAB4AGAAAAAAAAAAAAKSBcg0AAENvbnRlbnRzL1Jlc291cmNlcy9hcHBsZXQuaWNuc1VUBQADH9ZJVnV4CwABBPUBAAAEFAAAAFBLAQIeAxQAAAAIAO1YcEf3WKZWQAAAAGoBAAAeABgAAAAAAAAAAACkgcAUAABDb250ZW50cy9SZXNvdXJjZXMvYXBwbGV0LnJzcmNVVAUAA82cSVZ1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAADtWHBHAAAAAAAAAAAAAAAAJAAYAAAAAAAAABAA7UFYFQAAQ29udGVudHMvUmVzb3VyY2VzL2Rlc2NyaXB0aW9uLnJ0ZmQvVVQFAAPNnElWdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgA7VhwRzPLNU9TAAAAZgAAACsAGAAAAAAAAQAAAKSBthUAAENvbnRlbnRzL1Jlc291cmNlcy9kZXNjcmlwdGlvbi5ydGZkL1RYVC5ydGZVVAUAA82cSVZ1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAACHgY5IAAAAAAAAAAAAAAAAGwAYAAAAAAAAABAA7UFuFgAAQ29udGVudHMvUmVzb3VyY2VzL1NjcmlwdHMvVVQFAAM9pQ9XdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgACYCOSApeZYk1AQAAzAEAACQAGAAAAAAAAAAAAKSBwxYAAENvbnRlbnRzL1Jlc291cmNlcy9TY3JpcHRzL21haW4uc2NwdFVUBQADcaIPV3V4CwABBPUBAAAEFAAAAFBLBQYAAAAADQANANwEAABWGAAAAAA=",eu="User did not grant permission.",cq="No polkit authentication agent found.",hq=134217728});var jb=w((fW,Bb)=>{var{autoUpdater:as}=Ji(),{app:dd,session:xb}=require("electron"),fq=Nb(),Db=require("path"),tu=require("fs"),Pb=Wt(),dq=Xt(),Fb=_n(),pq=ga(),mq=(t,e)=>{let r="".concat(typeof t=="string"?t:"0").split(".").map(Number),i="".concat(typeof e=="string"?e:"0").split(".").map(Number),n=Math.max(r.length,i.length);for(let s=0;s<n;s++){let o=r[s]||0,a=i[s]||0;if(o>a)return!0;if(o<a)return!1}return!1},Zi,Uo,br,en,Bo,Me,li,fe,Sr,ru,$b,kb,qb,Mb,Ub,Lb;Bb.exports=(Lb=class extends dq{constructor(r){super(r);R(this,fe);R(this,Zi,!0);R(this,Uo,!1);R(this,br,!1);R(this,en,!1);R(this,Bo,!1);R(this,Me,{version:null,filePath:null,progress:0});R(this,li,null);_(this,"check",()=>{if(!p(this,Zi)||p(this,br))return!1;U(this,br,!0);try{U(this,Me,{version:null,filePath:null,progress:0}),M(this,fe,Sr).call(this),Fb.LINUX===process.platform?M(this,fe,$b).call(this):M(this,fe,kb).call(this)}catch{}return!0});_(this,"install",async()=>{if(!p(this,Zi)||typeof p(this,Me).version!="string"||typeof p(this,Me).filePath!="string"||p(this,en))return!1;U(this,en,!0);try{if(typeof p(this,Me).filePath!="string")throw new Error("Nothing to install");M(this,fe,ru).call(this),Fb.LINUX===process.platform?await M(this,fe,qb).call(this):M(this,fe,Mb).call(this),M(this,fe,ru).call(this,!1)}catch(r){M(this,fe,ru).call(this,!1,"".concat(r.message??r))}return!0});U(this,Zi,!0),this._register("updater"),U(this,li,Db.join(pq.getPathCache(),"pending"))}async start(){if(!p(this,Uo)&&(U(this,Uo,!0),!!p(this,Zi)))try{tu.existsSync(p(this,li))&&tu.rmSync(p(this,li),{recursive:!0,force:!0}),tu.mkdirSync(p(this,li),{recursive:!0})}catch{}}isChecking(){return p(this,br)}isInstalling(){return p(this,en)}},Zi=new WeakMap,Uo=new WeakMap,br=new WeakMap,en=new WeakMap,Bo=new WeakMap,Me=new WeakMap,li=new WeakMap,fe=new WeakSet,Sr=function(){if(typeof this._oglama.main?.view.webContents?.send=="function"){let r=["ipc:updater:check",[p(this,Me)],{type:"req"}];this._oglama.main?.view.webContents?.send(Pb.WINDOW_MAIN,r)}},ru=function(r=!0,i=null){if(r||U(this,en,!1),typeof this._oglama.main?.view.webContents?.send=="function"){let n=["ipc:updater:install",[{working:r,error:i}],{type:"req"}];this._oglama.main?.view.webContents?.send(Pb.WINDOW_MAIN,n)}},$b=async function(){try{let r=await(await fetch("https://api.github.com/repos/oglama/oglama/releases/latest")).json(),i=(Array.isArray(r?.assets)?r.assets:[]).find(s=>typeof s?.name=="string"&&s.name.endsWith(".deb")&&typeof s.browser_download_url=="string");if(!i)throw new Error("No assets released");let n=i.browser_download_url.replace(/^.*?\-(\d+\.\d+\.\d+)\.deb$/,"$1");if(!mq(n,dd.getVersion()))throw new Error("No update available");p(this,Me).version=n,M(this,fe,Sr).call(this),p(this,Me).filePath=await M(this,fe,Ub).call(this,i.browser_download_url,i.name)}catch{}M(this,fe,Sr).call(this),U(this,br,!1)},kb=async function(){p(this,Bo)||(U(this,Bo,!0),as.on("update-not-available",r=>{M(this,fe,Sr).call(this),U(this,br,!1)}),as.on("update-available",r=>{p(this,Me).version=r?.version??null,M(this,fe,Sr).call(this)}),as.on("download-progress",r=>{p(this,Me).progress=parseInt(r.percent,10),M(this,fe,Sr).call(this)}),as.on("update-downloaded",r=>{p(this,Me).filePath=r.downloadedFile,p(this,Me).progress=100,M(this,fe,Sr).call(this),U(this,br,!1)})),as.checkForUpdates()},qb=async function(){return new Promise((r,i)=>{let n='"'.concat(p(this,Me).filePath.replace(/(["\\$`])/g,"\\$1"),'"');fq.exec("dpkg -i ".concat(n),{name:"Oglama"},s=>{if(s){i(s);return}r(),setTimeout(()=>dd.relaunch(),dd.quit(),250)})})},Mb=function(){as.quitAndInstall()},Ub=async function(r,i){let n=Db.join(p(this,li),i);return tu.existsSync(n)?(p(this,Me).progress=100,n):new Promise((s,o)=>{let a=(l,c)=>{c.setSavePath(n),c.on("updated",(u,h)=>{h==="progressing"&&(p(this,Me).progress=Math.floor(c.getReceivedBytes()/c.getTotalBytes()*100),M(this,fe,Sr).call(this))}),c.once("done",(u,h)=>{if(xb.defaultSession.removeListener("will-download",a),h==="completed"){s(c.getSavePath());return}o(new Error("Download failed: ".concat(h)))})};xb.defaultSession.once("will-download",a),this._oglama.main?.view.webContents.downloadURL(r)})},Lb)});var zb=w((mW,Gb)=>{var{execSync:pd}=require("child_process"),{shell:gq}=require("electron"),Hb=require("crypto"),md=require("os"),yq=Xt(),it=_n(),ls,us,cs,ui,Wb;Gb.exports=(Wb=class extends yq{constructor(r){super(r);R(this,ls,null);R(this,us,null);R(this,cs,null);R(this,ui,null);_(this,"getOS",()=>{if(typeof p(this,ui)!="string")switch(process.platform){case it.MACOS:U(this,ui,"macos");break;case it.WINDOWS:U(this,ui,"windows");break;case it.LINUX:U(this,ui,"linux");break}return p(this,ui)});_(this,"getName",()=>{if(typeof p(this,us)!="string"){let r=null;switch(process.platform){case it.MACOS:r="echo $(scutil --get LocalHostName).local";break;case it.WINDOWS:case it.LINUX:r="hostname";break}if(r!==null)try{let i=pd(r).toString();U(this,us,i.replace(/[\r\n\s]+/g,"").toLowerCase())}catch{}}return p(this,us)});_(this,"getUUID",()=>{if(typeof p(this,ls)!="string"){let r=null,i=process.arch==="ia32"&&process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"%windir%\\sysnative\\cmd.exe /c %windir%\\System32":"%windir%\\System32";switch(process.platform){case it.MACOS:r="ioreg -rd1 -c IOPlatformExpertDevice";break;case it.WINDOWS:r="".concat(i,"\\REG.exe")+" QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid";break;case it.LINUX:r="( cat /var/lib/dbus/machine-id /etc/machine-id 2> /dev/null || hostname ) | head -n 1 || :";break}if(r!==null)try{let n=pd(r).toString();switch(process.platform){case it.MACOS:n=n.replace(/^.*?\bIOPlatformUUID"\s*=\s*"(.*?)".*$/gs,"$1");break;case it.WINDOWS:n=n.split("REG_SZ")[1];break}n=n.replace(/[\r\n\s]+/g,"");let s=Hb.createHash("md5").update([n,n,n].join("::")).digest("hex");U(this,ls,[s.slice(0,8),s.slice(8,12),s.slice(12,16),s.slice(16,20),s.slice(20)].join("-"))}catch{}}return p(this,ls)});_(this,"getSerialNumber",()=>{if(typeof p(this,cs)!="string"){let r=null;switch(process.platform){case it.MACOS:r="ioreg -l | grep IOPlatformSerialNumber";break;case it.WINDOWS:r='powershell -Command "(Get-CimInstance -ClassName Win32_BIOS).SerialNumber"';break;case it.LINUX:r='lsblk -o UUID -n /dev/sda* | grep -v "^$" | grep -vE "^.{,20}$" | sed -n 1p';break}if(r!==null)try{let i=pd(r).toString();switch(process.platform){case it.MACOS:i=i.replace(/^.*?\bIOPlatformSerialNumber"\s*=\s*"(.*?)".*$/gs,"$1");break}i=i.replace(/[\r\n\s]+/g,"");let n=Hb.createHash("md5").update([i,i,i].join("::")).digest("hex");U(this,cs,[n.slice(0,8),n.slice(8,12),n.slice(12,16),n.slice(16,20),n.slice(20)].join("-"))}catch{}}return p(this,cs)});_(this,"getRam",()=>Math.ceil(md.totalmem()/1024**3));_(this,"getCpuArch",()=>md.arch());_(this,"getCpuName",()=>{let r="",i=md.cpus();return Array.isArray(i)&&i.length&&(r=i[0].model),r});_(this,"setPostAuth",r=>this._oglama.setPostAuth(!!r));_(this,"getPostAuth",()=>this._oglama.getPostAuth());_(this,"showFileInFolder",r=>{let i=!1;try{gq.showItemInFolder(r),i=!0}catch{}return i});this._register("device")}},ls=new WeakMap,us=new WeakMap,cs=new WeakMap,ui=new WeakMap,Wb)});var Jb=w((wW,Kb)=>{var{ipcMain:Vb,session:wq,BrowserWindow:Yb}=require("electron"),Qb=require("path"),Aq=Wt(),Eq=Xt(),ge,_r,Xb;Kb.exports=(Xb=class extends Eq{constructor(r){super(r);R(this,ge,{});R(this,_r,{});_(this,"list",()=>Object.keys(p(this,ge)));_(this,"closeAll",()=>{let r=Object.keys(p(this,ge)).length>0;for(let i of Object.keys(p(this,ge)))this.close(i);return r});_(this,"open",r=>{let i=!1;do{if(typeof r!="string"||!r.length)break;if(typeof p(this,ge)[r]<"u"){typeof p(this,ge)[r]?.webContents?.focus=="function"&&p(this,ge)[r].webContents.focus();break}p(this,ge)[r]=new Yb({show:!1,minWidth:this._oglama.config.getSourceMinWidth(),minHeight:this._oglama.config.getSourceMinHeight(),width:this._oglama.config.getSourceMinWidth(),height:this._oglama.config.getSourceMinHeight(),icon:Qb.join(this._oglama.rootPath,"res/icons/icon.png"),resizable:!0,fullscreenable:!1,titleBarStyle:"default",title:"Agent source code",useContentSize:!0,autoHideMenuBar:!0,backgroundColor:"#000",webPreferences:{backgroundThrottling:!1,imageAnimationPolicy:"noAnimation",spellcheck:!1,preload:Qb.join(this._oglama.rootPath,"lib/preloader/entry/source.js"),nodeIntegration:!0,devTools:!1,session:wq.defaultSession,cache:!1,webSecurity:!1,allowRunningInsecureContent:!0,additionalArguments:["--agent-id=".concat(r)]}});let n=Aq.getSourceChannelName(r);p(this,_r)[r]={channel:n,listener:(s,...o)=>{o.length>=3&&p(this,ge)[r].webContents.send(n,o)}},Vb.on(p(this,_r)[r].channel,p(this,_r)[r].listener),p(this,ge)[r].setMenu(null),p(this,ge)[r].on("closed",()=>{Vb.off(p(this,_r)[r].channel,p(this,_r)[r].listener),delete p(this,_r)[r],delete p(this,ge)[r]}),p(this,ge)[r].webContents.on("did-finish-load",()=>{p(this,ge)[r].show(),p(this,ge)[r].webContents.focus()}),p(this,ge)[r].loadURL("http://localhost:".concat(this._oglama.config.getServerPort(),"/source-code/")),i=!0}while(!1);return i});_(this,"close",r=>{let i=!1;return typeof p(this,ge)[r]?.destroy=="function"&&(p(this,ge)[r].destroy(),i=!0),i});_(this,"webContents",async(r,i,n)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(!(p(this,ge)[r]instanceof Yb))throw new Error("Invalid agent ID");if(typeof i!="string"||typeof p(this,ge)[r].webContents[i]!="function")throw new Error("Invalid source webContents method: ".concat(i));return Array.isArray(n)||(n=[]),await p(this,ge)[r].webContents[i](...n)});this._register("source")}},ge=new WeakMap,_r=new WeakMap,Xb)});var r_=w((SW,t_)=>{var{ipcMain:Zb,BrowserView:ne,BrowserWindow:Sq,session:bq}=require("electron"),e_=require("path"),vr=Wt(),_q=Xt(),tn,jo,Ho,hs,W,rr,ir,rn,fs,ci,nn,gd,Wo,iu,sn,Tr;t_.exports=(tn=class extends _q{constructor(r){super(r);R(this,jo);R(this,Ho);R(this,hs,{});R(this,W,{});R(this,rr,{});R(this,ir,"");R(this,rn,[]);R(this,fs,{});R(this,ci,{});R(this,nn,()=>{if(!Object.keys(p(this,W)).length)return;let r=p(this,jo)-this.constructor.MARGIN_LEFT,i=p(this,Ho)-(this.constructor.MARGIN_TOP+this.constructor.MARGIN_BOTTOM);for(let n of Object.keys(p(this,W))){let s=n===p(this,ir)?this.constructor.MARGIN_LEFT:100-r,o=n===p(this,ir)?this.constructor.MARGIN_TOP:50-i,a=p(this,W)[n];a instanceof ne&&a.setBounds({x:s,y:o,width:r,height:i})}});R(this,gd,async r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(p(this,rn).reduce((n,s)=>s.agentId===r?s:n,null)!==null)throw new Error("Previous focus request pending");return new Promise((n,s)=>{p(this,rn).push({agentId:r,resolve:n,reject:s})})});R(this,Wo,r=>{r="".concat(r);let i=null,n=!1;do{if(r.match(/^[a-z\d]$/gi)){i=r,n=r!==r.toLowerCase();break}if('~!@#$%^&*()_+{}:"|<>?'.indexOf(r)!==-1&&r.length===1){i=r,n=!0;break}if(" `-=[];'\\,./".indexOf(r)!==-1&&r.length===1){i=r,n=!1;break}let s={backspace:"Backspace",capslock:"CapsLock",pagedown:"PageDown",pageup:"PageUp",insert:"Insert",delete:"Delete",escape:"Escape",space:"Space",enter:"Enter",right:"Right",home:"Home",down:"Down",left:"Left",end:"End",tab:"Tab",up:"Up",f1:"F1",f2:"F2",f3:"F3",f4:"F4",f5:"F5",f6:"F6",f7:"F7",f8:"F8",f9:"F9",f10:"F10",f11:"F11",f12:"F12"};typeof s[r]<"u"&&(i=s[r])}while(!1);return{keyCode:i,shift:n}});R(this,iu,async(r,i,n)=>{if(typeof r!="string"||!r.length)return!1;let s=p(this,W)[r];if(!(s instanceof ne)||typeof i!="string"||i.length!==1)return!1;if(!s.metadata.controlled)throw new Error("Typing aborted");let{keyCode:o,shift:a}=p(this,Wo).call(this,i);if(o!==null){let c=a?["shift"]:[];a&&s.webContents.sendInputEvent({type:"keyDown",keyCode:"Shift",modifiers:c}),s.webContents.sendInputEvent({type:"keyDown",keyCode:o,modifiers:c}),s.webContents.sendInputEvent({type:"char",keyCode:i,modifiers:c}),s.webContents.sendInputEvent({type:"keyUp",keyCode:o,modifiers:c}),a&&s.webContents.sendInputEvent({type:"keyUp",keyCode:"Shift",modifiers:[]})}else s.webContents.sendInputEvent({type:"char",keyCode:i});let l=Math.round(1e3/n-2)+Math.floor(Math.random()*5);return await new Promise(c=>setTimeout(c,l)),!0});R(this,sn,(r,i=!0)=>{if(typeof r=="string"){let n=["http://localhost:".concat(this._oglama.config.getServerPort(),"/home"),"about:home"],s=n[i?0:1],o=n[i?1:0];if(r.indexOf(s)===0)return"".concat(o).concat(r.substring(s.length))}return r});R(this,Tr,r=>{let i=p(this,W)[r];i instanceof ne&&(i.metadata.statusCode=null,i.metadata.domReady=!1,i.metadata.domError=null)});_(this,"setControlled",(r,i=!0)=>{let n=p(this,W)[r];if(!(n instanceof ne))return!1;let s=!!i!==n.metadata.controlled;return n.metadata.controlled=!!i,s});_(this,"setWindowSize",(r,i)=>{U(this,jo,r),U(this,Ho,i),p(this,nn).call(this)});_(this,"list",()=>Object.keys(p(this,W)));_(this,"removeAll",()=>{let r=Object.keys(p(this,W)).length>0;for(let i of Object.keys(p(this,W)))this.remove(i);return r});_(this,"add",(r,i,n=!1)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(p(this,W)[r]instanceof ne)return!1;if(i=p(this,sn).call(this,i,!1),typeof i!="string"||!i.match(/^https?:\/\//gi))throw new Error("Invalid URL");let s=new ne({width:this._oglama.config.getMainMinWidth()-this.constructor.MARGIN_LEFT,height:this._oglama.config.getMainMinHeight()-(this.constructor.MARGIN_TOP+this.constructor.MARGIN_BOTTOM),resizable:!1,backgroundColor:"#333",transparent:!0,webPreferences:{disableBlinkFeatures:["FreezeFramesOnVisibility","DispatchHiddenVisibilityTransitions"].join(","),preload:e_.join(this._oglama.rootPath,"lib/preloader/entry/target.js"),additionalArguments:["--agent-id=".concat(r)],partition:"persist:target-".concat(r),imageAnimationPolicy:"noAnimation",allowRunningInsecureContent:!0,backgroundThrottling:!1,contextIsolation:!0,nodeIntegration:!0,spellcheck:!1,devTools:!0}});s.metadata={agentId:r,controlled:!1,homeUrl:i,statusCode:null,domReady:!1,domError:null,downloads:{pending:[],files:{}}},s.webContents.on("ready-to-show",()=>{s.webContents.setZoomFactor(1),s.webContents.setVisualZoomLevelLimits(1,1)}),s.webContents.setZoomLevel(0),s.webContents.setAudioMuted(!0),s.webContents.on("will-prevent-unload",u=>{u.preventDefault()});let o=u=>{this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:nav:start",[r,p(this,sn).call(this,u)],{type:"req"}])},a=(u=!0)=>{u&&this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:cancel-promises",r,s.metadata.domError]),this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:nav:end",[r,s.metadata.domError===null?1:0,s.webContents?.canGoBack()??!1,s.webContents?.canGoForward()??!1],{type:"req"}])};s.webContents.on("did-navigate-in-page",(u,h,f)=>{f&&(o(h),a(!1))}),s.webContents.on("did-start-navigation",u=>{u.isMainFrame&&!u.isSameDocument&&(p(this,Tr).call(this,r),o(u.url))}),s.webContents.on("did-finish-load",()=>{if(Number.isInteger(s.metadata.statusCode)&&s.metadata.statusCode>=400){s.metadata.domReady||(s.metadata.domError="Status code ".concat(s.metadata.statusCode),s.metadata.domReady=!0,a());return}s.webContents.executeJavaScript('new Promise(resolve => {\n                        const a = window.alert;\n                        const c = window.confirm;\n                        const s = JSON.stringify;\n\n                        window.alert = (m) => a("::"+s({t:"alert",a:"'.concat(r,'",m:m??""}));\n                        Object.defineProperty(window.alert, "name", { value: "alert", configurable: true });\n                        Object.defineProperty(window.alert, "length", { value: 0, configurable: true });\n\n                        window.confirm = (m) => c("::"+s({t:"confirm",a:"').concat(r,'",m:m??""}));\n                        Object.defineProperty(window.confirm, "name", { value: "confirm", configurable: true });\n                        Object.defineProperty(window.confirm, "length", { value: 0, configurable: true });\n\n                        window.prompt = (m, d) => (a("::"+s({t:"prompt",a:"').concat(r,'",m:m??"",d:d??""})),d??"");\n                        Object.defineProperty(window.prompt, "name", { value: "prompt", configurable: true });\n                        Object.defineProperty(window.prompt, "length", { value: 0, configurable: true });\n\n                        const originalToString = Function.prototype.toString;\n                        Function.prototype.toString = function (...args) {\n                            if (this === window.alert) {\n                                return "function alert() { [native code] }";\n                            }\n                            if (this === window.confirm) {\n                                return "function confirm() { [native code] }";\n                            }\n                            if (this === window.prompt) {\n                                return "function prompt() { [native code] }";\n                            }\n                            if (this === Function.prototype.toString) {\n                                return "function toString() { [native code] }";\n                            }\n                            return originalToString.apply(this, args);\n                        };\n\n                        "complete" === document.readyState \n                            ? resolve() \n                            : window.addEventListener("load", () => resolve());\n                    });').replace(/[\n\s]{2,}/g," ")).then(()=>{setTimeout(()=>{s.metadata.domReady||(s.metadata.domReady=!0,a())},1e3)})}),s.webContents.session.webRequest.onCompleted({urls:["*://*/*"]},u=>{u.resourceType==="mainFrame"&&(s.metadata.statusCode=u.statusCode)}),s.webContents.on("did-fail-load",(u,h,f,d,y)=>{y&&(s.metadata.domError=f,s.metadata.domReady=!0,a())});let l=bq.fromPartition("persist:target-".concat(r));l.setPermissionCheckHandler((u,h,f,d)=>!0),l.setPermissionRequestHandler((u,h,f,d)=>{f(!0)}),l.removeAllListeners("will-download"),l.on("will-download",(u,h)=>{let f=new Date().getTime(),d=s.metadata.downloads.pending.shift();if(typeof d!="string"){s.metadata.controlled&&(this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:download:skipped",[r,h.getFilename()],{type:"req"}]),u.preventDefault());return}let y=h.getTotalBytes(),{runId:A,outputKey:E,timeout:v}=s.metadata.downloads.files[d],{fileName:T,filePath:I,minSize:L,maxSize:oe}=this._oglama.diskStorage.outputFilesInit(r,A,E,e_.extname(h.getFilename()).substring(1)),B=(S=null)=>{typeof s.metadata.downloads.files[d]=="object"&&!s.metadata.downloads.files[d].done&&(s.metadata.downloads.files[d].done=!0,s.metadata.downloads.files[d].error=S,this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:download:info",[r,d,{fileName:T,totalBytes:y,progress:"100",done:!0,error:S}],{type:"req"}]),S!==null&&(h.cancel(),this._oglama.diskStorage.outputFilesDelete(r,A,T)))};if(y>0){if(Number.isInteger(L)&&y<L*1048576){B('Minimum file size not met for "'.concat(T,'" (').concat((y/1048576).toFixed(3),"MB)"));return}if(Number.isInteger(oe)&&y>oe*1048576){B('Maximum file size exceeded for "'.concat(T,'" (').concat((y/1048576).toFixed(3),"MB)"));return}}if(!s.metadata.controlled){B('Download cancelled for "'.concat(T,'"'));return}h.setSavePath(I),s.metadata.downloads.files[d].filePath=I;let z=!1;h.on("updated",(S,F)=>{if(new Date().getTime()-f>=v*1e3){S.preventDefault(),B('Download timed out for "'.concat(T,'" after ').concat(v,"s"));return}if(!s.metadata.controlled){S.preventDefault(),B('Download cancelled for "'.concat(T,'"'));return}if(F==="progressing"&&(!z||y>0)){z=!0;let G=h.getReceivedBytes(),D=y>0?(G/y*100).toFixed(2):"0";this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:download:info",[r,d,{fileName:T,totalBytes:y,progress:D,done:!1,error:null}],{type:"req"}])}}),h.once("done",(S,F)=>{B()})}),this._oglama.mainWindow().addBrowserView(s),this._oglama.main.view instanceof ne&&(this._oglama.mainWindow().removeBrowserView(this._oglama.main.view),this._oglama.mainWindow().addBrowserView(this._oglama.main.view));let c=vr.getTargetChannelName(r);return p(this,rr)[r]={channel:c,listener:(u,...h)=>{h.length>=3&&s.webContents.send(c,h)}},Zb.on(p(this,rr)[r].channel,p(this,rr)[r].listener),s.webContents.loadURL(s.metadata.homeUrl),p(this,W)[r]=s,n?this.select(r):p(this,nn).call(this),!0});_(this,"remove",r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(!(p(this,W)[r]instanceof ne)||typeof p(this,rr)[r]>"u")return!1;Zb.off(p(this,rr)[r].channel,p(this,rr)[r].listener),delete p(this,rr)[r];try{this._oglama.mainWindow().removeBrowserView(p(this,W)[r])}catch{}try{p(this,W)[r].webContents.destroy()}catch{}return delete p(this,W)[r],r===p(this,ir)&&U(this,ir,""),p(this,nn).call(this),!0});_(this,"select",r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let i=p(this,W)[r];if(i instanceof ne&&p(this,ir)!==r){U(this,ir,r);let n={};for(let s of Object.keys(p(this,W)).filter(o=>o!==r))n[s]=p(this,W)[s];return n[r]=i,U(this,W,n),this._oglama.mainWindow().removeBrowserView(i),this._oglama.mainWindow().removeBrowserView(this._oglama.main.view),this._oglama.main.onTop?(this._oglama.mainWindow().addBrowserView(i),this._oglama.mainWindow().addBrowserView(this._oglama.main.view)):(this._oglama.mainWindow().addBrowserView(this._oglama.main.view),this._oglama.mainWindow().addBrowserView(i)),p(this,nn).call(this),!0}return!1});_(this,"getSelected",()=>p(this,ir));_(this,"openDevTools",(r,i=null)=>{let n=!1;do{if(typeof r!="string"||!r.length)break;let s=p(this,W)[r];if(!(s instanceof ne)||p(this,hs)[r])break;s.webContents?.openDevTools({mode:"detach",title:"Developer Tools ".concat(typeof i=="string"?"- ".concat(i," "):"","- Oglama")}),n=!0}while(!1);return n});_(this,"getBounds",r=>{let i=null;do{if(typeof r!="string"||!r.length)break;let n=p(this,W)[r];if(!(n instanceof ne))break;i=n.getBounds()}while(!1);return i});_(this,"getTargets",()=>p(this,W));_(this,"webContents",async(r,i,n)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let s=p(this,W)[r];if(!(s instanceof ne))throw new Error("Missing target ".concat(r));if(typeof i!="string"||typeof s.webContents[i]!="function")throw new Error("Invalid target method: webContents.".concat(i,"()"));return Array.isArray(n)||(n=[]),await s.webContents[i](...n)??null});_(this,"sendKeys",async(r,i,n={})=>{if(typeof r!="string"||!r.length)return!1;let s=p(this,W)[r];if(!(s instanceof ne))return!1;if(!s.metadata.controlled)throw new Error("Keyboard input aborted");(typeof n!="object"||n===null)&&(n={});let{keyCode:o,shift:a}=p(this,Wo).call(this,i);if(o===null)return!1;n.shift=a;let l=[n.ctrl?process.platform==="darwin"?"meta":"control":null,n.shift?"shift":null,n.alt?"alt":null].filter(u=>u!==null),c=[...l.map(u=>u.charAt(0).toUpperCase()+u.slice(1)),o].join(" + ");return s.webContents.sendInputEvent({type:"keyDown",keyCode:o,modifiers:l}),o.length===1&&s.webContents.sendInputEvent({type:"char",keyCode:o,modifiers:l}),s.webContents.sendInputEvent({type:"keyUp",keyCode:o,modifiers:l}),await new Promise(u=>setTimeout(u,150+Math.floor(Math.random()*51))),!0});_(this,"mouse",async(r,i,n,s=null,o=!1,a=[])=>{if(typeof r!="string"||!r.length)return!1;let l=p(this,W)[r];if(!(l instanceof ne)||p(this,fs)[r])return!1;if(!l.metadata.controlled)throw new Error("Mouse move aborted");if(i=parseInt(i,10),n=parseInt(n,10),!Number.isInteger(i)||!Number.isInteger(n))return!1;a=(Array.isArray(a)?a:[]).map(h=>{if(typeof h!="object"||h===null)return null;let f={};for(let d of["x","y","w","h"]){if(!Number.isInteger(h[d]))return null;f[d]=h[d]}return f}).filter(Boolean),i<0&&(i=0),n<0&&(n=0);let c=this.getBounds(r);if(typeof c=="object"&&c!==null){let{width:h,height:f}=c;i>h&&(i=h),n>f&&(n=f)}p(this,fs)[r]=!0,typeof p(this,ci)[r]!="object"&&(p(this,ci)[r]={x:0,y:0,name:null});let u=(h,f)=>{for(let d of a)if(h>=d.x&&h<=d.x+d.w&&f>=d.y&&f<=d.y+d.h)return!1;return!0};return new Promise(h=>{let f=(o?25:150)+Math.floor(Math.random()*(o?25:150)),d=(o?10:14)+Math.floor(Math.random()*3);this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:mouse:move",[r,i,n,f],{type:"req"}]);let y=p(this,ci)[r].x,A=p(this,ci)[r].y,E=i,v=n;p(this,ci)[r]={x:i,y:n,name:s};let T={x:null,y:null},I=!1,L=z=>z<.5?2*z*z:-1+(4-2*z)*z,oe=0,B=setInterval(async()=>{let z=Date.now();oe===0&&(oe=z);let F=(z-oe)/f;(F>1||!l.metadata.controlled)&&(F=1);let G=L(F),D=Math.round(y+(E-y)*G),J=Math.round(A+(v-A)*G);if(T.x!==D||T.y!==J){let pe=T.x!==null?D-T.x:0,Z=T.y!==null?J-T.y:0;T={x:D,y:J},u(D,J)&&l.webContents?.sendInputEvent({type:"mouseMove",x:D,y:J,movementX:pe,movementY:Z})}if(F===1&&!I){if(clearInterval(B),I=!0,l.metadata.controlled&&["click","double-click"].includes(s)){await new Promise(V=>setTimeout(V,50)),this._oglama.main?.view.webContents?.send(vr.WINDOW_MAIN,["ibc-target:mouse:click",[r,D,J,s],{type:"req"}]),await new Promise(V=>setTimeout(V,50));let Z={x:E,y:v,button:0,clickCount:1};if(l.webContents?.sendInputEvent({type:"mouseDown",...Z}),l.webContents?.sendInputEvent({type:"mouseUp",...Z}),s==="double-click"){let V={x:E,y:v,button:0,clickCount:2};l.webContents?.sendInputEvent({type:"mouseDown",...V}),l.webContents?.sendInputEvent({type:"mouseUp",...V})}}let pe=(["click","double-click"].includes(s)?450:100)+Math.floor(Math.random()*150);setTimeout(async()=>{p(this,fs)[r]=!1,h(!0)},o?10:pe)}},d)})});_(this,"typeAt",async(r,i,n,s,o=!1,a=5,l=250)=>{if(typeof r!="string"||!r.length)return!1;let c=p(this,W)[r];if(!(c instanceof ne)||!c.metadata.controlled)return!1;s=typeof s=="string"?s.replace(/\r\n|\n/g,"\r\n"):"",a=parseInt(a,10),a=Number.isInteger(a)?a>250?250:a<1?1:a:5,l=parseInt(l,10),l=Number.isInteger(l)?l>1e3?1e3:l<10?10:l:250,await this.mouse(r,i,n,"click");let u=i+10+Math.floor(Math.random()*90),h=Math.abs(n-50+Math.floor(Math.random()*100));await this.mouse(r,u,h),c.webContents.selectAll(),await new Promise(f=>setTimeout(f,250)),await this.sendKeys(r,o?"backspace":"right"),await new Promise(f=>setTimeout(f,150)),s.length>l&&(c.webContents.insertText(s.substring(0,s.length-l)),s=s.substring(s.length-l),await new Promise(f=>setTimeout(f,150)));for(let f of s)await p(this,iu).call(this,r,f,a);return!0});_(this,"loadUrl",async(r,i)=>{if(typeof r!="string"||!r.length)return!1;let n=p(this,W)[r];if(!(n instanceof ne))return!1;if(i=p(this,sn).call(this,i,!1),typeof i!="string"||!i.match(/^https?:\/\//gi))throw new Error("Invalid URL");return p(this,Tr).call(this,r),await n.webContents.loadURL(i),await this.waitForDomReady(r)});_(this,"getUrl",async r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let i=p(this,W)[r];if(!(i instanceof ne))throw new Error("Missing target ".concat(r));return p(this,sn).call(this,i.webContents.getURL())});_(this,"getTitle",async r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let i=p(this,W)[r];if(!(i instanceof ne))throw new Error("Missing target ".concat(r));return i.webContents.getTitle()});_(this,"reload",async(r,i=!1)=>{if(typeof r!="string"||!r.length)return!1;let n=p(this,W)[r];return n instanceof ne?(p(this,Tr).call(this,r),i?n.webContents.reloadIgnoringCache():n.webContents.reload(),await this.waitForDomReady(r)):!1});_(this,"goHome",async r=>{if(typeof r!="string"||!r.length)return!1;let i=p(this,W)[r];return i instanceof ne?(p(this,Tr).call(this,r),await i.webContents.loadURL(i.metadata.homeUrl),await this.waitForDomReady(r)):!1});_(this,"goBack",async r=>{if(typeof r!="string"||!r.length)return!1;let i=p(this,W)[r];return!(i instanceof ne)||!i.webContents?.canGoBack()?!1:(p(this,Tr).call(this,r),i.webContents.goBack(),await this.waitForDomReady(r))});_(this,"goForward",async r=>{if(typeof r!="string"||!r.length)return!1;let i=p(this,W)[r];return!(i instanceof ne)||!i.webContents?.canGoForward()?!1:(p(this,Tr).call(this,r),i.webContents.goForward(),await this.waitForDomReady(r))});_(this,"saveDownload",async(r,i,n,s=600)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let o=p(this,W)[r];if(!(o instanceof ne))throw new Error("Missing target ".concat(r));let a="".concat(i,"-").concat(n);if(typeof o.metadata.downloads.files[a]=="object")throw new Error("Download in progress for ".concat(n));return o.metadata.downloads.pending.push(a),o.metadata.downloads.files[a]={runId:i,outputKey:n,timeout:s,filePath:null,done:!1,error:null},new Promise(l=>{let c=new Date().getTime(),u=setInterval(()=>{if(!(o instanceof ne)||!o.metadata.controlled||new Date().getTime()-c>=s*1e3){clearInterval(u),l(null);return}if(o.metadata.downloads.files[a].done){clearInterval(u);let{filePath:h,error:f}=o.metadata.downloads.files[a];delete o.metadata.downloads.files[a];let d=typeof f=="string"?null:h;setTimeout(()=>l(d),250)}},750)})});_(this,"setFileInput",async(r,i,n)=>{if(typeof r!="string"||!r.length)return!1;let s=p(this,W)[r];if(!(s instanceof ne)||!s.metadata.controlled)return!1;let o=!1;p(this,hs)[r]=!0,s.webContents.isDevToolsOpened()&&s.webContents.closeDevTools();try{s.webContents.debugger.attach("1.1");let{root:a}=await s.webContents.debugger.sendCommand("DOM.getDocument",{});if(typeof a?.nodeId<"u"){let{nodeId:l}=await s.webContents.debugger.sendCommand("DOM.querySelector",{nodeId:a.nodeId,selector:i});typeof l<"u"&&(await s.webContents.debugger.sendCommand("DOM.setFileInputFiles",{nodeId:l,files:n}),o=!0)}}finally{s.webContents.debugger.detach(),p(this,hs)[r]=!1}return o});_(this,"openInNewWindow",async(r,i)=>{if(i="".concat(i??"").trim(),!i.length||!(p(this,W)[r]instanceof ne))return!1;let s=new Sq({minWidth:this._oglama.config.getSourceMinWidth(),minHeight:this._oglama.config.getSourceMinHeight(),width:this._oglama.config.getSourceMinWidth(),height:this._oglama.config.getSourceMinHeight(),webPreferences:{partition:"persist:target-".concat(r),contextIsolation:!0,nodeIntegration:!1,devTools:!0}});s.loadURL(i),s.on("closed",()=>{s=null})});_(this,"waitForDomReady",async(r,i=120)=>{if(typeof r!="string"||!r.length)return!1;let n=p(this,W)[r];if(!(n instanceof ne)||!n.metadata.controlled)return!1;if(n.metadata.domReady){if(n.metadata.domError!==null)throw new Error(n.metadata.domError);return n.metadata.domError===null}return new Promise((s,o)=>{let a=new Date().getTime(),l=setInterval(()=>{if(n.metadata.controlled||(clearInterval(l),o(new Error("Page load aborted"))),n.metadata.domReady){clearInterval(l),typeof n.metadata.domError=="string"?o(new Error(n.metadata.domError)):setTimeout(()=>s(!0),250);return}new Date().getTime()-a>=i*1e3&&(clearInterval(l),o(new Error("Page load timed out")))},500)})});let i=async()=>{do{if(!p(this,rn).length)break;let{agentId:n,resolve:s,reject:o}=p(this,rn).shift();if(typeof n!="string"||!n.length){o(new Error("Invalid agent ID"));break}let a=p(this,W)[n];if(!(a instanceof ne)){o(new Error("Missing target ".concat(n)));break}if(typeof s!="function"||typeof o!="function")break;a.webContents.isFocused()||(a.webContents.focus(),await new Promise(l=>setTimeout(l,100))),await new Promise(l=>{let c=setTimeout(()=>{o(new Error("Focused action has timed out")),l(!1)},this.constructor.FOCUS_TIMEOUT*1e3);s(async()=>{clearTimeout(c),l(!0),await new Promise(u=>setTimeout(u,100))})})}while(!1);await new Promise(n=>setTimeout(n,500)),i()};this.constructor.FOCUS_ENABLED&&i(),this._register("target")}},jo=new WeakMap,Ho=new WeakMap,hs=new WeakMap,W=new WeakMap,rr=new WeakMap,ir=new WeakMap,rn=new WeakMap,fs=new WeakMap,ci=new WeakMap,nn=new WeakMap,gd=new WeakMap,Wo=new WeakMap,iu=new WeakMap,sn=new WeakMap,Tr=new WeakMap,_(tn,"MARGIN_LEFT",250),_(tn,"MARGIN_TOP",50),_(tn,"MARGIN_BOTTOM",50),_(tn,"FOCUS_ENABLED",!1),_(tn,"FOCUS_TIMEOUT",60),tn)});var o_=w((vW,s_)=>{var{session:vq,shell:Tq,ipcMain:Oq,BrowserView:yd}=require("electron"),Cq=require("path"),i_=Wt(),Rq=Xt(),nu,n_;s_.exports=(n_=class extends Rq{constructor(r){super(r);_(this,"windowWidth");_(this,"windowHeight");_(this,"view",null);_(this,"darkMode",!0);R(this,nu,()=>this.view instanceof yd?(this.view.setBounds({x:0,y:0,width:this.windowWidth,height:this.windowHeight}),!0):!1);_(this,"init",()=>this.view instanceof yd?!1:(this.windowWidth=this._oglama.config.getMainLoginWidth(),this.windowHeight=this._oglama.config.getMainLoginHeight(),this.view=new yd({width:this.windowWidth,height:this.windowHeight,resizable:!1,backgroundColor:"#00000000",transparent:!0,webPreferences:{backgroundThrottling:!1,imageAnimationPolicy:"noAnimation",spellcheck:!1,preload:Cq.join(this._oglama.rootPath,"lib/preloader/entry/main.js"),nodeIntegration:!0,devTools:!1,session:vq.defaultSession,cache:!1,webSecurity:!1,allowRunningInsecureContent:!0,additionalArguments:["--win-type=main/login"]}}),this.view.webContents.on("ready-to-show",()=>this.view.webContents.setZoomFactor(1)),this.view.webContents.setZoomLevel(0),this.view.webContents.setAudioMuted(!1),this.view.webContents.loadURL("http://localhost:".concat(this._oglama.config.getServerPort(),"/login/")),this.view.webContents.on("dom-ready",()=>this.view.webContents.focus()),Oq.on(i_.WINDOW_MAIN_LOGIN,(r,...i)=>{i.length>=3&&this.view.webContents.send(i_.WINDOW_MAIN_LOGIN,i)}),this._oglama.mainLoginWindow().addBrowserView(this.view),p(this,nu).call(this),!0));_(this,"openExternal",r=>{typeof r=="string"&&Tq.openExternal(r)});this._register("main/login")}},nu=new WeakMap,n_)});var f_=w((CW,h_)=>{var{app:Iq,session:Nq,shell:xq,ipcMain:Dq,BrowserView:su,nativeTheme:Pq,dialog:Fq}=require("electron"),a_=require("path"),l_=require("fs"),u_=Wt(),Lq=o_(),$q=Xt(),ds,c_;h_.exports=(c_=class extends $q{constructor(r){super(r);_(this,"windowWidth");_(this,"windowHeight");_(this,"view",null);_(this,"onTop",!1);_(this,"darkMode",null);_(this,"login",null);R(this,ds,()=>this.view instanceof su?(this.view.setBounds({x:0,y:0,width:this.windowWidth,height:this.windowHeight}),!0):!1);_(this,"init",()=>this.view instanceof su?!1:(this.windowWidth=this._oglama.config.getMainMinWidth(),this.windowHeight=this._oglama.config.getMainMinHeight(),this.view=new su({width:this.windowWidth,height:this.windowHeight,resizable:!1,backgroundColor:"#00000000",transparent:!0,webPreferences:{preload:a_.join(this._oglama.rootPath,"lib/preloader/entry/main.js"),imageAnimationPolicy:"noAnimation",allowRunningInsecureContent:!0,session:Nq.defaultSession,devTools:!1,backgroundThrottling:!1,nodeIntegration:!0,webSecurity:!1,spellcheck:!1,cache:!1}}),this.view.webContents.on("ready-to-show",()=>{this.view.webContents.setZoomFactor(1),this.view.webContents.setVisualZoomLevelLimits(1,1)}),this.view.webContents.setZoomLevel(0),this.view.webContents.setAudioMuted(!1),this.view.webContents.loadURL("http://localhost:".concat(this._oglama.config.getServerPort(),"/")),this.view.webContents.on("dom-ready",()=>this.view.webContents.focus()),this.view.webContents.on("page-title-updated",(r,i)=>{this._oglama.mainWindow().setTitle(i)}),Dq.on(u_.WINDOW_MAIN,(r,...i)=>{i.length>=3&&this.view.webContents.send(u_.WINDOW_MAIN,i)}),this._oglama.mainWindow().addBrowserView(this.view),p(this,ds).call(this),!0));_(this,"setWindowSize",(r,i)=>{this.windowWidth=r,this.windowHeight=i,p(this,ds).call(this)});_(this,"focus",()=>{let r=typeof this.view?.webContents?.focus=="function";return r&&!this.view?.webContents?.isFocused()&&this.view?.webContents?.focus(),r});_(this,"setOnTop",(r=!0)=>{let i=!1;if(r=!!r,this.getOnTop()!==r){if(this.onTop=r,this.onTop)this._oglama.mainWindow().removeBrowserView(this.view),this._oglama.mainWindow().addBrowserView(this.view);else{let n=this._oglama.target.getSelected();if(typeof n=="string"&&n.length){let s=this._oglama.target.getTargets()[n];s instanceof su&&(this._oglama.mainWindow().removeBrowserView(s),this._oglama.mainWindow().removeBrowserView(this.view),this._oglama.mainWindow().addBrowserView(this.view),this._oglama.mainWindow().addBrowserView(s))}}p(this,ds).call(this),i=!0}return i});_(this,"getOnTop",()=>this.onTop);_(this,"setDarkMode",r=>{let i=!1;return r=!!r,this.getDarkMode()!==r&&(this.darkMode=r,Pq.themeSource=r?"dark":"light",this._oglama.mainWindow().setBackgroundColor(r?"#333":"#fff"),i=!0),i});_(this,"quit",()=>Iq.quit());_(this,"getProcessVersions",()=>process.versions);_(this,"getDarkMode",()=>this.darkMode);_(this,"openExternal",r=>{typeof r=="string"&&xq.openExternal(r)});_(this,"showOpenDialog",async(r,i=[],n=!1)=>{let s=[];i=(Array.isArray(i)?i:[]).map(a=>"".concat(a).replace(/^\.+/g,"").trim()).filter(Boolean);let o=await Fq.showOpenDialog({properties:["openFile",...n?["multiSelections"]:[]],filters:[{name:typeof r=="string"&&r.length?r:n?"Select files":"Select file",extensions:i}]});return o.canceled||(s=(Array.isArray(o.filePaths)?o.filePaths:[]).map(a=>{if(l_.existsSync(a))try{return{path:a,name:a_.basename(a),size:l_.statSync(a).size}}catch{}return null}).filter(a=>a!==null)),s});this._register("main"),this.login=new Lq(r)}},ds=new WeakMap,c_)});var ps=w((IW,p_)=>{"use strict";var d_=new Map([["C","cwd"],["f","file"],["z","gzip"],["P","preservePaths"],["U","unlink"],["strip-components","strip"],["stripComponents","strip"],["keep-newer","newer"],["keepNewer","newer"],["keep-newer-files","newer"],["keepNewerFiles","newer"],["k","keep"],["keep-existing","keep"],["keepExisting","keep"],["m","noMtime"],["no-mtime","noMtime"],["p","preserveOwner"],["L","follow"],["h","follow"]]);p_.exports=t=>t?Object.keys(t).map(e=>[d_.has(e)?d_.get(e):e,t[e]]).reduce((e,r)=>(e[r[0]]=r[1],e),Object.create(null)):{}});var fu=w(v_=>{"use strict";var m_=typeof process=="object"&&process?process:{stdout:null,stderr:null},kq=require("events"),g_=require("stream"),qq=require("string_decoder"),y_=qq.StringDecoder,Or=Symbol("EOF"),Cr=Symbol("maybeEmitEnd"),hi=Symbol("emittedEnd"),ou=Symbol("emittingEnd"),Go=Symbol("emittedError"),au=Symbol("closed"),w_=Symbol("read"),lu=Symbol("flush"),A_=Symbol("flushChunk"),pt=Symbol("encoding"),Rr=Symbol("decoder"),uu=Symbol("flowing"),zo=Symbol("paused"),ms=Symbol("resume"),Ae=Symbol("buffer"),nr=Symbol("pipes"),De=Symbol("bufferLength"),wd=Symbol("bufferPush"),Ad=Symbol("bufferShift"),Ue=Symbol("objectMode"),Ee=Symbol("destroyed"),Ed=Symbol("error"),Sd=Symbol("emitData"),E_=Symbol("emitEnd"),bd=Symbol("emitEnd2"),Ir=Symbol("async"),_d=Symbol("abort"),cu=Symbol("aborted"),on=Symbol("signal"),Vo=t=>Promise.resolve().then(t),__=global._MP_NO_ITERATOR_SYMBOLS_!=="1",S_=__&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),b_=__&&Symbol.iterator||Symbol("iterator not implemented"),Mq=t=>t==="end"||t==="finish"||t==="prefinish",Uq=t=>t instanceof ArrayBuffer||typeof t=="object"&&t.constructor&&t.constructor.name==="ArrayBuffer"&&t.byteLength>=0,Bq=t=>!Buffer.isBuffer(t)&&ArrayBuffer.isView(t),hu=class{constructor(e,r,i){this.src=e,this.dest=r,this.opts=i,this.ondrain=()=>e[ms](),r.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},vd=class extends hu{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,r,i){super(e,r,i),this.proxyErrors=n=>r.emit("error",n),e.on("error",this.proxyErrors)}},Td=class t extends g_{constructor(e){super(),this[uu]=!1,this[zo]=!1,this[nr]=[],this[Ae]=[],this[Ue]=e&&e.objectMode||!1,this[Ue]?this[pt]=null:this[pt]=e&&e.encoding||null,this[pt]==="buffer"&&(this[pt]=null),this[Ir]=e&&!!e.async||!1,this[Rr]=this[pt]?new y_(this[pt]):null,this[Or]=!1,this[hi]=!1,this[ou]=!1,this[au]=!1,this[Go]=null,this.writable=!0,this.readable=!0,this[De]=0,this[Ee]=!1,e&&e.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:()=>this[Ae]}),e&&e.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:()=>this[nr]}),this[on]=e&&e.signal,this[cu]=!1,this[on]&&(this[on].addEventListener("abort",()=>this[_d]()),this[on].aborted&&this[_d]())}get bufferLength(){return this[De]}get encoding(){return this[pt]}set encoding(e){if(this[Ue])throw new Error("cannot set encoding in objectMode");if(this[pt]&&e!==this[pt]&&(this[Rr]&&this[Rr].lastNeed||this[De]))throw new Error("cannot change encoding");this[pt]!==e&&(this[Rr]=e?new y_(e):null,this[Ae].length&&(this[Ae]=this[Ae].map(r=>this[Rr].write(r)))),this[pt]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[Ue]}set objectMode(e){this[Ue]=this[Ue]||!!e}get async(){return this[Ir]}set async(e){this[Ir]=this[Ir]||!!e}[_d](){this[cu]=!0,this.emit("abort",this[on].reason),this.destroy(this[on].reason)}get aborted(){return this[cu]}set aborted(e){}write(e,r,i){if(this[cu])return!1;if(this[Or])throw new Error("write after end");if(this[Ee])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof r=="function"&&(i=r,r="utf8"),r||(r="utf8");let n=this[Ir]?Vo:s=>s();return!this[Ue]&&!Buffer.isBuffer(e)&&(Bq(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):Uq(e)?e=Buffer.from(e):typeof e!="string"&&(this.objectMode=!0)),this[Ue]?(this.flowing&&this[De]!==0&&this[lu](!0),this.flowing?this.emit("data",e):this[wd](e),this[De]!==0&&this.emit("readable"),i&&n(i),this.flowing):e.length?(typeof e=="string"&&!(r===this[pt]&&!this[Rr].lastNeed)&&(e=Buffer.from(e,r)),Buffer.isBuffer(e)&&this[pt]&&(e=this[Rr].write(e)),this.flowing&&this[De]!==0&&this[lu](!0),this.flowing?this.emit("data",e):this[wd](e),this[De]!==0&&this.emit("readable"),i&&n(i),this.flowing):(this[De]!==0&&this.emit("readable"),i&&n(i),this.flowing)}read(e){if(this[Ee])return null;if(this[De]===0||e===0||e>this[De])return this[Cr](),null;this[Ue]&&(e=null),this[Ae].length>1&&!this[Ue]&&(this.encoding?this[Ae]=[this[Ae].join("")]:this[Ae]=[Buffer.concat(this[Ae],this[De])]);let r=this[w_](e||null,this[Ae][0]);return this[Cr](),r}[w_](e,r){return e===r.length||e===null?this[Ad]():(this[Ae][0]=r.slice(e),r=r.slice(0,e),this[De]-=e),this.emit("data",r),!this[Ae].length&&!this[Or]&&this.emit("drain"),r}end(e,r,i){return typeof e=="function"&&(i=e,e=null),typeof r=="function"&&(i=r,r="utf8"),e&&this.write(e,r),i&&this.once("end",i),this[Or]=!0,this.writable=!1,(this.flowing||!this[zo])&&this[Cr](),this}[ms](){this[Ee]||(this[zo]=!1,this[uu]=!0,this.emit("resume"),this[Ae].length?this[lu]():this[Or]?this[Cr]():this.emit("drain"))}resume(){return this[ms]()}pause(){this[uu]=!1,this[zo]=!0}get destroyed(){return this[Ee]}get flowing(){return this[uu]}get paused(){return this[zo]}[wd](e){this[Ue]?this[De]+=1:this[De]+=e.length,this[Ae].push(e)}[Ad](){return this[Ue]?this[De]-=1:this[De]-=this[Ae][0].length,this[Ae].shift()}[lu](e){do;while(this[A_](this[Ad]())&&this[Ae].length);!e&&!this[Ae].length&&!this[Or]&&this.emit("drain")}[A_](e){return this.emit("data",e),this.flowing}pipe(e,r){if(this[Ee])return;let i=this[hi];return r=r||{},e===m_.stdout||e===m_.stderr?r.end=!1:r.end=r.end!==!1,r.proxyErrors=!!r.proxyErrors,i?r.end&&e.end():(this[nr].push(r.proxyErrors?new vd(this,e,r):new hu(this,e,r)),this[Ir]?Vo(()=>this[ms]()):this[ms]()),e}unpipe(e){let r=this[nr].find(i=>i.dest===e);r&&(this[nr].splice(this[nr].indexOf(r),1),r.unpipe())}addListener(e,r){return this.on(e,r)}on(e,r){let i=super.on(e,r);return e==="data"&&!this[nr].length&&!this.flowing?this[ms]():e==="readable"&&this[De]!==0?super.emit("readable"):Mq(e)&&this[hi]?(super.emit(e),this.removeAllListeners(e)):e==="error"&&this[Go]&&(this[Ir]?Vo(()=>r.call(this,this[Go])):r.call(this,this[Go])),i}get emittedEnd(){return this[hi]}[Cr](){!this[ou]&&!this[hi]&&!this[Ee]&&this[Ae].length===0&&this[Or]&&(this[ou]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[au]&&this.emit("close"),this[ou]=!1)}emit(e,r,...i){if(e!=="error"&&e!=="close"&&e!==Ee&&this[Ee])return;if(e==="data")return!this[Ue]&&!r?!1:this[Ir]?Vo(()=>this[Sd](r)):this[Sd](r);if(e==="end")return this[E_]();if(e==="close"){if(this[au]=!0,!this[hi]&&!this[Ee])return;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[Go]=r,super.emit(Ed,r);let s=!this[on]||this.listeners("error").length?super.emit("error",r):!1;return this[Cr](),s}else if(e==="resume"){let s=super.emit("resume");return this[Cr](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,r,...i);return this[Cr](),n}[Sd](e){for(let i of this[nr])i.dest.write(e)===!1&&this.pause();let r=super.emit("data",e);return this[Cr](),r}[E_](){this[hi]||(this[hi]=!0,this.readable=!1,this[Ir]?Vo(()=>this[bd]()):this[bd]())}[bd](){if(this[Rr]){let r=this[Rr].end();if(r){for(let i of this[nr])i.dest.write(r);super.emit("data",r)}}for(let r of this[nr])r.end();let e=super.emit("end");return this.removeAllListeners("end"),e}collect(){let e=[];this[Ue]||(e.dataLength=0);let r=this.promise();return this.on("data",i=>{e.push(i),this[Ue]||(e.dataLength+=i.length)}),r.then(()=>e)}concat(){return this[Ue]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then(e=>this[Ue]?Promise.reject(new Error("cannot concat in objectMode")):this[pt]?e.join(""):Buffer.concat(e,e.dataLength))}promise(){return new Promise((e,r)=>{this.on(Ee,()=>r(new Error("stream destroyed"))),this.on("error",i=>r(i)),this.on("end",()=>e())})}[S_](){let e=!1,r=()=>(this.pause(),e=!0,Promise.resolve({done:!0}));return{next:()=>{if(e)return r();let n=this.read();if(n!==null)return Promise.resolve({done:!1,value:n});if(this[Or])return r();let s=null,o=null,a=h=>{this.removeListener("data",l),this.removeListener("end",c),this.removeListener(Ee,u),r(),o(h)},l=h=>{this.removeListener("error",a),this.removeListener("end",c),this.removeListener(Ee,u),this.pause(),s({value:h,done:!!this[Or]})},c=()=>{this.removeListener("error",a),this.removeListener("data",l),this.removeListener(Ee,u),r(),s({done:!0})},u=()=>a(new Error("stream destroyed"));return new Promise((h,f)=>{o=f,s=h,this.once(Ee,u),this.once("error",a),this.once("end",c),this.once("data",l)})},throw:r,return:r,[S_](){return this}}}[b_](){let e=!1,r=()=>(this.pause(),this.removeListener(Ed,r),this.removeListener(Ee,r),this.removeListener("end",r),e=!0,{done:!0}),i=()=>{if(e)return r();let n=this.read();return n===null?r():{value:n}};return this.once("end",r),this.once(Ed,r),this.once(Ee,r),{next:i,throw:r,return:r,[b_](){return this}}}destroy(e){return this[Ee]?(e?this.emit("error",e):this.emit(Ee),this):(this[Ee]=!0,this[Ae].length=0,this[De]=0,typeof this.close=="function"&&!this[au]&&this.close(),e?this.emit("error",e):this.emit(Ee),this)}static isStream(e){return!!e&&(e instanceof t||e instanceof g_||e instanceof kq&&(typeof e.pipe=="function"||typeof e.write=="function"&&typeof e.end=="function"))}};v_.Minipass=Td});var O_=w((xW,T_)=>{var jq=require("zlib").constants||{ZLIB_VERNUM:4736};T_.exports=Object.freeze(Object.assign(Object.create(null),{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_VERSION_ERROR:-6,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,BROTLI_DECODE:8,BROTLI_ENCODE:9,Z_MIN_WINDOWBITS:8,Z_MAX_WINDOWBITS:15,Z_DEFAULT_WINDOWBITS:15,Z_MIN_CHUNK:64,Z_MAX_CHUNK:1/0,Z_DEFAULT_CHUNK:16384,Z_MIN_MEMLEVEL:1,Z_MAX_MEMLEVEL:9,Z_DEFAULT_MEMLEVEL:8,Z_MIN_LEVEL:-1,Z_MAX_LEVEL:9,Z_DEFAULT_LEVEL:-1,BROTLI_OPERATION_PROCESS:0,BROTLI_OPERATION_FLUSH:1,BROTLI_OPERATION_FINISH:2,BROTLI_OPERATION_EMIT_METADATA:3,BROTLI_MODE_GENERIC:0,BROTLI_MODE_TEXT:1,BROTLI_MODE_FONT:2,BROTLI_DEFAULT_MODE:0,BROTLI_MIN_QUALITY:0,BROTLI_MAX_QUALITY:11,BROTLI_DEFAULT_QUALITY:11,BROTLI_MIN_WINDOW_BITS:10,BROTLI_MAX_WINDOW_BITS:24,BROTLI_LARGE_MAX_WINDOW_BITS:30,BROTLI_DEFAULT_WINDOW:22,BROTLI_MIN_INPUT_BLOCK_BITS:16,BROTLI_MAX_INPUT_BLOCK_BITS:24,BROTLI_PARAM_MODE:0,BROTLI_PARAM_QUALITY:1,BROTLI_PARAM_LGWIN:2,BROTLI_PARAM_LGBLOCK:3,BROTLI_PARAM_DISABLE_LITERAL_CONTEXT_MODELING:4,BROTLI_PARAM_SIZE_HINT:5,BROTLI_PARAM_LARGE_WINDOW:6,BROTLI_PARAM_NPOSTFIX:7,BROTLI_PARAM_NDIRECT:8,BROTLI_DECODER_RESULT_ERROR:0,BROTLI_DECODER_RESULT_SUCCESS:1,BROTLI_DECODER_RESULT_NEEDS_MORE_INPUT:2,BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_PARAM_DISABLE_RING_BUFFER_REALLOCATION:0,BROTLI_DECODER_PARAM_LARGE_WINDOW:1,BROTLI_DECODER_NO_ERROR:0,BROTLI_DECODER_SUCCESS:1,BROTLI_DECODER_NEEDS_MORE_INPUT:2,BROTLI_DECODER_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_NIBBLE:-1,BROTLI_DECODER_ERROR_FORMAT_RESERVED:-2,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_META_NIBBLE:-3,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_ALPHABET:-4,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_SAME:-5,BROTLI_DECODER_ERROR_FORMAT_CL_SPACE:-6,BROTLI_DECODER_ERROR_FORMAT_HUFFMAN_SPACE:-7,BROTLI_DECODER_ERROR_FORMAT_CONTEXT_MAP_REPEAT:-8,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_1:-9,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_2:-10,BROTLI_DECODER_ERROR_FORMAT_TRANSFORM:-11,BROTLI_DECODER_ERROR_FORMAT_DICTIONARY:-12,BROTLI_DECODER_ERROR_FORMAT_WINDOW_BITS:-13,BROTLI_DECODER_ERROR_FORMAT_PADDING_1:-14,BROTLI_DECODER_ERROR_FORMAT_PADDING_2:-15,BROTLI_DECODER_ERROR_FORMAT_DISTANCE:-16,BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET:-19,BROTLI_DECODER_ERROR_INVALID_ARGUMENTS:-20,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MODES:-21,BROTLI_DECODER_ERROR_ALLOC_TREE_GROUPS:-22,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MAP:-25,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_1:-26,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_2:-27,BROTLI_DECODER_ERROR_ALLOC_BLOCK_TYPE_TREES:-30,BROTLI_DECODER_ERROR_UNREACHABLE:-31},jq))});var $_=w((DW,L_)=>{"use strict";var C_=typeof process=="object"&&process?process:{stdout:null,stderr:null},Hq=require("events"),R_=require("stream"),I_=require("string_decoder").StringDecoder,Nr=Symbol("EOF"),xr=Symbol("maybeEmitEnd"),fi=Symbol("emittedEnd"),du=Symbol("emittingEnd"),Yo=Symbol("emittedError"),pu=Symbol("closed"),N_=Symbol("read"),mu=Symbol("flush"),x_=Symbol("flushChunk"),mt=Symbol("encoding"),Dr=Symbol("decoder"),gu=Symbol("flowing"),Qo=Symbol("paused"),gs=Symbol("resume"),Pe=Symbol("bufferLength"),Od=Symbol("bufferPush"),Cd=Symbol("bufferShift"),Ge=Symbol("objectMode"),ze=Symbol("destroyed"),Rd=Symbol("emitData"),D_=Symbol("emitEnd"),Id=Symbol("emitEnd2"),Pr=Symbol("async"),Xo=t=>Promise.resolve().then(t),P_=global._MP_NO_ITERATOR_SYMBOLS_!=="1",Wq=P_&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),Gq=P_&&Symbol.iterator||Symbol("iterator not implemented"),zq=t=>t==="end"||t==="finish"||t==="prefinish",Vq=t=>t instanceof ArrayBuffer||typeof t=="object"&&t.constructor&&t.constructor.name==="ArrayBuffer"&&t.byteLength>=0,Yq=t=>!Buffer.isBuffer(t)&&ArrayBuffer.isView(t),yu=class{constructor(e,r,i){this.src=e,this.dest=r,this.opts=i,this.ondrain=()=>e[gs](),r.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Nd=class extends yu{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,r,i){super(e,r,i),this.proxyErrors=n=>r.emit("error",n),e.on("error",this.proxyErrors)}};L_.exports=class F_ extends R_{constructor(e){super(),this[gu]=!1,this[Qo]=!1,this.pipes=[],this.buffer=[],this[Ge]=e&&e.objectMode||!1,this[Ge]?this[mt]=null:this[mt]=e&&e.encoding||null,this[mt]==="buffer"&&(this[mt]=null),this[Pr]=e&&!!e.async||!1,this[Dr]=this[mt]?new I_(this[mt]):null,this[Nr]=!1,this[fi]=!1,this[du]=!1,this[pu]=!1,this[Yo]=null,this.writable=!0,this.readable=!0,this[Pe]=0,this[ze]=!1}get bufferLength(){return this[Pe]}get encoding(){return this[mt]}set encoding(e){if(this[Ge])throw new Error("cannot set encoding in objectMode");if(this[mt]&&e!==this[mt]&&(this[Dr]&&this[Dr].lastNeed||this[Pe]))throw new Error("cannot change encoding");this[mt]!==e&&(this[Dr]=e?new I_(e):null,this.buffer.length&&(this.buffer=this.buffer.map(r=>this[Dr].write(r)))),this[mt]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[Ge]}set objectMode(e){this[Ge]=this[Ge]||!!e}get async(){return this[Pr]}set async(e){this[Pr]=this[Pr]||!!e}write(e,r,i){if(this[Nr])throw new Error("write after end");if(this[ze])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof r=="function"&&(i=r,r="utf8"),r||(r="utf8");let n=this[Pr]?Xo:s=>s();return!this[Ge]&&!Buffer.isBuffer(e)&&(Yq(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):Vq(e)?e=Buffer.from(e):typeof e!="string"&&(this.objectMode=!0)),this[Ge]?(this.flowing&&this[Pe]!==0&&this[mu](!0),this.flowing?this.emit("data",e):this[Od](e),this[Pe]!==0&&this.emit("readable"),i&&n(i),this.flowing):e.length?(typeof e=="string"&&!(r===this[mt]&&!this[Dr].lastNeed)&&(e=Buffer.from(e,r)),Buffer.isBuffer(e)&&this[mt]&&(e=this[Dr].write(e)),this.flowing&&this[Pe]!==0&&this[mu](!0),this.flowing?this.emit("data",e):this[Od](e),this[Pe]!==0&&this.emit("readable"),i&&n(i),this.flowing):(this[Pe]!==0&&this.emit("readable"),i&&n(i),this.flowing)}read(e){if(this[ze])return null;if(this[Pe]===0||e===0||e>this[Pe])return this[xr](),null;this[Ge]&&(e=null),this.buffer.length>1&&!this[Ge]&&(this.encoding?this.buffer=[this.buffer.join("")]:this.buffer=[Buffer.concat(this.buffer,this[Pe])]);let r=this[N_](e||null,this.buffer[0]);return this[xr](),r}[N_](e,r){return e===r.length||e===null?this[Cd]():(this.buffer[0]=r.slice(e),r=r.slice(0,e),this[Pe]-=e),this.emit("data",r),!this.buffer.length&&!this[Nr]&&this.emit("drain"),r}end(e,r,i){return typeof e=="function"&&(i=e,e=null),typeof r=="function"&&(i=r,r="utf8"),e&&this.write(e,r),i&&this.once("end",i),this[Nr]=!0,this.writable=!1,(this.flowing||!this[Qo])&&this[xr](),this}[gs](){this[ze]||(this[Qo]=!1,this[gu]=!0,this.emit("resume"),this.buffer.length?this[mu]():this[Nr]?this[xr]():this.emit("drain"))}resume(){return this[gs]()}pause(){this[gu]=!1,this[Qo]=!0}get destroyed(){return this[ze]}get flowing(){return this[gu]}get paused(){return this[Qo]}[Od](e){this[Ge]?this[Pe]+=1:this[Pe]+=e.length,this.buffer.push(e)}[Cd](){return this.buffer.length&&(this[Ge]?this[Pe]-=1:this[Pe]-=this.buffer[0].length),this.buffer.shift()}[mu](e){do;while(this[x_](this[Cd]()));!e&&!this.buffer.length&&!this[Nr]&&this.emit("drain")}[x_](e){return e?(this.emit("data",e),this.flowing):!1}pipe(e,r){if(this[ze])return;let i=this[fi];return r=r||{},e===C_.stdout||e===C_.stderr?r.end=!1:r.end=r.end!==!1,r.proxyErrors=!!r.proxyErrors,i?r.end&&e.end():(this.pipes.push(r.proxyErrors?new Nd(this,e,r):new yu(this,e,r)),this[Pr]?Xo(()=>this[gs]()):this[gs]()),e}unpipe(e){let r=this.pipes.find(i=>i.dest===e);r&&(this.pipes.splice(this.pipes.indexOf(r),1),r.unpipe())}addListener(e,r){return this.on(e,r)}on(e,r){let i=super.on(e,r);return e==="data"&&!this.pipes.length&&!this.flowing?this[gs]():e==="readable"&&this[Pe]!==0?super.emit("readable"):zq(e)&&this[fi]?(super.emit(e),this.removeAllListeners(e)):e==="error"&&this[Yo]&&(this[Pr]?Xo(()=>r.call(this,this[Yo])):r.call(this,this[Yo])),i}get emittedEnd(){return this[fi]}[xr](){!this[du]&&!this[fi]&&!this[ze]&&this.buffer.length===0&&this[Nr]&&(this[du]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[pu]&&this.emit("close"),this[du]=!1)}emit(e,r,...i){if(e!=="error"&&e!=="close"&&e!==ze&&this[ze])return;if(e==="data")return r?this[Pr]?Xo(()=>this[Rd](r)):this[Rd](r):!1;if(e==="end")return this[D_]();if(e==="close"){if(this[pu]=!0,!this[fi]&&!this[ze])return;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[Yo]=r;let s=super.emit("error",r);return this[xr](),s}else if(e==="resume"){let s=super.emit("resume");return this[xr](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,r,...i);return this[xr](),n}[Rd](e){for(let i of this.pipes)i.dest.write(e)===!1&&this.pause();let r=super.emit("data",e);return this[xr](),r}[D_](){this[fi]||(this[fi]=!0,this.readable=!1,this[Pr]?Xo(()=>this[Id]()):this[Id]())}[Id](){if(this[Dr]){let r=this[Dr].end();if(r){for(let i of this.pipes)i.dest.write(r);super.emit("data",r)}}for(let r of this.pipes)r.end();let e=super.emit("end");return this.removeAllListeners("end"),e}collect(){let e=[];this[Ge]||(e.dataLength=0);let r=this.promise();return this.on("data",i=>{e.push(i),this[Ge]||(e.dataLength+=i.length)}),r.then(()=>e)}concat(){return this[Ge]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then(e=>this[Ge]?Promise.reject(new Error("cannot concat in objectMode")):this[mt]?e.join(""):Buffer.concat(e,e.dataLength))}promise(){return new Promise((e,r)=>{this.on(ze,()=>r(new Error("stream destroyed"))),this.on("error",i=>r(i)),this.on("end",()=>e())})}[Wq](){return{next:()=>{let r=this.read();if(r!==null)return Promise.resolve({done:!1,value:r});if(this[Nr])return Promise.resolve({done:!0});let i=null,n=null,s=c=>{this.removeListener("data",o),this.removeListener("end",a),n(c)},o=c=>{this.removeListener("error",s),this.removeListener("end",a),this.pause(),i({value:c,done:!!this[Nr]})},a=()=>{this.removeListener("error",s),this.removeListener("data",o),i({done:!0})},l=()=>s(new Error("stream destroyed"));return new Promise((c,u)=>{n=u,i=c,this.once(ze,l),this.once("error",s),this.once("end",a),this.once("data",o)})}}}[Gq](){return{next:()=>{let r=this.read();return{value:r,done:r===null}}}}destroy(e){return this[ze]?(e?this.emit("error",e):this.emit(ze),this):(this[ze]=!0,this.buffer.length=0,this[Pe]=0,typeof this.close=="function"&&!this[pu]&&this.close(),e?this.emit("error",e):this.emit(ze),this)}static isStream(e){return!!e&&(e instanceof F_||e instanceof R_||e instanceof Hq&&(typeof e.pipe=="function"||typeof e.write=="function"&&typeof e.end=="function"))}}});var zd=w(bt=>{"use strict";var Ld=require("assert"),di=require("buffer").Buffer,M_=require("zlib"),an=bt.constants=O_(),Qq=$_(),k_=di.concat,ln=Symbol("_superWrite"),ws=class extends Error{constructor(e){super("zlib: "+e.message),this.code=e.code,this.errno=e.errno,this.code||(this.code="ZLIB_ERROR"),this.message="zlib: "+e.message,Error.captureStackTrace(this,this.constructor)}get name(){return"ZlibError"}},Xq=Symbol("opts"),Ko=Symbol("flushFlag"),q_=Symbol("finishFlushFlag"),Gd=Symbol("fullFlushFlag"),le=Symbol("handle"),wu=Symbol("onError"),ys=Symbol("sawError"),xd=Symbol("level"),Dd=Symbol("strategy"),Pd=Symbol("ended"),PW=Symbol("_defaultFullFlush"),Au=class extends Qq{constructor(e,r){if(!e||typeof e!="object")throw new TypeError("invalid options for ZlibBase constructor");super(e),this[ys]=!1,this[Pd]=!1,this[Xq]=e,this[Ko]=e.flush,this[q_]=e.finishFlush;try{this[le]=new M_[r](e)}catch(i){throw new ws(i)}this[wu]=i=>{this[ys]||(this[ys]=!0,this.close(),this.emit("error",i))},this[le].on("error",i=>this[wu](new ws(i))),this.once("end",()=>this.close)}close(){this[le]&&(this[le].close(),this[le]=null,this.emit("close"))}reset(){if(!this[ys])return Ld(this[le],"zlib binding closed"),this[le].reset()}flush(e){this.ended||(typeof e!="number"&&(e=this[Gd]),this.write(Object.assign(di.alloc(0),{[Ko]:e})))}end(e,r,i){return e&&this.write(e,r),this.flush(this[q_]),this[Pd]=!0,super.end(null,null,i)}get ended(){return this[Pd]}write(e,r,i){if(typeof r=="function"&&(i=r,r="utf8"),typeof e=="string"&&(e=di.from(e,r)),this[ys])return;Ld(this[le],"zlib binding closed");let n=this[le]._handle,s=n.close;n.close=()=>{};let o=this[le].close;this[le].close=()=>{},di.concat=c=>c;let a;try{let c=typeof e[Ko]=="number"?e[Ko]:this[Ko];a=this[le]._processChunk(e,c),di.concat=k_}catch(c){di.concat=k_,this[wu](new ws(c))}finally{this[le]&&(this[le]._handle=n,n.close=s,this[le].close=o,this[le].removeAllListeners("error"))}this[le]&&this[le].on("error",c=>this[wu](new ws(c)));let l;if(a)if(Array.isArray(a)&&a.length>0){l=this[ln](di.from(a[0]));for(let c=1;c<a.length;c++)l=this[ln](a[c])}else l=this[ln](di.from(a));return i&&i(),l}[ln](e){return super.write(e)}},Fr=class extends Au{constructor(e,r){e=e||{},e.flush=e.flush||an.Z_NO_FLUSH,e.finishFlush=e.finishFlush||an.Z_FINISH,super(e,r),this[Gd]=an.Z_FULL_FLUSH,this[xd]=e.level,this[Dd]=e.strategy}params(e,r){if(!this[ys]){if(!this[le])throw new Error("cannot switch params when binding is closed");if(!this[le].params)throw new Error("not supported in this implementation");if(this[xd]!==e||this[Dd]!==r){this.flush(an.Z_SYNC_FLUSH),Ld(this[le],"zlib binding closed");let i=this[le].flush;this[le].flush=(n,s)=>{this.flush(n),s()};try{this[le].params(e,r)}finally{this[le].flush=i}this[le]&&(this[xd]=e,this[Dd]=r)}}}},$d=class extends Fr{constructor(e){super(e,"Deflate")}},kd=class extends Fr{constructor(e){super(e,"Inflate")}},Fd=Symbol("_portable"),qd=class extends Fr{constructor(e){super(e,"Gzip"),this[Fd]=e&&!!e.portable}[ln](e){return this[Fd]?(this[Fd]=!1,e[9]=255,super[ln](e)):super[ln](e)}},Md=class extends Fr{constructor(e){super(e,"Gunzip")}},Ud=class extends Fr{constructor(e){super(e,"DeflateRaw")}},Bd=class extends Fr{constructor(e){super(e,"InflateRaw")}},jd=class extends Fr{constructor(e){super(e,"Unzip")}},Eu=class extends Au{constructor(e,r){e=e||{},e.flush=e.flush||an.BROTLI_OPERATION_PROCESS,e.finishFlush=e.finishFlush||an.BROTLI_OPERATION_FINISH,super(e,r),this[Gd]=an.BROTLI_OPERATION_FLUSH}},Hd=class extends Eu{constructor(e){super(e,"BrotliCompress")}},Wd=class extends Eu{constructor(e){super(e,"BrotliDecompress")}};bt.Deflate=$d;bt.Inflate=kd;bt.Gzip=qd;bt.Gunzip=Md;bt.DeflateRaw=Ud;bt.InflateRaw=Bd;bt.Unzip=jd;typeof M_.BrotliCompress=="function"?(bt.BrotliCompress=Hd,bt.BrotliDecompress=Wd):bt.BrotliCompress=bt.BrotliDecompress=class{constructor(){throw new Error("Brotli is not supported in this version of Node.js")}}});var As=w(($W,U_)=>{var Kq=process.env.TESTING_TAR_FAKE_PLATFORM||process.platform;U_.exports=Kq!=="win32"?t=>t:t=>t&&t.replace(/\\/g,"/")});var Su=w((qW,B_)=>{"use strict";var{Minipass:Jq}=fu(),Vd=As(),Yd=Symbol("slurp");B_.exports=class extends Jq{constructor(e,r,i){switch(super(),this.pause(),this.extended=r,this.globalExtended=i,this.header=e,this.startBlockSize=512*Math.ceil(e.size/512),this.blockRemain=this.startBlockSize,this.remain=e.size,this.type=e.type,this.meta=!1,this.ignore=!1,this.type){case"File":case"OldFile":case"Link":case"SymbolicLink":case"CharacterDevice":case"BlockDevice":case"Directory":case"FIFO":case"ContiguousFile":case"GNUDumpDir":break;case"NextFileHasLongLinkpath":case"NextFileHasLongPath":case"OldGnuLongPath":case"GlobalExtendedHeader":case"ExtendedHeader":case"OldExtendedHeader":this.meta=!0;break;default:this.ignore=!0}this.path=Vd(e.path),this.mode=e.mode,this.mode&&(this.mode=this.mode&4095),this.uid=e.uid,this.gid=e.gid,this.uname=e.uname,this.gname=e.gname,this.size=e.size,this.mtime=e.mtime,this.atime=e.atime,this.ctime=e.ctime,this.linkpath=Vd(e.linkpath),this.uname=e.uname,this.gname=e.gname,r&&this[Yd](r),i&&this[Yd](i,!0)}write(e){let r=e.length;if(r>this.blockRemain)throw new Error("writing more to entry than is appropriate");let i=this.remain,n=this.blockRemain;return this.remain=Math.max(0,i-r),this.blockRemain=Math.max(0,n-r),this.ignore?!0:i>=r?super.write(e):super.write(e.slice(0,i))}[Yd](e,r){for(let i in e)e[i]!==null&&e[i]!==void 0&&!(r&&i==="path")&&(this[i]=i==="path"||i==="linkpath"?Vd(e[i]):e[i])}}});var Qd=w(bu=>{"use strict";bu.name=new Map([["0","File"],["","OldFile"],["1","Link"],["2","SymbolicLink"],["3","CharacterDevice"],["4","BlockDevice"],["5","Directory"],["6","FIFO"],["7","ContiguousFile"],["g","GlobalExtendedHeader"],["x","ExtendedHeader"],["A","SolarisACL"],["D","GNUDumpDir"],["I","Inode"],["K","NextFileHasLongLinkpath"],["L","NextFileHasLongPath"],["M","ContinuationFile"],["N","OldGnuLongPath"],["S","SparseFile"],["V","TapeVolumeHeader"],["X","OldExtendedHeader"]]);bu.code=new Map(Array.from(bu.name).map(t=>[t[1],t[0]]))});var G_=w((UW,W_)=>{"use strict";var Zq=(t,e)=>{if(Number.isSafeInteger(t))t<0?tM(t,e):eM(t,e);else throw Error("cannot encode number outside of javascript safe integer range");return e},eM=(t,e)=>{e[0]=128;for(var r=e.length;r>1;r--)e[r-1]=t&255,t=Math.floor(t/256)},tM=(t,e)=>{e[0]=255;var r=!1;t=t*-1;for(var i=e.length;i>1;i--){var n=t&255;t=Math.floor(t/256),r?e[i-1]=j_(n):n===0?e[i-1]=0:(r=!0,e[i-1]=H_(n))}},rM=t=>{let e=t[0],r=e===128?nM(t.slice(1,t.length)):e===255?iM(t):null;if(r===null)throw Error("invalid base256 encoding");if(!Number.isSafeInteger(r))throw Error("parsed number outside of javascript safe integer range");return r},iM=t=>{for(var e=t.length,r=0,i=!1,n=e-1;n>-1;n--){var s=t[n],o;i?o=j_(s):s===0?o=s:(i=!0,o=H_(s)),o!==0&&(r-=o*Math.pow(256,e-n-1))}return r},nM=t=>{for(var e=t.length,r=0,i=e-1;i>-1;i--){var n=t[i];n!==0&&(r+=n*Math.pow(256,e-i-1))}return r},j_=t=>(255^t)&255,H_=t=>(255^t)+1&255;W_.exports={encode:Zq,parse:rM}});var Ss=w((BW,V_)=>{"use strict";var Xd=Qd(),Es=require("path").posix,z_=G_(),Kd=Symbol("slurp"),_t=Symbol("type"),ep=class{constructor(e,r,i,n){this.cksumValid=!1,this.needPax=!1,this.nullBlock=!1,this.block=null,this.path=null,this.mode=null,this.uid=null,this.gid=null,this.size=null,this.mtime=null,this.cksum=null,this[_t]="0",this.linkpath=null,this.uname=null,this.gname=null,this.devmaj=0,this.devmin=0,this.atime=null,this.ctime=null,Buffer.isBuffer(e)?this.decode(e,r||0,i,n):e&&this.set(e)}decode(e,r,i,n){if(r||(r=0),!e||!(e.length>=r+512))throw new Error("need 512 bytes for header");if(this.path=un(e,r,100),this.mode=pi(e,r+100,8),this.uid=pi(e,r+108,8),this.gid=pi(e,r+116,8),this.size=pi(e,r+124,12),this.mtime=Jd(e,r+136,12),this.cksum=pi(e,r+148,12),this[Kd](i),this[Kd](n,!0),this[_t]=un(e,r+156,1),this[_t]===""&&(this[_t]="0"),this[_t]==="0"&&this.path.slice(-1)==="/"&&(this[_t]="5"),this[_t]==="5"&&(this.size=0),this.linkpath=un(e,r+157,100),e.slice(r+257,r+265).toString()==="ustar\x0000")if(this.uname=un(e,r+265,32),this.gname=un(e,r+297,32),this.devmaj=pi(e,r+329,8),this.devmin=pi(e,r+337,8),e[r+475]!==0){let o=un(e,r+345,155);this.path=o+"/"+this.path}else{let o=un(e,r+345,130);o&&(this.path=o+"/"+this.path),this.atime=Jd(e,r+476,12),this.ctime=Jd(e,r+488,12)}let s=8*32;for(let o=r;o<r+148;o++)s+=e[o];for(let o=r+156;o<r+512;o++)s+=e[o];this.cksumValid=s===this.cksum,this.cksum===null&&s===8*32&&(this.nullBlock=!0)}[Kd](e,r){for(let i in e)e[i]!==null&&e[i]!==void 0&&!(r&&i==="path")&&(this[i]=e[i])}encode(e,r){if(e||(e=this.block=Buffer.alloc(512),r=0),r||(r=0),!(e.length>=r+512))throw new Error("need 512 bytes for header");let i=this.ctime||this.atime?130:155,n=sM(this.path||"",i),s=n[0],o=n[1];this.needPax=n[2],this.needPax=cn(e,r,100,s)||this.needPax,this.needPax=mi(e,r+100,8,this.mode)||this.needPax,this.needPax=mi(e,r+108,8,this.uid)||this.needPax,this.needPax=mi(e,r+116,8,this.gid)||this.needPax,this.needPax=mi(e,r+124,12,this.size)||this.needPax,this.needPax=Zd(e,r+136,12,this.mtime)||this.needPax,e[r+156]=this[_t].charCodeAt(0),this.needPax=cn(e,r+157,100,this.linkpath)||this.needPax,e.write("ustar\x0000",r+257,8),this.needPax=cn(e,r+265,32,this.uname)||this.needPax,this.needPax=cn(e,r+297,32,this.gname)||this.needPax,this.needPax=mi(e,r+329,8,this.devmaj)||this.needPax,this.needPax=mi(e,r+337,8,this.devmin)||this.needPax,this.needPax=cn(e,r+345,i,o)||this.needPax,e[r+475]!==0?this.needPax=cn(e,r+345,155,o)||this.needPax:(this.needPax=cn(e,r+345,130,o)||this.needPax,this.needPax=Zd(e,r+476,12,this.atime)||this.needPax,this.needPax=Zd(e,r+488,12,this.ctime)||this.needPax);let a=8*32;for(let l=r;l<r+148;l++)a+=e[l];for(let l=r+156;l<r+512;l++)a+=e[l];return this.cksum=a,mi(e,r+148,8,this.cksum),this.cksumValid=!0,this.needPax}set(e){for(let r in e)e[r]!==null&&e[r]!==void 0&&(this[r]=e[r])}get type(){return Xd.name.get(this[_t])||this[_t]}get typeKey(){return this[_t]}set type(e){Xd.code.has(e)?this[_t]=Xd.code.get(e):this[_t]=e}},sM=(t,e)=>{let i=t,n="",s,o=Es.parse(t).root||".";if(Buffer.byteLength(i)<100)s=[i,n,!1];else{n=Es.dirname(i),i=Es.basename(i);do Buffer.byteLength(i)<=100&&Buffer.byteLength(n)<=e?s=[i,n,!1]:Buffer.byteLength(i)>100&&Buffer.byteLength(n)<=e?s=[i.slice(0,99),n,!0]:(i=Es.join(Es.basename(n),i),n=Es.dirname(n));while(n!==o&&!s);s||(s=[t.slice(0,99),"",!0])}return s},un=(t,e,r)=>t.slice(e,e+r).toString("utf8").replace(/\0.*/,""),Jd=(t,e,r)=>oM(pi(t,e,r)),oM=t=>t===null?null:new Date(t*1e3),pi=(t,e,r)=>t[e]&128?z_.parse(t.slice(e,e+r)):lM(t,e,r),aM=t=>isNaN(t)?null:t,lM=(t,e,r)=>aM(parseInt(t.slice(e,e+r).toString("utf8").replace(/\0.*$/,"").trim(),8)),uM={12:8589934591,8:2097151},mi=(t,e,r,i)=>i===null?!1:i>uM[r]||i<0?(z_.encode(i,t.slice(e,e+r)),!0):(cM(t,e,r,i),!1),cM=(t,e,r,i)=>t.write(hM(i,r),e,r,"ascii"),hM=(t,e)=>fM(Math.floor(t).toString(8),e),fM=(t,e)=>(t.length===e-1?t:new Array(e-t.length-1).join("0")+t+" ")+"\0",Zd=(t,e,r,i)=>i===null?!1:mi(t,e,r,i.getTime()/1e3),dM=new Array(156).join("\0"),cn=(t,e,r,i)=>i===null?!1:(t.write(i+dM,e,r,"utf8"),i.length!==Buffer.byteLength(i)||i.length>r);V_.exports=ep});var _u=w((jW,Y_)=>{"use strict";var pM=Ss(),mM=require("path"),Jo=class{constructor(e,r){this.atime=e.atime||null,this.charset=e.charset||null,this.comment=e.comment||null,this.ctime=e.ctime||null,this.gid=e.gid||null,this.gname=e.gname||null,this.linkpath=e.linkpath||null,this.mtime=e.mtime||null,this.path=e.path||null,this.size=e.size||null,this.uid=e.uid||null,this.uname=e.uname||null,this.dev=e.dev||null,this.ino=e.ino||null,this.nlink=e.nlink||null,this.global=r||!1}encode(){let e=this.encodeBody();if(e==="")return null;let r=Buffer.byteLength(e),i=512*Math.ceil(1+r/512),n=Buffer.allocUnsafe(i);for(let s=0;s<512;s++)n[s]=0;new pM({path:("PaxHeader/"+mM.basename(this.path)).slice(0,99),mode:this.mode||420,uid:this.uid||null,gid:this.gid||null,size:r,mtime:this.mtime||null,type:this.global?"GlobalExtendedHeader":"ExtendedHeader",linkpath:"",uname:this.uname||"",gname:this.gname||"",devmaj:0,devmin:0,atime:this.atime||null,ctime:this.ctime||null}).encode(n),n.write(e,512,r,"utf8");for(let s=r+512;s<n.length;s++)n[s]=0;return n}encodeBody(){return this.encodeField("path")+this.encodeField("ctime")+this.encodeField("atime")+this.encodeField("dev")+this.encodeField("ino")+this.encodeField("nlink")+this.encodeField("charset")+this.encodeField("comment")+this.encodeField("gid")+this.encodeField("gname")+this.encodeField("linkpath")+this.encodeField("mtime")+this.encodeField("size")+this.encodeField("uid")+this.encodeField("uname")}encodeField(e){if(this[e]===null||this[e]===void 0)return"";let r=this[e]instanceof Date?this[e].getTime()/1e3:this[e],i=" "+(e==="dev"||e==="ino"||e==="nlink"?"SCHILY.":"")+e+"="+r+"\n",n=Buffer.byteLength(i),s=Math.floor(Math.log(n)/Math.log(10))+1;return n+s>=Math.pow(10,s)&&(s+=1),s+n+i}};Jo.parse=(t,e,r)=>new Jo(gM(yM(t),e),r);var gM=(t,e)=>e?Object.keys(t).reduce((r,i)=>(r[i]=t[i],r),e):t,yM=t=>t.replace(/\n$/,"").split("\n").reduce(wM,Object.create(null)),wM=(t,e)=>{let r=parseInt(e,10);if(r!==Buffer.byteLength(e)+1)return t;e=e.slice((r+" ").length);let i=e.split("="),n=i.shift().replace(/^SCHILY\.(dev|ino|nlink)/,"$1");if(!n)return t;let s=i.join("=");return t[n]=/^([A-Z]+\.)?([mac]|birth|creation)time$/.test(n)?new Date(s*1e3):/^[0-9]+$/.test(s)?+s:s,t};Y_.exports=Jo});var bs=w((HW,Q_)=>{Q_.exports=t=>{let e=t.length-1,r=-1;for(;e>-1&&t.charAt(e)==="/";)r=e,e--;return r===-1?t:t.slice(0,r)}});var vu=w((WW,X_)=>{"use strict";X_.exports=t=>class extends t{warn(e,r,i={}){this.file&&(i.file=this.file),this.cwd&&(i.cwd=this.cwd),i.code=r instanceof Error&&r.code||e,i.tarCode=e,!this.strict&&i.recoverable!==!1?(r instanceof Error&&(i=Object.assign(r,i),r=r.message),this.emit("warn",i.tarCode,r,i)):r instanceof Error?this.emit("error",Object.assign(r,i)):this.emit("error",Object.assign(new Error("".concat(e,": ").concat(r)),i))}}});var rp=w((zW,K_)=>{"use strict";var Tu=["|","<",">","?",":"],tp=Tu.map(t=>String.fromCharCode(61440+t.charCodeAt(0))),AM=new Map(Tu.map((t,e)=>[t,tp[e]])),EM=new Map(tp.map((t,e)=>[t,Tu[e]]));K_.exports={encode:t=>Tu.reduce((e,r)=>e.split(r).join(AM.get(r)),t),decode:t=>tp.reduce((e,r)=>e.split(r).join(EM.get(r)),t)}});var ip=w((VW,Z_)=>{var{isAbsolute:SM,parse:J_}=require("path").win32;Z_.exports=t=>{let e="",r=J_(t);for(;SM(t)||r.root;){let i=t.charAt(0)==="/"&&t.slice(0,4)!=="//?/"?"/":r.root;t=t.slice(i.length),e+=i,r=J_(t)}return[e,t]}});var tv=w((YW,ev)=>{"use strict";ev.exports=(t,e,r)=>(t&=4095,r&&(t=(t|384)&-19),e&&(t&256&&(t|=64),t&32&&(t|=8),t&4&&(t|=1)),t)});var dp=w((KW,mv)=>{"use strict";var{Minipass:lv}=fu(),uv=_u(),cv=Ss(),or=require("fs"),rv=require("path"),sr=As(),bM=bs(),hv=(t,e)=>e?(t=sr(t).replace(/^\.(\/|$)/,""),bM(e)+"/"+t):sr(t),_M=16*1024*1024,iv=Symbol("process"),nv=Symbol("file"),sv=Symbol("directory"),sp=Symbol("symlink"),ov=Symbol("hardlink"),Zo=Symbol("header"),Ou=Symbol("read"),op=Symbol("lstat"),Cu=Symbol("onlstat"),ap=Symbol("onread"),lp=Symbol("onreadlink"),up=Symbol("openfile"),cp=Symbol("onopenfile"),gi=Symbol("close"),Ru=Symbol("mode"),hp=Symbol("awaitDrain"),np=Symbol("ondrain"),ar=Symbol("prefix"),av=Symbol("hadError"),fv=vu(),vM=rp(),dv=ip(),pv=tv(),Iu=fv(class extends lv{constructor(e,r){if(r=r||{},super(r),typeof e!="string")throw new TypeError("path is required");this.path=sr(e),this.portable=!!r.portable,this.myuid=process.getuid&&process.getuid()||0,this.myuser=process.env.USER||"",this.maxReadSize=r.maxReadSize||_M,this.linkCache=r.linkCache||new Map,this.statCache=r.statCache||new Map,this.preservePaths=!!r.preservePaths,this.cwd=sr(r.cwd||process.cwd()),this.strict=!!r.strict,this.noPax=!!r.noPax,this.noMtime=!!r.noMtime,this.mtime=r.mtime||null,this.prefix=r.prefix?sr(r.prefix):null,this.fd=null,this.blockLen=null,this.blockRemain=null,this.buf=null,this.offset=null,this.length=null,this.pos=null,this.remain=null,typeof r.onwarn=="function"&&this.on("warn",r.onwarn);let i=!1;if(!this.preservePaths){let[n,s]=dv(this.path);n&&(this.path=s,i=n)}this.win32=!!r.win32||process.platform==="win32",this.win32&&(this.path=vM.decode(this.path.replace(/\\/g,"/")),e=e.replace(/\\/g,"/")),this.absolute=sr(r.absolute||rv.resolve(this.cwd,e)),this.path===""&&(this.path="./"),i&&this.warn("TAR_ENTRY_INFO","stripping ".concat(i," from absolute path"),{entry:this,path:i+this.path}),this.statCache.has(this.absolute)?this[Cu](this.statCache.get(this.absolute)):this[op]()}emit(e,...r){return e==="error"&&(this[av]=!0),super.emit(e,...r)}[op](){or.lstat(this.absolute,(e,r)=>{if(e)return this.emit("error",e);this[Cu](r)})}[Cu](e){this.statCache.set(this.absolute,e),this.stat=e,e.isFile()||(e.size=0),this.type=OM(e),this.emit("stat",e),this[iv]()}[iv](){switch(this.type){case"File":return this[nv]();case"Directory":return this[sv]();case"SymbolicLink":return this[sp]();default:return this.end()}}[Ru](e){return pv(e,this.type==="Directory",this.portable)}[ar](e){return hv(e,this.prefix)}[Zo](){this.type==="Directory"&&this.portable&&(this.noMtime=!0),this.header=new cv({path:this[ar](this.path),linkpath:this.type==="Link"?this[ar](this.linkpath):this.linkpath,mode:this[Ru](this.stat.mode),uid:this.portable?null:this.stat.uid,gid:this.portable?null:this.stat.gid,size:this.stat.size,mtime:this.noMtime?null:this.mtime||this.stat.mtime,type:this.type,uname:this.portable?null:this.stat.uid===this.myuid?this.myuser:"",atime:this.portable?null:this.stat.atime,ctime:this.portable?null:this.stat.ctime}),this.header.encode()&&!this.noPax&&super.write(new uv({atime:this.portable?null:this.header.atime,ctime:this.portable?null:this.header.ctime,gid:this.portable?null:this.header.gid,mtime:this.noMtime?null:this.mtime||this.header.mtime,path:this[ar](this.path),linkpath:this.type==="Link"?this[ar](this.linkpath):this.linkpath,size:this.header.size,uid:this.portable?null:this.header.uid,uname:this.portable?null:this.header.uname,dev:this.portable?null:this.stat.dev,ino:this.portable?null:this.stat.ino,nlink:this.portable?null:this.stat.nlink}).encode()),super.write(this.header.block)}[sv](){this.path.slice(-1)!=="/"&&(this.path+="/"),this.stat.size=0,this[Zo](),this.end()}[sp](){or.readlink(this.absolute,(e,r)=>{if(e)return this.emit("error",e);this[lp](r)})}[lp](e){this.linkpath=sr(e),this[Zo](),this.end()}[ov](e){this.type="Link",this.linkpath=sr(rv.relative(this.cwd,e)),this.stat.size=0,this[Zo](),this.end()}[nv](){if(this.stat.nlink>1){let e=this.stat.dev+":"+this.stat.ino;if(this.linkCache.has(e)){let r=this.linkCache.get(e);if(r.indexOf(this.cwd)===0)return this[ov](r)}this.linkCache.set(e,this.absolute)}if(this[Zo](),this.stat.size===0)return this.end();this[up]()}[up](){or.open(this.absolute,"r",(e,r)=>{if(e)return this.emit("error",e);this[cp](r)})}[cp](e){if(this.fd=e,this[av])return this[gi]();this.blockLen=512*Math.ceil(this.stat.size/512),this.blockRemain=this.blockLen;let r=Math.min(this.blockLen,this.maxReadSize);this.buf=Buffer.allocUnsafe(r),this.offset=0,this.pos=0,this.remain=this.stat.size,this.length=this.buf.length,this[Ou]()}[Ou](){let{fd:e,buf:r,offset:i,length:n,pos:s}=this;or.read(e,r,i,n,s,(o,a)=>{if(o)return this[gi](()=>this.emit("error",o));this[ap](a)})}[gi](e){or.close(this.fd,e)}[ap](e){if(e<=0&&this.remain>0){let n=new Error("encountered unexpected EOF");return n.path=this.absolute,n.syscall="read",n.code="EOF",this[gi](()=>this.emit("error",n))}if(e>this.remain){let n=new Error("did not encounter expected EOF");return n.path=this.absolute,n.syscall="read",n.code="EOF",this[gi](()=>this.emit("error",n))}if(e===this.remain)for(let n=e;n<this.length&&e<this.blockRemain;n++)this.buf[n+this.offset]=0,e++,this.remain++;let r=this.offset===0&&e===this.buf.length?this.buf:this.buf.slice(this.offset,this.offset+e);this.write(r)?this[np]():this[hp](()=>this[np]())}[hp](e){this.once("drain",e)}write(e){if(this.blockRemain<e.length){let r=new Error("writing more data than expected");return r.path=this.absolute,this.emit("error",r)}return this.remain-=e.length,this.blockRemain-=e.length,this.pos+=e.length,this.offset+=e.length,super.write(e)}[np](){if(!this.remain)return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),this[gi](e=>e?this.emit("error",e):this.end());this.offset>=this.length&&(this.buf=Buffer.allocUnsafe(Math.min(this.blockRemain,this.buf.length)),this.offset=0),this.length=this.buf.length-this.offset,this[Ou]()}}),fp=class extends Iu{[op](){this[Cu](or.lstatSync(this.absolute))}[sp](){this[lp](or.readlinkSync(this.absolute))}[up](){this[cp](or.openSync(this.absolute,"r"))}[Ou](){let e=!0;try{let{fd:r,buf:i,offset:n,length:s,pos:o}=this,a=or.readSync(r,i,n,s,o);this[ap](a),e=!1}finally{if(e)try{this[gi](()=>{})}catch{}}}[hp](e){e()}[gi](e){or.closeSync(this.fd),e()}},TM=fv(class extends lv{constructor(e,r){r=r||{},super(r),this.preservePaths=!!r.preservePaths,this.portable=!!r.portable,this.strict=!!r.strict,this.noPax=!!r.noPax,this.noMtime=!!r.noMtime,this.readEntry=e,this.type=e.type,this.type==="Directory"&&this.portable&&(this.noMtime=!0),this.prefix=r.prefix||null,this.path=sr(e.path),this.mode=this[Ru](e.mode),this.uid=this.portable?null:e.uid,this.gid=this.portable?null:e.gid,this.uname=this.portable?null:e.uname,this.gname=this.portable?null:e.gname,this.size=e.size,this.mtime=this.noMtime?null:r.mtime||e.mtime,this.atime=this.portable?null:e.atime,this.ctime=this.portable?null:e.ctime,this.linkpath=sr(e.linkpath),typeof r.onwarn=="function"&&this.on("warn",r.onwarn);let i=!1;if(!this.preservePaths){let[n,s]=dv(this.path);n&&(this.path=s,i=n)}this.remain=e.size,this.blockRemain=e.startBlockSize,this.header=new cv({path:this[ar](this.path),linkpath:this.type==="Link"?this[ar](this.linkpath):this.linkpath,mode:this.mode,uid:this.portable?null:this.uid,gid:this.portable?null:this.gid,size:this.size,mtime:this.noMtime?null:this.mtime,type:this.type,uname:this.portable?null:this.uname,atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime}),i&&this.warn("TAR_ENTRY_INFO","stripping ".concat(i," from absolute path"),{entry:this,path:i+this.path}),this.header.encode()&&!this.noPax&&super.write(new uv({atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime,gid:this.portable?null:this.gid,mtime:this.noMtime?null:this.mtime,path:this[ar](this.path),linkpath:this.type==="Link"?this[ar](this.linkpath):this.linkpath,size:this.size,uid:this.portable?null:this.uid,uname:this.portable?null:this.uname,dev:this.portable?null:this.readEntry.dev,ino:this.portable?null:this.readEntry.ino,nlink:this.portable?null:this.readEntry.nlink}).encode()),super.write(this.header.block),e.pipe(this)}[ar](e){return hv(e,this.prefix)}[Ru](e){return pv(e,this.type==="Directory",this.portable)}write(e){let r=e.length;if(r>this.blockRemain)throw new Error("writing more to entry than is appropriate");return this.blockRemain-=r,super.write(e)}end(){return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),super.end()}});Iu.Sync=fp;Iu.Tar=TM;var OM=t=>t.isFile()?"File":t.isDirectory()?"Directory":t.isSymbolicLink()?"SymbolicLink":"Unsupported";mv.exports=Iu});var yv=w((JW,gv)=>{"use strict";gv.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var pp=w((ZW,wv)=>{"use strict";wv.exports=Q;Q.Node=hn;Q.create=Q;function Q(t){var e=this;if(e instanceof Q||(e=new Q),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(n){e.push(n)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}Q.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};Q.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};Q.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};Q.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)RM(this,arguments[t]);return this.length};Q.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)IM(this,arguments[t]);return this.length};Q.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};Q.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};Q.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,i=0;r!==null;i++)t.call(e,r.value,i,this),r=r.next};Q.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,i=this.length-1;r!==null;i--)t.call(e,r.value,i,this),r=r.prev};Q.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};Q.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};Q.prototype.map=function(t,e){e=e||this;for(var r=new Q,i=this.head;i!==null;)r.push(t.call(e,i.value,this)),i=i.next;return r};Q.prototype.mapReverse=function(t,e){e=e||this;for(var r=new Q,i=this.tail;i!==null;)r.push(t.call(e,i.value,this)),i=i.prev;return r};Q.prototype.reduce=function(t,e){var r,i=this.head;if(arguments.length>1)r=e;else if(this.head)i=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=0;i!==null;n++)r=t(r,i.value,n),i=i.next;return r};Q.prototype.reduceReverse=function(t,e){var r,i=this.tail;if(arguments.length>1)r=e;else if(this.tail)i=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=this.length-1;i!==null;n--)r=t(r,i.value,n),i=i.prev;return r};Q.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};Q.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};Q.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Q;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,n=this.head;n!==null&&i<t;i++)n=n.next;for(;n!==null&&i<e;i++,n=n.next)r.push(n.value);return r};Q.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new Q;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,n=this.tail;n!==null&&i>e;i--)n=n.prev;for(;n!==null&&i>t;i--,n=n.prev)r.push(n.value);return r};Q.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var i=0,n=this.head;n!==null&&i<t;i++)n=n.next;for(var s=[],i=0;n&&i<e;i++)s.push(n.value),n=this.removeNode(n);n===null&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(var i=0;i<r.length;i++)n=CM(this,n,r[i]);return s};Q.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var i=r.prev;r.prev=r.next,r.next=i}return this.head=e,this.tail=t,this};function CM(t,e,r){var i=e===t.head?new hn(r,null,e,t):new hn(r,e,e.next,t);return i.next===null&&(t.tail=i),i.prev===null&&(t.head=i),t.length++,i}function RM(t,e){t.tail=new hn(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function IM(t,e){t.head=new hn(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function hn(t,e,r,i){if(!(this instanceof hn))return new hn(t,e,r,i);this.list=i,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{yv()(Q)}catch{}});var qu=w((t3,Ov)=>{"use strict";var $u=class{constructor(e,r){this.path=e||"./",this.absolute=r,this.entry=null,this.stat=null,this.readdir=null,this.pending=!1,this.ignore=!1,this.piped=!1}},{Minipass:NM}=fu(),Av=zd(),xM=Su(),_p=dp(),DM=_p.Sync,PM=_p.Tar,FM=pp(),Ev=Buffer.alloc(1024),Du=Symbol("onStat"),Nu=Symbol("ended"),lr=Symbol("queue"),_s=Symbol("current"),fn=Symbol("process"),xu=Symbol("processing"),Sv=Symbol("processJob"),ur=Symbol("jobs"),mp=Symbol("jobDone"),Pu=Symbol("addFSEntry"),bv=Symbol("addTarEntry"),Ap=Symbol("stat"),Ep=Symbol("readdir"),Fu=Symbol("onreaddir"),Lu=Symbol("pipe"),_v=Symbol("entry"),gp=Symbol("entryOpt"),Sp=Symbol("writeEntryClass"),Tv=Symbol("write"),yp=Symbol("ondrain"),ku=require("fs"),vv=require("path"),LM=vu(),wp=As(),vp=LM(class extends NM{constructor(e){if(super(e),e=e||Object.create(null),this.opt=e,this.file=e.file||"",this.cwd=e.cwd||process.cwd(),this.maxReadSize=e.maxReadSize,this.preservePaths=!!e.preservePaths,this.strict=!!e.strict,this.noPax=!!e.noPax,this.prefix=wp(e.prefix||""),this.linkCache=e.linkCache||new Map,this.statCache=e.statCache||new Map,this.readdirCache=e.readdirCache||new Map,this[Sp]=_p,typeof e.onwarn=="function"&&this.on("warn",e.onwarn),this.portable=!!e.portable,this.zip=null,e.gzip||e.brotli){if(e.gzip&&e.brotli)throw new TypeError("gzip and brotli are mutually exclusive");e.gzip&&(typeof e.gzip!="object"&&(e.gzip={}),this.portable&&(e.gzip.portable=!0),this.zip=new Av.Gzip(e.gzip)),e.brotli&&(typeof e.brotli!="object"&&(e.brotli={}),this.zip=new Av.BrotliCompress(e.brotli)),this.zip.on("data",r=>super.write(r)),this.zip.on("end",r=>super.end()),this.zip.on("drain",r=>this[yp]()),this.on("resume",r=>this.zip.resume())}else this.on("drain",this[yp]);this.noDirRecurse=!!e.noDirRecurse,this.follow=!!e.follow,this.noMtime=!!e.noMtime,this.mtime=e.mtime||null,this.filter=typeof e.filter=="function"?e.filter:r=>!0,this[lr]=new FM,this[ur]=0,this.jobs=+e.jobs||4,this[xu]=!1,this[Nu]=!1}[Tv](e){return super.write(e)}add(e){return this.write(e),this}end(e){return e&&this.write(e),this[Nu]=!0,this[fn](),this}write(e){if(this[Nu])throw new Error("write after end");return e instanceof xM?this[bv](e):this[Pu](e),this.flowing}[bv](e){let r=wp(vv.resolve(this.cwd,e.path));if(!this.filter(e.path,e))e.resume();else{let i=new $u(e.path,r,!1);i.entry=new PM(e,this[gp](i)),i.entry.on("end",n=>this[mp](i)),this[ur]+=1,this[lr].push(i)}this[fn]()}[Pu](e){let r=wp(vv.resolve(this.cwd,e));this[lr].push(new $u(e,r)),this[fn]()}[Ap](e){e.pending=!0,this[ur]+=1;let r=this.follow?"stat":"lstat";ku[r](e.absolute,(i,n)=>{e.pending=!1,this[ur]-=1,i?this.emit("error",i):this[Du](e,n)})}[Du](e,r){this.statCache.set(e.absolute,r),e.stat=r,this.filter(e.path,r)||(e.ignore=!0),this[fn]()}[Ep](e){e.pending=!0,this[ur]+=1,ku.readdir(e.absolute,(r,i)=>{if(e.pending=!1,this[ur]-=1,r)return this.emit("error",r);this[Fu](e,i)})}[Fu](e,r){this.readdirCache.set(e.absolute,r),e.readdir=r,this[fn]()}[fn](){if(!this[xu]){this[xu]=!0;for(let e=this[lr].head;e!==null&&this[ur]<this.jobs;e=e.next)if(this[Sv](e.value),e.value.ignore){let r=e.next;this[lr].removeNode(e),e.next=r}this[xu]=!1,this[Nu]&&!this[lr].length&&this[ur]===0&&(this.zip?this.zip.end(Ev):(super.write(Ev),super.end()))}}get[_s](){return this[lr]&&this[lr].head&&this[lr].head.value}[mp](e){this[lr].shift(),this[ur]-=1,this[fn]()}[Sv](e){if(!e.pending){if(e.entry){e===this[_s]&&!e.piped&&this[Lu](e);return}if(e.stat||(this.statCache.has(e.absolute)?this[Du](e,this.statCache.get(e.absolute)):this[Ap](e)),!!e.stat&&!e.ignore&&!(!this.noDirRecurse&&e.stat.isDirectory()&&!e.readdir&&(this.readdirCache.has(e.absolute)?this[Fu](e,this.readdirCache.get(e.absolute)):this[Ep](e),!e.readdir))){if(e.entry=this[_v](e),!e.entry){e.ignore=!0;return}e===this[_s]&&!e.piped&&this[Lu](e)}}}[gp](e){return{onwarn:(r,i,n)=>this.warn(r,i,n),noPax:this.noPax,cwd:this.cwd,absolute:e.absolute,preservePaths:this.preservePaths,maxReadSize:this.maxReadSize,strict:this.strict,portable:this.portable,linkCache:this.linkCache,statCache:this.statCache,noMtime:this.noMtime,mtime:this.mtime,prefix:this.prefix}}[_v](e){this[ur]+=1;try{return new this[Sp](e.path,this[gp](e)).on("end",()=>this[mp](e)).on("error",r=>this.emit("error",r))}catch(r){this.emit("error",r)}}[yp](){this[_s]&&this[_s].entry&&this[_s].entry.resume()}[Lu](e){e.piped=!0,e.readdir&&e.readdir.forEach(n=>{let s=e.path,o=s==="./"?"":s.replace(/\/*$/,"/");this[Pu](o+n)});let r=e.entry,i=this.zip;i?r.on("data",n=>{i.write(n)||r.pause()}):r.on("data",n=>{super.write(n)||r.pause()})}pause(){return this.zip&&this.zip.pause(),super.pause()}}),bp=class extends vp{constructor(e){super(e),this[Sp]=DM}pause(){}resume(){}[Ap](e){let r=this.follow?"statSync":"lstatSync";this[Du](e,ku[r](e.absolute))}[Ep](e,r){this[Fu](e,ku.readdirSync(e.absolute))}[Lu](e){let r=e.entry,i=this.zip;e.readdir&&e.readdir.forEach(n=>{let s=e.path,o=s==="./"?"":s.replace(/\/*$/,"/");this[Pu](o+n)}),i?r.on("data",n=>{i.write(n)}):r.on("data",n=>{super[Tv](n)})}};vp.Sync=bp;Ov.exports=vp});var $v=w((r3,Lv)=>{"use strict";var Cv=typeof process=="object"&&process?process:{stdout:null,stderr:null},$M=require("events"),Rv=require("stream"),Iv=require("string_decoder").StringDecoder,Lr=Symbol("EOF"),$r=Symbol("maybeEmitEnd"),yi=Symbol("emittedEnd"),Mu=Symbol("emittingEnd"),ea=Symbol("emittedError"),Uu=Symbol("closed"),Nv=Symbol("read"),Bu=Symbol("flush"),xv=Symbol("flushChunk"),gt=Symbol("encoding"),kr=Symbol("decoder"),ju=Symbol("flowing"),ta=Symbol("paused"),vs=Symbol("resume"),Fe=Symbol("bufferLength"),Tp=Symbol("bufferPush"),Op=Symbol("bufferShift"),Ve=Symbol("objectMode"),Ye=Symbol("destroyed"),Cp=Symbol("emitData"),Dv=Symbol("emitEnd"),Rp=Symbol("emitEnd2"),qr=Symbol("async"),ra=t=>Promise.resolve().then(t),Pv=global._MP_NO_ITERATOR_SYMBOLS_!=="1",kM=Pv&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),qM=Pv&&Symbol.iterator||Symbol("iterator not implemented"),MM=t=>t==="end"||t==="finish"||t==="prefinish",UM=t=>t instanceof ArrayBuffer||typeof t=="object"&&t.constructor&&t.constructor.name==="ArrayBuffer"&&t.byteLength>=0,BM=t=>!Buffer.isBuffer(t)&&ArrayBuffer.isView(t),Hu=class{constructor(e,r,i){this.src=e,this.dest=r,this.opts=i,this.ondrain=()=>e[vs](),r.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Ip=class extends Hu{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,r,i){super(e,r,i),this.proxyErrors=n=>r.emit("error",n),e.on("error",this.proxyErrors)}};Lv.exports=class Fv extends Rv{constructor(e){super(),this[ju]=!1,this[ta]=!1,this.pipes=[],this.buffer=[],this[Ve]=e&&e.objectMode||!1,this[Ve]?this[gt]=null:this[gt]=e&&e.encoding||null,this[gt]==="buffer"&&(this[gt]=null),this[qr]=e&&!!e.async||!1,this[kr]=this[gt]?new Iv(this[gt]):null,this[Lr]=!1,this[yi]=!1,this[Mu]=!1,this[Uu]=!1,this[ea]=null,this.writable=!0,this.readable=!0,this[Fe]=0,this[Ye]=!1}get bufferLength(){return this[Fe]}get encoding(){return this[gt]}set encoding(e){if(this[Ve])throw new Error("cannot set encoding in objectMode");if(this[gt]&&e!==this[gt]&&(this[kr]&&this[kr].lastNeed||this[Fe]))throw new Error("cannot change encoding");this[gt]!==e&&(this[kr]=e?new Iv(e):null,this.buffer.length&&(this.buffer=this.buffer.map(r=>this[kr].write(r)))),this[gt]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[Ve]}set objectMode(e){this[Ve]=this[Ve]||!!e}get async(){return this[qr]}set async(e){this[qr]=this[qr]||!!e}write(e,r,i){if(this[Lr])throw new Error("write after end");if(this[Ye])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof r=="function"&&(i=r,r="utf8"),r||(r="utf8");let n=this[qr]?ra:s=>s();return!this[Ve]&&!Buffer.isBuffer(e)&&(BM(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):UM(e)?e=Buffer.from(e):typeof e!="string"&&(this.objectMode=!0)),this[Ve]?(this.flowing&&this[Fe]!==0&&this[Bu](!0),this.flowing?this.emit("data",e):this[Tp](e),this[Fe]!==0&&this.emit("readable"),i&&n(i),this.flowing):e.length?(typeof e=="string"&&!(r===this[gt]&&!this[kr].lastNeed)&&(e=Buffer.from(e,r)),Buffer.isBuffer(e)&&this[gt]&&(e=this[kr].write(e)),this.flowing&&this[Fe]!==0&&this[Bu](!0),this.flowing?this.emit("data",e):this[Tp](e),this[Fe]!==0&&this.emit("readable"),i&&n(i),this.flowing):(this[Fe]!==0&&this.emit("readable"),i&&n(i),this.flowing)}read(e){if(this[Ye])return null;if(this[Fe]===0||e===0||e>this[Fe])return this[$r](),null;this[Ve]&&(e=null),this.buffer.length>1&&!this[Ve]&&(this.encoding?this.buffer=[this.buffer.join("")]:this.buffer=[Buffer.concat(this.buffer,this[Fe])]);let r=this[Nv](e||null,this.buffer[0]);return this[$r](),r}[Nv](e,r){return e===r.length||e===null?this[Op]():(this.buffer[0]=r.slice(e),r=r.slice(0,e),this[Fe]-=e),this.emit("data",r),!this.buffer.length&&!this[Lr]&&this.emit("drain"),r}end(e,r,i){return typeof e=="function"&&(i=e,e=null),typeof r=="function"&&(i=r,r="utf8"),e&&this.write(e,r),i&&this.once("end",i),this[Lr]=!0,this.writable=!1,(this.flowing||!this[ta])&&this[$r](),this}[vs](){this[Ye]||(this[ta]=!1,this[ju]=!0,this.emit("resume"),this.buffer.length?this[Bu]():this[Lr]?this[$r]():this.emit("drain"))}resume(){return this[vs]()}pause(){this[ju]=!1,this[ta]=!0}get destroyed(){return this[Ye]}get flowing(){return this[ju]}get paused(){return this[ta]}[Tp](e){this[Ve]?this[Fe]+=1:this[Fe]+=e.length,this.buffer.push(e)}[Op](){return this.buffer.length&&(this[Ve]?this[Fe]-=1:this[Fe]-=this.buffer[0].length),this.buffer.shift()}[Bu](e){do;while(this[xv](this[Op]()));!e&&!this.buffer.length&&!this[Lr]&&this.emit("drain")}[xv](e){return e?(this.emit("data",e),this.flowing):!1}pipe(e,r){if(this[Ye])return;let i=this[yi];return r=r||{},e===Cv.stdout||e===Cv.stderr?r.end=!1:r.end=r.end!==!1,r.proxyErrors=!!r.proxyErrors,i?r.end&&e.end():(this.pipes.push(r.proxyErrors?new Ip(this,e,r):new Hu(this,e,r)),this[qr]?ra(()=>this[vs]()):this[vs]()),e}unpipe(e){let r=this.pipes.find(i=>i.dest===e);r&&(this.pipes.splice(this.pipes.indexOf(r),1),r.unpipe())}addListener(e,r){return this.on(e,r)}on(e,r){let i=super.on(e,r);return e==="data"&&!this.pipes.length&&!this.flowing?this[vs]():e==="readable"&&this[Fe]!==0?super.emit("readable"):MM(e)&&this[yi]?(super.emit(e),this.removeAllListeners(e)):e==="error"&&this[ea]&&(this[qr]?ra(()=>r.call(this,this[ea])):r.call(this,this[ea])),i}get emittedEnd(){return this[yi]}[$r](){!this[Mu]&&!this[yi]&&!this[Ye]&&this.buffer.length===0&&this[Lr]&&(this[Mu]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[Uu]&&this.emit("close"),this[Mu]=!1)}emit(e,r,...i){if(e!=="error"&&e!=="close"&&e!==Ye&&this[Ye])return;if(e==="data")return r?this[qr]?ra(()=>this[Cp](r)):this[Cp](r):!1;if(e==="end")return this[Dv]();if(e==="close"){if(this[Uu]=!0,!this[yi]&&!this[Ye])return;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[ea]=r;let s=super.emit("error",r);return this[$r](),s}else if(e==="resume"){let s=super.emit("resume");return this[$r](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,r,...i);return this[$r](),n}[Cp](e){for(let i of this.pipes)i.dest.write(e)===!1&&this.pause();let r=super.emit("data",e);return this[$r](),r}[Dv](){this[yi]||(this[yi]=!0,this.readable=!1,this[qr]?ra(()=>this[Rp]()):this[Rp]())}[Rp](){if(this[kr]){let r=this[kr].end();if(r){for(let i of this.pipes)i.dest.write(r);super.emit("data",r)}}for(let r of this.pipes)r.end();let e=super.emit("end");return this.removeAllListeners("end"),e}collect(){let e=[];this[Ve]||(e.dataLength=0);let r=this.promise();return this.on("data",i=>{e.push(i),this[Ve]||(e.dataLength+=i.length)}),r.then(()=>e)}concat(){return this[Ve]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then(e=>this[Ve]?Promise.reject(new Error("cannot concat in objectMode")):this[gt]?e.join(""):Buffer.concat(e,e.dataLength))}promise(){return new Promise((e,r)=>{this.on(Ye,()=>r(new Error("stream destroyed"))),this.on("error",i=>r(i)),this.on("end",()=>e())})}[kM](){return{next:()=>{let r=this.read();if(r!==null)return Promise.resolve({done:!1,value:r});if(this[Lr])return Promise.resolve({done:!0});let i=null,n=null,s=c=>{this.removeListener("data",o),this.removeListener("end",a),n(c)},o=c=>{this.removeListener("error",s),this.removeListener("end",a),this.pause(),i({value:c,done:!!this[Lr]})},a=()=>{this.removeListener("error",s),this.removeListener("data",o),i({done:!0})},l=()=>s(new Error("stream destroyed"));return new Promise((c,u)=>{n=u,i=c,this.once(Ye,l),this.once("error",s),this.once("end",a),this.once("data",o)})}}}[qM](){return{next:()=>{let r=this.read();return{value:r,done:r===null}}}}destroy(e){return this[Ye]?(e?this.emit("error",e):this.emit(Ye),this):(this[Ye]=!0,this.buffer.length=0,this[Fe]=0,typeof this.close=="function"&&!this[Uu]&&this.close(),e?this.emit("error",e):this.emit(Ye),this)}static isStream(e){return!!e&&(e instanceof Fv||e instanceof Rv||e instanceof $M&&(typeof e.pipe=="function"||typeof e.write=="function"&&typeof e.end=="function"))}}});var Ds=w(na=>{"use strict";var jM=$v(),HM=require("events").EventEmitter,yt=require("fs"),Dp=yt.writev;if(!Dp){let t=process.binding("fs"),e=t.FSReqWrap||t.FSReqCallback;Dp=(r,i,n,s)=>{let o=(l,c)=>s(l,c,i),a=new e;a.oncomplete=o,t.writeBuffers(r,i,n,a)}}var Ns=Symbol("_autoClose"),Yt=Symbol("_close"),ia=Symbol("_ended"),se=Symbol("_fd"),kv=Symbol("_finished"),Ai=Symbol("_flags"),Np=Symbol("_flush"),Pp=Symbol("_handleChunk"),Fp=Symbol("_makeBuf"),Yu=Symbol("_mode"),Wu=Symbol("_needDrain"),Rs=Symbol("_onerror"),xs=Symbol("_onopen"),xp=Symbol("_onread"),Os=Symbol("_onwrite"),Ei=Symbol("_open"),Mr=Symbol("_path"),dn=Symbol("_pos"),cr=Symbol("_queue"),Cs=Symbol("_read"),qv=Symbol("_readSize"),wi=Symbol("_reading"),Gu=Symbol("_remain"),Mv=Symbol("_size"),zu=Symbol("_write"),Ts=Symbol("_writing"),Vu=Symbol("_defaultFlag"),Is=Symbol("_errored"),Qu=class extends jM{constructor(e,r){if(r=r||{},super(r),this.readable=!0,this.writable=!1,typeof e!="string")throw new TypeError("path must be a string");this[Is]=!1,this[se]=typeof r.fd=="number"?r.fd:null,this[Mr]=e,this[qv]=r.readSize||16*1024*1024,this[wi]=!1,this[Mv]=typeof r.size=="number"?r.size:1/0,this[Gu]=this[Mv],this[Ns]=typeof r.autoClose=="boolean"?r.autoClose:!0,typeof this[se]=="number"?this[Cs]():this[Ei]()}get fd(){return this[se]}get path(){return this[Mr]}write(){throw new TypeError("this is a readable stream")}end(){throw new TypeError("this is a readable stream")}[Ei](){yt.open(this[Mr],"r",(e,r)=>this[xs](e,r))}[xs](e,r){e?this[Rs](e):(this[se]=r,this.emit("open",r),this[Cs]())}[Fp](){return Buffer.allocUnsafe(Math.min(this[qv],this[Gu]))}[Cs](){if(!this[wi]){this[wi]=!0;let e=this[Fp]();if(e.length===0)return process.nextTick(()=>this[xp](null,0,e));yt.read(this[se],e,0,e.length,null,(r,i,n)=>this[xp](r,i,n))}}[xp](e,r,i){this[wi]=!1,e?this[Rs](e):this[Pp](r,i)&&this[Cs]()}[Yt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.close(e,r=>r?this.emit("error",r):this.emit("close"))}}[Rs](e){this[wi]=!0,this[Yt](),this.emit("error",e)}[Pp](e,r){let i=!1;return this[Gu]-=e,e>0&&(i=super.write(e<r.length?r.slice(0,e):r)),(e===0||this[Gu]<=0)&&(i=!1,this[Yt](),super.end()),i}emit(e,r){switch(e){case"prefinish":case"finish":break;case"drain":typeof this[se]=="number"&&this[Cs]();break;case"error":return this[Is]?void 0:(this[Is]=!0,super.emit(e,r));default:return super.emit(e,r)}}},Lp=class extends Qu{[Ei](){let e=!0;try{this[xs](null,yt.openSync(this[Mr],"r")),e=!1}finally{e&&this[Yt]()}}[Cs](){let e=!0;try{if(!this[wi]){this[wi]=!0;do{let r=this[Fp](),i=r.length===0?0:yt.readSync(this[se],r,0,r.length,null);if(!this[Pp](i,r))break}while(!0);this[wi]=!1}e=!1}finally{e&&this[Yt]()}}[Yt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.closeSync(e),this.emit("close")}}},Xu=class extends HM{constructor(e,r){r=r||{},super(r),this.readable=!1,this.writable=!0,this[Is]=!1,this[Ts]=!1,this[ia]=!1,this[Wu]=!1,this[cr]=[],this[Mr]=e,this[se]=typeof r.fd=="number"?r.fd:null,this[Yu]=r.mode===void 0?438:r.mode,this[dn]=typeof r.start=="number"?r.start:null,this[Ns]=typeof r.autoClose=="boolean"?r.autoClose:!0;let i=this[dn]!==null?"r+":"w";this[Vu]=r.flags===void 0,this[Ai]=this[Vu]?i:r.flags,this[se]===null&&this[Ei]()}emit(e,r){if(e==="error"){if(this[Is])return;this[Is]=!0}return super.emit(e,r)}get fd(){return this[se]}get path(){return this[Mr]}[Rs](e){this[Yt](),this[Ts]=!0,this.emit("error",e)}[Ei](){yt.open(this[Mr],this[Ai],this[Yu],(e,r)=>this[xs](e,r))}[xs](e,r){this[Vu]&&this[Ai]==="r+"&&e&&e.code==="ENOENT"?(this[Ai]="w",this[Ei]()):e?this[Rs](e):(this[se]=r,this.emit("open",r),this[Np]())}end(e,r){return e&&this.write(e,r),this[ia]=!0,!this[Ts]&&!this[cr].length&&typeof this[se]=="number"&&this[Os](null,0),this}write(e,r){return typeof e=="string"&&(e=Buffer.from(e,r)),this[ia]?(this.emit("error",new Error("write() after end()")),!1):this[se]===null||this[Ts]||this[cr].length?(this[cr].push(e),this[Wu]=!0,!1):(this[Ts]=!0,this[zu](e),!0)}[zu](e){yt.write(this[se],e,0,e.length,this[dn],(r,i)=>this[Os](r,i))}[Os](e,r){e?this[Rs](e):(this[dn]!==null&&(this[dn]+=r),this[cr].length?this[Np]():(this[Ts]=!1,this[ia]&&!this[kv]?(this[kv]=!0,this[Yt](),this.emit("finish")):this[Wu]&&(this[Wu]=!1,this.emit("drain"))))}[Np](){if(this[cr].length===0)this[ia]&&this[Os](null,0);else if(this[cr].length===1)this[zu](this[cr].pop());else{let e=this[cr];this[cr]=[],Dp(this[se],e,this[dn],(r,i)=>this[Os](r,i))}}[Yt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.close(e,r=>r?this.emit("error",r):this.emit("close"))}}},$p=class extends Xu{[Ei](){let e;if(this[Vu]&&this[Ai]==="r+")try{e=yt.openSync(this[Mr],this[Ai],this[Yu])}catch(r){if(r.code==="ENOENT")return this[Ai]="w",this[Ei]();throw r}else e=yt.openSync(this[Mr],this[Ai],this[Yu]);this[xs](null,e)}[Yt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.closeSync(e),this.emit("close")}}[zu](e){let r=!0;try{this[Os](null,yt.writeSync(this[se],e,0,e.length,this[dn])),r=!1}finally{if(r)try{this[Yt]()}catch{}}}};na.ReadStream=Qu;na.ReadStreamSync=Lp;na.WriteStream=Xu;na.WriteStreamSync=$p});var ic=w((s3,Qv)=>{"use strict";var WM=vu(),Uv=Ss(),GM=require("events"),zM=pp(),VM=1024*1024,YM=Su(),Bv=_u(),jv=zd(),{nextTick:QM}=require("process"),kp=Buffer.from([31,139]),Ft=Symbol("state"),pn=Symbol("writeEntry"),Ur=Symbol("readEntry"),qp=Symbol("nextEntry"),Hv=Symbol("processEntry"),Lt=Symbol("extendedHeader"),sa=Symbol("globalExtendedHeader"),Si=Symbol("meta"),Wv=Symbol("emitMeta"),ue=Symbol("buffer"),Br=Symbol("queue"),bi=Symbol("ended"),Gv=Symbol("emittedEnd"),mn=Symbol("emit"),Le=Symbol("unzip"),Ku=Symbol("consumeChunk"),Ju=Symbol("consumeChunkSub"),Mp=Symbol("consumeBody"),zv=Symbol("consumeMeta"),Vv=Symbol("consumeHeader"),Zu=Symbol("consuming"),Up=Symbol("bufferConcat"),Bp=Symbol("maybeEnd"),oa=Symbol("writing"),_i=Symbol("aborted"),ec=Symbol("onDone"),gn=Symbol("sawValidEntry"),tc=Symbol("sawNullBlock"),rc=Symbol("sawEOF"),Yv=Symbol("closeStream"),XM=t=>!0;Qv.exports=WM(class extends GM{constructor(e){e=e||{},super(e),this.file=e.file||"",this[gn]=null,this.on(ec,i=>{(this[Ft]==="begin"||this[gn]===!1)&&this.warn("TAR_BAD_ARCHIVE","Unrecognized archive format")}),e.ondone?this.on(ec,e.ondone):this.on(ec,i=>{this.emit("prefinish"),this.emit("finish"),this.emit("end")}),this.strict=!!e.strict,this.maxMetaEntrySize=e.maxMetaEntrySize||VM,this.filter=typeof e.filter=="function"?e.filter:XM;let r=e.file&&(e.file.endsWith(".tar.br")||e.file.endsWith(".tbr"));this.brotli=!e.gzip&&e.brotli!==void 0?e.brotli:r?void 0:!1,this.writable=!0,this.readable=!1,this[Br]=new zM,this[ue]=null,this[Ur]=null,this[pn]=null,this[Ft]="begin",this[Si]="",this[Lt]=null,this[sa]=null,this[bi]=!1,this[Le]=null,this[_i]=!1,this[tc]=!1,this[rc]=!1,this.on("end",()=>this[Yv]()),typeof e.onwarn=="function"&&this.on("warn",e.onwarn),typeof e.onentry=="function"&&this.on("entry",e.onentry)}[Vv](e,r){this[gn]===null&&(this[gn]=!1);let i;try{i=new Uv(e,r,this[Lt],this[sa])}catch(n){return this.warn("TAR_ENTRY_INVALID",n)}if(i.nullBlock)this[tc]?(this[rc]=!0,this[Ft]==="begin"&&(this[Ft]="header"),this[mn]("eof")):(this[tc]=!0,this[mn]("nullBlock"));else if(this[tc]=!1,!i.cksumValid)this.warn("TAR_ENTRY_INVALID","checksum failure",{header:i});else if(!i.path)this.warn("TAR_ENTRY_INVALID","path is required",{header:i});else{let n=i.type;if(/^(Symbolic)?Link$/.test(n)&&!i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath required",{header:i});else if(!/^(Symbolic)?Link$/.test(n)&&i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath forbidden",{header:i});else{let s=this[pn]=new YM(i,this[Lt],this[sa]);if(!this[gn])if(s.remain){let o=()=>{s.invalid||(this[gn]=!0)};s.on("end",o)}else this[gn]=!0;s.meta?s.size>this.maxMetaEntrySize?(s.ignore=!0,this[mn]("ignoredEntry",s),this[Ft]="ignore",s.resume()):s.size>0&&(this[Si]="",s.on("data",o=>this[Si]+=o),this[Ft]="meta"):(this[Lt]=null,s.ignore=s.ignore||!this.filter(s.path,s),s.ignore?(this[mn]("ignoredEntry",s),this[Ft]=s.remain?"ignore":"header",s.resume()):(s.remain?this[Ft]="body":(this[Ft]="header",s.end()),this[Ur]?this[Br].push(s):(this[Br].push(s),this[qp]())))}}}[Yv](){QM(()=>this.emit("close"))}[Hv](e){let r=!0;return e?Array.isArray(e)?this.emit.apply(this,e):(this[Ur]=e,this.emit("entry",e),e.emittedEnd||(e.on("end",i=>this[qp]()),r=!1)):(this[Ur]=null,r=!1),r}[qp](){do;while(this[Hv](this[Br].shift()));if(!this[Br].length){let e=this[Ur];!e||e.flowing||e.size===e.remain?this[oa]||this.emit("drain"):e.once("drain",i=>this.emit("drain"))}}[Mp](e,r){let i=this[pn],n=i.blockRemain,s=n>=e.length&&r===0?e:e.slice(r,r+n);return i.write(s),i.blockRemain||(this[Ft]="header",this[pn]=null,i.end()),s.length}[zv](e,r){let i=this[pn],n=this[Mp](e,r);return this[pn]||this[Wv](i),n}[mn](e,r,i){!this[Br].length&&!this[Ur]?this.emit(e,r,i):this[Br].push([e,r,i])}[Wv](e){switch(this[mn]("meta",this[Si]),e.type){case"ExtendedHeader":case"OldExtendedHeader":this[Lt]=Bv.parse(this[Si],this[Lt],!1);break;case"GlobalExtendedHeader":this[sa]=Bv.parse(this[Si],this[sa],!0);break;case"NextFileHasLongPath":case"OldGnuLongPath":this[Lt]=this[Lt]||Object.create(null),this[Lt].path=this[Si].replace(/\0.*/,"");break;case"NextFileHasLongLinkpath":this[Lt]=this[Lt]||Object.create(null),this[Lt].linkpath=this[Si].replace(/\0.*/,"");break;default:throw new Error("unknown meta: "+e.type)}}abort(e){this[_i]=!0,this.emit("abort",e),this.warn("TAR_ABORT",e,{recoverable:!1})}write(e){if(this[_i])return;if((this[Le]===null||this.brotli===void 0&&this[Le]===!1)&&e){if(this[ue]&&(e=Buffer.concat([this[ue],e]),this[ue]=null),e.length<kp.length)return this[ue]=e,!0;for(let s=0;this[Le]===null&&s<kp.length;s++)e[s]!==kp[s]&&(this[Le]=!1);let n=this.brotli===void 0;if(this[Le]===!1&&n)if(e.length<512)if(this[bi])this.brotli=!0;else return this[ue]=e,!0;else try{new Uv(e.slice(0,512)),this.brotli=!1}catch{this.brotli=!0}if(this[Le]===null||this[Le]===!1&&this.brotli){let s=this[bi];this[bi]=!1,this[Le]=this[Le]===null?new jv.Unzip:new jv.BrotliDecompress,this[Le].on("data",a=>this[Ku](a)),this[Le].on("error",a=>this.abort(a)),this[Le].on("end",a=>{this[bi]=!0,this[Ku]()}),this[oa]=!0;let o=this[Le][s?"end":"write"](e);return this[oa]=!1,o}}this[oa]=!0,this[Le]?this[Le].write(e):this[Ku](e),this[oa]=!1;let i=this[Br].length?!1:this[Ur]?this[Ur].flowing:!0;return!i&&!this[Br].length&&this[Ur].once("drain",n=>this.emit("drain")),i}[Up](e){e&&!this[_i]&&(this[ue]=this[ue]?Buffer.concat([this[ue],e]):e)}[Bp](){if(this[bi]&&!this[Gv]&&!this[_i]&&!this[Zu]){this[Gv]=!0;let e=this[pn];if(e&&e.blockRemain){let r=this[ue]?this[ue].length:0;this.warn("TAR_BAD_ARCHIVE","Truncated input (needed ".concat(e.blockRemain," more bytes, only ").concat(r," available)"),{entry:e}),this[ue]&&e.write(this[ue]),e.end()}this[mn](ec)}}[Ku](e){if(this[Zu])this[Up](e);else if(!e&&!this[ue])this[Bp]();else{if(this[Zu]=!0,this[ue]){this[Up](e);let r=this[ue];this[ue]=null,this[Ju](r)}else this[Ju](e);for(;this[ue]&&this[ue].length>=512&&!this[_i]&&!this[rc];){let r=this[ue];this[ue]=null,this[Ju](r)}this[Zu]=!1}(!this[ue]||this[bi])&&this[Bp]()}[Ju](e){let r=0,i=e.length;for(;r+512<=i&&!this[_i]&&!this[rc];)switch(this[Ft]){case"begin":case"header":this[Vv](e,r),r+=512;break;case"ignore":case"body":r+=this[Mp](e,r);break;case"meta":r+=this[zv](e,r);break;default:throw new Error("invalid state: "+this[Ft])}r<i&&(this[ue]?this[ue]=Buffer.concat([e.slice(r),this[ue]]):this[ue]=e.slice(r))}end(e){this[_i]||(this[Le]?this[Le].end(e):(this[bi]=!0,this.brotli===void 0&&(e=e||Buffer.alloc(0)),this.write(e)))}})});var nc=w((o3,Zv)=>{"use strict";var KM=ps(),Kv=ic(),Ps=require("fs"),JM=Ds(),Xv=require("path"),jp=bs();Zv.exports=(t,e,r)=>{typeof t=="function"?(r=t,e=null,t={}):Array.isArray(t)&&(e=t,t={}),typeof e=="function"&&(r=e,e=null),e?e=Array.from(e):e=[];let i=KM(t);if(i.sync&&typeof r=="function")throw new TypeError("callback not supported for sync tar functions");if(!i.file&&typeof r=="function")throw new TypeError("callback only supported with file option");return e.length&&eU(i,e),i.noResume||ZM(i),i.file&&i.sync?tU(i):i.file?rU(i,r):Jv(i)};var ZM=t=>{let e=t.onentry;t.onentry=e?r=>{e(r),r.resume()}:r=>r.resume()},eU=(t,e)=>{let r=new Map(e.map(s=>[jp(s),!0])),i=t.filter,n=(s,o)=>{let a=o||Xv.parse(s).root||".",l=s===a?!1:r.has(s)?r.get(s):n(Xv.dirname(s),a);return r.set(s,l),l};t.filter=i?(s,o)=>i(s,o)&&n(jp(s)):s=>n(jp(s))},tU=t=>{let e=Jv(t),r=t.file,i=!0,n;try{let s=Ps.statSync(r),o=t.maxReadSize||16*1024*1024;if(s.size<o)e.end(Ps.readFileSync(r));else{let a=0,l=Buffer.allocUnsafe(o);for(n=Ps.openSync(r,"r");a<s.size;){let c=Ps.readSync(n,l,0,o,a);a+=c,e.write(l.slice(0,c))}e.end()}i=!1}finally{if(i&&n)try{Ps.closeSync(n)}catch{}}},rU=(t,e)=>{let r=new Kv(t),i=t.maxReadSize||16*1024*1024,n=t.file,s=new Promise((o,a)=>{r.on("error",a),r.on("end",o),Ps.stat(n,(l,c)=>{if(l)a(l);else{let u=new JM.ReadStream(n,{readSize:i,size:c.size});u.on("error",a),u.pipe(r)}})});return e?s.then(e,e):s},Jv=t=>new Kv(t)});var sT=w((a3,nT)=>{"use strict";var iU=ps(),sc=qu(),eT=Ds(),tT=nc(),rT=require("path");nT.exports=(t,e,r)=>{if(typeof e=="function"&&(r=e),Array.isArray(t)&&(e=t,t={}),!e||!Array.isArray(e)||!e.length)throw new TypeError("no files or directories specified");e=Array.from(e);let i=iU(t);if(i.sync&&typeof r=="function")throw new TypeError("callback not supported for sync tar functions");if(!i.file&&typeof r=="function")throw new TypeError("callback only supported with file option");return i.file&&i.sync?nU(i,e):i.file?sU(i,e,r):i.sync?oU(i,e):aU(i,e)};var nU=(t,e)=>{let r=new sc.Sync(t),i=new eT.WriteStreamSync(t.file,{mode:t.mode||438});r.pipe(i),iT(r,e)},sU=(t,e,r)=>{let i=new sc(t),n=new eT.WriteStream(t.file,{mode:t.mode||438});i.pipe(n);let s=new Promise((o,a)=>{n.on("error",a),n.on("close",o),i.on("error",a)});return Hp(i,e),r?s.then(r,r):s},iT=(t,e)=>{e.forEach(r=>{r.charAt(0)==="@"?tT({file:rT.resolve(t.cwd,r.slice(1)),sync:!0,noResume:!0,onentry:i=>t.add(i)}):t.add(r)}),t.end()},Hp=(t,e)=>{for(;e.length;){let r=e.shift();if(r.charAt(0)==="@")return tT({file:rT.resolve(t.cwd,r.slice(1)),noResume:!0,onentry:i=>t.add(i)}).then(i=>Hp(t,e));t.add(r)}t.end()},oU=(t,e)=>{let r=new sc.Sync(t);return iT(r,e),r},aU=(t,e)=>{let r=new sc(t);return Hp(r,e),r}});var Wp=w((l3,fT)=>{"use strict";var lU=ps(),oT=qu(),vt=require("fs"),aT=Ds(),lT=nc(),uT=require("path"),cT=Ss();fT.exports=(t,e,r)=>{let i=lU(t);if(!i.file)throw new TypeError("file is required");if(i.gzip||i.brotli||i.file.endsWith(".br")||i.file.endsWith(".tbr"))throw new TypeError("cannot append to compressed archives");if(!e||!Array.isArray(e)||!e.length)throw new TypeError("no files or directories specified");return e=Array.from(e),i.sync?uU(i,e):hU(i,e,r)};var uU=(t,e)=>{let r=new oT.Sync(t),i=!0,n,s;try{try{n=vt.openSync(t.file,"r+")}catch(l){if(l.code==="ENOENT")n=vt.openSync(t.file,"w+");else throw l}let o=vt.fstatSync(n),a=Buffer.alloc(512);e:for(s=0;s<o.size;s+=512){for(let u=0,h=0;u<512;u+=h){if(h=vt.readSync(n,a,u,a.length-u,s+u),s===0&&a[0]===31&&a[1]===139)throw new Error("cannot append to compressed archives");if(!h)break e}let l=new cT(a);if(!l.cksumValid)break;let c=512*Math.ceil(l.size/512);if(s+c+512>o.size)break;s+=c,t.mtimeCache&&t.mtimeCache.set(l.path,l.mtime)}i=!1,cU(t,r,s,n,e)}finally{if(i)try{vt.closeSync(n)}catch{}}},cU=(t,e,r,i,n)=>{let s=new aT.WriteStreamSync(t.file,{fd:i,start:r});e.pipe(s),fU(e,n)},hU=(t,e,r)=>{e=Array.from(e);let i=new oT(t),n=(o,a,l)=>{let c=(y,A)=>{y?vt.close(o,E=>l(y)):l(null,A)},u=0;if(a===0)return c(null,0);let h=0,f=Buffer.alloc(512),d=(y,A)=>{if(y)return c(y);if(h+=A,h<512&&A)return vt.read(o,f,h,f.length-h,u+h,d);if(u===0&&f[0]===31&&f[1]===139)return c(new Error("cannot append to compressed archives"));if(h<512)return c(null,u);let E=new cT(f);if(!E.cksumValid)return c(null,u);let v=512*Math.ceil(E.size/512);if(u+v+512>a||(u+=v+512,u>=a))return c(null,u);t.mtimeCache&&t.mtimeCache.set(E.path,E.mtime),h=0,vt.read(o,f,0,512,u,d)};vt.read(o,f,0,512,u,d)},s=new Promise((o,a)=>{i.on("error",a);let l="r+",c=(u,h)=>{if(u&&u.code==="ENOENT"&&l==="r+")return l="w+",vt.open(t.file,l,c);if(u)return a(u);vt.fstat(h,(f,d)=>{if(f)return vt.close(h,()=>a(f));n(h,d.size,(y,A)=>{if(y)return a(y);let E=new aT.WriteStream(t.file,{fd:h,start:A});i.pipe(E),E.on("error",a),E.on("close",o),hT(i,e)})})};vt.open(t.file,l,c)});return r?s.then(r,r):s},fU=(t,e)=>{e.forEach(r=>{r.charAt(0)==="@"?lT({file:uT.resolve(t.cwd,r.slice(1)),sync:!0,noResume:!0,onentry:i=>t.add(i)}):t.add(r)}),t.end()},hT=(t,e)=>{for(;e.length;){let r=e.shift();if(r.charAt(0)==="@")return lT({file:uT.resolve(t.cwd,r.slice(1)),noResume:!0,onentry:i=>t.add(i)}).then(i=>hT(t,e));t.add(r)}t.end()}});var pT=w((u3,dT)=>{"use strict";var dU=ps(),pU=Wp();dT.exports=(t,e,r)=>{let i=dU(t);if(!i.file)throw new TypeError("file is required");if(i.gzip||i.brotli||i.file.endsWith(".br")||i.file.endsWith(".tbr"))throw new TypeError("cannot append to compressed archives");if(!e||!Array.isArray(e)||!e.length)throw new TypeError("no files or directories specified");return e=Array.from(e),mU(i),pU(i,e,r)};var mU=t=>{let e=t.filter;t.mtimeCache||(t.mtimeCache=new Map),t.filter=e?(r,i)=>e(r,i)&&!(t.mtimeCache.get(r)>i.mtime):(r,i)=>!(t.mtimeCache.get(r)>i.mtime)}});var yT=w((c3,gT)=>{var{promisify:mT}=require("util"),vi=require("fs"),gU=t=>{if(!t)t={mode:511,fs:vi};else if(typeof t=="object")t={mode:511,fs:vi,...t};else if(typeof t=="number")t={mode:t,fs:vi};else if(typeof t=="string")t={mode:parseInt(t,8),fs:vi};else throw new TypeError("invalid options argument");return t.mkdir=t.mkdir||t.fs.mkdir||vi.mkdir,t.mkdirAsync=mT(t.mkdir),t.stat=t.stat||t.fs.stat||vi.stat,t.statAsync=mT(t.stat),t.statSync=t.statSync||t.fs.statSync||vi.statSync,t.mkdirSync=t.mkdirSync||t.fs.mkdirSync||vi.mkdirSync,t};gT.exports=gU});var AT=w((h3,wT)=>{var yU=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:wU,parse:AU}=require("path"),EU=t=>{if(/\0/.test(t))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:t,code:"ERR_INVALID_ARG_VALUE"});if(t=wU(t),yU==="win32"){let e=/[*|"<>?:]/,{root:r}=AU(t);if(e.test(t.substr(r.length)))throw Object.assign(new Error("Illegal characters in path."),{path:t,code:"EINVAL"})}return t};wT.exports=EU});var vT=w((f3,_T)=>{var{dirname:ET}=require("path"),ST=(t,e,r=void 0)=>r===e?Promise.resolve():t.statAsync(e).then(i=>i.isDirectory()?r:void 0,i=>i.code==="ENOENT"?ST(t,ET(e),e):void 0),bT=(t,e,r=void 0)=>{if(r!==e)try{return t.statSync(e).isDirectory()?r:void 0}catch(i){return i.code==="ENOENT"?bT(t,ET(e),e):void 0}};_T.exports={findMade:ST,findMadeSync:bT}});var Vp=w((d3,OT)=>{var{dirname:TT}=require("path"),Gp=(t,e,r)=>{e.recursive=!1;let i=TT(t);return i===t?e.mkdirAsync(t,e).catch(n=>{if(n.code!=="EISDIR")throw n}):e.mkdirAsync(t,e).then(()=>r||t,n=>{if(n.code==="ENOENT")return Gp(i,e).then(s=>Gp(t,e,s));if(n.code!=="EEXIST"&&n.code!=="EROFS")throw n;return e.statAsync(t).then(s=>{if(s.isDirectory())return r;throw n},()=>{throw n})})},zp=(t,e,r)=>{let i=TT(t);if(e.recursive=!1,i===t)try{return e.mkdirSync(t,e)}catch(n){if(n.code!=="EISDIR")throw n;return}try{return e.mkdirSync(t,e),r||t}catch(n){if(n.code==="ENOENT")return zp(t,e,zp(i,e,r));if(n.code!=="EEXIST"&&n.code!=="EROFS")throw n;try{if(!e.statSync(t).isDirectory())throw n}catch{throw n}}};OT.exports={mkdirpManual:Gp,mkdirpManualSync:zp}});var IT=w((p3,RT)=>{var{dirname:CT}=require("path"),{findMade:SU,findMadeSync:bU}=vT(),{mkdirpManual:_U,mkdirpManualSync:vU}=Vp(),TU=(t,e)=>(e.recursive=!0,CT(t)===t?e.mkdirAsync(t,e):SU(e,t).then(i=>e.mkdirAsync(t,e).then(()=>i).catch(n=>{if(n.code==="ENOENT")return _U(t,e);throw n}))),OU=(t,e)=>{if(e.recursive=!0,CT(t)===t)return e.mkdirSync(t,e);let i=bU(e,t);try{return e.mkdirSync(t,e),i}catch(n){if(n.code==="ENOENT")return vU(t,e);throw n}};RT.exports={mkdirpNative:TU,mkdirpNativeSync:OU}});var PT=w((m3,DT)=>{var NT=require("fs"),CU=process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version,Yp=CU.replace(/^v/,"").split("."),xT=+Yp[0]>10||+Yp[0]==10&&+Yp[1]>=12,RU=xT?t=>t.mkdir===NT.mkdir:()=>!1,IU=xT?t=>t.mkdirSync===NT.mkdirSync:()=>!1;DT.exports={useNative:RU,useNativeSync:IU}});var MT=w((g3,qT)=>{var Fs=yT(),Ls=AT(),{mkdirpNative:FT,mkdirpNativeSync:LT}=IT(),{mkdirpManual:$T,mkdirpManualSync:kT}=Vp(),{useNative:NU,useNativeSync:xU}=PT(),$s=(t,e)=>(t=Ls(t),e=Fs(e),NU(e)?FT(t,e):$T(t,e)),DU=(t,e)=>(t=Ls(t),e=Fs(e),xU(e)?LT(t,e):kT(t,e));$s.sync=DU;$s.native=(t,e)=>FT(Ls(t),Fs(e));$s.manual=(t,e)=>$T(Ls(t),Fs(e));$s.nativeSync=(t,e)=>LT(Ls(t),Fs(e));$s.manualSync=(t,e)=>kT(Ls(t),Fs(e));qT.exports=$s});var zT=w((y3,GT)=>{"use strict";var $t=require("fs"),yn=require("path"),PU=$t.lchown?"lchown":"chown",FU=$t.lchownSync?"lchownSync":"chownSync",BT=$t.lchown&&!process.version.match(/v1[1-9]+\./)&&!process.version.match(/v10\.[6-9]/),UT=(t,e,r)=>{try{return $t[FU](t,e,r)}catch(i){if(i.code!=="ENOENT")throw i}},LU=(t,e,r)=>{try{return $t.chownSync(t,e,r)}catch(i){if(i.code!=="ENOENT")throw i}},$U=BT?(t,e,r,i)=>n=>{!n||n.code!=="EISDIR"?i(n):$t.chown(t,e,r,i)}:(t,e,r,i)=>i,Qp=BT?(t,e,r)=>{try{return UT(t,e,r)}catch(i){if(i.code!=="EISDIR")throw i;LU(t,e,r)}}:(t,e,r)=>UT(t,e,r),kU=process.version,jT=(t,e,r)=>$t.readdir(t,e,r),qU=(t,e)=>$t.readdirSync(t,e);/^v4\./.test(kU)&&(jT=(t,e,r)=>$t.readdir(t,r));var oc=(t,e,r,i)=>{$t[PU](t,e,r,$U(t,e,r,n=>{i(n&&n.code!=="ENOENT"?n:null)}))},HT=(t,e,r,i,n)=>{if(typeof e=="string")return $t.lstat(yn.resolve(t,e),(s,o)=>{if(s)return n(s.code!=="ENOENT"?s:null);o.name=e,HT(t,o,r,i,n)});if(e.isDirectory())Xp(yn.resolve(t,e.name),r,i,s=>{if(s)return n(s);let o=yn.resolve(t,e.name);oc(o,r,i,n)});else{let s=yn.resolve(t,e.name);oc(s,r,i,n)}},Xp=(t,e,r,i)=>{jT(t,{withFileTypes:!0},(n,s)=>{if(n){if(n.code==="ENOENT")return i();if(n.code!=="ENOTDIR"&&n.code!=="ENOTSUP")return i(n)}if(n||!s.length)return oc(t,e,r,i);let o=s.length,a=null,l=c=>{if(!a){if(c)return i(a=c);if(--o===0)return oc(t,e,r,i)}};s.forEach(c=>HT(t,c,e,r,l))})},MU=(t,e,r,i)=>{if(typeof e=="string")try{let n=$t.lstatSync(yn.resolve(t,e));n.name=e,e=n}catch(n){if(n.code==="ENOENT")return;throw n}e.isDirectory()&&WT(yn.resolve(t,e.name),r,i),Qp(yn.resolve(t,e.name),r,i)},WT=(t,e,r)=>{let i;try{i=qU(t,{withFileTypes:!0})}catch(n){if(n.code==="ENOENT")return;if(n.code==="ENOTDIR"||n.code==="ENOTSUP")return Qp(t,e,r);throw n}return i&&i.length&&i.forEach(n=>MU(t,n,e,r)),Qp(t,e,r)};GT.exports=Xp;Xp.sync=WT});var XT=w((w3,Kp)=>{"use strict";var VT=MT(),kt=require("fs"),ac=require("path"),YT=zT(),Qt=As(),lc=class extends Error{constructor(e,r){super("Cannot extract through symbolic link"),this.path=r,this.symlink=e}get name(){return"SylinkError"}},uc=class extends Error{constructor(e,r){super(r+": Cannot cd into '"+e+"'"),this.path=e,this.code=r}get name(){return"CwdError"}},cc=(t,e)=>t.get(Qt(e)),aa=(t,e,r)=>t.set(Qt(e),r),UU=(t,e)=>{kt.stat(t,(r,i)=>{(r||!i.isDirectory())&&(r=new uc(t,r&&r.code||"ENOTDIR")),e(r)})};Kp.exports=(t,e,r)=>{t=Qt(t);let i=e.umask,n=e.mode|448,s=(n&i)!==0,o=e.uid,a=e.gid,l=typeof o=="number"&&typeof a=="number"&&(o!==e.processUid||a!==e.processGid),c=e.preserve,u=e.unlink,h=e.cache,f=Qt(e.cwd),d=(E,v)=>{E?r(E):(aa(h,t,!0),v&&l?YT(v,o,a,T=>d(T)):s?kt.chmod(t,n,r):r())};if(h&&cc(h,t)===!0)return d();if(t===f)return UU(t,d);if(c)return VT(t,{mode:n}).then(E=>d(null,E),d);let A=Qt(ac.relative(f,t)).split("/");hc(f,A,n,h,u,f,null,d)};var hc=(t,e,r,i,n,s,o,a)=>{if(!e.length)return a(null,o);let l=e.shift(),c=Qt(ac.resolve(t+"/"+l));if(cc(i,c))return hc(c,e,r,i,n,s,o,a);kt.mkdir(c,r,QT(c,e,r,i,n,s,o,a))},QT=(t,e,r,i,n,s,o,a)=>l=>{l?kt.lstat(t,(c,u)=>{if(c)c.path=c.path&&Qt(c.path),a(c);else if(u.isDirectory())hc(t,e,r,i,n,s,o,a);else if(n)kt.unlink(t,h=>{if(h)return a(h);kt.mkdir(t,r,QT(t,e,r,i,n,s,o,a))});else{if(u.isSymbolicLink())return a(new lc(t,t+"/"+e.join("/")));a(l)}}):(o=o||t,hc(t,e,r,i,n,s,o,a))},BU=t=>{let e=!1,r="ENOTDIR";try{e=kt.statSync(t).isDirectory()}catch(i){r=i.code}finally{if(!e)throw new uc(t,r)}};Kp.exports.sync=(t,e)=>{t=Qt(t);let r=e.umask,i=e.mode|448,n=(i&r)!==0,s=e.uid,o=e.gid,a=typeof s=="number"&&typeof o=="number"&&(s!==e.processUid||o!==e.processGid),l=e.preserve,c=e.unlink,u=e.cache,h=Qt(e.cwd),f=E=>{aa(u,t,!0),E&&a&&YT.sync(E,s,o),n&&kt.chmodSync(t,i)};if(u&&cc(u,t)===!0)return f();if(t===h)return BU(h),f();if(l)return f(VT.sync(t,i));let y=Qt(ac.relative(h,t)).split("/"),A=null;for(let E=y.shift(),v=h;E&&(v+="/"+E);E=y.shift())if(v=Qt(ac.resolve(v)),!cc(u,v))try{kt.mkdirSync(v,i),A=A||v,aa(u,v,!0)}catch{let I=kt.lstatSync(v);if(I.isDirectory()){aa(u,v,!0);continue}else if(c){kt.unlinkSync(v),kt.mkdirSync(v,i),A=A||v,aa(u,v,!0);continue}else if(I.isSymbolicLink())return new lc(v,v+"/"+y.join("/"))}return f(A)}});var Zp=w((A3,KT)=>{var Jp=Object.create(null),{hasOwnProperty:jU}=Object.prototype;KT.exports=t=>(jU.call(Jp,t)||(Jp[t]=t.normalize("NFD")),Jp[t])});var tO=w((E3,eO)=>{var JT=require("assert"),HU=Zp(),WU=bs(),{join:ZT}=require("path"),GU=process.env.TESTING_TAR_FAKE_PLATFORM||process.platform,zU=GU==="win32";eO.exports=()=>{let t=new Map,e=new Map,r=c=>c.split("/").slice(0,-1).reduce((h,f)=>(h.length&&(f=ZT(h[h.length-1],f)),h.push(f||"/"),h),[]),i=new Set,n=c=>{let u=e.get(c);if(!u)throw new Error("function does not have any path reservations");return{paths:u.paths.map(h=>t.get(h)),dirs:[...u.dirs].map(h=>t.get(h))}},s=c=>{let{paths:u,dirs:h}=n(c);return u.every(f=>f[0]===c)&&h.every(f=>f[0]instanceof Set&&f[0].has(c))},o=c=>i.has(c)||!s(c)?!1:(i.add(c),c(()=>a(c)),!0),a=c=>{if(!i.has(c))return!1;let{paths:u,dirs:h}=e.get(c),f=new Set;return u.forEach(d=>{let y=t.get(d);JT.equal(y[0],c),y.length===1?t.delete(d):(y.shift(),typeof y[0]=="function"?f.add(y[0]):y[0].forEach(A=>f.add(A)))}),h.forEach(d=>{let y=t.get(d);JT(y[0]instanceof Set),y[0].size===1&&y.length===1?t.delete(d):y[0].size===1?(y.shift(),f.add(y[0])):y[0].delete(c)}),i.delete(c),f.forEach(d=>o(d)),!0};return{check:s,reserve:(c,u)=>{c=zU?["win32 parallelization disabled"]:c.map(f=>WU(ZT(HU(f))).toLowerCase());let h=new Set(c.map(f=>r(f)).reduce((f,d)=>f.concat(d)));return e.set(u,{dirs:h,paths:c}),c.forEach(f=>{let d=t.get(f);d?d.push(u):t.set(f,[u])}),h.forEach(f=>{let d=t.get(f);d?d[d.length-1]instanceof Set?d[d.length-1].add(u):d.push(new Set([u])):t.set(f,[new Set([u])])}),o(u)}}}});var nO=w((S3,iO)=>{var VU=process.env.__FAKE_PLATFORM__||process.platform,YU=VU==="win32",QU=global.__FAKE_TESTING_FS__||require("fs"),{O_CREAT:XU,O_TRUNC:KU,O_WRONLY:JU,UV_FS_O_FILEMAP:rO=0}=QU.constants,ZU=YU&&!!rO,e2=512*1024,t2=rO|KU|XU|JU;iO.exports=ZU?t=>t<e2?t2:"w":()=>"w"});var lm=w((b3,wO)=>{"use strict";var r2=require("assert"),i2=ic(),X=require("fs"),n2=Ds(),jr=require("path"),mO=XT(),sO=rp(),s2=tO(),o2=ip(),qt=As(),a2=bs(),l2=Zp(),oO=Symbol("onEntry"),rm=Symbol("checkFs"),aO=Symbol("checkFs2"),pc=Symbol("pruneCache"),im=Symbol("isReusable"),Mt=Symbol("makeFs"),nm=Symbol("file"),sm=Symbol("directory"),mc=Symbol("link"),lO=Symbol("symlink"),uO=Symbol("hardlink"),cO=Symbol("unsupported"),hO=Symbol("checkPath"),Ti=Symbol("mkdir"),Qe=Symbol("onError"),fc=Symbol("pending"),fO=Symbol("pend"),ks=Symbol("unpend"),em=Symbol("ended"),tm=Symbol("maybeClose"),om=Symbol("skip"),la=Symbol("doChown"),ua=Symbol("uid"),ca=Symbol("gid"),ha=Symbol("checkedCwd"),gO=require("crypto"),yO=nO(),u2=process.env.TESTING_TAR_FAKE_PLATFORM||process.platform,fa=u2==="win32",c2=1024,h2=(t,e)=>{if(!fa)return X.unlink(t,e);let r=t+".DELETE."+gO.randomBytes(16).toString("hex");X.rename(t,r,i=>{if(i)return e(i);X.unlink(r,e)})},f2=t=>{if(!fa)return X.unlinkSync(t);let e=t+".DELETE."+gO.randomBytes(16).toString("hex");X.renameSync(t,e),X.unlinkSync(e)},dO=(t,e,r)=>t===t>>>0?t:e===e>>>0?e:r,pO=t=>a2(qt(l2(t))).toLowerCase(),d2=(t,e)=>{e=pO(e);for(let r of t.keys()){let i=pO(r);(i===e||i.indexOf(e+"/")===0)&&t.delete(r)}},p2=t=>{for(let e of t.keys())t.delete(e)},da=class extends i2{constructor(e){if(e||(e={}),e.ondone=r=>{this[em]=!0,this[tm]()},super(e),this[ha]=!1,this.reservations=s2(),this.transform=typeof e.transform=="function"?e.transform:null,this.writable=!0,this.readable=!1,this[fc]=0,this[em]=!1,this.dirCache=e.dirCache||new Map,typeof e.uid=="number"||typeof e.gid=="number"){if(typeof e.uid!="number"||typeof e.gid!="number")throw new TypeError("cannot set owner without number uid and gid");if(e.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=e.uid,this.gid=e.gid,this.setOwner=!0}else this.uid=null,this.gid=null,this.setOwner=!1;e.preserveOwner===void 0&&typeof e.uid!="number"?this.preserveOwner=process.getuid&&process.getuid()===0:this.preserveOwner=!!e.preserveOwner,this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null,this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null,this.maxDepth=typeof e.maxDepth=="number"?e.maxDepth:c2,this.forceChown=e.forceChown===!0,this.win32=!!e.win32||fa,this.newer=!!e.newer,this.keep=!!e.keep,this.noMtime=!!e.noMtime,this.preservePaths=!!e.preservePaths,this.unlink=!!e.unlink,this.cwd=qt(jr.resolve(e.cwd||process.cwd())),this.strip=+e.strip||0,this.processUmask=e.noChmod?0:process.umask(),this.umask=typeof e.umask=="number"?e.umask:this.processUmask,this.dmode=e.dmode||511&~this.umask,this.fmode=e.fmode||438&~this.umask,this.on("entry",r=>this[oO](r))}warn(e,r,i={}){return(e==="TAR_BAD_ARCHIVE"||e==="TAR_ABORT")&&(i.recoverable=!1),super.warn(e,r,i)}[tm](){this[em]&&this[fc]===0&&(this.emit("prefinish"),this.emit("finish"),this.emit("end"))}[hO](e){let r=qt(e.path),i=r.split("/");if(this.strip){if(i.length<this.strip)return!1;if(e.type==="Link"){let n=qt(e.linkpath).split("/");if(n.length>=this.strip)e.linkpath=n.slice(this.strip).join("/");else return!1}i.splice(0,this.strip),e.path=i.join("/")}if(isFinite(this.maxDepth)&&i.length>this.maxDepth)return this.warn("TAR_ENTRY_ERROR","path excessively deep",{entry:e,path:r,depth:i.length,maxDepth:this.maxDepth}),!1;if(!this.preservePaths){if(i.includes("..")||fa&&/^[a-z]:\.\.$/i.test(i[0]))return this.warn("TAR_ENTRY_ERROR","path contains '..'",{entry:e,path:r}),!1;let[n,s]=o2(r);n&&(e.path=s,this.warn("TAR_ENTRY_INFO","stripping ".concat(n," from absolute path"),{entry:e,path:r}))}if(jr.isAbsolute(e.path)?e.absolute=qt(jr.resolve(e.path)):e.absolute=qt(jr.resolve(this.cwd,e.path)),!this.preservePaths&&e.absolute.indexOf(this.cwd+"/")!==0&&e.absolute!==this.cwd)return this.warn("TAR_ENTRY_ERROR","path escaped extraction target",{entry:e,path:qt(e.path),resolvedPath:e.absolute,cwd:this.cwd}),!1;if(e.absolute===this.cwd&&e.type!=="Directory"&&e.type!=="GNUDumpDir")return!1;if(this.win32){let{root:n}=jr.win32.parse(e.absolute);e.absolute=n+sO.encode(e.absolute.slice(n.length));let{root:s}=jr.win32.parse(e.path);e.path=s+sO.encode(e.path.slice(s.length))}return!0}[oO](e){if(!this[hO](e))return e.resume();switch(r2.equal(typeof e.absolute,"string"),e.type){case"Directory":case"GNUDumpDir":e.mode&&(e.mode=e.mode|448);case"File":case"OldFile":case"ContiguousFile":case"Link":case"SymbolicLink":return this[rm](e);case"CharacterDevice":case"BlockDevice":case"FIFO":default:return this[cO](e)}}[Qe](e,r){e.name==="CwdError"?this.emit("error",e):(this.warn("TAR_ENTRY_ERROR",e,{entry:r}),this[ks](),r.resume())}[Ti](e,r,i){mO(qt(e),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:r,noChmod:this.noChmod},i)}[la](e){return this.forceChown||this.preserveOwner&&(typeof e.uid=="number"&&e.uid!==this.processUid||typeof e.gid=="number"&&e.gid!==this.processGid)||typeof this.uid=="number"&&this.uid!==this.processUid||typeof this.gid=="number"&&this.gid!==this.processGid}[ua](e){return dO(this.uid,e.uid,this.processUid)}[ca](e){return dO(this.gid,e.gid,this.processGid)}[nm](e,r){let i=e.mode&4095||this.fmode,n=new n2.WriteStream(e.absolute,{flags:yO(e.size),mode:i,autoClose:!1});n.on("error",l=>{n.fd&&X.close(n.fd,()=>{}),n.write=()=>!0,this[Qe](l,e),r()});let s=1,o=l=>{if(l){n.fd&&X.close(n.fd,()=>{}),this[Qe](l,e),r();return}--s===0&&X.close(n.fd,c=>{c?this[Qe](c,e):this[ks](),r()})};n.on("finish",l=>{let c=e.absolute,u=n.fd;if(e.mtime&&!this.noMtime){s++;let h=e.atime||new Date,f=e.mtime;X.futimes(u,h,f,d=>d?X.utimes(c,h,f,y=>o(y&&d)):o())}if(this[la](e)){s++;let h=this[ua](e),f=this[ca](e);X.fchown(u,h,f,d=>d?X.chown(c,h,f,y=>o(y&&d)):o())}o()});let a=this.transform&&this.transform(e)||e;a!==e&&(a.on("error",l=>{this[Qe](l,e),r()}),e.pipe(a)),a.pipe(n)}[sm](e,r){let i=e.mode&4095||this.dmode;this[Ti](e.absolute,i,n=>{if(n){this[Qe](n,e),r();return}let s=1,o=a=>{--s===0&&(r(),this[ks](),e.resume())};e.mtime&&!this.noMtime&&(s++,X.utimes(e.absolute,e.atime||new Date,e.mtime,o)),this[la](e)&&(s++,X.chown(e.absolute,this[ua](e),this[ca](e),o)),o()})}[cO](e){e.unsupported=!0,this.warn("TAR_ENTRY_UNSUPPORTED","unsupported entry type: ".concat(e.type),{entry:e}),e.resume()}[lO](e,r){this[mc](e,e.linkpath,"symlink",r)}[uO](e,r){let i=qt(jr.resolve(this.cwd,e.linkpath));this[mc](e,i,"link",r)}[fO](){this[fc]++}[ks](){this[fc]--,this[tm]()}[om](e){this[ks](),e.resume()}[im](e,r){return e.type==="File"&&!this.unlink&&r.isFile()&&r.nlink<=1&&!fa}[rm](e){this[fO]();let r=[e.path];e.linkpath&&r.push(e.linkpath),this.reservations.reserve(r,i=>this[aO](e,i))}[pc](e){e.type==="SymbolicLink"?p2(this.dirCache):e.type!=="Directory"&&d2(this.dirCache,e.absolute)}[aO](e,r){this[pc](e);let i=a=>{this[pc](e),r(a)},n=()=>{this[Ti](this.cwd,this.dmode,a=>{if(a){this[Qe](a,e),i();return}this[ha]=!0,s()})},s=()=>{if(e.absolute!==this.cwd){let a=qt(jr.dirname(e.absolute));if(a!==this.cwd)return this[Ti](a,this.dmode,l=>{if(l){this[Qe](l,e),i();return}o()})}o()},o=()=>{X.lstat(e.absolute,(a,l)=>{if(l&&(this.keep||this.newer&&l.mtime>e.mtime)){this[om](e),i();return}if(a||this[im](e,l))return this[Mt](null,e,i);if(l.isDirectory()){if(e.type==="Directory"){let c=!this.noChmod&&e.mode&&(l.mode&4095)!==e.mode,u=h=>this[Mt](h,e,i);return c?X.chmod(e.absolute,e.mode,u):u()}if(e.absolute!==this.cwd)return X.rmdir(e.absolute,c=>this[Mt](c,e,i))}if(e.absolute===this.cwd)return this[Mt](null,e,i);h2(e.absolute,c=>this[Mt](c,e,i))})};this[ha]?s():n()}[Mt](e,r,i){if(e){this[Qe](e,r),i();return}switch(r.type){case"File":case"OldFile":case"ContiguousFile":return this[nm](r,i);case"Link":return this[uO](r,i);case"SymbolicLink":return this[lO](r,i);case"Directory":case"GNUDumpDir":return this[sm](r,i)}}[mc](e,r,i,n){X[i](r,e.absolute,s=>{s?this[Qe](s,e):(this[ks](),e.resume()),n()})}},dc=t=>{try{return[null,t()]}catch(e){return[e,null]}},am=class extends da{[Mt](e,r){return super[Mt](e,r,()=>{})}[rm](e){if(this[pc](e),!this[ha]){let s=this[Ti](this.cwd,this.dmode);if(s)return this[Qe](s,e);this[ha]=!0}if(e.absolute!==this.cwd){let s=qt(jr.dirname(e.absolute));if(s!==this.cwd){let o=this[Ti](s,this.dmode);if(o)return this[Qe](o,e)}}let[r,i]=dc(()=>X.lstatSync(e.absolute));if(i&&(this.keep||this.newer&&i.mtime>e.mtime))return this[om](e);if(r||this[im](e,i))return this[Mt](null,e);if(i.isDirectory()){if(e.type==="Directory"){let o=!this.noChmod&&e.mode&&(i.mode&4095)!==e.mode,[a]=o?dc(()=>{X.chmodSync(e.absolute,e.mode)}):[];return this[Mt](a,e)}let[s]=dc(()=>X.rmdirSync(e.absolute));this[Mt](s,e)}let[n]=e.absolute===this.cwd?[]:dc(()=>f2(e.absolute));this[Mt](n,e)}[nm](e,r){let i=e.mode&4095||this.fmode,n=a=>{let l;try{X.closeSync(s)}catch(c){l=c}(a||l)&&this[Qe](a||l,e),r()},s;try{s=X.openSync(e.absolute,yO(e.size),i)}catch(a){return n(a)}let o=this.transform&&this.transform(e)||e;o!==e&&(o.on("error",a=>this[Qe](a,e)),e.pipe(o)),o.on("data",a=>{try{X.writeSync(s,a,0,a.length)}catch(l){n(l)}}),o.on("end",a=>{let l=null;if(e.mtime&&!this.noMtime){let c=e.atime||new Date,u=e.mtime;try{X.futimesSync(s,c,u)}catch(h){try{X.utimesSync(e.absolute,c,u)}catch{l=h}}}if(this[la](e)){let c=this[ua](e),u=this[ca](e);try{X.fchownSync(s,c,u)}catch(h){try{X.chownSync(e.absolute,c,u)}catch{l=l||h}}}n(l)})}[sm](e,r){let i=e.mode&4095||this.dmode,n=this[Ti](e.absolute,i);if(n){this[Qe](n,e),r();return}if(e.mtime&&!this.noMtime)try{X.utimesSync(e.absolute,e.atime||new Date,e.mtime)}catch{}if(this[la](e))try{X.chownSync(e.absolute,this[ua](e),this[ca](e))}catch{}r(),e.resume()}[Ti](e,r){try{return mO.sync(qt(e),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:r})}catch(i){return i}}[mc](e,r,i,n){try{X[i+"Sync"](r,e.absolute),n(),e.resume()}catch(s){return this[Qe](s,e)}}};da.Sync=am;wO.exports=da});var _O=w((_3,bO)=>{"use strict";var m2=ps(),gc=lm(),EO=require("fs"),SO=Ds(),AO=require("path"),um=bs();bO.exports=(t,e,r)=>{typeof t=="function"?(r=t,e=null,t={}):Array.isArray(t)&&(e=t,t={}),typeof e=="function"&&(r=e,e=null),e?e=Array.from(e):e=[];let i=m2(t);if(i.sync&&typeof r=="function")throw new TypeError("callback not supported for sync tar functions");if(!i.file&&typeof r=="function")throw new TypeError("callback only supported with file option");return e.length&&g2(i,e),i.file&&i.sync?y2(i):i.file?w2(i,r):i.sync?A2(i):E2(i)};var g2=(t,e)=>{let r=new Map(e.map(s=>[um(s),!0])),i=t.filter,n=(s,o)=>{let a=o||AO.parse(s).root||".",l=s===a?!1:r.has(s)?r.get(s):n(AO.dirname(s),a);return r.set(s,l),l};t.filter=i?(s,o)=>i(s,o)&&n(um(s)):s=>n(um(s))},y2=t=>{let e=new gc.Sync(t),r=t.file,i=EO.statSync(r),n=t.maxReadSize||16*1024*1024;new SO.ReadStreamSync(r,{readSize:n,size:i.size}).pipe(e)},w2=(t,e)=>{let r=new gc(t),i=t.maxReadSize||16*1024*1024,n=t.file,s=new Promise((o,a)=>{r.on("error",a),r.on("close",o),EO.stat(n,(l,c)=>{if(l)a(l);else{let u=new SO.ReadStream(n,{readSize:i,size:c.size});u.on("error",a),u.pipe(r)}})});return e?s.then(e,e):s},A2=t=>new gc.Sync(t),E2=t=>new gc(t)});var vO=w(Oe=>{"use strict";Oe.c=Oe.create=sT();Oe.r=Oe.replace=Wp();Oe.t=Oe.list=nc();Oe.u=Oe.update=pT();Oe.x=Oe.extract=_O();Oe.Pack=qu();Oe.Unpack=lm();Oe.Parse=ic();Oe.ReadEntry=Su();Oe.WriteEntry=dp();Oe.Header=Ss();Oe.Pax=_u();Oe.types=Qd()});var NO=w((T3,IO)=>{var{spawn:cm}=require("child_process"),{session:TO}=require("electron"),wn=require("path"),S2=vO(),wt=require("fs"),b2=require("os"),_2=Wt(),v2=Xt(),An=_n(),T2=ga(),de,Ut,Bt,En,hr,Se,Tt,OO,CO,RO;IO.exports=(de=class extends v2{constructor(r){super(r);R(this,Se);R(this,Ut,null);R(this,Bt,null);R(this,En,!1);R(this,hr,{code:de.CODE_OLLAMA_DOWNLOAD,success:!0,progressBar:!1,message:""});_(this,"install",(r=!1)=>p(this,En)?(M(this,Se,Tt).call(this,p(this,hr).code,p(this,hr).success,p(this,hr).progressBar,p(this,hr).message),!1):(U(this,En,!0),p(this,Ut)!==null?(M(this,Se,Tt).call(this,de.CODE_OLLAMA_FINISH),U(this,En,!1),!0):(r&&(M(this,Se,Tt).call(this,de.CODE_OLLAMA_DOWNLOAD,!0,!0),wt.existsSync(p(this,Bt))&&wt.rmSync(p(this,Bt),{recursive:!0,force:!0}),wt.mkdirSync(p(this,Bt),{recursive:!0})),(async()=>{let i=["arm","arm64"].includes(b2.arch()),n=wn.join(p(this,Bt),"ollama"),s=wn.join(p(this,Bt),"models");try{let o=wn.join(n,An.MACOS===process.platform?"ollama":An.WINDOWS===process.platform?"ollama.exe":"bin/ollama"),a=wt.existsSync(o),l=[{codeDownload:de.CODE_OLLAMA_DOWNLOAD,codeUnpack:de.CODE_OLLAMA_UNPACK,outputPath:n,archiveName:An.MACOS===process.platform?"ollama-darwin.tgz":An.WINDOWS===process.platform?"ollama-windows-".concat(i?"arm64":"amd64",".zip"):"ollama-linux-".concat(i?"arm64":"amd64",".tgz")},{codeDownload:de.CODE_MODELS_DOWNLOAD,codeUnpack:de.CODE_MODELS_UNPACK,outputPath:s,archiveName:"models.tgz"}];for(let c of l){let u="".concat(de.DOWNLOAD_URL,"/").concat(c.archiveName),h=await M(this,Se,OO).call(this,c.codeDownload,u,c.archiveName);await M(this,Se,CO).call(this,c.codeUnpack,h,c.outputPath),!a&&wt.existsSync(o)&&de.CODE_OLLAMA_DOWNLOAD===c.codeDownload&&An.WINDOWS!==process.platform&&wt.chmodSync(o,493)}p(this,Ut)===null&&(M(this,Se,Tt).call(this,de.CODE_OLLAMA_SERVE,!0,!0),U(this,Ut,cm(o,["serve"],{env:{...process.env,OLLAMA_HOST:"0.0.0.0:".concat(this._oglama.config.getOllamaPort()),OLLAMA_MODELS:s},detached:!1,stdio:"ignore"})),p(this,Ut).unref(),p(this,Ut).on("error",c=>{this.stop(),M(this,Se,Tt).call(this,de.CODE_OLLAMA_SERVE,!1,!1,"Ollama server offline")})),M(this,Se,Tt).call(this,de.CODE_OLLAMA_FINISH)}catch(o){M(this,Se,Tt).call(this,p(this,hr).code||de.CODE_OLLAMA_DOWNLOAD,!1,!1,"".concat(o.message??o))}U(this,En,!1)})(),!0)));_(this,"getPort",()=>this._oglama.config.getOllamaPort());this._register("llm"),U(this,Bt,wn.join(T2.getPathConfig(),"llm")),wt.existsSync(p(this,Bt))||wt.mkdirSync(p(this,Bt),{recursive:!0})}stop(){if(p(this,Ut)!==null){try{process.platform==="win32"?cm("taskkill",["/PID",p(this,Ut).pid,"/T","/F"],{shell:!0,windowsHide:!0}):p(this,Ut).kill("SIGTERM")}catch{}U(this,Ut,null)}}},Ut=new WeakMap,Bt=new WeakMap,En=new WeakMap,hr=new WeakMap,Se=new WeakSet,Tt=async function(r,i=!0,n=!1,s=""){if(U(this,hr,{code:r,success:i,progressBar:n,message:s}),typeof this._oglama.main?.view.webContents?.send=="function"){let o=["ipc:llm:install",[p(this,hr)],{type:"req"}];this._oglama.main?.view.webContents?.send(_2.WINDOW_MAIN,o)}},OO=async function(r,i,n){let s=wn.join(p(this,Bt),n);return wt.existsSync(s)?s:new Promise((o,a)=>{let l=(c,u)=>{u.setSavePath(s),M(this,Se,Tt).call(this,r,!0,0),u.on("updated",(h,f)=>{if(f==="progressing"){let d=Math.floor(u.getReceivedBytes()/u.getTotalBytes()*100);M(this,Se,Tt).call(this,r,!0,d)}}),u.once("done",(h,f)=>{if(TO.defaultSession.removeListener("will-download",l),f==="completed"){M(this,Se,Tt).call(this,r,!0,100),o(u.getSavePath());return}a(new Error("".concat(r," download failed: ").concat(f)))})};TO.defaultSession.once("will-download",l),this._oglama.main?.view.webContents.downloadURL(i)})},CO=async function(r,i,n){let s=wn.join(n,"meta.json");if(wt.existsSync(s))return;M(this,Se,Tt).call(this,r,!0,!0),wt.existsSync(n)&&wt.rmSync(n,{recursive:!0,force:!0}),wt.mkdirSync(n,{recursive:!0});let o=Math.floor(new Date().getTime()/1e3);try{wn.extname(i)===".zip"?await M(this,Se,RO).call(this,i,n):await S2.extract({file:i,cwd:n,strict:!0});let a=Math.floor(new Date().getTime()/1e3);wt.writeFileSync(s,JSON.stringify({t:a,d:a-o})),M(this,Se,Tt).call(this,r,!0,100)}catch(a){throw new Error("".concat(r," extraction failed: ").concat(a.message??a))}},RO=async function(r,i){return new Promise((n,s)=>{let o=An.WINDOWS===process.platform?"powershell":"unzip",a=An.WINDOWS===process.platform?["-Command","Expand-Archive -Path '".concat(r,"' -DestinationPath '").concat(i,"' -Force")]:["-o",r,"-d",i];cm(o,a,{shell:!0}).on("close",c=>{if(c===0){n();return}s(new Error("Extraction failed with code ".concat(c)))})})},_(de,"DOWNLOAD_URL","https://dl.oglama.com"),_(de,"CODE_OLLAMA_DOWNLOAD","download:ollama"),_(de,"CODE_OLLAMA_UNPACK","unpack:ollama"),_(de,"CODE_MODELS_DOWNLOAD","download:models"),_(de,"CODE_MODELS_UNPACK","unpack:models"),_(de,"CODE_OLLAMA_SERVE","serve"),_(de,"CODE_OLLAMA_FINISH","finish"),de)});var $O=w((R3,LO)=>{var{app:hm,session:yc,BrowserWindow:xO,powerSaveBlocker:DO}=require("electron"),PO=require("path"),pa=Wt(),O2=Sm(),C2=_m(),R2=Tm(),I2=Cm(),fm=_n(),N2=Um(),x2=Hm(),D2=jb(),P2=zb(),F2=Jb(),L2=r_(),$2=f_(),k2=NO(),ye,qs,ma,jt,FO;LO.exports=(FO=class{constructor(){R(this,ye,null);R(this,qs,null);R(this,ma,!1);R(this,jt,null);_(this,"rootPath",hm.getAppPath());_(this,"devMode",!1);_(this,"log",new R2(this));_(this,"webserver",new O2(this));_(this,"activity",new C2(this));_(this,"diskStorage",new N2(this));_(this,"session",new x2(this));_(this,"llm",new k2(this));_(this,"updater",new D2(this));_(this,"device",new P2(this));_(this,"source",new F2(this));_(this,"target",new L2(this));_(this,"main",new $2(this));_(this,"config",new I2(this))}mainWindow(){let e=this;if(yc.defaultSession.setPermissionCheckHandler((r,i,n,s)=>!0),yc.defaultSession.setPermissionRequestHandler((r,i,n,s)=>{n(!0)}),p(e,ye)===null){U(e,ye,new xO({icon:PO.join(e.rootPath,"res/icons/icon.png"),minHeight:e.config.getMainMinHeight(),minWidth:e.config.getMainMinWidth(),height:e.config.getMainMinHeight(),width:e.config.getMainMinWidth(),titleBarStyle:"default",backgroundColor:"#000",fullscreenable:!1,useContentSize:!0,resizable:!0,title:"Oglama",show:!1,webPreferences:{session:yc.defaultSession,backgroundThrottling:!1,nodeIntegration:!0,spellcheck:!1}})),p(e,ye).setMenu(null),p(e,ye).on("minimize",i=>{if(i.preventDefault(),!e.updater.isInstalling()){let n=["ipc:oglama:restored",[],{type:"req",fromWin:pa.WINDOW_MAIN_LOGIN}];e.main.view?.webContents.send(pa.WINDOW_MAIN,n)}setTimeout(()=>{p(e,ye).restore(),p(e,ye).webContents.invalidate()},250)}),p(e,ye).setMaxListeners(0),p(e,ye).on("closed",()=>{e.llm.stop(),U(e,ye,null),p(e,qs)!==null&&DO.stop(p(e,qs)),hm.quit()});let r=()=>{let i=p(e,ye).getSize(),n=[fm.WINDOWS,fm.MACOS].includes(process.platform)?Math.abs(p(e,ye).getSize()[1]-p(e,ye).getContentSize()[1]):0,s=[fm.WINDOWS].includes(process.platform)?Math.abs(p(e,ye).getSize()[0]-p(e,ye).getContentSize()[0]):0;e.main.setWindowSize(i[0]-s,i[1]-n),e.target.setWindowSize(i[0]-s,i[1]-n)};p(e,ye).on("resize",()=>r()),p(e,ye).once("ready-to-show",()=>r()),e.main.init(),e.main.view.webContents.on("did-finish-load",()=>{e.getPostAuth()&&p(e,ye).show(),r()}),p(e,ye).setMenu(null),U(e,qs,DO.start("prevent-app-suspension"))}return p(e,ye)}mainLoginWindow(){let e=this;return p(e,jt)===null&&(U(e,jt,new xO({width:e.config.getMainLoginWidth(),height:e.config.getMainLoginHeight(),icon:PO.join(e.rootPath,"res/icons/icon.png"),resizable:!1,fullscreenable:!1,transparent:!0,titleBarStyle:"hidden",title:"Oglama",backgroundColor:"#00000000",webPreferences:{backgroundThrottling:!1,spellcheck:!1,nodeIntegration:!0,session:yc.defaultSession}})),p(e,jt).setMenu(null),p(e,jt).setMaxListeners(0),p(e,jt).on("closed",()=>{U(e,jt,null),hm.quit()}),e.main?.login?.init(),e.main?.login?.view.webContents.on("did-finish-load",()=>{e.getPostAuth()||p(e,jt).show()}),p(e,jt).setMenu(null)),p(e,jt)}getPostAuth(){return p(this,ma)}setPostAuth(e){let r=!1;if(e=!!e,e!==this.getPostAuth()){U(this,ma,e);let i=["ipc:oglama:auth",[e],{type:"req",fromWin:pa.WINDOW_MAIN_LOGIN}];this.main?.login?.view.webContents.send(pa.WINDOW_MAIN_LOGIN,i),setTimeout(()=>{this.main?.view.webContents.send(pa.WINDOW_MAIN,i)},750),e?(this.mainWindow().show(),this.mainLoginWindow().hide()):(this.mainWindow().hide(),this.mainLoginWindow().show()),r=!0}return r}},ye=new WeakMap,qs=new WeakMap,ma=new WeakMap,jt=new WeakMap,FO)});var{app:nt,BrowserWindow:q2}=require("electron"),M2=$O();nt.userAgentFallback=nt.userAgentFallback.replace(/\s*Electron\/\d+(\.\d+)+\s*/g," ").replace(/\boglama\b/g,"Oglama");nt.commandLine.appendSwitch("allow-insecure-localhost");nt.commandLine.appendSwitch("disable-renderer-backgrounding");nt.commandLine.appendSwitch("disable-background-timer-throttling");nt.commandLine.appendSwitch("disable-backgrounding-occluded-windows");nt.commandLine.appendSwitch("disable-features","UserAgentClientHint");process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";process.on("uncaughtException",t=>{});var Hr=null;do{if(!nt.requestSingleInstanceLock()){nt.quit();break}nt.on("second-instance",()=>{if(Hr!==null){let t=Hr.getPostAuth()?Hr.mainWindow():Hr.mainLoginWindow();t.isMinimized()&&(t.restore(),t.webContents?.invalidate()),t.show()}}),nt.on("ready",async()=>{Hr=new M2,nt.on("activate",()=>{q2.getAllWindows().length===0&&Hr.activity.start()}),await Hr.webserver.start(),await Hr.activity.start(),await Hr.updater.start()}),nt.on("before-quit",()=>{process.exit(0)}),nt.on("window-all-closed",()=>{process.platform!=="darwin"&&nt.quit()})}while(!1);
