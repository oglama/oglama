/*!
 * @architect Mark Jivko <mark@oglama.com>
 * @copyright Â© 2024-2025 Oglama (https://oglama.com)
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var WT=Object.defineProperty;var Sm=t=>{throw TypeError(t)};var GT=(t,e,r)=>e in t?WT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var w=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var _=(t,e,r)=>GT(t,typeof e!="symbol"?e+"":e,r),Sc=(t,e,r)=>e.has(t)||Sm("Cannot "+r);var p=(t,e,r)=>(Sc(t,e,"read from private field"),r?r.call(t):e.get(t)),I=(t,e,r)=>e.has(t)?Sm("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),U=(t,e,r,i)=>(Sc(t,e,"write to private field"),i?i.call(t,r):e.set(t,r),r),k=(t,e,r)=>(Sc(t,e,"access private method"),r);var zt=w((Z2,bm)=>{var Gt;bm.exports=(Gt=class{static getSourceChannelName(e){return"".concat(Gt.WINDOW_SOURCE,"/").concat(e)}static getTargetChannelName(e){return"".concat(Gt.WINDOW_TARGET,"/").concat(e)}static generateKey(){return"".concat(Date.now().toString(36)).concat(Math.random().toString(36).substring(2,13))}},_(Gt,"WINDOW_MAIN_LOGIN","@main/login"),_(Gt,"WINDOW_MAIN","@main"),_(Gt,"WINDOW_SOURCE","@source"),_(Gt,"WINDOW_TARGET","@target"),Gt)});var _n=w((rB,_m)=>{_m.exports=class{constructor(e){_(this,"_oglama");this._oglama=e}}});var Om=w((sB,vm)=>{var Ms=require("path"),zT=require("http"),bc=require("fs"),VT=_n(),_c;vm.exports=(_c=class extends VT{start(){if(this.constructor._instance===null){let e=Ms.join(this._oglama.rootPath,"ssg"),r=this._oglama.config.getServerPort();this.constructor._instance=new Promise((i,n)=>{try{let s=zT.createServer((o,a)=>{let l=".empty";try{let u=new URL(o.url,"http://0.0.0.0");l=decodeURIComponent(u.pathname).replace(/^\/+|\/+$/g,"")}catch{}let c=Ms.join(e,l);bc.statSync(c,{throwIfNoEntry:!1})?.isDirectory()&&(c=Ms.join(c,"index.html")),bc.stat(c,(u,h)=>{let f=u?Ms.join(e,"404/index.html"):c;a.writeHead(u?404:200,{"Content-Length":h.size,"Content-Type":{".js":"application/javascript",".json":"application/json",".woff2":"font/woff2",".html":"text/html",".txt":"text/plain",".css":"text/css",".ico":"image/x-icon",".jpeg":"image/jpeg",".jpg":"image/jpeg",".png":"image/png",".gif":"image/gif",".svg":"image/svg+xml"}[Ms.extname(f)]||"application/octet-stream"}),bc.createReadStream(f).pipe(a)})});s.listen(r,()=>{this._oglama.log.info("webserver:start","Listening on port ".concat(r)),i(s)})}catch(s){this._oglama.log.error("webserver:start",s),n(s)}})}return this.constructor._instance}},_(_c,"_instance",null),_c)});var Cm=w((lB,Tm)=>{var{dialog:vc}=require("electron"),YT=require("path"),QT=zt(),XT=_n();Tm.exports=class extends XT{constructor(){super(...arguments);_(this,"_showMessageBox",null)}async start(){let r=YT.join(this._oglama.rootPath,"res","index.html"),i={extraHeaders:"pragma: no-cache"};if(this._oglama.mainWindow().loadFile(r,i),this._oglama.mainLoginWindow().loadFile(r,i),this._oglama.mainWindow().hide(),this._oglama.mainLoginWindow().show(),this._showMessageBox===null){let n=this;this._showMessageBox=vc.showMessageBox,vc.showMessageBox=async function(s,o){if(Array.isArray(o.buttons)&&o.buttons.length){let a=o.buttons.map(l=>l.toLowerCase()).indexOf("ok");if(a!==-1){let l={agentId:null,type:o.buttons.length>1?"confirm":"alert",message:"".concat(o.message??"").trim(),result:o.buttons.length>1?!0:void 0};if(l.message.indexOf("::{")===0)try{let u=JSON.parse(l.message.substring(2));typeof u=="object"&&u!==null&&(l.agentId=u.a??null,l.type=u.t??"alert",l.message=u.m??"",l.result=u.t==="prompt"?u.d??"":u.t==="confirm"?!0:void 0)}catch{}let c=["ipc:oglama:dialog",[l],{type:"req"}];return n._oglama.main?.view.webContents.send(QT.WINDOW_MAIN,c),{response:a}}}return n._showMessageBox.call(vc,s,o)}}}}});var Im=w((hB,Rm)=>{var KT=_n();Rm.exports=class extends KT{error(){console.error("%coglama-error","color:red",...arguments)}info(){console.info("%coglama-info","color:lightblue",...arguments)}}});var xm=w((dB,Nm)=>{var JT=_n();Nm.exports=class extends JT{getMainMinWidth(){return 1200}getMainMinHeight(){return 650}getMainLoginWidth(){return 512}getMainLoginHeight(){return 512}getSourceMinWidth(){return 1100}getSourceMinHeight(){return 600}getServerPort(){return 7199}getOllamaPort(){return 7299}}});var vn=w((mB,Dm)=>{var Us;Dm.exports=(Us=class{},_(Us,"WINDOWS","win32"),_(Us,"MACOS","darwin"),_(Us,"LINUX","linux"),Us)});var Zt=w((wB,Pm)=>{var{ipcMain:ZT}=require("electron"),eC=_n();Pm.exports=class extends eC{constructor(e){super(e)}_register(e){if(typeof e=="string")for(let r of Object.getOwnPropertyNames(this)){if(["_","#"].includes(r[0]||typeof this[r]!="function"))continue;let i=this[r];ZT.handle("ipc:".concat(e,":").concat(r),async(n,...s)=>{let o=null;try{o=typeof i=="function"?await i(...s):null}catch(a){o=a}return o})}}}});var Lm=w((EB,Fm)=>{var Oc;Fm.exports=(Oc=class{},_(Oc,"max",{computersCount:5,agentsCount:9,logsPerAgent:250,logsOnRender:15,sourceCode:{smCodeLength:5120,smCount:64,smEnvSize:512,fnCodeLength:5120,fnCount:128,ioCount:20,ioInputFileCount:500,ioOutputFileCount:50,ioFieldNameLength:32,ioFieldDescLength:512,ioFieldStringLength:1024,ioFieldOptionLength:32,ioFieldOptionCount:25,ioFieldExtensionLength:24,ioFieldExtensionCount:10,ioFieldTableCount:3,ioFieldTableSize:20,ioFieldColumnLength:24,ioFieldColumnCount:6},diskStorage:{outputRunsCount:10}}),Oc)});var km=w((_B,$m)=>{var Tc;$m.exports=(Tc=class{},_(Tc,"ModuleSrc",{K_SRC_STATE_MACHINE:"srcStateMachine",K_SRC_FUNCTIONS:"srcFunctions",K_SRC_INPUTS:"srcInputs",K_SRC_OUTPUTS:"srcOutputs"}),Tc)});var ga=w((OB,Um)=>{var{app:qm}=require("electron"),Bs=require("path"),Cc=require("os"),Mm=vn(),At,On,Tn;Um.exports=(At=class{static getPathCache(){if(p(At,On)===null){let e=process.env.XDG_CACHE_HOME||Bs.join(Cc.homedir(),".cache");switch(process.platform){case Mm.WINDOWS:e=process.env.LOCALAPPDATA||Bs.join(Cc.homedir(),"AppData","Local");break;case Mm.MACOS:e=Bs.join(Cc.homedir(),"Library","Caches");break}U(At,On,Bs.join(e,"".concat(qm.name.toLowerCase(),"-updater")))}return p(At,On)}static getPathConfig(){return p(At,Tn)===null&&U(At,Tn,Bs.join(qm.getPath("appData"),"oglama")),p(At,Tn)}},On=new WeakMap,Tn=new WeakMap,I(At,On,null),I(At,Tn,null),At)});var Hm=w((RB,jm)=>{var B=require("path"),T=require("fs"),tC=zt(),rC=Zt(),er=Lm(),{ModuleSrc:Te}=km(),iC=ga(),{shell:nC}=require("electron"),sC=150,Rc="default",ya="local",oC="metadata.json",aC="environment.json",lC="source.json",Ic="input.json",wa="input",Nc="output.json",uC="output",Cn="files",Vt,Ii,It,Et,js,Ni,gr,yr,xi,Rn,Di,In,Hs,Ws,xc,Pi,Gs,Nn,ee,Nt,St,zs,at,Vs,Ys,ke,Qs,Bm;jm.exports=(Bm=class extends rC{constructor(r){super(r);I(this,Vt,{});I(this,Ii,{});I(this,It,{});I(this,Et,null);I(this,js,r=>B.join(p(this,Et),"agents",r,aC));I(this,Ni,r=>B.join(p(this,Et),"agents",r,lC));I(this,gr,(r,i="session",n=null)=>i==="run"?p(this,ke).call(this,r,n,Ic):p(this,Qs).call(this,r,n,Ic));I(this,yr,(r,i,n="session",s=null)=>{let o="".concat(wa,"-").concat(i,".jsonl");return n==="run"?p(this,ke).call(this,r,s,o):p(this,Qs).call(this,r,s,o)});I(this,xi,async(r,i=[],n={},s="session",o=null)=>{do{if(typeof r!="string"||!Array.isArray(i)||typeof n!="object"||n===null)break;for(let a of i)if(a?.type==="table"){let l=0,c=p(this,yr).call(this,r,a.key,s,o);T.existsSync(c)&&(l=await p(this,Di).call(this,c)),n[a.key]=l}}while(!1)});I(this,Rn,(r,i,n)=>p(this,ke).call(this,r,n,"".concat(uC,"-").concat(i,".jsonl")));I(this,Di,async r=>new Promise(i=>{if(!T.existsSync(r)||!T.statSync(r).isFile()){i(0);return}let n=0,s="",o=T.createReadStream(r,{encoding:"utf8"});o.on("error",()=>i(0)),o.on("data",a=>{let l=a.split(/\r\n|\n/);n+=l.length-1,s=l.pop()}),o.on("end",()=>{s.length&&n++,i(n)})}));I(this,In,async(r,i,n=null)=>new Promise((s,o)=>{let a=[];if(!T.existsSync(r)||!T.statSync(r).isFile()){s(a);return}let l=0,c="",u=T.createReadStream(r,{encoding:"utf8"});u.on("error",o),u.on("data",h=>{let f=h.split(/\r\n|\n/);c=f.pop();for(let d of f){if(l>=i&&(n===null||a.length<n))try{a.push(JSON.parse(d))}catch{}l++}}),u.on("end",()=>{if(c.length){if(l>=i&&(n===null||a.length<n))try{a.push(JSON.parse(c))}catch{}l++}s(a)})}));I(this,Hs,async(r,i,n,s=!1)=>new Promise(o=>{let a=0;if(!T.existsSync(r)||!T.statSync(r).isFile()){o(a);return}let l=0,c="",u="".concat(r,".temp");T.existsSync(u)&&T.rmSync(u,{force:!0,recursive:!0});let h=T.createReadStream(r,{encoding:"utf8"});h.on("data",f=>{let d=f.split(/\r\n|\n/);c=d.pop();for(let y of d){if(i>=0&&(l!==i||!s)){let A=l!==i?y:JSON.stringify(n);T.writeFileSync(u,"".concat(A,"\n"),{flag:"a",encoding:"utf8"}),a++}l++}}),h.on("close",()=>{if(c.length&&i>=0&&(l!==i||!s)){let f=l!==i?c:JSON.stringify(n);T.writeFileSync(u,"".concat(f,"\n"),{flag:"a",encoding:"utf8"}),a++}T.rmSync(r),T.existsSync(u)&&T.renameSync(u,r),o(a)})}));I(this,Ws,async(r,i)=>new Promise(n=>{let s=-1;if(!T.existsSync(r)||!T.statSync(r).isFile()){n(s);return}let o=0,a="",l=T.createReadStream(r,{encoding:"utf8"});l.on("data",c=>{let u=c.split(/\r\n|\n/);a=u.pop();for(let h of u){if(s===-1)try{let f=JSON.parse(h);if(typeof f=="object"&&f!==null&&f._id===i){s=o;break}}catch{}o++}}),l.on("end",()=>{if(a.length&&s===-1)try{let c=JSON.parse(a);typeof c=="object"&&c!==null&&c._id===i&&(s=o)}catch{}n(s)})}));I(this,xc,r=>{let i=n=>{let s="";if(typeof n<"u"&&n!==null)try{s=typeof n=="string"?n:JSON.stringify(n),s.includes('"')&&(s=s.replace(/"/g,'""')),(s.includes(",")||s.includes("\n")||s.includes('"'))&&(s='"'.concat(s,'"'))}catch{}return s};return(Array.isArray(r)?r.map(n=>i(n)):[]).join(",")});I(this,Pi,(r,i)=>{if(typeof r!="object"||r===null||typeof i!="object"||i===null||i.type!=="table"||!Array.isArray(i.columns)||!i.columns.length)return null;let n={},s=!1;for(let o of i.columns)typeof r[o]<"u"&&(s=!0),n[o]=typeof r[o]=="string"?r[o]:"";return s&&typeof n._id!="string"&&(n={_id:tC.generateKey(),...n}),s?n:null});I(this,Gs,r=>{let i=null;if(typeof r=="object"&&r!==null){i={};for(let n of Object.values(Te))i[n]=(Array.isArray(r[n])?r[n]:[]).filter(s=>typeof s=="object"&&s!==null).map(s=>{for(let o of Object.keys(s))(typeof s[o]>"u"||s[o]===null)&&delete s[o];return s})}return i});I(this,Nn,(r,i)=>{if(typeof i!="object"||i===null)return null;let n=i.default??null;if(["int","string"].includes(i.type)){let s=o=>{switch(i.type){case"int":o=parseInt(o,10),Number.isInteger(o)?(Number.isInteger(i.min)&&o<i.min&&(o=n),Number.isInteger(i.max)&&o>i.max&&(o=n)):o=n;break;case"string":o="".concat(o||""),(!o.length||i.min!==null&&o.length<i.min)&&(o=n),i.max!==null&&o!==null&&o.length>i.max&&(o=o.substring(0,i.max));break}return Array.isArray(i.options)&&i.options.length&&!i.options.includes(o)&&(o=n),o};r=i.isList?(o=>(o=[...new Set((Array.isArray(o)?o:[o]).map(a=>s(a)).filter(a=>a!==null))],o.length?o:n!==null?[n]:null))(r):s(r)}return i.type==="boolean"&&(r=!!(typeof r>"u"?n:r)),r});I(this,ee,r=>"".concat(r??"").replace(/\W+/g,""));I(this,Nt,r=>"".concat(r??"").replace(/[^\w\-]+/gi,""));I(this,St,r=>(r="".concat(r??"").replace(/[^\w\-]+/gi,""),r.length?r:null));I(this,zs,r=>"".concat(r??"").replace(/[^\w\-\.]+/gi,"").replace(/\.{2,}/g,"."));I(this,at,(r,i=32)=>"".concat(r).trim().toLowerCase().replace(/\s+/g,"-").replace(/\.{2,}/g,".").replace(/\-{2,}/g,"-").replace(/\_{2,}/g,"_").replace(/[^\w\.\-]+|^[\-\._]+|[\-\._]+$/gi,"").substring(0,i));I(this,Vs,(r,i,n=!0)=>{if(typeof r!="object"||r===null||typeof i!="string"||!i.length||!Array.isArray(r.extensions)||!r.extensions.includes(B.extname(i).replace(/^\./g,"").toLowerCase())||!T.existsSync(i)||!T.statSync(i).isFile())return!1;if(!n)return!0;let s=T.statSync(i).size;return!(Number.isInteger(r.min)&&r.min>0&&s<r.min*1048576||Number.isInteger(r.max)&&r.max>0&&s>r.max*1048576)});I(this,Ys,(r,{agentId:i,runId:n,scalarData:s,srcOutputs:o})=>{let a={};do{if(typeof r!="object"||r===null||typeof i!="string"||typeof n!="string"||typeof s!="object"||s===null||!Array.isArray(o)||!o.length||typeof o[0]!="object"||o[0]===null||typeof o[0].type!="string")break;let l=B.join(p(this,ke).call(this,i,n),Cn);if(T.existsSync(l)&&T.lstatSync(l).isDirectory()){for(let c of T.readdirSync(l,{withFileTypes:!0}))if(c.isFile()){let u=c.name.replace(/^(.*?)\-\d+\..*$/gi,"$1");typeof a[u]>"u"&&(a[u]=[]),a[u].push(B.join(l,c.name))}}for(let c of o){if(c.type==="files"){r[c.key]=(Array.isArray(a[c.key])?a[c.key]:[]).filter(u=>p(this,Vs).call(this,c,u,!1)).slice(0,er.max.sourceCode.ioOutputFileCount);continue}r[c.key]=s[c.key],typeof r[c.key]>"u"&&(r[c.key]=c.default??null)}}while(!1);return a});I(this,ke,(r,i=null,n=null)=>{let s=[];return typeof i=="string"&&i.length&&(s.push(i),typeof n=="string"&&n.length&&s.push(n)),B.join(p(this,Et),"agents",r,"runs",...s)});I(this,Qs,(r,i=null,n=null)=>{let s=[typeof i=="string"&&i.length?i:Rc];return typeof n=="string"&&n.length&&s.push(n),B.join(p(this,Et),"agents",r,"sessions",...s)});_(this,"openAgentFiles",async r=>{let i=!1;if(r=p(this,ee).call(this,r),r.length){let n=B.dirname(p(this,Ni).call(this,r));T.existsSync(n)&&(nC.openPath(n),i=n)}return i});_(this,"purge",async r=>{let i=!1;if(r=p(this,ee).call(this,r),r.length){let n=B.dirname(p(this,Ni).call(this,r));T.existsSync(n)&&(T.rmSync(n,{recursive:!0,force:!0}),i=!0)}return i});_(this,"runInit",(r,i=null,n=null,s=null)=>{if(r=p(this,ee).call(this,r),!r.length)throw new Error("Invalid agent ID");i="".concat(i??ya).toLowerCase().replace(/\W+/gi,""),i.length||(i=ya),n=p(this,St).call(this,n);let o="".concat(n??Rc).toLowerCase().replace(/\W+/gi,"");o.length||(o=Rc),(!Number.isInteger(s)||s<=0)&&(s=Math.floor(new Date().getTime()/1e3));let a="".concat(i,"-").concat(o,"-").concat(s),l=null;do{let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_INPUTS],h=c[Te.K_SRC_OUTPUTS];if((!Array.isArray(u)||!u.length)&&(!Array.isArray(h)||!h.length))break;if(l=p(this,ke).call(this,r,a),!T.existsSync(l)){T.mkdirSync(l,{recursive:!0}),T.mkdirSync(B.join(l,Cn),{recursive:!0});let f=B.dirname(p(this,gr).call(this,r,"session",n));if(typeof f=="string"&&T.existsSync(f)&&T.statSync(f).isDirectory())for(let d of T.readdirSync(f,{withFileTypes:!0}))d.isFile()&&(Ic===d.name||d.name.indexOf("".concat(wa,"-"))===0&&B.extname(d.name)===".jsonl")&&T.copyFileSync(B.join(f,d.name),B.join(l,d.name))}}while(!1);return typeof n=="string"&&this._oglama.session.incrementRuns(r,n),{runId:a,runPath:l}});_(this,"runDelete",(r,i)=>{let n=!1;do{if(r=p(this,ee).call(this,r),!r.length||(i=p(this,Nt).call(this,i),!i.length))break;let s=p(this,ke).call(this,r,i);T.existsSync(s)&&(T.rmSync(s,{recursive:!0}),n=!0)}while(!1);return n});_(this,"envGet",r=>{if(r=p(this,ee).call(this,r),!r.length)return{};if(typeof p(this,Vt)[r]>"u"){try{let i=p(this,js).call(this,r);T.existsSync(i)&&T.statSync(i).isFile()&&(p(this,Vt)[r]=JSON.parse(T.readFileSync(i).toString()))}catch{}(typeof p(this,Vt)[r]!="object"||p(this,Vt)[r]===null)&&(p(this,Vt)[r]={})}return p(this,Vt)[r]});_(this,"envSet",(r,i)=>(r=p(this,ee).call(this,r),!r.length||typeof i!="object"?!1:(i!==null?p(this,Vt)[r]=i:delete p(this,Vt)[r],typeof p(this,Ii)[r]<"u"&&clearTimeout(p(this,Ii)[r]),p(this,Ii)[r]=setTimeout(()=>{delete p(this,Ii)[r];let n=p(this,js).call(this,r);i!==null?T.writeFileSync(n,JSON.stringify(i,null,2)):T.existsSync(n)&&T.rmSync(n)},sC),!0)));_(this,"sourceGet",r=>{if(r=p(this,ee).call(this,r),!r.length)return null;if(typeof p(this,It)[r]!="object"||p(this,It)[r]===null){p(this,It)[r]=null;try{let i=p(this,Ni).call(this,r);if(!T.existsSync(i)||!T.statSync(i).isFile())throw new Error('"'.concat(B.basename(i),'" file not found'));p(this,It)[r]=p(this,Gs).call(this,JSON.parse(T.readFileSync(i).toString()))}catch{}}return p(this,It)[r]});_(this,"sourceSet",(r,i)=>{let n=!1;r=p(this,ee).call(this,r);do{if(!r.length||(i=p(this,Gs).call(this,i),JSON.stringify(this.sourceGet(r))===JSON.stringify(i)))break;p(this,It)[r]=i;let s=p(this,Ni).call(this,r);if(T.existsSync(B.dirname(s))||T.mkdirSync(B.dirname(s),{recursive:!0}),p(this,It)[r]!==null){let o=p(this,It)[r][Te.K_SRC_INPUTS],a=[];if(Array.isArray(o)&&o.length)for(let u of o)typeof u=="object"&&u!==null&&u.type==="table"&&typeof u.key=="string"&&a.push("".concat(wa,"-").concat(u.key,".jsonl"));let l=B.join(p(this,Et),"agents",r,"sessions");T.existsSync(l)||T.mkdirSync(l,{recursive:!0});let c=T.readdirSync(l,{withFileTypes:!0}).filter(u=>u.isDirectory()).map(u=>u.name);for(let u of c){let h=B.dirname(p(this,gr).call(this,r,"session",u));if(T.existsSync(h)&&T.lstatSync(h).isDirectory())for(let f of T.readdirSync(h,{withFileTypes:!0}))!f.isFile()||f.name.indexOf("".concat(wa,"-"))!==0||a.includes(f.name)||T.rmSync(B.join(h,f.name))}T.writeFileSync(s,JSON.stringify(p(this,It)[r],null,2))}else T.existsSync(s)&&T.rmSync(s);n=!0}while(!1);return n});_(this,"inputsGet",async(r,i="session",n=null)=>{let s={};r=p(this,ee).call(this,r),n=i==="run"?p(this,Nt).call(this,n):p(this,St).call(this,n);do{if(!r.length||typeof n=="string"&&!n.length)break;let o=this.sourceGet(r);if(typeof o!="object"||o===null)break;let a=o[Te.K_SRC_INPUTS];if(!Array.isArray(a)||!a.length)break;let l=p(this,gr).call(this,r,i,n),c={};if(T.existsSync(l)&&T.statSync(l).isFile())try{if(c=JSON.parse(T.readFileSync(l).toString()),typeof c!="object"||c===null)throw c={},new Error("Corrupted data")}catch{}for(let u of a)["int","string","boolean"].includes(u.type)&&(s[u.key]=p(this,Nn).call(this,c[u.key],u)),u.type==="files"&&(s[u.key]=(Array.isArray(c[u.key])?c[u.key]:[]).slice(0,er.max.sourceCode.ioInputFileCount));i==="session"&&await p(this,xi).call(this,r,a,s,i,n)}while(!1);return s});_(this,"inputScalarsSet",async(r,i,n=null)=>{let s={};r=p(this,ee).call(this,r),n=p(this,St).call(this,n);do{if(!r.length)break;let o=this.sourceGet(r);if(typeof o!="object"||o===null)break;let a=o[Te.K_SRC_INPUTS];if(!Array.isArray(a)||!a.length)break;let l=p(this,gr).call(this,r,"session",n),c={};try{T.existsSync(l)&&T.statSync(l).isFile()&&(c=JSON.parse(T.readFileSync(l).toString()),(typeof c!="object"||c===null)&&(c={}))}catch{}for(let u of a)if(u.type!=="table"){if(s[u.key]=c[u.key],u.type==="files"){s[u.key]=(Array.isArray(s[u.key])?s[u.key]:[]).slice(0,er.max.sourceCode.ioInputFileCount);continue}(typeof s[u.key]>"u"||s[u.key]===null)&&(s[u.key]=u.default??null),typeof i=="object"&&i!==null&&typeof i[u.key]<"u"&&(s[u.key]=p(this,Nn).call(this,i[u.key],u),s[u.key]===null&&delete s[u.key])}T.existsSync(B.dirname(l))||T.mkdirSync(B.dirname(l),{recursive:!0}),T.writeFileSync(l,JSON.stringify(s,null,2)),await p(this,xi).call(this,r,a,s,"session",n)}while(!1);return s});_(this,"inputFilesAdd",async(r,i,n,s=null)=>{let o={},a=[];r=p(this,ee).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s);do{if(!r.length||!i.length)break;let l=this.sourceGet(r);if(typeof l!="object"||l===null)break;let c=l[Te.K_SRC_INPUTS];if(!Array.isArray(c)||!c.length)break;let u=p(this,gr).call(this,r,"session",s),h={};try{T.existsSync(u)&&T.statSync(u).isFile()&&(h=JSON.parse(T.readFileSync(u).toString()),(typeof h!="object"||h===null)&&(h={}))}catch{}for(let f of c)if(f.type!=="table"){if(o[f.key]=h[f.key],f.type!=="files"){typeof o[f.key]>"u"&&(o[f.key]=f.default??null);continue}(typeof o[f.key]>"u"||!Array.isArray(o[f.key]))&&(o[f.key]=[]),f.key===i&&(a=(Array.isArray(n)?n:[]).map(d=>B.normalize("".concat(d).trim())).filter(d=>p(this,Vs).call(this,f,d,"")),o[f.key]=[...new Set([...o[f.key],...a])].slice(0,er.max.sourceCode.ioInputFileCount))}T.existsSync(B.dirname(u))||T.mkdirSync(B.dirname(u),{recursive:!0}),T.writeFileSync(u,JSON.stringify(o,null,2)),await p(this,xi).call(this,r,c,o,"session",s)}while(!1);return o});_(this,"inputFilesDelete",async(r,i,n,s=null)=>{let o={};r=p(this,ee).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s);let a=B.basename("".concat(n));do{if(!r.length||!i.length)break;let l=this.sourceGet(r);if(typeof l!="object"||l===null)break;let c=l[Te.K_SRC_INPUTS];if(!Array.isArray(c)||!c.length)break;let u=p(this,gr).call(this,r,"session",s),h={};try{T.existsSync(u)&&T.statSync(u).isFile()&&(h=JSON.parse(T.readFileSync(u).toString()),(typeof h!="object"||h===null)&&(h={}))}catch{}for(let f of c)if(f.type!=="table"){if(o[f.key]=h[f.key],f.type!=="files"){typeof o[f.key]>"u"&&(o[f.key]=f.default??null);continue}(typeof o[f.key]>"u"||!Array.isArray(o[f.key]))&&(o[f.key]=[]),f.key===i&&(o[f.key]=(Array.isArray(o[f.key])?o[f.key]:[]).filter(d=>d!==B.normalize("".concat(n))).slice(0,er.max.sourceCode.ioInputFileCount))}T.existsSync(B.dirname(u))||T.mkdirSync(B.dirname(u),{recursive:!0}),T.writeFileSync(u,JSON.stringify(o,null,2)),await p(this,xi).call(this,r,c,o,"session",s)}while(!1);return o});_(this,"inputTableQuery",async(r,i,n=1,s=5e3,o=null)=>{let a=[],l=0;n=parseInt(n,10),(!Number.isInteger(n)||n<1)&&(n=1),s=parseInt(s,10),(!Number.isInteger(s)||s<1)&&(s=1);do{if(r=p(this,ee).call(this,r),i=p(this,at).call(this,i),o=p(this,St).call(this,o),!r.length||!i.length)break;let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_INPUTS];if(!Array.isArray(u)||!u.length||u.reduce((d,y)=>y.type==="table"&&y.key===i?y:d,null)===null)break;let f=p(this,yr).call(this,r,i,"session",o);if(!T.existsSync(f))break;if(l=await p(this,Di).call(this,f),l>0)try{a=await p(this,In).call(this,f,(n-1)*s,s)}catch{}}while(!1);return{rows:a,total:l,pageNumber:n,pageSize:s}});_(this,"inputTableAdd",async(r,i,n=[],s=null)=>{let o=!1;do{if(r=p(this,ee).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s),!r.length||!i.length)break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_INPUTS];if(!Array.isArray(l)||!l.length)break;let c=l.reduce((h,f)=>f.type==="table"&&f.key===i?f:h,null);if(c===null||(n=Array.isArray(n)?n.map(h=>p(this,Pi).call(this,h,c)).filter(h=>h!==null):[],!n.length))break;let u=p(this,yr).call(this,r,i,"session",s);if(T.existsSync(u)&&T.statSync(u).size/1048576>=er.max.sourceCode.ioFieldTableSize)break;T.existsSync(B.dirname(u))||T.mkdirSync(B.dirname(u),{recursive:!0}),T.writeFileSync(u,"".concat(n.map(h=>JSON.stringify(h)).join("\n"),"\n"),{flag:"a",encoding:"utf8"}),o=!0}while(!1);return o});_(this,"inputTableGet",async(r,i,n,s="session",o=null)=>{let a=null,l=null;r=p(this,ee).call(this,r),o=s==="run"?p(this,Nt).call(this,o):p(this,St).call(this,o);do{if(!r.length||(i=p(this,at).call(this,i),!i.length)||typeof o=="string"&&!o.length)break;let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_INPUTS];if(!Array.isArray(u)||!u.length)break;let h=u.reduce((y,A)=>A.type==="table"&&A.key===i?A:y,null);if(h===null)break;let f=p(this,yr).call(this,r,i,s,o);if(!T.existsSync(f))break;let d=await p(this,Di).call(this,f);if(n<d)try{let y=await p(this,In).call(this,f,n,1);y.length&&(a=p(this,Pi).call(this,y[0],h))}catch{}n<d-1&&(l=n+1)}while(!1);return{row:a,nextIndex:l}});_(this,"inputTableUpdate",async(r,i,n,s,o=null)=>{let a=!1;do{if(r=p(this,ee).call(this,r),i=p(this,at).call(this,i),o=p(this,St).call(this,o),!r.length||!i.length)break;let l=this.sourceGet(r);if(typeof l!="object"||l===null)break;let c=l[Te.K_SRC_INPUTS];if(!Array.isArray(c)||!c.length)break;let u=c.reduce((d,y)=>y.type==="table"&&y.key===i?y:d,null);if(u===null||(s=p(this,Pi).call(this,s,u),s===null))break;let h=p(this,yr).call(this,r,i,"session",o),f=await p(this,Ws).call(this,h,n);f>=0&&(await p(this,Hs).call(this,h,f,s),a=!0)}while(!1);return a});_(this,"inputTableDelete",async(r,i,n=null,s=null)=>{let o=!1;do{if(r=p(this,ee).call(this,r),i=p(this,at).call(this,i),s=p(this,St).call(this,s),!r.length||!i.length)break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_INPUTS];if(!Array.isArray(l)||!l.length||l.reduce((h,f)=>f.type==="table"&&f.key===i?f:h,null)===null)break;let u=p(this,yr).call(this,r,i,"session",s);if(typeof n=="string"){let h=await p(this,Ws).call(this,u,n);h>=0&&await p(this,Hs).call(this,u,h,null,!0),o=!0;break}T.existsSync(u)&&(T.rmSync(u),o=!0)}while(!1);return o});_(this,"outputTableQuery",async(r,i,n,s=1,o=5e3)=>{let a=[],l=0;s=parseInt(s,10),(!Number.isInteger(s)||s<1)&&(s=1),o=parseInt(o,10),(!Number.isInteger(o)||o<1)&&(o=1);do{if(r=p(this,ee).call(this,r),n=p(this,at).call(this,n),i=Array.isArray(i)?[...new Set(i)].slice(-er.max.diskStorage.outputRunsCount):[],!r.length||!n.length||!i.length)break;let c=this.sourceGet(r);if(typeof c!="object"||c===null)break;let u=c[Te.K_SRC_OUTPUTS];if(!Array.isArray(u)||!u.length||u.reduce((O,R)=>R.type==="table"&&R.key===n?R:O,null)===null)break;let f={};for(let O of i){let R=p(this,Rn).call(this,r,n,O);if(!T.existsSync(R))continue;let L=await p(this,Di).call(this,R);L>0&&(l+=L,f[O]=L)}let d=[],y=(s-1)*o,A=0,E=0,v=0;for(let O of Object.keys(f)){if(A>=o)break;v+=f[O]-1;let R=y>=E&&y<=v,L=y+o-1>=E&&y+o-1<=v,oe=y<=E&&y+o-1>=v;if(R||oe||L){let G=y-E,z=Math.min(v-y+1,o-A);A+=z,d.push({runId:O,startIndex:G,count:z})}E+=f[O],v=E}if(!d.length)break;for(let O of d){let{runId:R,startIndex:L,count:oe}=O,G=p(this,Rn).call(this,r,n,R),z=parseInt(R.replace(/^.*\-(\d+)$/g,"$1"),10),S=R.split("-")[1]??"default";try{a=a.concat((await p(this,In).call(this,G,L,oe)).map(N=>(N._time=z,N._sid=S,N)))}catch{}}}while(!1);return{rows:a,total:l,pageNumber:s,pageSize:o}});_(this,"outputTableAdd",(r,i,n,s)=>{let o=!1;do{if(r=p(this,ee).call(this,r),!r.length||(n=p(this,at).call(this,n),!n.length)||(i=p(this,Nt).call(this,i),!i.length))break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_OUTPUTS];if(!Array.isArray(l)||!l.length)break;let c=l.reduce((h,f)=>f.type==="table"&&f.key===n?f:h,null);if(c===null||(s=p(this,Pi).call(this,s,c),s===null))break;let u=p(this,Rn).call(this,r,n,i);if(T.existsSync(u)&&T.statSync(u).size/1048576>=er.max.sourceCode.ioFieldTableSize)break;T.existsSync(B.dirname(u))||T.mkdirSync(B.dirname(u),{recursive:!0}),T.writeFileSync(u,"".concat(JSON.stringify(s),"\n"),{flag:"a",encoding:"utf8"}),o=!0}while(!1);return o});_(this,"outputsGet",(r,i,n=null)=>{let s={},o={};do{if(r=p(this,ee).call(this,r),!r.length||(i=p(this,Nt).call(this,i),!i.length))break;let a=p(this,ke).call(this,r,i);if(!T.existsSync(a)||!T.statSync(a).isDirectory())break;let l=p(this,ke).call(this,r,i,Nc),c={};try{T.existsSync(l)&&T.statSync(l).isFile()&&(c=JSON.parse(T.readFileSync(l).toString()),(typeof c!="object"||c===null)&&(c={}))}catch{}if(!Array.isArray(n)||!n.length){let u=this.sourceGet(r);if(typeof u!="object"||u===null||(n=u[Te.K_SRC_OUTPUTS],!Array.isArray(n)||!n.length))break}o=p(this,Ys).call(this,s,{agentId:r,runId:i,scalarData:c,srcOutputs:n})}while(!1);return s});_(this,"outputsQuery",(r,i,n=null,s=null)=>{let o=[],a=0,l={};do{if(r=p(this,ee).call(this,r),!r.length)break;let c=p(this,ke).call(this,r);if(!T.existsSync(c)||!T.statSync(c).isDirectory())break;i="".concat(i??ya).toLowerCase().replace(/\W+/gi,""),i.length||(i=ya);let u=this.sourceGet(r);if(typeof u!="object"||u===null)break;let h=u[Te.K_SRC_OUTPUTS];if(!Array.isArray(h)||!h.length)break;for(let f of h)l[f.key]=[];(!Number.isInteger(n)||n<=0)&&(n=Math.floor(new Date().setHours(0,0,0,0)/1e3)),(!Number.isInteger(s)||s<=0)&&(s=Math.floor(new Date().getTime()/1e3));for(let f of T.readdirSync(c,{withFileTypes:!0})){let d=f.name;if(!f.isDirectory()||d.indexOf("".concat(i,"-"))!==0)continue;let y=d.match(/\-(\d+)$/);if(!y)continue;let A=parseInt(y[1],10);!Number.isInteger(A)||A<n||A>s||(o.push(d),a++)}o.sort((f,d)=>{let y="".concat(f).trim().split("-").pop(),A="".concat(d).trim().split("-").pop();return y>A?-1:y<A?1:0}),o.length>er.max.diskStorage.outputRunsCount&&(o=o.slice(0,er.max.diskStorage.outputRunsCount));for(let f of o){let d=p(this,ke).call(this,r,f,Nc),y={};try{T.existsSync(d)&&T.statSync(d).isFile()&&(y=JSON.parse(T.readFileSync(d).toString()),(typeof y!="object"||y===null)&&(y={}))}catch{}let A={};p(this,Ys).call(this,A,{agentId:r,runId:f,scalarData:y,srcOutputs:h});for(let E of h)typeof A[E.key]<"u"&&l[E.key].push({runId:f,runData:A[E.key]})}}while(!1);return{runIds:o,runIdsTotal:a,fields:l}});_(this,"outputScalarSet",async(r,i,n,s)=>{let o=!1;do{if(r=p(this,ee).call(this,r),!r.length||(i=p(this,Nt).call(this,i),!i.length))break;let a=this.sourceGet(r);if(typeof a!="object"||a===null)break;let l=a[Te.K_SRC_OUTPUTS];if(!Array.isArray(l)||!l.length)break;let c=l.reduce((d,y)=>["int","string","boolean"].includes(y.type)&&y.key===n?y:d,null);if(c===null)break;let u=await this.outputsGet(r,i,l);u[n]=p(this,Nn).call(this,s,c);let h={};for(let d of l)["int","string","boolean"].includes(d.type)&&typeof u[d.key]<"u"&&(h[d.key]=u[d.key]);let f=p(this,ke).call(this,r,i,Nc);T.existsSync(B.dirname(f))||T.mkdirSync(B.dirname(f),{recursive:!0}),T.writeFileSync(f,JSON.stringify(h,null,2)),o=!0}while(!1);return o});_(this,"outputFilesInit",(r,i,n,s=null)=>{if(r=p(this,ee).call(this,r),!r.length)throw new Error("Invalid agent ID");if(i=p(this,Nt).call(this,i),!i.length)throw new Error("Invalid run ID");if(n=p(this,at).call(this,n),!n.length)throw new Error("Invalid output key");let o=p(this,ke).call(this,r,i);if(!T.existsSync(o)||!T.statSync(o).isDirectory())throw new Error("Run not initialized");let a=B.join(o,Cn);T.existsSync(a)||T.mkdirSync(a,{recursive:!0});let l=this.sourceGet(r);if(typeof l!="object"||l===null)throw new Error("Source code not defined for this agent");let c=l[Te.K_SRC_OUTPUTS];if(!Array.isArray(c)||!c.length)throw new Error("Outputs not defined for this agent");let u=c.reduce((v,O)=>O.type==="files"&&O.key===n?O:v,null);if(u===null)throw new Error('Field "'.concat(n,'" is not of type file'));Array.isArray(u.extensions)||(u.extensions=["txt"]),s=typeof s=="string"?p(this,at).call(this,s):null,u.extensions.includes(s)||(s=u.extensions[0]);let h=0,f="".concat(n,"-"),[d,y]=i.split("-");for(let v of T.readdirSync(B.dirname(o),{withFileTypes:!0})){if(!v.isDirectory())continue;let[O,R]=v.name.split("-");if(O!==d||R!==y)continue;let L=B.join(B.dirname(o),v.name,Cn);if(T.existsSync(L)){for(let oe of T.readdirSync(L,{withFileTypes:!0}))if(oe.isFile()&&oe.name.indexOf(f)===0){let G=parseInt(oe.name.substring(f.length).replace(/^(\d+).*/,"$1"),10);Number.isInteger(G)&&G>0&&G>h&&(h=G)}}}let A="".concat(n,"-").concat(h+1,".").concat(s),E=B.join(a,A);return T.writeFileSync(E,"",{flag:"a"}),{fileName:A,filePath:E,minSize:Number.isInteger(u.min)&&u.min>0?u.min:null,maxSize:Number.isInteger(u.max)&&u.max>0?u.max:null}});_(this,"outputFilesAppend",async(r,i,n,s,o=null)=>{let a=!1;if(r=p(this,ee).call(this,r),i=p(this,Nt).call(this,i),n=p(this,zs).call(this,n),r.length&&i.length&&n.length){let l=B.join(p(this,ke).call(this,r,i),Cn,n);if(T.existsSync(l)){if(Number.isInteger(o)&&T.statSync(l).size+s.length>o*1048576)throw T.rmSync(l),new Error("Maximum file size exceeded for ".concat(n," (").concat(o,"MB)"));T.writeFileSync(l,s,{flag:"a"}),a=!0}}return a});_(this,"outputFilesDelete",async(r,i,n)=>{let s=!1;if(r=p(this,ee).call(this,r),i=p(this,Nt).call(this,i),n=p(this,zs).call(this,n),r.length&&i.length&&n.length){let o=B.join(p(this,ke).call(this,r,i),Cn,n);T.existsSync(o)&&(T.rmSync(o,{force:!0}),s=!0)}return s});this._register("diskStorage"),U(this,Et,iC.getPathConfig()),T.existsSync(p(this,Et))||T.mkdirSync(p(this,Et),{recursive:!0})}getSessionMetaPath(r){return r=p(this,ee).call(this,r),r.length?B.join(p(this,Et),"agents",r,"sessions",oC):null}getStorePath(){return p(this,Et)}},Vt=new WeakMap,Ii=new WeakMap,It=new WeakMap,Et=new WeakMap,js=new WeakMap,Ni=new WeakMap,gr=new WeakMap,yr=new WeakMap,xi=new WeakMap,Rn=new WeakMap,Di=new WeakMap,In=new WeakMap,Hs=new WeakMap,Ws=new WeakMap,xc=new WeakMap,Pi=new WeakMap,Gs=new WeakMap,Nn=new WeakMap,ee=new WeakMap,Nt=new WeakMap,St=new WeakMap,zs=new WeakMap,at=new WeakMap,Vs=new WeakMap,Ys=new WeakMap,ke=new WeakMap,Qs=new WeakMap,Bm)});var zm=w((xB,Gm)=>{var Aa=require("path"),bt=require("fs"),cC=zt(),hC=Zt(),Ae,Yt,Vr,Wm;Gm.exports=(Wm=class extends hC{constructor(r){super(r);I(this,Ae);_(this,"getAt",(r,i)=>{let n=k(this,Ae,Yt).call(this,r);if(!Array.isArray(n)||!Number.isInteger(i)||i<=0)return null;let s=null,o=new Date(i*1e3),a=o.getFullYear(),l=o.getMonth()+1,c=o.getDate(),u=o.getHours(),h=o.getMinutes();for(let d of n)if(d.sessionType==="schedule"&&!(!d.sessionReady||!d.sessionEnabled)&&d.sessionInfo.year===a&&d.sessionInfo.month===l&&d.sessionInfo.day===c&&d.sessionInfo.hour===u&&d.sessionInfo.minute===h){s=d;break}if(s!==null)return s;let f=(d,y=!1)=>{if(d="".concat(d??"").trim(),d==="*")return()=>!0;if(d[0]==="%"){let A=Math.abs(parseInt(d.substring(1),10));if(Number.isInteger(A)&&A>=2&&A<=1e3)return E=>E%A===0}if(d.match(/^\d+(?:,\d+)*?$/)){let A=d.split(",").map(E=>Math.abs(parseInt(E.trim(),10))).filter(E=>Number.isInteger(E));if(A.length)return E=>A.includes(E)}if(y&&d.match(/^\d+(?:,\d+)*?$/)){let A=d.substring(1).split(",").map(E=>Math.abs(parseInt(E.trim(),10))).filter(E=>Number.isInteger(E)&&E>=1&&E<=7);if(A.length)return E=>A.includes(E)}return()=>!1};for(let d of n)if(d.sessionType==="cron"&&!(!d.sessionReady||!d.sessionEnabled)&&f(d.sessionInfo.day,!0)(c)&&f(d.sessionInfo.hour)(u)&&f(d.sessionInfo.minute)(h)){s=d;break}return s});_(this,"create",(r,i,n)=>{let s=k(this,Ae,Yt).call(this,r);if(!Array.isArray(s))return null;let o=n[0]+cC.generateKey().substring(1);do{if(typeof i=="string"&&(i=i.toLowerCase().trim(),i.length))break;i=null}while(!1);["schedule","cron"].includes(n)||(n="schedule");let a=!0,l=!1,c=0,u="[ ".concat(n==="schedule"?"scheduled":"recurring"," ]"),h=new Date(new Date().getTime()+864e5),f=n==="schedule"?{year:h.getFullYear(),month:h.getMonth()+1,day:h.getDate(),hour:h.getHours(),minute:h.getMinutes()}:{day:"*",hour:"*",minute:"0"};return s.push({sessionId:o,moduleId:i,sessionEnabled:a,sessionReady:l,sessionName:u,sessionType:n,sessionInfo:f,sessionRuns:c}),k(this,Ae,Vr).call(this,r,s),o});_(this,"readAll",(r,i)=>{let n=k(this,Ae,Yt).call(this,r,i);return Array.isArray(n)?n:[]});_(this,"read",(r,i)=>{let n=k(this,Ae,Yt).call(this,r);return(Array.isArray(n)?n:[]).reduce((s,o)=>o.sessionId===i?o:s,null)});_(this,"updateName",(r,i,n)=>{let s=k(this,Ae,Yt).call(this,r);if(!Array.isArray(s))return"";let o=s.reduce((a,l)=>l.sessionId===i?l.sessionType:a,null);return["schedule","cron"].includes(o)?(n="".concat(n??"").replace(/\s+/g," ").substring(0,32).trim(),k(this,Ae,Vr).call(this,r,s.map(a=>a.sessionId===i?{...a,sessionName:n}:a)),n):""});_(this,"updateInfo",(r,i,n)=>{let s=k(this,Ae,Yt).call(this,r);if(!Array.isArray(s))return!1;let o=s.reduce((l,c)=>c.sessionId===i?c.sessionType:l,null);if(!["schedule","cron"].includes(o)||typeof n!="object"||n===null)return!1;let a={};if(o==="schedule")for(let l of["year","month","day","hour","minute"]){if(!Number.isInteger(n[l])||n[l]<0||n[l]>1e4)return!1;a[l]=n[l]}else for(let l of["day","hour","minute"]){if(typeof n[l]!="string"||!n[l].length)return!1;a[l]=n[l]}return n=a,k(this,Ae,Vr).call(this,r,s.map(l=>l.sessionId===i?{...l,sessionInfo:n}:l)),!0});_(this,"updateReady",(r,i,n)=>{let s=k(this,Ae,Yt).call(this,r);return Array.isArray(s)?(n=!!n,s.reduce((a,l)=>l.sessionId===i?l.sessionReady:a,!1)!==n?(k(this,Ae,Vr).call(this,r,s.map(a=>a.sessionId===i?{...a,sessionReady:n}:a)),!0):!1):!1});_(this,"updateEnabled",(r,i,n)=>{let s=k(this,Ae,Yt).call(this,r);return Array.isArray(s)?(n=!!n,s.reduce((a,l)=>l.sessionId===i?l.sessionEnabled:a,!1)!==n?(k(this,Ae,Vr).call(this,r,s.map(a=>a.sessionId===i?{...a,sessionEnabled:n}:a)),!0):!1):!1});_(this,"delete",(r,i=null,n=null)=>{let s=k(this,Ae,Yt).call(this,r);return Array.isArray(s)?(s=s.filter(o=>typeof i=="string"&&o.sessionType!==i||typeof n=="string"&&o.sessionId!==n),k(this,Ae,Vr).call(this,r,s),!0):!1});this._register("session")}incrementRuns(r,i){let n=k(this,Ae,Yt).call(this,r);if(!Array.isArray(n))return!1;let s=n.reduce((c,u)=>u.sessionId===i?u.sessionType:c,null);if(!["schedule","cron"].includes(s))return!1;let o=n.reduce((c,u)=>u.sessionId===i?u.sessionReady:c,!1),a=n.reduce((c,u)=>u.sessionId===i?u.sessionEnabled:c,!1);if(!o||!a)return!1;let l=n.reduce((c,u)=>u.sessionId===i?u.sessionRuns:c,0);return Number.isInteger(l)&&l>0?l++:l=1,k(this,Ae,Vr).call(this,r,n.map(c=>c.sessionId===i?{...c,sessionRuns:l}:c)),!0}},Ae=new WeakSet,Yt=function(r,i=null){if(typeof r!="string")return null;let n=this._oglama.diskStorage.getSessionMetaPath(r);if(typeof n!="string")return null;let s=Aa.dirname(n);bt.existsSync(s)||bt.mkdirSync(s,{recursive:!0});let o=[];if(!bt.existsSync(n))bt.writeFileSync(n,"[]");else try{let l=JSON.parse(bt.readFileSync(n).toString());Array.isArray(l)&&(o=l)}catch{}let a=bt.readdirSync(s,{withFileTypes:!0}).filter(l=>l.isDirectory()&&l.name!=="default").map(l=>l.name);return o=o.filter(l=>typeof l=="object"&&typeof l?.sessionId=="string"&&(i===null||l?.sessionType===i)&&a.includes(l.sessionId)),o},Vr=function(r,i){if(typeof r!="string"||!Array.isArray(i))return!1;let n=this._oglama.diskStorage.getSessionMetaPath(r);if(typeof n!="string")return!1;let s=Aa.dirname(n);bt.existsSync(s)||bt.mkdirSync(s,{recursive:!0}),bt.writeFileSync(n,JSON.stringify(i,null,2));let o=i.map(l=>l.sessionId),a=bt.readdirSync(s,{withFileTypes:!0}).filter(l=>l.isDirectory()&&l.name!=="default").map(l=>l.name);for(let l of o){let c=Aa.join(s,l);bt.existsSync(c)||bt.mkdirSync(c,{recursive:!0})}for(let l of a)if(!o.includes(l)){let c=Aa.join(s,l);bt.rmSync(c,{recursive:!0})}return!0},Wm)});var lt=w(Dc=>{"use strict";Dc.fromCallback=function(t){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")t.apply(this,e);else return new Promise((r,i)=>{e.push((n,s)=>n!=null?i(n):r(s)),t.apply(this,e)})},"name",{value:t.name})};Dc.fromPromise=function(t){return Object.defineProperty(function(...e){let r=e[e.length-1];if(typeof r!="function")return t.apply(this,e);e.pop(),t.apply(this,e).then(i=>r(null,i),r)},"name",{value:t.name})}});var Ym=w((FB,Vm)=>{var Yr=require("constants"),fC=process.cwd,Ea=null,dC=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Ea||(Ea=fC.call(process)),Ea};try{process.cwd()}catch{}typeof process.chdir=="function"&&(Pc=process.chdir,process.chdir=function(t){Ea=null,Pc.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Pc));var Pc;Vm.exports=pC;function pC(t){Yr.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=s(t.chown),t.fchown=s(t.fchown),t.lchown=s(t.lchown),t.chmod=i(t.chmod),t.fchmod=i(t.fchmod),t.lchmod=i(t.lchmod),t.chownSync=o(t.chownSync),t.fchownSync=o(t.fchownSync),t.lchownSync=o(t.lchownSync),t.chmodSync=n(t.chmodSync),t.fchmodSync=n(t.fchmodSync),t.lchmodSync=n(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=l(t.statSync),t.fstatSync=l(t.fstatSync),t.lstatSync=l(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(u,h,f){f&&process.nextTick(f)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(u,h,f,d){d&&process.nextTick(d)},t.lchownSync=function(){}),dC==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:(function(u){function h(f,d,y){var A=Date.now(),E=0;u(f,d,function v(O){if(O&&(O.code==="EACCES"||O.code==="EPERM"||O.code==="EBUSY")&&Date.now()-A<6e4){setTimeout(function(){t.stat(d,function(R,L){R&&R.code==="ENOENT"?u(f,d,v):y(O)})},E),E<100&&(E+=10);return}y&&y(O)})}return Object.setPrototypeOf&&Object.setPrototypeOf(h,u),h})(t.rename)),t.read=typeof t.read!="function"?t.read:(function(u){function h(f,d,y,A,E,v){var O;if(v&&typeof v=="function"){var R=0;O=function(L,oe,G){if(L&&L.code==="EAGAIN"&&R<10)return R++,u.call(t,f,d,y,A,E,O);v.apply(this,arguments)}}return u.call(t,f,d,y,A,E,O)}return Object.setPrototypeOf&&Object.setPrototypeOf(h,u),h})(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:(function(u){return function(h,f,d,y,A){for(var E=0;;)try{return u.call(t,h,f,d,y,A)}catch(v){if(v.code==="EAGAIN"&&E<10){E++;continue}throw v}}})(t.readSync);function e(u){u.lchmod=function(h,f,d){u.open(h,Yr.O_WRONLY|Yr.O_SYMLINK,f,function(y,A){if(y){d&&d(y);return}u.fchmod(A,f,function(E){u.close(A,function(v){d&&d(E||v)})})})},u.lchmodSync=function(h,f){var d=u.openSync(h,Yr.O_WRONLY|Yr.O_SYMLINK,f),y=!0,A;try{A=u.fchmodSync(d,f),y=!1}finally{if(y)try{u.closeSync(d)}catch{}else u.closeSync(d)}return A}}function r(u){Yr.hasOwnProperty("O_SYMLINK")&&u.futimes?(u.lutimes=function(h,f,d,y){u.open(h,Yr.O_SYMLINK,function(A,E){if(A){y&&y(A);return}u.futimes(E,f,d,function(v){u.close(E,function(O){y&&y(v||O)})})})},u.lutimesSync=function(h,f,d){var y=u.openSync(h,Yr.O_SYMLINK),A,E=!0;try{A=u.futimesSync(y,f,d),E=!1}finally{if(E)try{u.closeSync(y)}catch{}else u.closeSync(y)}return A}):u.futimes&&(u.lutimes=function(h,f,d,y){y&&process.nextTick(y)},u.lutimesSync=function(){})}function i(u){return u&&function(h,f,d){return u.call(t,h,f,function(y){c(y)&&(y=null),d&&d.apply(this,arguments)})}}function n(u){return u&&function(h,f){try{return u.call(t,h,f)}catch(d){if(!c(d))throw d}}}function s(u){return u&&function(h,f,d,y){return u.call(t,h,f,d,function(A){c(A)&&(A=null),y&&y.apply(this,arguments)})}}function o(u){return u&&function(h,f,d){try{return u.call(t,h,f,d)}catch(y){if(!c(y))throw y}}}function a(u){return u&&function(h,f,d){typeof f=="function"&&(d=f,f=null);function y(A,E){E&&(E.uid<0&&(E.uid+=4294967296),E.gid<0&&(E.gid+=4294967296)),d&&d.apply(this,arguments)}return f?u.call(t,h,f,y):u.call(t,h,y)}}function l(u){return u&&function(h,f){var d=f?u.call(t,h,f):u.call(t,h);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function c(u){if(!u||u.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(u.code==="EINVAL"||u.code==="EPERM"))}}});var Km=w((LB,Xm)=>{var Qm=require("stream").Stream;Xm.exports=mC;function mC(t){return{ReadStream:e,WriteStream:r};function e(i,n){if(!(this instanceof e))return new e(i,n);Qm.call(this);var s=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,n=n||{};for(var o=Object.keys(n),a=0,l=o.length;a<l;a++){var c=o[a];this[c]=n[c]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}t.open(this.path,this.flags,this.mode,function(u,h){if(u){s.emit("error",u),s.readable=!1;return}s.fd=h,s.emit("open",h),s._read()})}function r(i,n){if(!(this instanceof r))return new r(i,n);Qm.call(this),this.path=i,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,n=n||{};for(var s=Object.keys(n),o=0,a=s.length;o<a;o++){var l=s[o];this[l]=n[l]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var Zm=w(($B,Jm)=>{"use strict";Jm.exports=yC;var gC=Object.getPrototypeOf||function(t){return t.__proto__};function yC(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:gC(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var Xe=w((kB,$c)=>{var me=require("fs"),wC=Ym(),AC=Km(),EC=Zm(),Sa=require("util"),qe,_a;typeof Symbol=="function"&&typeof Symbol.for=="function"?(qe=Symbol.for("graceful-fs.queue"),_a=Symbol.for("graceful-fs.previous")):(qe="___graceful-fs.queue",_a="___graceful-fs.previous");function SC(){}function rg(t,e){Object.defineProperty(t,qe,{get:function(){return e}})}var Fi=SC;Sa.debuglog?Fi=Sa.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Fi=function(){var t=Sa.format.apply(Sa,arguments);t="GFS4: "+t.split(/\n/).join("\nGFS4: "),console.error(t)});me[qe]||(eg=global[qe]||[],rg(me,eg),me.close=(function(t){function e(r,i){return t.call(me,r,function(n){n||tg(),typeof i=="function"&&i.apply(this,arguments)})}return Object.defineProperty(e,_a,{value:t}),e})(me.close),me.closeSync=(function(t){function e(r){t.apply(me,arguments),tg()}return Object.defineProperty(e,_a,{value:t}),e})(me.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Fi(me[qe]),require("assert").equal(me[qe].length,0)}));var eg;global[qe]||rg(global,me[qe]);$c.exports=Fc(EC(me));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!me.__patched&&($c.exports=Fc(me),me.__patched=!0);function Fc(t){wC(t),t.gracefulify=Fc,t.createReadStream=oe,t.createWriteStream=G;var e=t.readFile;t.readFile=r;function r(N,H,P){return typeof H=="function"&&(P=H,H=null),Q(N,H,P);function Q(pe,J,V,M){return e(pe,J,function(re){re&&(re.code==="EMFILE"||re.code==="ENFILE")?xn([Q,[pe,J,V],re,M||Date.now(),Date.now()]):typeof V=="function"&&V.apply(this,arguments)})}}var i=t.writeFile;t.writeFile=n;function n(N,H,P,Q){return typeof P=="function"&&(Q=P,P=null),pe(N,H,P,Q);function pe(J,V,M,re,we){return i(J,V,M,function(ie){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?xn([pe,[J,V,M,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}var s=t.appendFile;s&&(t.appendFile=o);function o(N,H,P,Q){return typeof P=="function"&&(Q=P,P=null),pe(N,H,P,Q);function pe(J,V,M,re,we){return s(J,V,M,function(ie){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?xn([pe,[J,V,M,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=l);function l(N,H,P,Q){return typeof P=="function"&&(Q=P,P=0),pe(N,H,P,Q);function pe(J,V,M,re,we){return a(J,V,M,function(ie){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?xn([pe,[J,V,M,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}var c=t.readdir;t.readdir=h;var u=/^v[0-5]\./;function h(N,H,P){typeof H=="function"&&(P=H,H=null);var Q=u.test(process.version)?function(V,M,re,we){return c(V,pe(V,M,re,we))}:function(V,M,re,we){return c(V,M,pe(V,M,re,we))};return Q(N,H,P);function pe(J,V,M,re){return function(we,ie){we&&(we.code==="EMFILE"||we.code==="ENFILE")?xn([Q,[J,V,M],we,re||Date.now(),Date.now()]):(ie&&ie.sort&&ie.sort(),typeof M=="function"&&M.call(this,we,ie))}}}if(process.version.substr(0,4)==="v0.8"){var f=AC(t);v=f.ReadStream,R=f.WriteStream}var d=t.ReadStream;d&&(v.prototype=Object.create(d.prototype),v.prototype.open=O);var y=t.WriteStream;y&&(R.prototype=Object.create(y.prototype),R.prototype.open=L),Object.defineProperty(t,"ReadStream",{get:function(){return v},set:function(N){v=N},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return R},set:function(N){R=N},enumerable:!0,configurable:!0});var A=v;Object.defineProperty(t,"FileReadStream",{get:function(){return A},set:function(N){A=N},enumerable:!0,configurable:!0});var E=R;Object.defineProperty(t,"FileWriteStream",{get:function(){return E},set:function(N){E=N},enumerable:!0,configurable:!0});function v(N,H){return this instanceof v?(d.apply(this,arguments),this):v.apply(Object.create(v.prototype),arguments)}function O(){var N=this;S(N.path,N.flags,N.mode,function(H,P){H?(N.autoClose&&N.destroy(),N.emit("error",H)):(N.fd=P,N.emit("open",P),N.read())})}function R(N,H){return this instanceof R?(y.apply(this,arguments),this):R.apply(Object.create(R.prototype),arguments)}function L(){var N=this;S(N.path,N.flags,N.mode,function(H,P){H?(N.destroy(),N.emit("error",H)):(N.fd=P,N.emit("open",P))})}function oe(N,H){return new t.ReadStream(N,H)}function G(N,H){return new t.WriteStream(N,H)}var z=t.open;t.open=S;function S(N,H,P,Q){return typeof P=="function"&&(Q=P,P=null),pe(N,H,P,Q);function pe(J,V,M,re,we){return z(J,V,M,function(ie,zr){ie&&(ie.code==="EMFILE"||ie.code==="ENFILE")?xn([pe,[J,V,M,re],ie,we||Date.now(),Date.now()]):typeof re=="function"&&re.apply(this,arguments)})}}return t}function xn(t){Fi("ENQUEUE",t[0].name,t[1]),me[qe].push(t),Lc()}var ba;function tg(){for(var t=Date.now(),e=0;e<me[qe].length;++e)me[qe][e].length>2&&(me[qe][e][3]=t,me[qe][e][4]=t);Lc()}function Lc(){if(clearTimeout(ba),ba=void 0,me[qe].length!==0){var t=me[qe].shift(),e=t[0],r=t[1],i=t[2],n=t[3],s=t[4];if(n===void 0)Fi("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-n>=6e4){Fi("TIMEOUT",e.name,r);var o=r.pop();typeof o=="function"&&o.call(null,i)}else{var a=Date.now()-s,l=Math.max(s-n,1),c=Math.min(l*1.2,100);a>=c?(Fi("RETRY",e.name,r),e.apply(null,r.concat([n]))):me[qe].push(t)}ba===void 0&&(ba=setTimeout(Lc,0))}}});var Li=w(Qr=>{"use strict";var ig=lt().fromCallback,ut=Xe(),bC=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>typeof ut[t]=="function");Object.assign(Qr,ut);bC.forEach(t=>{Qr[t]=ig(ut[t])});Qr.exists=function(t,e){return typeof e=="function"?ut.exists(t,e):new Promise(r=>ut.exists(t,r))};Qr.read=function(t,e,r,i,n,s){return typeof s=="function"?ut.read(t,e,r,i,n,s):new Promise((o,a)=>{ut.read(t,e,r,i,n,(l,c,u)=>{if(l)return a(l);o({bytesRead:c,buffer:u})})})};Qr.write=function(t,e,...r){return typeof r[r.length-1]=="function"?ut.write(t,e,...r):new Promise((i,n)=>{ut.write(t,e,...r,(s,o,a)=>{if(s)return n(s);i({bytesWritten:o,buffer:a})})})};typeof ut.writev=="function"&&(Qr.writev=function(t,e,...r){return typeof r[r.length-1]=="function"?ut.writev(t,e,...r):new Promise((i,n)=>{ut.writev(t,e,...r,(s,o,a)=>{if(s)return n(s);i({bytesWritten:o,buffers:a})})})});typeof ut.realpath.native=="function"?Qr.realpath.native=ig(ut.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var sg=w((MB,ng)=>{"use strict";var _C=require("path");ng.exports.checkPath=function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(_C.parse(e).root,""))){let i=new Error("Path contains invalid characters: ".concat(e));throw i.code="EINVAL",i}}});var ug=w((UB,kc)=>{"use strict";var og=Li(),{checkPath:ag}=sg(),lg=t=>{let e={mode:511};return typeof t=="number"?t:{...e,...t}.mode};kc.exports.makeDir=async(t,e)=>(ag(t),og.mkdir(t,{mode:lg(e),recursive:!0}));kc.exports.makeDirSync=(t,e)=>(ag(t),og.mkdirSync(t,{mode:lg(e),recursive:!0}))});var Qt=w((BB,cg)=>{"use strict";var vC=lt().fromPromise,{makeDir:OC,makeDirSync:qc}=ug(),Mc=vC(OC);cg.exports={mkdirs:Mc,mkdirsSync:qc,mkdirp:Mc,mkdirpSync:qc,ensureDir:Mc,ensureDirSync:qc}});var Xr=w((jB,fg)=>{"use strict";var TC=lt().fromPromise,hg=Li();function CC(t){return hg.access(t).then(()=>!0).catch(()=>!1)}fg.exports={pathExists:TC(CC),pathExistsSync:hg.existsSync}});var Uc=w((HB,dg)=>{"use strict";var Dn=Xe();function RC(t,e,r,i){Dn.open(t,"r+",(n,s)=>{if(n)return i(n);Dn.futimes(s,e,r,o=>{Dn.close(s,a=>{i&&i(o||a)})})})}function IC(t,e,r){let i=Dn.openSync(t,"r+");return Dn.futimesSync(i,e,r),Dn.closeSync(i)}dg.exports={utimesMillis:RC,utimesMillisSync:IC}});var $i=w((WB,gg)=>{"use strict";var Pn=Li(),Re=require("path"),NC=require("util");function xC(t,e,r){let i=r.dereference?n=>Pn.stat(n,{bigint:!0}):n=>Pn.lstat(n,{bigint:!0});return Promise.all([i(t),i(e).catch(n=>{if(n.code==="ENOENT")return null;throw n})]).then(([n,s])=>({srcStat:n,destStat:s}))}function DC(t,e,r){let i,n=r.dereference?o=>Pn.statSync(o,{bigint:!0}):o=>Pn.lstatSync(o,{bigint:!0}),s=n(t);try{i=n(e)}catch(o){if(o.code==="ENOENT")return{srcStat:s,destStat:null};throw o}return{srcStat:s,destStat:i}}function PC(t,e,r,i,n){NC.callbackify(xC)(t,e,i,(s,o)=>{if(s)return n(s);let{srcStat:a,destStat:l}=o;if(l){if(Xs(a,l)){let c=Re.basename(t),u=Re.basename(e);return r==="move"&&c!==u&&c.toLowerCase()===u.toLowerCase()?n(null,{srcStat:a,destStat:l,isChangingCase:!0}):n(new Error("Source and destination must not be the same."))}if(a.isDirectory()&&!l.isDirectory())return n(new Error("Cannot overwrite non-directory '".concat(e,"' with directory '").concat(t,"'.")));if(!a.isDirectory()&&l.isDirectory())return n(new Error("Cannot overwrite directory '".concat(e,"' with non-directory '").concat(t,"'.")))}return a.isDirectory()&&Bc(t,e)?n(new Error(va(t,e,r))):n(null,{srcStat:a,destStat:l})})}function FC(t,e,r,i){let{srcStat:n,destStat:s}=DC(t,e,i);if(s){if(Xs(n,s)){let o=Re.basename(t),a=Re.basename(e);if(r==="move"&&o!==a&&o.toLowerCase()===a.toLowerCase())return{srcStat:n,destStat:s,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(n.isDirectory()&&!s.isDirectory())throw new Error("Cannot overwrite non-directory '".concat(e,"' with directory '").concat(t,"'."));if(!n.isDirectory()&&s.isDirectory())throw new Error("Cannot overwrite directory '".concat(e,"' with non-directory '").concat(t,"'."))}if(n.isDirectory()&&Bc(t,e))throw new Error(va(t,e,r));return{srcStat:n,destStat:s}}function pg(t,e,r,i,n){let s=Re.resolve(Re.dirname(t)),o=Re.resolve(Re.dirname(r));if(o===s||o===Re.parse(o).root)return n();Pn.stat(o,{bigint:!0},(a,l)=>a?a.code==="ENOENT"?n():n(a):Xs(e,l)?n(new Error(va(t,r,i))):pg(t,e,o,i,n))}function mg(t,e,r,i){let n=Re.resolve(Re.dirname(t)),s=Re.resolve(Re.dirname(r));if(s===n||s===Re.parse(s).root)return;let o;try{o=Pn.statSync(s,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Xs(e,o))throw new Error(va(t,r,i));return mg(t,e,s,i)}function Xs(t,e){return e.ino&&e.dev&&e.ino===t.ino&&e.dev===t.dev}function Bc(t,e){let r=Re.resolve(t).split(Re.sep).filter(n=>n),i=Re.resolve(e).split(Re.sep).filter(n=>n);return r.reduce((n,s,o)=>n&&i[o]===s,!0)}function va(t,e,r){return"Cannot ".concat(r," '").concat(t,"' to a subdirectory of itself, '").concat(e,"'.")}gg.exports={checkPaths:PC,checkPathsSync:FC,checkParentPaths:pg,checkParentPathsSync:mg,isSrcSubdir:Bc,areIdentical:Xs}});var vg=w((GB,_g)=>{"use strict";var ct=Xe(),Ks=require("path"),LC=Qt().mkdirs,$C=Xr().pathExists,kC=Uc().utimesMillis,Js=$i();function qC(t,e,r,i){typeof r=="function"&&!i?(i=r,r={}):typeof r=="function"&&(r={filter:r}),i=i||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n	see https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0001"),Js.checkPaths(t,e,"copy",r,(n,s)=>{if(n)return i(n);let{srcStat:o,destStat:a}=s;Js.checkParentPaths(t,o,e,"copy",l=>l?i(l):r.filter?Ag(yg,a,t,e,r,i):yg(a,t,e,r,i))})}function yg(t,e,r,i,n){let s=Ks.dirname(r);$C(s,(o,a)=>{if(o)return n(o);if(a)return Oa(t,e,r,i,n);LC(s,l=>l?n(l):Oa(t,e,r,i,n))})}function Ag(t,e,r,i,n,s){Promise.resolve(n.filter(r,i)).then(o=>o?t(e,r,i,n,s):s(),o=>s(o))}function MC(t,e,r,i,n){return i.filter?Ag(Oa,t,e,r,i,n):Oa(t,e,r,i,n)}function Oa(t,e,r,i,n){(i.dereference?ct.stat:ct.lstat)(e,(o,a)=>o?n(o):a.isDirectory()?zC(a,t,e,r,i,n):a.isFile()||a.isCharacterDevice()||a.isBlockDevice()?UC(a,t,e,r,i,n):a.isSymbolicLink()?QC(t,e,r,i,n):a.isSocket()?n(new Error("Cannot copy a socket file: ".concat(e))):a.isFIFO()?n(new Error("Cannot copy a FIFO pipe: ".concat(e))):n(new Error("Unknown file: ".concat(e))))}function UC(t,e,r,i,n,s){return e?BC(t,r,i,n,s):Eg(t,r,i,n,s)}function BC(t,e,r,i,n){if(i.overwrite)ct.unlink(r,s=>s?n(s):Eg(t,e,r,i,n));else return i.errorOnExist?n(new Error("'".concat(r,"' already exists"))):n()}function Eg(t,e,r,i,n){ct.copyFile(e,r,s=>s?n(s):i.preserveTimestamps?jC(t.mode,e,r,n):Ta(r,t.mode,n))}function jC(t,e,r,i){return HC(t)?WC(r,t,n=>n?i(n):wg(t,e,r,i)):wg(t,e,r,i)}function HC(t){return(t&128)===0}function WC(t,e,r){return Ta(t,e|128,r)}function wg(t,e,r,i){GC(e,r,n=>n?i(n):Ta(r,t,i))}function Ta(t,e,r){return ct.chmod(t,e,r)}function GC(t,e,r){ct.stat(t,(i,n)=>i?r(i):kC(e,n.atime,n.mtime,r))}function zC(t,e,r,i,n,s){return e?Sg(r,i,n,s):VC(t.mode,r,i,n,s)}function VC(t,e,r,i,n){ct.mkdir(r,s=>{if(s)return n(s);Sg(e,r,i,o=>o?n(o):Ta(r,t,n))})}function Sg(t,e,r,i){ct.readdir(t,(n,s)=>n?i(n):bg(s,t,e,r,i))}function bg(t,e,r,i,n){let s=t.pop();return s?YC(t,s,e,r,i,n):n()}function YC(t,e,r,i,n,s){let o=Ks.join(r,e),a=Ks.join(i,e);Js.checkPaths(o,a,"copy",n,(l,c)=>{if(l)return s(l);let{destStat:u}=c;MC(u,o,a,n,h=>h?s(h):bg(t,r,i,n,s))})}function QC(t,e,r,i,n){ct.readlink(e,(s,o)=>{if(s)return n(s);if(i.dereference&&(o=Ks.resolve(process.cwd(),o)),t)ct.readlink(r,(a,l)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?ct.symlink(o,r,n):n(a):(i.dereference&&(l=Ks.resolve(process.cwd(),l)),Js.isSrcSubdir(o,l)?n(new Error("Cannot copy '".concat(o,"' to a subdirectory of itself, '").concat(l,"'."))):t.isDirectory()&&Js.isSrcSubdir(l,o)?n(new Error("Cannot overwrite '".concat(l,"' with '").concat(o,"'."))):XC(o,r,n)));else return ct.symlink(o,r,n)})}function XC(t,e,r){ct.unlink(e,i=>i?r(i):ct.symlink(t,e,r))}_g.exports=qC});var Ig=w((zB,Rg)=>{"use strict";var Be=Xe(),Zs=require("path"),KC=Qt().mkdirsSync,JC=Uc().utimesMillisSync,eo=$i();function ZC(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n	see https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0002");let{srcStat:i,destStat:n}=eo.checkPathsSync(t,e,"copy",r);return eo.checkParentPathsSync(t,i,e,"copy"),eR(n,t,e,r)}function eR(t,e,r,i){if(i.filter&&!i.filter(e,r))return;let n=Zs.dirname(r);return Be.existsSync(n)||KC(n),Og(t,e,r,i)}function tR(t,e,r,i){if(!(i.filter&&!i.filter(e,r)))return Og(t,e,r,i)}function Og(t,e,r,i){let s=(i.dereference?Be.statSync:Be.lstatSync)(e);if(s.isDirectory())return lR(s,t,e,r,i);if(s.isFile()||s.isCharacterDevice()||s.isBlockDevice())return rR(s,t,e,r,i);if(s.isSymbolicLink())return hR(t,e,r,i);throw s.isSocket()?new Error("Cannot copy a socket file: ".concat(e)):s.isFIFO()?new Error("Cannot copy a FIFO pipe: ".concat(e)):new Error("Unknown file: ".concat(e))}function rR(t,e,r,i,n){return e?iR(t,r,i,n):Tg(t,r,i,n)}function iR(t,e,r,i){if(i.overwrite)return Be.unlinkSync(r),Tg(t,e,r,i);if(i.errorOnExist)throw new Error("'".concat(r,"' already exists"))}function Tg(t,e,r,i){return Be.copyFileSync(e,r),i.preserveTimestamps&&nR(t.mode,e,r),jc(r,t.mode)}function nR(t,e,r){return sR(t)&&oR(r,t),aR(e,r)}function sR(t){return(t&128)===0}function oR(t,e){return jc(t,e|128)}function jc(t,e){return Be.chmodSync(t,e)}function aR(t,e){let r=Be.statSync(t);return JC(e,r.atime,r.mtime)}function lR(t,e,r,i,n){return e?Cg(r,i,n):uR(t.mode,r,i,n)}function uR(t,e,r,i){return Be.mkdirSync(r),Cg(e,r,i),jc(r,t)}function Cg(t,e,r){Be.readdirSync(t).forEach(i=>cR(i,t,e,r))}function cR(t,e,r,i){let n=Zs.join(e,t),s=Zs.join(r,t),{destStat:o}=eo.checkPathsSync(n,s,"copy",i);return tR(o,n,s,i)}function hR(t,e,r,i){let n=Be.readlinkSync(e);if(i.dereference&&(n=Zs.resolve(process.cwd(),n)),t){let s;try{s=Be.readlinkSync(r)}catch(o){if(o.code==="EINVAL"||o.code==="UNKNOWN")return Be.symlinkSync(n,r);throw o}if(i.dereference&&(s=Zs.resolve(process.cwd(),s)),eo.isSrcSubdir(n,s))throw new Error("Cannot copy '".concat(n,"' to a subdirectory of itself, '").concat(s,"'."));if(Be.statSync(r).isDirectory()&&eo.isSrcSubdir(s,n))throw new Error("Cannot overwrite '".concat(s,"' with '").concat(n,"'."));return fR(n,r)}else return Be.symlinkSync(n,r)}function fR(t,e){return Be.unlinkSync(e),Be.symlinkSync(t,e)}Rg.exports=ZC});var Ca=w((VB,Ng)=>{"use strict";var dR=lt().fromCallback;Ng.exports={copy:dR(vg()),copySync:Ig()}});var Mg=w((YB,qg)=>{"use strict";var xg=Xe(),Lg=require("path"),ae=require("assert"),to=process.platform==="win32";function $g(t){["unlink","chmod","stat","lstat","rmdir","readdir"].forEach(r=>{t[r]=t[r]||xg[r],r=r+"Sync",t[r]=t[r]||xg[r]}),t.maxBusyTries=t.maxBusyTries||3}function Hc(t,e,r){let i=0;typeof e=="function"&&(r=e,e={}),ae(t,"rimraf: missing path"),ae.strictEqual(typeof t,"string","rimraf: path should be a string"),ae.strictEqual(typeof r,"function","rimraf: callback function required"),ae(e,"rimraf: invalid options argument provided"),ae.strictEqual(typeof e,"object","rimraf: options should be object"),$g(e),Dg(t,e,function n(s){if(s){if((s.code==="EBUSY"||s.code==="ENOTEMPTY"||s.code==="EPERM")&&i<e.maxBusyTries){i++;let o=i*100;return setTimeout(()=>Dg(t,e,n),o)}s.code==="ENOENT"&&(s=null)}r(s)})}function Dg(t,e,r){ae(t),ae(e),ae(typeof r=="function"),e.lstat(t,(i,n)=>{if(i&&i.code==="ENOENT")return r(null);if(i&&i.code==="EPERM"&&to)return Pg(t,e,i,r);if(n&&n.isDirectory())return Ra(t,e,i,r);e.unlink(t,s=>{if(s){if(s.code==="ENOENT")return r(null);if(s.code==="EPERM")return to?Pg(t,e,s,r):Ra(t,e,s,r);if(s.code==="EISDIR")return Ra(t,e,s,r)}return r(s)})})}function Pg(t,e,r,i){ae(t),ae(e),ae(typeof i=="function"),e.chmod(t,438,n=>{n?i(n.code==="ENOENT"?null:r):e.stat(t,(s,o)=>{s?i(s.code==="ENOENT"?null:r):o.isDirectory()?Ra(t,e,r,i):e.unlink(t,i)})})}function Fg(t,e,r){let i;ae(t),ae(e);try{e.chmodSync(t,438)}catch(n){if(n.code==="ENOENT")return;throw r}try{i=e.statSync(t)}catch(n){if(n.code==="ENOENT")return;throw r}i.isDirectory()?Ia(t,e,r):e.unlinkSync(t)}function Ra(t,e,r,i){ae(t),ae(e),ae(typeof i=="function"),e.rmdir(t,n=>{n&&(n.code==="ENOTEMPTY"||n.code==="EEXIST"||n.code==="EPERM")?pR(t,e,i):n&&n.code==="ENOTDIR"?i(r):i(n)})}function pR(t,e,r){ae(t),ae(e),ae(typeof r=="function"),e.readdir(t,(i,n)=>{if(i)return r(i);let s=n.length,o;if(s===0)return e.rmdir(t,r);n.forEach(a=>{Hc(Lg.join(t,a),e,l=>{if(!o){if(l)return r(o=l);--s===0&&e.rmdir(t,r)}})})})}function kg(t,e){let r;e=e||{},$g(e),ae(t,"rimraf: missing path"),ae.strictEqual(typeof t,"string","rimraf: path should be a string"),ae(e,"rimraf: missing options"),ae.strictEqual(typeof e,"object","rimraf: options should be object");try{r=e.lstatSync(t)}catch(i){if(i.code==="ENOENT")return;i.code==="EPERM"&&to&&Fg(t,e,i)}try{r&&r.isDirectory()?Ia(t,e,null):e.unlinkSync(t)}catch(i){if(i.code==="ENOENT")return;if(i.code==="EPERM")return to?Fg(t,e,i):Ia(t,e,i);if(i.code!=="EISDIR")throw i;Ia(t,e,i)}}function Ia(t,e,r){ae(t),ae(e);try{e.rmdirSync(t)}catch(i){if(i.code==="ENOTDIR")throw r;if(i.code==="ENOTEMPTY"||i.code==="EEXIST"||i.code==="EPERM")mR(t,e);else if(i.code!=="ENOENT")throw i}}function mR(t,e){if(ae(t),ae(e),e.readdirSync(t).forEach(r=>kg(Lg.join(t,r),e)),to){let r=Date.now();do try{return e.rmdirSync(t,e)}catch{}while(Date.now()-r<500)}else return e.rmdirSync(t,e)}qg.exports=Hc;Hc.sync=kg});var ro=w((QB,Bg)=>{"use strict";var Na=Xe(),gR=lt().fromCallback,Ug=Mg();function yR(t,e){if(Na.rm)return Na.rm(t,{recursive:!0,force:!0},e);Ug(t,e)}function wR(t){if(Na.rmSync)return Na.rmSync(t,{recursive:!0,force:!0});Ug.sync(t)}Bg.exports={remove:gR(yR),removeSync:wR}});var Qg=w((XB,Yg)=>{"use strict";var AR=lt().fromPromise,Wg=Li(),Gg=require("path"),zg=Qt(),Vg=ro(),jg=AR(async function(e){let r;try{r=await Wg.readdir(e)}catch{return zg.mkdirs(e)}return Promise.all(r.map(i=>Vg.remove(Gg.join(e,i))))});function Hg(t){let e;try{e=Wg.readdirSync(t)}catch{return zg.mkdirsSync(t)}e.forEach(r=>{r=Gg.join(t,r),Vg.removeSync(r)})}Yg.exports={emptyDirSync:Hg,emptydirSync:Hg,emptyDir:jg,emptydir:jg}});var Zg=w((KB,Jg)=>{"use strict";var ER=lt().fromCallback,Xg=require("path"),Kr=Xe(),Kg=Qt();function SR(t,e){function r(){Kr.writeFile(t,"",i=>{if(i)return e(i);e()})}Kr.stat(t,(i,n)=>{if(!i&&n.isFile())return e();let s=Xg.dirname(t);Kr.stat(s,(o,a)=>{if(o)return o.code==="ENOENT"?Kg.mkdirs(s,l=>{if(l)return e(l);r()}):e(o);a.isDirectory()?r():Kr.readdir(s,l=>{if(l)return e(l)})})})}function bR(t){let e;try{e=Kr.statSync(t)}catch{}if(e&&e.isFile())return;let r=Xg.dirname(t);try{Kr.statSync(r).isDirectory()||Kr.readdirSync(r)}catch(i){if(i&&i.code==="ENOENT")Kg.mkdirsSync(r);else throw i}Kr.writeFileSync(t,"")}Jg.exports={createFile:ER(SR),createFileSync:bR}});var ny=w((JB,iy)=>{"use strict";var _R=lt().fromCallback,ey=require("path"),Jr=Xe(),ty=Qt(),vR=Xr().pathExists,{areIdentical:ry}=$i();function OR(t,e,r){function i(n,s){Jr.link(n,s,o=>{if(o)return r(o);r(null)})}Jr.lstat(e,(n,s)=>{Jr.lstat(t,(o,a)=>{if(o)return o.message=o.message.replace("lstat","ensureLink"),r(o);if(s&&ry(a,s))return r(null);let l=ey.dirname(e);vR(l,(c,u)=>{if(c)return r(c);if(u)return i(t,e);ty.mkdirs(l,h=>{if(h)return r(h);i(t,e)})})})})}function TR(t,e){let r;try{r=Jr.lstatSync(e)}catch{}try{let s=Jr.lstatSync(t);if(r&&ry(s,r))return}catch(s){throw s.message=s.message.replace("lstat","ensureLink"),s}let i=ey.dirname(e);return Jr.existsSync(i)||ty.mkdirsSync(i),Jr.linkSync(t,e)}iy.exports={createLink:_R(OR),createLinkSync:TR}});var oy=w((ZB,sy)=>{"use strict";var Zr=require("path"),io=Xe(),CR=Xr().pathExists;function RR(t,e,r){if(Zr.isAbsolute(t))return io.lstat(t,i=>i?(i.message=i.message.replace("lstat","ensureSymlink"),r(i)):r(null,{toCwd:t,toDst:t}));{let i=Zr.dirname(e),n=Zr.join(i,t);return CR(n,(s,o)=>s?r(s):o?r(null,{toCwd:n,toDst:t}):io.lstat(t,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:t,toDst:Zr.relative(i,t)})))}}function IR(t,e){let r;if(Zr.isAbsolute(t)){if(r=io.existsSync(t),!r)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}else{let i=Zr.dirname(e),n=Zr.join(i,t);if(r=io.existsSync(n),r)return{toCwd:n,toDst:t};if(r=io.existsSync(t),!r)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:Zr.relative(i,t)}}}sy.exports={symlinkPaths:RR,symlinkPathsSync:IR}});var uy=w((ej,ly)=>{"use strict";var ay=Xe();function NR(t,e,r){if(r=typeof e=="function"?e:r,e=typeof e=="function"?!1:e,e)return r(null,e);ay.lstat(t,(i,n)=>{if(i)return r(null,"file");e=n&&n.isDirectory()?"dir":"file",r(null,e)})}function xR(t,e){let r;if(e)return e;try{r=ay.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}ly.exports={symlinkType:NR,symlinkTypeSync:xR}});var yy=w((tj,gy)=>{"use strict";var DR=lt().fromCallback,hy=require("path"),Xt=Li(),fy=Qt(),PR=fy.mkdirs,FR=fy.mkdirsSync,dy=oy(),LR=dy.symlinkPaths,$R=dy.symlinkPathsSync,py=uy(),kR=py.symlinkType,qR=py.symlinkTypeSync,MR=Xr().pathExists,{areIdentical:my}=$i();function UR(t,e,r,i){i=typeof r=="function"?r:i,r=typeof r=="function"?!1:r,Xt.lstat(e,(n,s)=>{!n&&s.isSymbolicLink()?Promise.all([Xt.stat(t),Xt.stat(e)]).then(([o,a])=>{if(my(o,a))return i(null);cy(t,e,r,i)}):cy(t,e,r,i)})}function cy(t,e,r,i){LR(t,e,(n,s)=>{if(n)return i(n);t=s.toDst,kR(s.toCwd,r,(o,a)=>{if(o)return i(o);let l=hy.dirname(e);MR(l,(c,u)=>{if(c)return i(c);if(u)return Xt.symlink(t,e,a,i);PR(l,h=>{if(h)return i(h);Xt.symlink(t,e,a,i)})})})})}function BR(t,e,r){let i;try{i=Xt.lstatSync(e)}catch{}if(i&&i.isSymbolicLink()){let a=Xt.statSync(t),l=Xt.statSync(e);if(my(a,l))return}let n=$R(t,e);t=n.toDst,r=qR(n.toCwd,r);let s=hy.dirname(e);return Xt.existsSync(s)||FR(s),Xt.symlinkSync(t,e,r)}gy.exports={createSymlink:DR(UR),createSymlinkSync:BR}});var Oy=w((rj,vy)=>{"use strict";var{createFile:wy,createFileSync:Ay}=Zg(),{createLink:Ey,createLinkSync:Sy}=ny(),{createSymlink:by,createSymlinkSync:_y}=yy();vy.exports={createFile:wy,createFileSync:Ay,ensureFile:wy,ensureFileSync:Ay,createLink:Ey,createLinkSync:Sy,ensureLink:Ey,ensureLinkSync:Sy,createSymlink:by,createSymlinkSync:_y,ensureSymlink:by,ensureSymlinkSync:_y}});var xa=w((ij,Ty)=>{function jR(t,{EOL:e="\n",finalEOL:r=!0,replacer:i=null,spaces:n}={}){let s=r?e:"";return JSON.stringify(t,i,n).replace(/\n/g,e)+s}function HR(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t.replace(/^\uFEFF/,"")}Ty.exports={stringify:jR,stripBom:HR}});var Ny=w((nj,Iy)=>{var Fn;try{Fn=Xe()}catch{Fn=require("fs")}var Da=lt(),{stringify:Cy,stripBom:Ry}=xa();async function WR(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||Fn,i="throws"in e?e.throws:!0,n=await Da.fromCallback(r.readFile)(t,e);n=Ry(n);let s;try{s=JSON.parse(n,e?e.reviver:null)}catch(o){if(i)throw o.message="".concat(t,": ").concat(o.message),o;return null}return s}var GR=Da.fromPromise(WR);function zR(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||Fn,i="throws"in e?e.throws:!0;try{let n=r.readFileSync(t,e);return n=Ry(n),JSON.parse(n,e.reviver)}catch(n){if(i)throw n.message="".concat(t,": ").concat(n.message),n;return null}}async function VR(t,e,r={}){let i=r.fs||Fn,n=Cy(e,r);await Da.fromCallback(i.writeFile)(t,n,r)}var YR=Da.fromPromise(VR);function QR(t,e,r={}){let i=r.fs||Fn,n=Cy(e,r);return i.writeFileSync(t,n,r)}var XR={readFile:GR,readFileSync:zR,writeFile:YR,writeFileSync:QR};Iy.exports=XR});var Dy=w((sj,xy)=>{"use strict";var Pa=Ny();xy.exports={readJson:Pa.readFile,readJsonSync:Pa.readFileSync,writeJson:Pa.writeFile,writeJsonSync:Pa.writeFileSync}});var Fa=w((oj,Ly)=>{"use strict";var KR=lt().fromCallback,no=Xe(),Py=require("path"),Fy=Qt(),JR=Xr().pathExists;function ZR(t,e,r,i){typeof r=="function"&&(i=r,r="utf8");let n=Py.dirname(t);JR(n,(s,o)=>{if(s)return i(s);if(o)return no.writeFile(t,e,r,i);Fy.mkdirs(n,a=>{if(a)return i(a);no.writeFile(t,e,r,i)})})}function eI(t,...e){let r=Py.dirname(t);if(no.existsSync(r))return no.writeFileSync(t,...e);Fy.mkdirsSync(r),no.writeFileSync(t,...e)}Ly.exports={outputFile:KR(ZR),outputFileSync:eI}});var ky=w((aj,$y)=>{"use strict";var{stringify:tI}=xa(),{outputFile:rI}=Fa();async function iI(t,e,r={}){let i=tI(e,r);await rI(t,i,r)}$y.exports=iI});var My=w((lj,qy)=>{"use strict";var{stringify:nI}=xa(),{outputFileSync:sI}=Fa();function oI(t,e,r){let i=nI(e,r);sI(t,i,r)}qy.exports=oI});var By=w((uj,Uy)=>{"use strict";var aI=lt().fromPromise,Ke=Dy();Ke.outputJson=aI(ky());Ke.outputJsonSync=My();Ke.outputJSON=Ke.outputJson;Ke.outputJSONSync=Ke.outputJsonSync;Ke.writeJSON=Ke.writeJson;Ke.writeJSONSync=Ke.writeJsonSync;Ke.readJSON=Ke.readJson;Ke.readJSONSync=Ke.readJsonSync;Uy.exports=Ke});var zy=w((cj,Gy)=>{"use strict";var lI=Xe(),Gc=require("path"),uI=Ca().copy,Wy=ro().remove,cI=Qt().mkdirp,hI=Xr().pathExists,jy=$i();function fI(t,e,r,i){typeof r=="function"&&(i=r,r={}),r=r||{};let n=r.overwrite||r.clobber||!1;jy.checkPaths(t,e,"move",r,(s,o)=>{if(s)return i(s);let{srcStat:a,isChangingCase:l=!1}=o;jy.checkParentPaths(t,a,e,"move",c=>{if(c)return i(c);if(dI(e))return Hy(t,e,n,l,i);cI(Gc.dirname(e),u=>u?i(u):Hy(t,e,n,l,i))})})}function dI(t){let e=Gc.dirname(t);return Gc.parse(e).root===e}function Hy(t,e,r,i,n){if(i)return Wc(t,e,r,n);if(r)return Wy(e,s=>s?n(s):Wc(t,e,r,n));hI(e,(s,o)=>s?n(s):o?n(new Error("dest already exists.")):Wc(t,e,r,n))}function Wc(t,e,r,i){lI.rename(t,e,n=>n?n.code!=="EXDEV"?i(n):pI(t,e,r,i):i())}function pI(t,e,r,i){uI(t,e,{overwrite:r,errorOnExist:!0},s=>s?i(s):Wy(t,i))}Gy.exports=fI});var Ky=w((hj,Xy)=>{"use strict";var Yy=Xe(),Vc=require("path"),mI=Ca().copySync,Qy=ro().removeSync,gI=Qt().mkdirpSync,Vy=$i();function yI(t,e,r){r=r||{};let i=r.overwrite||r.clobber||!1,{srcStat:n,isChangingCase:s=!1}=Vy.checkPathsSync(t,e,"move",r);return Vy.checkParentPathsSync(t,n,e,"move"),wI(e)||gI(Vc.dirname(e)),AI(t,e,i,s)}function wI(t){let e=Vc.dirname(t);return Vc.parse(e).root===e}function AI(t,e,r,i){if(i)return zc(t,e,r);if(r)return Qy(e),zc(t,e,r);if(Yy.existsSync(e))throw new Error("dest already exists.");return zc(t,e,r)}function zc(t,e,r){try{Yy.renameSync(t,e)}catch(i){if(i.code!=="EXDEV")throw i;return EI(t,e,r)}}function EI(t,e,r){return mI(t,e,{overwrite:r,errorOnExist:!0}),Qy(t)}Xy.exports=yI});var Zy=w((fj,Jy)=>{"use strict";var SI=lt().fromCallback;Jy.exports={move:SI(zy()),moveSync:Ky()}});var wr=w((dj,ew)=>{"use strict";ew.exports={...Li(),...Ca(),...Qg(),...Oy(),...By(),...Qt(),...Zy(),...Fa(),...Xr(),...ro()}});var La=w(Ln=>{"use strict";Object.defineProperty(Ln,"__esModule",{value:!0});Ln.CancellationError=Ln.CancellationToken=void 0;var bI=require("events"),Yc=class extends bI.EventEmitter{get cancelled(){return this._cancelled||this._parent!=null&&this._parent.cancelled}set parent(e){this.removeParentCancelHandler(),this._parent=e,this.parentCancelHandler=()=>this.cancel(),this._parent.onCancel(this.parentCancelHandler)}constructor(e){super(),this.parentCancelHandler=null,this._parent=null,this._cancelled=!1,e!=null&&(this.parent=e)}cancel(){this._cancelled=!0,this.emit("cancel")}onCancel(e){this.cancelled?e():this.once("cancel",e)}createPromise(e){if(this.cancelled)return Promise.reject(new so);let r=()=>{if(i!=null)try{this.removeListener("cancel",i),i=null}catch{}},i=null;return new Promise((n,s)=>{let o=null;if(i=()=>{try{o!=null&&(o(),o=null)}finally{s(new so)}},this.cancelled){i();return}this.onCancel(i),e(n,s,a=>{o=a})}).then(n=>(r(),n)).catch(n=>{throw r(),n})}removeParentCancelHandler(){let e=this._parent;e!=null&&this.parentCancelHandler!=null&&(e.removeListener("cancel",this.parentCancelHandler),this.parentCancelHandler=null)}dispose(){try{this.removeParentCancelHandler()}finally{this.removeAllListeners(),this._parent=null}}};Ln.CancellationToken=Yc;var so=class extends Error{constructor(){super("cancelled")}};Ln.CancellationError=so});var oo=w(Qc=>{"use strict";Object.defineProperty(Qc,"__esModule",{value:!0});Qc.newError=_I;function _I(t,e){let r=new Error(t);return r.code=e,r}});var rw=w((gj,tw)=>{var $n=1e3,kn=$n*60,qn=kn*60,ki=qn*24,vI=ki*7,OI=ki*365.25;tw.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return TI(t);if(r==="number"&&isFinite(t))return e.long?RI(t):CI(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function TI(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return r*OI;case"weeks":case"week":case"w":return r*vI;case"days":case"day":case"d":return r*ki;case"hours":case"hour":case"hrs":case"hr":case"h":return r*qn;case"minutes":case"minute":case"mins":case"min":case"m":return r*kn;case"seconds":case"second":case"secs":case"sec":case"s":return r*$n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function CI(t){var e=Math.abs(t);return e>=ki?Math.round(t/ki)+"d":e>=qn?Math.round(t/qn)+"h":e>=kn?Math.round(t/kn)+"m":e>=$n?Math.round(t/$n)+"s":t+"ms"}function RI(t){var e=Math.abs(t);return e>=ki?$a(t,e,ki,"day"):e>=qn?$a(t,e,qn,"hour"):e>=kn?$a(t,e,kn,"minute"):e>=$n?$a(t,e,$n,"second"):t+" ms"}function $a(t,e,r,i){var n=e>=r*1.5;return Math.round(t/r)+" "+i+(n?"s":"")}});var Xc=w((yj,iw)=>{function II(t){r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=n,r.enabled=a,r.humanize=rw(),r.destroy=c,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let f=0;f<u.length;f++)h=(h<<5)-h+u.charCodeAt(f),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,f=null,d,y;function A(...E){if(!A.enabled)return;let v=A,O=Number(new Date),R=O-(h||O);v.diff=R,v.prev=h,v.curr=O,h=O,E[0]=r.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let L=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(G,z)=>{if(G==="%%")return"%";L++;let S=r.formatters[z];if(typeof S=="function"){let N=E[L];G=S.call(v,N),E.splice(L,1),L--}return G}),r.formatArgs.call(v,E),(v.log||r.log).apply(v,E)}return A.namespace=u,A.useColors=r.useColors(),A.color=r.selectColor(u),A.extend=i,A.destroy=r.destroy,Object.defineProperty(A,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(d!==r.namespaces&&(d=r.namespaces,y=r.enabled(u)),y),set:E=>{f=E}}),typeof r.init=="function"&&r.init(A),A}function i(u,h){let f=r(this.namespace+(typeof h>"u"?":":h)+u);return f.log=this.log,f}function n(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h=(typeof u=="string"?u:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let f of h)f[0]==="-"?r.skips.push(f.slice(1)):r.names.push(f)}function s(u,h){let f=0,d=0,y=-1,A=0;for(;f<u.length;)if(d<h.length&&(h[d]===u[f]||h[d]==="*"))h[d]==="*"?(y=d,A=f,d++):(f++,d++);else if(y!==-1)d=y+1,A++,f=A;else return!1;for(;d<h.length&&h[d]==="*";)d++;return d===h.length}function o(){let u=[...r.names,...r.skips.map(h=>"-"+h)].join(",");return r.enable(""),u}function a(u){for(let h of r.skips)if(s(u,h))return!1;for(let h of r.names)if(s(u,h))return!0;return!1}function l(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}iw.exports=II});var nw=w((ht,ka)=>{ht.formatArgs=xI;ht.save=DI;ht.load=PI;ht.useColors=NI;ht.storage=FI();ht.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ht.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function NI(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let t;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function xI(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+ka.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(r++,n==="%c"&&(i=r))}),t.splice(i,0,e)}ht.log=console.debug||console.log||(()=>{});function DI(t){try{t?ht.storage.setItem("debug",t):ht.storage.removeItem("debug")}catch{}}function PI(){let t;try{t=ht.storage.getItem("debug")||ht.storage.getItem("DEBUG")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function FI(){try{return localStorage}catch{}}ka.exports=Xc()(ht);var{formatters:LI}=ka.exports;LI.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var ow=w((wj,sw)=>{"use strict";sw.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",i=e.indexOf(r+t),n=e.indexOf("--");return i!==-1&&(n===-1||i<n)}});var uw=w((Aj,lw)=>{"use strict";var $I=require("os"),aw=require("tty"),xt=ow(),{env:Ie}=process,ei;xt("no-color")||xt("no-colors")||xt("color=false")||xt("color=never")?ei=0:(xt("color")||xt("colors")||xt("color=true")||xt("color=always"))&&(ei=1);"FORCE_COLOR"in Ie&&(Ie.FORCE_COLOR==="true"?ei=1:Ie.FORCE_COLOR==="false"?ei=0:ei=Ie.FORCE_COLOR.length===0?1:Math.min(parseInt(Ie.FORCE_COLOR,10),3));function Kc(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function Jc(t,e){if(ei===0)return 0;if(xt("color=16m")||xt("color=full")||xt("color=truecolor"))return 3;if(xt("color=256"))return 2;if(t&&!e&&ei===void 0)return 0;let r=ei||0;if(Ie.TERM==="dumb")return r;if(process.platform==="win32"){let i=$I.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in Ie)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(i=>i in Ie)||Ie.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in Ie)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Ie.TEAMCITY_VERSION)?1:0;if(Ie.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Ie){let i=parseInt((Ie.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Ie.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Ie.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Ie.TERM)||"COLORTERM"in Ie?1:r}function kI(t){let e=Jc(t,t&&t.isTTY);return Kc(e)}lw.exports={supportsColor:kI,stdout:Kc(Jc(!0,aw.isatty(1))),stderr:Kc(Jc(!0,aw.isatty(2)))}});var hw=w((Ne,Ma)=>{var qI=require("tty"),qa=require("util");Ne.init=GI;Ne.log=jI;Ne.formatArgs=UI;Ne.save=HI;Ne.load=WI;Ne.useColors=MI;Ne.destroy=qa.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");Ne.colors=[6,2,3,4,5,1];try{let t=uw();t&&(t.stderr||t).level>=2&&(Ne.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}Ne.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(n,s)=>s.toUpperCase()),i=process.env[e];return/^(yes|on|true|enabled)$/i.test(i)?i=!0:/^(no|off|false|disabled)$/i.test(i)?i=!1:i==="null"?i=null:i=Number(i),t[r]=i,t},{});function MI(){return"colors"in Ne.inspectOpts?!!Ne.inspectOpts.colors:qI.isatty(process.stderr.fd)}function UI(t){let{namespace:e,useColors:r}=this;if(r){let i=this.color,n="\x1B[3"+(i<8?i:"8;5;"+i),s="  ".concat(n,";1m").concat(e," \x1B[0m");t[0]=s+t[0].split("\n").join("\n"+s),t.push(n+"m+"+Ma.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=BI()+e+" "+t[0]}function BI(){return Ne.inspectOpts.hideDate?"":new Date().toISOString()+" "}function jI(...t){return process.stderr.write(qa.formatWithOptions(Ne.inspectOpts,...t)+"\n")}function HI(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function WI(){return process.env.DEBUG}function GI(t){t.inspectOpts={};let e=Object.keys(Ne.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=Ne.inspectOpts[e[r]]}Ma.exports=Xc()(Ne);var{formatters:cw}=Ma.exports;cw.o=function(t){return this.inspectOpts.colors=this.useColors,qa.inspect(t,this.inspectOpts).split("\n").map(e=>e.trim()).join(" ")};cw.O=function(t){return this.inspectOpts.colors=this.useColors,qa.inspect(t,this.inspectOpts)}});var fw=w((Ej,Zc)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Zc.exports=nw():Zc.exports=hw()});var th=w(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.ProgressCallbackTransform=void 0;var zI=require("stream"),eh=class extends zI.Transform{constructor(e,r,i){super(),this.total=e,this.cancellationToken=r,this.onProgress=i,this.start=Date.now(),this.transferred=0,this.delta=0,this.nextUpdate=this.start+1e3}_transform(e,r,i){if(this.cancellationToken.cancelled){i(new Error("cancelled"),null);return}this.transferred+=e.length,this.delta+=e.length;let n=Date.now();n>=this.nextUpdate&&this.transferred!==this.total&&(this.nextUpdate=n+1e3,this.onProgress({total:this.total,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.total*100,bytesPerSecond:Math.round(this.transferred/((n-this.start)/1e3))}),this.delta=0),i(null,e)}_flush(e){if(this.cancellationToken.cancelled){e(new Error("cancelled"));return}this.onProgress({total:this.total,delta:this.delta,transferred:this.total,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,e(null)}};Ua.ProgressCallbackTransform=eh});var gw=w(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.DigestTransform=Je.HttpExecutor=Je.HttpError=void 0;Je.createHttpError=rh;Je.parseJson=eN;Je.configureRequestOptionsFromUrl=mw;Je.configureRequestUrl=nh;Je.safeGetHeader=Mn;Je.configureRequestOptions=Ba;Je.safeStringifyJson=ja;var VI=require("crypto"),YI=fw(),QI=require("fs"),XI=require("stream"),pw=require("url"),KI=La(),dw=oo(),JI=th(),ao=(0,YI.default)("electron-builder");function rh(t,e=null){return new lo(t.statusCode||-1,"".concat(t.statusCode," ").concat(t.statusMessage)+(e==null?"":"\n"+JSON.stringify(e,null,"  "))+"\nHeaders: "+ja(t.headers),e)}var ZI=new Map([[429,"Too many requests"],[400,"Bad request"],[403,"Forbidden"],[404,"Not found"],[405,"Method not allowed"],[406,"Not acceptable"],[408,"Request timeout"],[413,"Request entity too large"],[500,"Internal server error"],[502,"Bad gateway"],[503,"Service unavailable"],[504,"Gateway timeout"],[505,"HTTP version not supported"]]),lo=class extends Error{constructor(e,r="HTTP error: ".concat(ZI.get(e)||e),i=null){super(r),this.statusCode=e,this.description=i,this.name="HttpError",this.code="HTTP_ERROR_".concat(e)}isServerError(){return this.statusCode>=500&&this.statusCode<=599}};Je.HttpError=lo;function eN(t){return t.then(e=>e==null||e.length===0?null:JSON.parse(e))}var ih=class t{constructor(){this.maxRedirects=10}request(e,r=new KI.CancellationToken,i){Ba(e);let n=i==null?void 0:JSON.stringify(i),s=n?Buffer.from(n):void 0;if(s!=null){ao(n);let{headers:o,...a}=e;e={method:"post",headers:{"Content-Type":"application/json","Content-Length":s.length,...o},...a}}return this.doApiRequest(e,r,o=>o.end(s))}doApiRequest(e,r,i,n=0){return ao.enabled&&ao("Request: ".concat(ja(e))),r.createPromise((s,o,a)=>{let l=this.createRequest(e,c=>{try{this.handleResponse(c,e,r,s,o,n,i)}catch(u){o(u)}});this.addErrorAndTimeoutHandlers(l,o,e.timeout),this.addRedirectHandlers(l,e,o,n,c=>{this.doApiRequest(c,r,i,n).then(s).catch(o)}),i(l,o),a(()=>l.abort())})}addRedirectHandlers(e,r,i,n,s){}addErrorAndTimeoutHandlers(e,r,i=60*1e3){this.addTimeOutHandler(e,r,i),e.on("error",r),e.on("aborted",()=>{r(new Error("Request has been aborted by the server"))})}handleResponse(e,r,i,n,s,o,a){var l;if(ao.enabled&&ao("Response: ".concat(e.statusCode," ").concat(e.statusMessage,", request options: ").concat(ja(r))),e.statusCode===404){s(rh(e,"method: ".concat(r.method||"GET"," url: ").concat(r.protocol||"https:","//").concat(r.hostname).concat(r.port?":".concat(r.port):"").concat(r.path,"\n\nPlease double check that your authentication token is correct. Due to security reasons, actual status maybe not reported, but 404.\n")));return}else if(e.statusCode===204){n();return}let c=(l=e.statusCode)!==null&&l!==void 0?l:0,u=c>=300&&c<400,h=Mn(e,"location");if(u&&h!=null){if(o>this.maxRedirects){s(this.createMaxRedirectError());return}this.doApiRequest(t.prepareRedirectUrlOptions(h,r),i,a,o).then(n).catch(s);return}e.setEncoding("utf8");let f="";e.on("error",s),e.on("data",d=>f+=d),e.on("end",()=>{try{if(e.statusCode!=null&&e.statusCode>=400){let d=Mn(e,"content-type"),y=d!=null&&(Array.isArray(d)?d.find(A=>A.includes("json"))!=null:d.includes("json"));s(rh(e,"method: ".concat(r.method||"GET"," url: ").concat(r.protocol||"https:","//").concat(r.hostname).concat(r.port?":".concat(r.port):"").concat(r.path,"\n\n          Data:\n          ").concat(y?JSON.stringify(JSON.parse(f)):f,"\n          ")))}else n(f.length===0?null:f)}catch(d){s(d)}})}async downloadToBuffer(e,r){return await r.cancellationToken.createPromise((i,n,s)=>{let o=[],a={headers:r.headers||void 0,redirect:"manual"};nh(e,a),Ba(a),this.doDownload(a,{destination:null,options:r,onCancel:s,callback:l=>{l==null?i(Buffer.concat(o)):n(l)},responseHandler:(l,c)=>{let u=0;l.on("data",h=>{if(u+=h.length,u>524288e3){c(new Error("Maximum allowed size is 500 MB"));return}o.push(h)}),l.on("end",()=>{c(null)})}},0)})}doDownload(e,r,i){let n=this.createRequest(e,s=>{if(s.statusCode>=400){r.callback(new Error('Cannot download "'.concat(e.protocol||"https:","//").concat(e.hostname).concat(e.path,'", status ').concat(s.statusCode,": ").concat(s.statusMessage)));return}s.on("error",r.callback);let o=Mn(s,"location");if(o!=null){i<this.maxRedirects?this.doDownload(t.prepareRedirectUrlOptions(o,e),r,i++):r.callback(this.createMaxRedirectError());return}r.responseHandler==null?rN(r,s):r.responseHandler(s,r.callback)});this.addErrorAndTimeoutHandlers(n,r.callback,e.timeout),this.addRedirectHandlers(n,e,r.callback,i,s=>{this.doDownload(s,r,i++)}),n.end()}createMaxRedirectError(){return new Error("Too many redirects (> ".concat(this.maxRedirects,")"))}addTimeOutHandler(e,r,i){e.on("socket",n=>{n.setTimeout(i,()=>{e.abort(),r(new Error("Request timed out"))})})}static prepareRedirectUrlOptions(e,r){let i=mw(e,{...r}),n=i.headers;if(n?.authorization){let s=new pw.URL(e);(s.hostname.endsWith(".amazonaws.com")||s.searchParams.has("X-Amz-Credential"))&&delete n.authorization}return i}static retryOnServerError(e,r=3){for(let i=0;;i++)try{return e()}catch(n){if(i<r&&(n instanceof lo&&n.isServerError()||n.code==="EPIPE"))continue;throw n}}};Je.HttpExecutor=ih;function mw(t,e){let r=Ba(e);return nh(new pw.URL(t),r),r}function nh(t,e){e.protocol=t.protocol,e.hostname=t.hostname,t.port?e.port=t.port:e.port&&delete e.port,e.path=t.pathname+t.search}var uo=class extends XI.Transform{get actual(){return this._actual}constructor(e,r="sha512",i="base64"){super(),this.expected=e,this.algorithm=r,this.encoding=i,this._actual=null,this.isValidateOnEnd=!0,this.digester=(0,VI.createHash)(r)}_transform(e,r,i){this.digester.update(e),i(null,e)}_flush(e){if(this._actual=this.digester.digest(this.encoding),this.isValidateOnEnd)try{this.validate()}catch(r){e(r);return}e(null)}validate(){if(this._actual==null)throw(0,dw.newError)("Not finished yet","ERR_STREAM_NOT_FINISHED");if(this._actual!==this.expected)throw(0,dw.newError)("".concat(this.algorithm," checksum mismatch, expected ").concat(this.expected,", got ").concat(this._actual),"ERR_CHECKSUM_MISMATCH");return null}};Je.DigestTransform=uo;function tN(t,e,r){return t!=null&&e!=null&&t!==e?(r(new Error("checksum mismatch: expected ".concat(e," but got ").concat(t," (X-Checksum-Sha2 header)"))),!1):!0}function Mn(t,e){let r=t.headers[e];return r==null?null:Array.isArray(r)?r.length===0?null:r[r.length-1]:r}function rN(t,e){if(!tN(Mn(e,"X-Checksum-Sha2"),t.options.sha2,t.callback))return;let r=[];if(t.options.onProgress!=null){let o=Mn(e,"content-length");o!=null&&r.push(new JI.ProgressCallbackTransform(parseInt(o,10),t.options.cancellationToken,t.options.onProgress))}let i=t.options.sha512;i!=null?r.push(new uo(i,"sha512",i.length===128&&!i.includes("+")&&!i.includes("Z")&&!i.includes("=")?"hex":"base64")):t.options.sha2!=null&&r.push(new uo(t.options.sha2,"sha256","hex"));let n=(0,QI.createWriteStream)(t.destination);r.push(n);let s=e;for(let o of r)o.on("error",a=>{n.close(),t.options.cancellationToken.cancelled||t.callback(a)}),s=s.pipe(o);n.on("finish",()=>{n.close(t.callback)})}function Ba(t,e,r){r!=null&&(t.method=r),t.headers={...t.headers};let i=t.headers;return e!=null&&(i.authorization=e.startsWith("Basic")||e.startsWith("Bearer")?e:"token ".concat(e)),i["User-Agent"]==null&&(i["User-Agent"]="electron-builder"),(r==null||r==="GET"||i["Cache-Control"]==null)&&(i["Cache-Control"]="no-cache"),t.protocol==null&&process.versions.electron!=null&&(t.protocol="https:"),t}function ja(t,e){return JSON.stringify(t,(r,i)=>r.endsWith("Authorization")||r.endsWith("authorization")||r.endsWith("Password")||r.endsWith("PASSWORD")||r.endsWith("Token")||r.includes("password")||r.includes("token")||e!=null&&e.has(r)?"<stripped sensitive data>":i,2)}});var ww=w(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});Ha.MemoLazy=void 0;var sh=class{constructor(e,r){this.selector=e,this.creator=r,this.selected=void 0,this._value=void 0}get hasValue(){return this._value!==void 0}get value(){let e=this.selector();if(this._value!==void 0&&yw(this.selected,e))return this._value;this.selected=e;let r=this.creator(e);return this.value=r,r}set value(e){this._value=e}};Ha.MemoLazy=sh;function yw(t,e){if(typeof t=="object"&&t!==null&&(typeof e=="object"&&e!==null)){let n=Object.keys(t),s=Object.keys(e);return n.length===s.length&&n.every(o=>yw(t[o],e[o]))}return t===e}});var Ew=w(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.githubUrl=iN;Wa.getS3LikeProviderBaseUrl=nN;function iN(t,e="github.com"){return"".concat(t.protocol||"https","://").concat(t.host||e)}function nN(t){let e=t.provider;if(e==="s3")return sN(t);if(e==="spaces")return oN(t);throw new Error("Not supported provider: ".concat(e))}function sN(t){let e;if(t.accelerate==!0)e="https://".concat(t.bucket,".s3-accelerate.amazonaws.com");else if(t.endpoint!=null)e="".concat(t.endpoint,"/").concat(t.bucket);else if(t.bucket.includes(".")){if(t.region==null)throw new Error('Bucket name "'.concat(t.bucket,'" includes a dot, but S3 region is missing'));t.region==="us-east-1"?e="https://s3.amazonaws.com/".concat(t.bucket):e="https://s3-".concat(t.region,".amazonaws.com/").concat(t.bucket)}else t.region==="cn-north-1"?e="https://".concat(t.bucket,".s3.").concat(t.region,".amazonaws.com.cn"):e="https://".concat(t.bucket,".s3.amazonaws.com");return Aw(e,t.path)}function Aw(t,e){return e!=null&&e.length>0&&(e.startsWith("/")||(t+="/"),t+=e),t}function oN(t){if(t.name==null)throw new Error("name is missing");if(t.region==null)throw new Error("region is missing");return Aw("https://".concat(t.name,".").concat(t.region,".digitaloceanspaces.com"),t.path)}});var bw=w(oh=>{"use strict";Object.defineProperty(oh,"__esModule",{value:!0});oh.retry=Sw;var aN=La();async function Sw(t,e,r,i=0,n=0,s){var o;let a=new aN.CancellationToken;try{return await t()}catch(l){if((!((o=s?.(l))!==null&&o!==void 0)||o)&&e>0&&!a.cancelled)return await new Promise(c=>setTimeout(c,r+i*n)),await Sw(t,e-1,r,i,n+1,s);throw l}}});var _w=w(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.parseDn=lN;function lN(t){let e=!1,r=null,i="",n=0;t=t.trim();let s=new Map;for(let o=0;o<=t.length;o++){if(o===t.length){r!==null&&s.set(r,i);break}let a=t[o];if(e){if(a==='"'){e=!1;continue}}else{if(a==='"'){e=!0;continue}if(a==="\\"){o++;let l=parseInt(t.slice(o,o+2),16);Number.isNaN(l)?i+=t[o]:(o++,i+=String.fromCharCode(l));continue}if(r===null&&a==="="){r=i,i="";continue}if(a===","||a===";"||a==="+"){r!==null&&s.set(r,i),r=null,i="";continue}}if(a===" "&&!e){if(i.length===0)continue;if(o>n){let l=o;for(;t[l]===" ";)l++;n=l}if(n>=t.length||t[n]===","||t[n]===";"||r===null&&t[n]==="="||r!==null&&t[n]==="+"){o=n-1;continue}}i+=a}return s}});var Rw=w(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.nil=Un.UUID=void 0;var Tw=require("crypto"),Cw=oo(),uN="options.name must be either a string or a Buffer",vw=(0,Tw.randomBytes)(16);vw[0]=vw[0]|1;var Ga={},Y=[];for(let t=0;t<256;t++){let e=(t+256).toString(16).substr(1);Ga[e]=t,Y[t]=e}var qi=class t{constructor(e){this.ascii=null,this.binary=null;let r=t.check(e);if(!r)throw new Error("not a UUID");this.version=r.version,r.format==="ascii"?this.ascii=e:this.binary=e}static v5(e,r){return cN(e,"sha1",80,r)}toString(){return this.ascii==null&&(this.ascii=hN(this.binary)),this.ascii}inspect(){return"UUID v".concat(this.version," ").concat(this.toString())}static check(e,r=0){if(typeof e=="string")return e=e.toLowerCase(),/^[a-f0-9]{8}(-[a-f0-9]{4}){3}-([a-f0-9]{12})$/.test(e)?e==="00000000-0000-0000-0000-000000000000"?{version:void 0,variant:"nil",format:"ascii"}:{version:(Ga[e[14]+e[15]]&240)>>4,variant:Ow((Ga[e[19]+e[20]]&224)>>5),format:"ascii"}:!1;if(Buffer.isBuffer(e)){if(e.length<r+16)return!1;let i=0;for(;i<16&&e[r+i]===0;i++);return i===16?{version:void 0,variant:"nil",format:"binary"}:{version:(e[r+6]&240)>>4,variant:Ow((e[r+8]&224)>>5),format:"binary"}}throw(0,Cw.newError)("Unknown type of uuid","ERR_UNKNOWN_UUID_TYPE")}static parse(e){let r=Buffer.allocUnsafe(16),i=0;for(let n=0;n<16;n++)r[n]=Ga[e[i++]+e[i++]],(n===3||n===5||n===7||n===9)&&(i+=1);return r}};Un.UUID=qi;qi.OID=qi.parse("6ba7b812-9dad-11d1-80b4-00c04fd430c8");function Ow(t){switch(t){case 0:case 1:case 3:return"ncs";case 4:case 5:return"rfc4122";case 6:return"microsoft";default:return"future"}}var co;(function(t){t[t.ASCII=0]="ASCII",t[t.BINARY=1]="BINARY",t[t.OBJECT=2]="OBJECT"})(co||(co={}));function cN(t,e,r,i,n=co.ASCII){let s=(0,Tw.createHash)(e);if(typeof t!="string"&&!Buffer.isBuffer(t))throw(0,Cw.newError)(uN,"ERR_INVALID_UUID_NAME");s.update(i),s.update(t);let a=s.digest(),l;switch(n){case co.BINARY:a[6]=a[6]&15|r,a[8]=a[8]&63|128,l=a;break;case co.OBJECT:a[6]=a[6]&15|r,a[8]=a[8]&63|128,l=new qi(a);break;default:l=Y[a[0]]+Y[a[1]]+Y[a[2]]+Y[a[3]]+"-"+Y[a[4]]+Y[a[5]]+"-"+Y[a[6]&15|r]+Y[a[7]]+"-"+Y[a[8]&63|128]+Y[a[9]]+"-"+Y[a[10]]+Y[a[11]]+Y[a[12]]+Y[a[13]]+Y[a[14]]+Y[a[15]];break}return l}function hN(t){return Y[t[0]]+Y[t[1]]+Y[t[2]]+Y[t[3]]+"-"+Y[t[4]]+Y[t[5]]+"-"+Y[t[6]]+Y[t[7]]+"-"+Y[t[8]]+Y[t[9]]+"-"+Y[t[10]]+Y[t[11]]+Y[t[12]]+Y[t[13]]+Y[t[14]]+Y[t[15]]}Un.nil=new qi("00000000-0000-0000-0000-000000000000")});var Iw=w(za=>{(function(t){t.parser=function(g,m){return new r(g,m)},t.SAXParser=r,t.SAXStream=c,t.createStream=l,t.MAX_BUFFER_LENGTH=64*1024;var e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function r(g,m){if(!(this instanceof r))return new r(g,m);var C=this;n(C),C.q=C.c="",C.bufferCheckPosition=t.MAX_BUFFER_LENGTH,C.opt=m||{},C.opt.lowercase=C.opt.lowercase||C.opt.lowercasetags,C.looseCase=C.opt.lowercase?"toLowerCase":"toUpperCase",C.tags=[],C.closed=C.closedRoot=C.sawRoot=!1,C.tag=C.error=null,C.strict=!!g,C.noscript=!!(g||C.opt.noscript),C.state=S.BEGIN,C.strictEntities=C.opt.strictEntities,C.ENTITIES=C.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),C.attribList=[],C.opt.xmlns&&(C.ns=Object.create(y)),C.opt.unquotedAttributeValues===void 0&&(C.opt.unquotedAttributeValues=!g),C.trackPosition=C.opt.position!==!1,C.trackPosition&&(C.position=C.line=C.column=0),H(C,"onready")}Object.create||(Object.create=function(g){function m(){}m.prototype=g;var C=new m;return C}),Object.keys||(Object.keys=function(g){var m=[];for(var C in g)g.hasOwnProperty(C)&&m.push(C);return m});function i(g){for(var m=Math.max(t.MAX_BUFFER_LENGTH,10),C=0,b=0,Z=e.length;b<Z;b++){var ve=g[e[b]].length;if(ve>m)switch(e[b]){case"textNode":Q(g);break;case"cdata":P(g,"oncdata",g.cdata),g.cdata="";break;case"script":P(g,"onscript",g.script),g.script="";break;default:J(g,"Max buffer length exceeded: "+e[b])}C=Math.max(C,ve)}var Oe=t.MAX_BUFFER_LENGTH-C;g.bufferCheckPosition=Oe+g.position}function n(g){for(var m=0,C=e.length;m<C;m++)g[e[m]]=""}function s(g){Q(g),g.cdata!==""&&(P(g,"oncdata",g.cdata),g.cdata=""),g.script!==""&&(P(g,"onscript",g.script),g.script="")}r.prototype={end:function(){V(this)},write:jT,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){s(this)}};var o;try{o=require("stream").Stream}catch{o=function(){}}o||(o=function(){});var a=t.EVENTS.filter(function(g){return g!=="error"&&g!=="end"});function l(g,m){return new c(g,m)}function c(g,m){if(!(this instanceof c))return new c(g,m);o.apply(this),this._parser=new r(g,m),this.writable=!0,this.readable=!0;var C=this;this._parser.onend=function(){C.emit("end")},this._parser.onerror=function(b){C.emit("error",b),C._parser.error=null},this._decoder=null,a.forEach(function(b){Object.defineProperty(C,"on"+b,{get:function(){return C._parser["on"+b]},set:function(Z){if(!Z)return C.removeAllListeners(b),C._parser["on"+b]=Z,Z;C.on(b,Z)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(o.prototype,{constructor:{value:c}}),c.prototype.write=function(g){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(g)){if(!this._decoder){var m=require("string_decoder").StringDecoder;this._decoder=new m("utf8")}g=this._decoder.write(g)}return this._parser.write(g.toString()),this.emit("data",g),!0},c.prototype.end=function(g){return g&&g.length&&this.write(g),this._parser.end(),!0},c.prototype.on=function(g,m){var C=this;return!C._parser["on"+g]&&a.indexOf(g)!==-1&&(C._parser["on"+g]=function(){var b=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);b.splice(0,0,g),C.emit.apply(C,b)}),o.prototype.on.call(C,g,m)};var u="[CDATA[",h="DOCTYPE",f="http://www.w3.org/XML/1998/namespace",d="http://www.w3.org/2000/xmlns/",y={xml:f,xmlns:d},A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,O=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function R(g){return g===" "||g==="\n"||g==="\r"||g==="	"}function L(g){return g==='"'||g==="'"}function oe(g){return g===">"||R(g)}function G(g,m){return g.test(m)}function z(g,m){return!G(g,m)}var S=0;t.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(g){var m=t.ENTITIES[g],C=typeof m=="number"?String.fromCharCode(m):m;t.ENTITIES[g]=C});for(var N in t.STATE)t.STATE[t.STATE[N]]=N;S=t.STATE;function H(g,m,C){g[m]&&g[m](C)}function P(g,m,C){g.textNode&&Q(g),H(g,m,C)}function Q(g){g.textNode=pe(g.opt,g.textNode),g.textNode&&H(g,"ontext",g.textNode),g.textNode=""}function pe(g,m){return g.trim&&(m=m.trim()),g.normalize&&(m=m.replace(/\s+/g," ")),m}function J(g,m){return Q(g),g.trackPosition&&(m+="\nLine: "+g.line+"\nColumn: "+g.column+"\nChar: "+g.c),m=new Error(m),g.error=m,H(g,"onerror",m),g}function V(g){return g.sawRoot&&!g.closedRoot&&M(g,"Unclosed root tag"),g.state!==S.BEGIN&&g.state!==S.BEGIN_WHITESPACE&&g.state!==S.TEXT&&J(g,"Unexpected end"),Q(g),g.c="",g.closed=!0,H(g,"onend"),r.call(g,g.strict,g.opt),g}function M(g,m){if(typeof g!="object"||!(g instanceof r))throw new Error("bad call to strictFail");g.strict&&J(g,m)}function re(g){g.strict||(g.tagName=g.tagName[g.looseCase]());var m=g.tags[g.tags.length-1]||g,C=g.tag={name:g.tagName,attributes:{}};g.opt.xmlns&&(C.ns=m.ns),g.attribList.length=0,P(g,"onopentagstart",C)}function we(g,m){var C=g.indexOf(":"),b=C<0?["",g]:g.split(":"),Z=b[0],ve=b[1];return m&&g==="xmlns"&&(Z="xmlns",ve=""),{prefix:Z,local:ve}}function ie(g){if(g.strict||(g.attribName=g.attribName[g.looseCase]()),g.attribList.indexOf(g.attribName)!==-1||g.tag.attributes.hasOwnProperty(g.attribName)){g.attribName=g.attribValue="";return}if(g.opt.xmlns){var m=we(g.attribName,!0),C=m.prefix,b=m.local;if(C==="xmlns")if(b==="xml"&&g.attribValue!==f)M(g,"xml: prefix must be bound to "+f+"\nActual: "+g.attribValue);else if(b==="xmlns"&&g.attribValue!==d)M(g,"xmlns: prefix must be bound to "+d+"\nActual: "+g.attribValue);else{var Z=g.tag,ve=g.tags[g.tags.length-1]||g;Z.ns===ve.ns&&(Z.ns=Object.create(ve.ns)),Z.ns[b]=g.attribValue}g.attribList.push([g.attribName,g.attribValue])}else g.tag.attributes[g.attribName]=g.attribValue,P(g,"onattribute",{name:g.attribName,value:g.attribValue});g.attribName=g.attribValue=""}function zr(g,m){if(g.opt.xmlns){var C=g.tag,b=we(g.tagName);C.prefix=b.prefix,C.local=b.local,C.uri=C.ns[b.prefix]||"",C.prefix&&!C.uri&&(M(g,"Unbound namespace prefix: "+JSON.stringify(g.tagName)),C.uri=b.prefix);var Z=g.tags[g.tags.length-1]||g;C.ns&&Z.ns!==C.ns&&Object.keys(C.ns).forEach(function(Em){P(g,"onopennamespace",{prefix:Em,uri:C.ns[Em]})});for(var ve=0,Oe=g.attribList.length;ve<Oe;ve++){var st=g.attribList[ve],ot=st[0],bn=st[1],$e=we(ot,!0),mr=$e.prefix,HT=$e.local,Am=mr===""?"":C.ns[mr]||"",Ec={name:ot,value:bn,prefix:mr,local:HT,uri:Am};mr&&mr!=="xmlns"&&!Am&&(M(g,"Unbound namespace prefix: "+JSON.stringify(mr)),Ec.uri=mr),g.tag.attributes[ot]=Ec,P(g,"onattribute",Ec)}g.attribList.length=0}g.tag.isSelfClosing=!!m,g.sawRoot=!0,g.tags.push(g.tag),P(g,"onopentag",g.tag),m||(!g.noscript&&g.tagName.toLowerCase()==="script"?g.state=S.SCRIPT:g.state=S.TEXT,g.tag=null,g.tagName=""),g.attribName=g.attribValue="",g.attribList.length=0}function Ac(g){if(!g.tagName){M(g,"Weird empty close tag."),g.textNode+="</>",g.state=S.TEXT;return}if(g.script){if(g.tagName!=="script"){g.script+="</"+g.tagName+">",g.tagName="",g.state=S.SCRIPT;return}P(g,"onscript",g.script),g.script=""}var m=g.tags.length,C=g.tagName;g.strict||(C=C[g.looseCase]());for(var b=C;m--;){var Z=g.tags[m];if(Z.name!==b)M(g,"Unexpected close tag");else break}if(m<0){M(g,"Unmatched closing tag: "+g.tagName),g.textNode+="</"+g.tagName+">",g.state=S.TEXT;return}g.tagName=C;for(var ve=g.tags.length;ve-- >m;){var Oe=g.tag=g.tags.pop();g.tagName=g.tag.name,P(g,"onclosetag",g.tagName);var st={};for(var ot in Oe.ns)st[ot]=Oe.ns[ot];var bn=g.tags[g.tags.length-1]||g;g.opt.xmlns&&Oe.ns!==bn.ns&&Object.keys(Oe.ns).forEach(function($e){var mr=Oe.ns[$e];P(g,"onclosenamespace",{prefix:$e,uri:mr})})}m===0&&(g.closedRoot=!0),g.tagName=g.attribValue=g.attribName="",g.attribList.length=0,g.state=S.TEXT}function BT(g){var m=g.entity,C=m.toLowerCase(),b,Z="";return g.ENTITIES[m]?g.ENTITIES[m]:g.ENTITIES[C]?g.ENTITIES[C]:(m=C,m.charAt(0)==="#"&&(m.charAt(1)==="x"?(m=m.slice(2),b=parseInt(m,16),Z=b.toString(16)):(m=m.slice(1),b=parseInt(m,10),Z=b.toString(10))),m=m.replace(/^0+/,""),isNaN(b)||Z.toLowerCase()!==m?(M(g,"Invalid character entity"),"&"+g.entity+";"):String.fromCodePoint(b))}function ym(g,m){m==="<"?(g.state=S.OPEN_WAKA,g.startTagPosition=g.position):R(m)||(M(g,"Non-whitespace before first tag."),g.textNode=m,g.state=S.TEXT)}function wm(g,m){var C="";return m<g.length&&(C=g.charAt(m)),C}function jT(g){var m=this;if(this.error)throw this.error;if(m.closed)return J(m,"Cannot write after close. Assign an onready handler.");if(g===null)return V(m);typeof g=="object"&&(g=g.toString());for(var C=0,b="";b=wm(g,C++),m.c=b,!!b;)switch(m.trackPosition&&(m.position++,b==="\n"?(m.line++,m.column=0):m.column++),m.state){case S.BEGIN:if(m.state=S.BEGIN_WHITESPACE,b==="\uFEFF")continue;ym(m,b);continue;case S.BEGIN_WHITESPACE:ym(m,b);continue;case S.TEXT:if(m.sawRoot&&!m.closedRoot){for(var Z=C-1;b&&b!=="<"&&b!=="&";)b=wm(g,C++),b&&m.trackPosition&&(m.position++,b==="\n"?(m.line++,m.column=0):m.column++);m.textNode+=g.substring(Z,C-1)}b==="<"&&!(m.sawRoot&&m.closedRoot&&!m.strict)?(m.state=S.OPEN_WAKA,m.startTagPosition=m.position):(!R(b)&&(!m.sawRoot||m.closedRoot)&&M(m,"Text data outside of root node."),b==="&"?m.state=S.TEXT_ENTITY:m.textNode+=b);continue;case S.SCRIPT:b==="<"?m.state=S.SCRIPT_ENDING:m.script+=b;continue;case S.SCRIPT_ENDING:b==="/"?m.state=S.CLOSE_TAG:(m.script+="<"+b,m.state=S.SCRIPT);continue;case S.OPEN_WAKA:if(b==="!")m.state=S.SGML_DECL,m.sgmlDecl="";else if(!R(b))if(G(A,b))m.state=S.OPEN_TAG,m.tagName=b;else if(b==="/")m.state=S.CLOSE_TAG,m.tagName="";else if(b==="?")m.state=S.PROC_INST,m.procInstName=m.procInstBody="";else{if(M(m,"Unencoded <"),m.startTagPosition+1<m.position){var ve=m.position-m.startTagPosition;b=new Array(ve).join(" ")+b}m.textNode+="<"+b,m.state=S.TEXT}continue;case S.SGML_DECL:if(m.sgmlDecl+b==="--"){m.state=S.COMMENT,m.comment="",m.sgmlDecl="";continue}m.doctype&&m.doctype!==!0&&m.sgmlDecl?(m.state=S.DOCTYPE_DTD,m.doctype+="<!"+m.sgmlDecl+b,m.sgmlDecl=""):(m.sgmlDecl+b).toUpperCase()===u?(P(m,"onopencdata"),m.state=S.CDATA,m.sgmlDecl="",m.cdata=""):(m.sgmlDecl+b).toUpperCase()===h?(m.state=S.DOCTYPE,(m.doctype||m.sawRoot)&&M(m,"Inappropriately located doctype declaration"),m.doctype="",m.sgmlDecl=""):b===">"?(P(m,"onsgmldeclaration",m.sgmlDecl),m.sgmlDecl="",m.state=S.TEXT):(L(b)&&(m.state=S.SGML_DECL_QUOTED),m.sgmlDecl+=b);continue;case S.SGML_DECL_QUOTED:b===m.q&&(m.state=S.SGML_DECL,m.q=""),m.sgmlDecl+=b;continue;case S.DOCTYPE:b===">"?(m.state=S.TEXT,P(m,"ondoctype",m.doctype),m.doctype=!0):(m.doctype+=b,b==="["?m.state=S.DOCTYPE_DTD:L(b)&&(m.state=S.DOCTYPE_QUOTED,m.q=b));continue;case S.DOCTYPE_QUOTED:m.doctype+=b,b===m.q&&(m.q="",m.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:b==="]"?(m.doctype+=b,m.state=S.DOCTYPE):b==="<"?(m.state=S.OPEN_WAKA,m.startTagPosition=m.position):L(b)?(m.doctype+=b,m.state=S.DOCTYPE_DTD_QUOTED,m.q=b):m.doctype+=b;continue;case S.DOCTYPE_DTD_QUOTED:m.doctype+=b,b===m.q&&(m.state=S.DOCTYPE_DTD,m.q="");continue;case S.COMMENT:b==="-"?m.state=S.COMMENT_ENDING:m.comment+=b;continue;case S.COMMENT_ENDING:b==="-"?(m.state=S.COMMENT_ENDED,m.comment=pe(m.opt,m.comment),m.comment&&P(m,"oncomment",m.comment),m.comment=""):(m.comment+="-"+b,m.state=S.COMMENT);continue;case S.COMMENT_ENDED:b!==">"?(M(m,"Malformed comment"),m.comment+="--"+b,m.state=S.COMMENT):m.doctype&&m.doctype!==!0?m.state=S.DOCTYPE_DTD:m.state=S.TEXT;continue;case S.CDATA:b==="]"?m.state=S.CDATA_ENDING:m.cdata+=b;continue;case S.CDATA_ENDING:b==="]"?m.state=S.CDATA_ENDING_2:(m.cdata+="]"+b,m.state=S.CDATA);continue;case S.CDATA_ENDING_2:b===">"?(m.cdata&&P(m,"oncdata",m.cdata),P(m,"onclosecdata"),m.cdata="",m.state=S.TEXT):b==="]"?m.cdata+="]":(m.cdata+="]]"+b,m.state=S.CDATA);continue;case S.PROC_INST:b==="?"?m.state=S.PROC_INST_ENDING:R(b)?m.state=S.PROC_INST_BODY:m.procInstName+=b;continue;case S.PROC_INST_BODY:if(!m.procInstBody&&R(b))continue;b==="?"?m.state=S.PROC_INST_ENDING:m.procInstBody+=b;continue;case S.PROC_INST_ENDING:b===">"?(P(m,"onprocessinginstruction",{name:m.procInstName,body:m.procInstBody}),m.procInstName=m.procInstBody="",m.state=S.TEXT):(m.procInstBody+="?"+b,m.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:G(E,b)?m.tagName+=b:(re(m),b===">"?zr(m):b==="/"?m.state=S.OPEN_TAG_SLASH:(R(b)||M(m,"Invalid character in tag name"),m.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:b===">"?(zr(m,!0),Ac(m)):(M(m,"Forward-slash in opening tag not followed by >"),m.state=S.ATTRIB);continue;case S.ATTRIB:if(R(b))continue;b===">"?zr(m):b==="/"?m.state=S.OPEN_TAG_SLASH:G(A,b)?(m.attribName=b,m.attribValue="",m.state=S.ATTRIB_NAME):M(m,"Invalid attribute name");continue;case S.ATTRIB_NAME:b==="="?m.state=S.ATTRIB_VALUE:b===">"?(M(m,"Attribute without value"),m.attribValue=m.attribName,ie(m),zr(m)):R(b)?m.state=S.ATTRIB_NAME_SAW_WHITE:G(E,b)?m.attribName+=b:M(m,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if(b==="=")m.state=S.ATTRIB_VALUE;else{if(R(b))continue;M(m,"Attribute without value"),m.tag.attributes[m.attribName]="",m.attribValue="",P(m,"onattribute",{name:m.attribName,value:""}),m.attribName="",b===">"?zr(m):G(A,b)?(m.attribName=b,m.state=S.ATTRIB_NAME):(M(m,"Invalid attribute name"),m.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(R(b))continue;L(b)?(m.q=b,m.state=S.ATTRIB_VALUE_QUOTED):(m.opt.unquotedAttributeValues||J(m,"Unquoted attribute value"),m.state=S.ATTRIB_VALUE_UNQUOTED,m.attribValue=b);continue;case S.ATTRIB_VALUE_QUOTED:if(b!==m.q){b==="&"?m.state=S.ATTRIB_VALUE_ENTITY_Q:m.attribValue+=b;continue}ie(m),m.q="",m.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:R(b)?m.state=S.ATTRIB:b===">"?zr(m):b==="/"?m.state=S.OPEN_TAG_SLASH:G(A,b)?(M(m,"No whitespace between attributes"),m.attribName=b,m.attribValue="",m.state=S.ATTRIB_NAME):M(m,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(!oe(b)){b==="&"?m.state=S.ATTRIB_VALUE_ENTITY_U:m.attribValue+=b;continue}ie(m),b===">"?zr(m):m.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(m.tagName)b===">"?Ac(m):G(E,b)?m.tagName+=b:m.script?(m.script+="</"+m.tagName,m.tagName="",m.state=S.SCRIPT):(R(b)||M(m,"Invalid tagname in closing tag"),m.state=S.CLOSE_TAG_SAW_WHITE);else{if(R(b))continue;z(A,b)?m.script?(m.script+="</"+b,m.state=S.SCRIPT):M(m,"Invalid tagname in closing tag."):m.tagName=b}continue;case S.CLOSE_TAG_SAW_WHITE:if(R(b))continue;b===">"?Ac(m):M(m,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var Oe,st;switch(m.state){case S.TEXT_ENTITY:Oe=S.TEXT,st="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:Oe=S.ATTRIB_VALUE_QUOTED,st="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:Oe=S.ATTRIB_VALUE_UNQUOTED,st="attribValue";break}if(b===";"){var ot=BT(m);m.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(ot)?(m.entity="",m.state=Oe,m.write(ot)):(m[st]+=ot,m.entity="",m.state=Oe)}else G(m.entity.length?O:v,b)?m.entity+=b:(M(m,"Invalid character in entity name"),m[st]+="&"+m.entity+b,m.entity="",m.state=Oe);continue;default:throw new Error(m,"Unknown state: "+m.state)}return m.position>=m.bufferCheckPosition&&i(m),m}String.fromCodePoint||(function(){var g=String.fromCharCode,m=Math.floor,C=function(){var b=16384,Z=[],ve,Oe,st=-1,ot=arguments.length;if(!ot)return"";for(var bn="";++st<ot;){var $e=Number(arguments[st]);if(!isFinite($e)||$e<0||$e>1114111||m($e)!==$e)throw RangeError("Invalid code point: "+$e);$e<=65535?Z.push($e):($e-=65536,ve=($e>>10)+55296,Oe=$e%1024+56320,Z.push(ve,Oe)),(st+1===ot||Z.length>b)&&(bn+=g.apply(null,Z),Z.length=0)}return bn};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:C,configurable:!0,writable:!0}):String.fromCodePoint=C})()})(typeof za>"u"?za.sax={}:za)});var xw=w(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.XElement=void 0;ho.parseXml=mN;var fN=Iw(),Va=oo(),Ya=class{constructor(e){if(this.name=e,this.value="",this.attributes=null,this.isCData=!1,this.elements=null,!e)throw(0,Va.newError)("Element name cannot be empty","ERR_XML_ELEMENT_NAME_EMPTY");if(!pN(e))throw(0,Va.newError)("Invalid element name: ".concat(e),"ERR_XML_ELEMENT_INVALID_NAME")}attribute(e){let r=this.attributes===null?null:this.attributes[e];if(r==null)throw(0,Va.newError)('No attribute "'.concat(e,'"'),"ERR_XML_MISSED_ATTRIBUTE");return r}removeAttribute(e){this.attributes!==null&&delete this.attributes[e]}element(e,r=!1,i=null){let n=this.elementOrNull(e,r);if(n===null)throw(0,Va.newError)(i||'No element "'.concat(e,'"'),"ERR_XML_MISSED_ELEMENT");return n}elementOrNull(e,r=!1){if(this.elements===null)return null;for(let i of this.elements)if(Nw(i,e,r))return i;return null}getElements(e,r=!1){return this.elements===null?[]:this.elements.filter(i=>Nw(i,e,r))}elementValueOrEmpty(e,r=!1){let i=this.elementOrNull(e,r);return i===null?"":i.value}};ho.XElement=Ya;var dN=new RegExp(/^[A-Za-z_][:A-Za-z0-9_-]*$/i);function pN(t){return dN.test(t)}function Nw(t,e,r){let i=t.name;return i===e||r===!0&&i.length===e.length&&i.toLowerCase()===e.toLowerCase()}function mN(t){let e=null,r=fN.parser(!0,{}),i=[];return r.onopentag=n=>{let s=new Ya(n.name);if(s.attributes=n.attributes,e===null)e=s;else{let o=i[i.length-1];o.elements==null&&(o.elements=[]),o.elements.push(s)}i.push(s)},r.onclosetag=()=>{i.pop()},r.ontext=n=>{i.length>0&&(i[i.length-1].value=n)},r.oncdata=n=>{let s=i[i.length-1];s.value=n,s.isCData=!0},r.onerror=n=>{throw n},r.write(t),e}});var xe=w(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.CURRENT_APP_PACKAGE_FILE_NAME=q.CURRENT_APP_INSTALLER_FILE_NAME=q.XElement=q.parseXml=q.UUID=q.parseDn=q.retry=q.githubUrl=q.getS3LikeProviderBaseUrl=q.ProgressCallbackTransform=q.MemoLazy=q.safeStringifyJson=q.safeGetHeader=q.parseJson=q.HttpExecutor=q.HttpError=q.DigestTransform=q.createHttpError=q.configureRequestUrl=q.configureRequestOptionsFromUrl=q.configureRequestOptions=q.newError=q.CancellationToken=q.CancellationError=void 0;q.asArray=bN;var Dw=La();Object.defineProperty(q,"CancellationError",{enumerable:!0,get:function(){return Dw.CancellationError}});Object.defineProperty(q,"CancellationToken",{enumerable:!0,get:function(){return Dw.CancellationToken}});var gN=oo();Object.defineProperty(q,"newError",{enumerable:!0,get:function(){return gN.newError}});var tr=gw();Object.defineProperty(q,"configureRequestOptions",{enumerable:!0,get:function(){return tr.configureRequestOptions}});Object.defineProperty(q,"configureRequestOptionsFromUrl",{enumerable:!0,get:function(){return tr.configureRequestOptionsFromUrl}});Object.defineProperty(q,"configureRequestUrl",{enumerable:!0,get:function(){return tr.configureRequestUrl}});Object.defineProperty(q,"createHttpError",{enumerable:!0,get:function(){return tr.createHttpError}});Object.defineProperty(q,"DigestTransform",{enumerable:!0,get:function(){return tr.DigestTransform}});Object.defineProperty(q,"HttpError",{enumerable:!0,get:function(){return tr.HttpError}});Object.defineProperty(q,"HttpExecutor",{enumerable:!0,get:function(){return tr.HttpExecutor}});Object.defineProperty(q,"parseJson",{enumerable:!0,get:function(){return tr.parseJson}});Object.defineProperty(q,"safeGetHeader",{enumerable:!0,get:function(){return tr.safeGetHeader}});Object.defineProperty(q,"safeStringifyJson",{enumerable:!0,get:function(){return tr.safeStringifyJson}});var yN=ww();Object.defineProperty(q,"MemoLazy",{enumerable:!0,get:function(){return yN.MemoLazy}});var wN=th();Object.defineProperty(q,"ProgressCallbackTransform",{enumerable:!0,get:function(){return wN.ProgressCallbackTransform}});var Pw=Ew();Object.defineProperty(q,"getS3LikeProviderBaseUrl",{enumerable:!0,get:function(){return Pw.getS3LikeProviderBaseUrl}});Object.defineProperty(q,"githubUrl",{enumerable:!0,get:function(){return Pw.githubUrl}});var AN=bw();Object.defineProperty(q,"retry",{enumerable:!0,get:function(){return AN.retry}});var EN=_w();Object.defineProperty(q,"parseDn",{enumerable:!0,get:function(){return EN.parseDn}});var SN=Rw();Object.defineProperty(q,"UUID",{enumerable:!0,get:function(){return SN.UUID}});var Fw=xw();Object.defineProperty(q,"parseXml",{enumerable:!0,get:function(){return Fw.parseXml}});Object.defineProperty(q,"XElement",{enumerable:!0,get:function(){return Fw.XElement}});q.CURRENT_APP_INSTALLER_FILE_NAME="installer.exe";q.CURRENT_APP_PACKAGE_FILE_NAME="package.7z";function bN(t){return t==null?[]:Array.isArray(t)?t:[t]}});var Bn=w((xj,Mi)=>{"use strict";function Lw(t){return typeof t>"u"||t===null}function _N(t){return typeof t=="object"&&t!==null}function vN(t){return Array.isArray(t)?t:Lw(t)?[]:[t]}function ON(t,e){var r,i,n,s;if(e)for(s=Object.keys(e),r=0,i=s.length;r<i;r+=1)n=s[r],t[n]=e[n];return t}function TN(t,e){var r="",i;for(i=0;i<e;i+=1)r+=t;return r}function CN(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}Mi.exports.isNothing=Lw;Mi.exports.isObject=_N;Mi.exports.toArray=vN;Mi.exports.repeat=TN;Mi.exports.isNegativeZero=CN;Mi.exports.extend=ON});var jn=w((Dj,kw)=>{"use strict";function $w(t,e){var r="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+="\n\n"+t.mark.snippet),i+" "+r):i}function fo(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=$w(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}fo.prototype=Object.create(Error.prototype);fo.prototype.constructor=fo;fo.prototype.toString=function(e){return this.name+": "+$w(this,e)};kw.exports=fo});var Mw=w((Pj,qw)=>{"use strict";var po=Bn();function lh(t,e,r,i,n){var s="",o="",a=Math.floor(n/2)-1;return i-e>a&&(s=" ... ",e=i-a+s.length),r-i>a&&(o=" ...",r=i+a-o.length),{str:s+t.slice(e,r).replace(/\t/g,"\u2192")+o,pos:i-e+s.length}}function uh(t,e){return po.repeat(" ",e-t.length)+t}function RN(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,i=[0],n=[],s,o=-1;s=r.exec(t.buffer);)n.push(s.index),i.push(s.index+s[0].length),t.position<=s.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var a="",l,c,u=Math.min(t.line+e.linesAfter,n.length).toString().length,h=e.maxLength-(e.indent+u+3);for(l=1;l<=e.linesBefore&&!(o-l<0);l++)c=lh(t.buffer,i[o-l],n[o-l],t.position-(i[o]-i[o-l]),h),a=po.repeat(" ",e.indent)+uh((t.line-l+1).toString(),u)+" | "+c.str+"\n"+a;for(c=lh(t.buffer,i[o],n[o],t.position,h),a+=po.repeat(" ",e.indent)+uh((t.line+1).toString(),u)+" | "+c.str+"\n",a+=po.repeat("-",e.indent+u+3+c.pos)+"^\n",l=1;l<=e.linesAfter&&!(o+l>=n.length);l++)c=lh(t.buffer,i[o+l],n[o+l],t.position-(i[o]-i[o+l]),h),a+=po.repeat(" ",e.indent)+uh((t.line+l+1).toString(),u)+" | "+c.str+"\n";return a.replace(/\n$/,"")}qw.exports=RN});var je=w((Fj,Bw)=>{"use strict";var Uw=jn(),IN=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],NN=["scalar","sequence","mapping"];function xN(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(i){e[String(i)]=r})}),e}function DN(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(IN.indexOf(r)===-1)throw new Uw('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=xN(e.styleAliases||null),NN.indexOf(this.kind)===-1)throw new Uw('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}Bw.exports=DN});var fh=w((Lj,Hw)=>{"use strict";var mo=jn(),ch=je();function jw(t,e){var r=[];return t[e].forEach(function(i){var n=r.length;r.forEach(function(s,o){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(n=o)}),r[n]=i}),r}function PN(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function i(n){n.multi?(t.multi[n.kind].push(n),t.multi.fallback.push(n)):t[n.kind][n.tag]=t.fallback[n.tag]=n}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(i);return t}function hh(t){return this.extend(t)}hh.prototype.extend=function(e){var r=[],i=[];if(e instanceof ch)i.push(e);else if(Array.isArray(e))i=i.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(i=i.concat(e.explicit));else throw new mo("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof ch))throw new mo("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new mo("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new mo("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof ch))throw new mo("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var n=Object.create(hh.prototype);return n.implicit=(this.implicit||[]).concat(r),n.explicit=(this.explicit||[]).concat(i),n.compiledImplicit=jw(n,"implicit"),n.compiledExplicit=jw(n,"explicit"),n.compiledTypeMap=PN(n.compiledImplicit,n.compiledExplicit),n};Hw.exports=hh});var dh=w(($j,Ww)=>{"use strict";var FN=je();Ww.exports=new FN("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return t!==null?t:""}})});var ph=w((kj,Gw)=>{"use strict";var LN=je();Gw.exports=new LN("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return t!==null?t:[]}})});var mh=w((qj,zw)=>{"use strict";var $N=je();zw.exports=new $N("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return t!==null?t:{}}})});var gh=w((Mj,Vw)=>{"use strict";var kN=fh();Vw.exports=new kN({explicit:[dh(),ph(),mh()]})});var yh=w((Uj,Yw)=>{"use strict";var qN=je();function MN(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}function UN(){return null}function BN(t){return t===null}Yw.exports=new qN("tag:yaml.org,2002:null",{kind:"scalar",resolve:MN,construct:UN,predicate:BN,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"})});var wh=w((Bj,Qw)=>{"use strict";var jN=je();function HN(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}function WN(t){return t==="true"||t==="True"||t==="TRUE"}function GN(t){return Object.prototype.toString.call(t)==="[object Boolean]"}Qw.exports=new jN("tag:yaml.org,2002:bool",{kind:"scalar",resolve:HN,construct:WN,predicate:GN,represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"})});var Ah=w((jj,Xw)=>{"use strict";var zN=Bn(),VN=je();function YN(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function QN(t){return 48<=t&&t<=55}function XN(t){return 48<=t&&t<=57}function KN(t){if(t===null)return!1;var e=t.length,r=0,i=!1,n;if(!e)return!1;if(n=t[r],(n==="-"||n==="+")&&(n=t[++r]),n==="0"){if(r+1===e)return!0;if(n=t[++r],n==="b"){for(r++;r<e;r++)if(n=t[r],n!=="_"){if(n!=="0"&&n!=="1")return!1;i=!0}return i&&n!=="_"}if(n==="x"){for(r++;r<e;r++)if(n=t[r],n!=="_"){if(!YN(t.charCodeAt(r)))return!1;i=!0}return i&&n!=="_"}if(n==="o"){for(r++;r<e;r++)if(n=t[r],n!=="_"){if(!QN(t.charCodeAt(r)))return!1;i=!0}return i&&n!=="_"}}if(n==="_")return!1;for(;r<e;r++)if(n=t[r],n!=="_"){if(!XN(t.charCodeAt(r)))return!1;i=!0}return!(!i||n==="_")}function JN(t){var e=t,r=1,i;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),i=e[0],(i==="-"||i==="+")&&(i==="-"&&(r=-1),e=e.slice(1),i=e[0]),e==="0")return 0;if(i==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}function ZN(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!zN.isNegativeZero(t)}Xw.exports=new VN("tag:yaml.org,2002:int",{kind:"scalar",resolve:KN,construct:JN,predicate:ZN,represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})});var Eh=w((Hj,Jw)=>{"use strict";var Kw=Bn(),ex=je(),tx=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function rx(t){return!(t===null||!tx.test(t)||t[t.length-1]==="_")}function ix(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}var nx=/^[-+]?[0-9]+e/;function sx(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Kw.isNegativeZero(t))return"-0.0";return r=t.toString(10),nx.test(r)?r.replace("e",".e"):r}function ox(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||Kw.isNegativeZero(t))}Jw.exports=new ex("tag:yaml.org,2002:float",{kind:"scalar",resolve:rx,construct:ix,predicate:ox,represent:sx,defaultStyle:"lowercase"})});var Sh=w((Wj,Zw)=>{"use strict";Zw.exports=gh().extend({implicit:[yh(),wh(),Ah(),Eh()]})});var bh=w((Gj,e0)=>{"use strict";e0.exports=Sh()});var _h=w((zj,i0)=>{"use strict";var ax=je(),t0=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),r0=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function lx(t){return t===null?!1:t0.exec(t)!==null||r0.exec(t)!==null}function ux(t){var e,r,i,n,s,o,a,l=0,c=null,u,h,f;if(e=t0.exec(t),e===null&&(e=r0.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],i=+e[2]-1,n=+e[3],!e[4])return new Date(Date.UTC(r,i,n));if(s=+e[4],o=+e[5],a=+e[6],e[7]){for(l=e[7].slice(0,3);l.length<3;)l+="0";l=+l}return e[9]&&(u=+e[10],h=+(e[11]||0),c=(u*60+h)*6e4,e[9]==="-"&&(c=-c)),f=new Date(Date.UTC(r,i,n,s,o,a,l)),c&&f.setTime(f.getTime()-c),f}function cx(t){return t.toISOString()}i0.exports=new ax("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:lx,construct:ux,instanceOf:Date,represent:cx})});var vh=w((Vj,n0)=>{"use strict";var hx=je();function fx(t){return t==="<<"||t===null}n0.exports=new hx("tag:yaml.org,2002:merge",{kind:"scalar",resolve:fx})});var Th=w((Yj,s0)=>{"use strict";var dx=je(),Oh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";function px(t){if(t===null)return!1;var e,r,i=0,n=t.length,s=Oh;for(r=0;r<n;r++)if(e=s.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;i+=6}return i%8===0}function mx(t){var e,r,i=t.replace(/[\r\n=]/g,""),n=i.length,s=Oh,o=0,a=[];for(e=0;e<n;e++)e%4===0&&e&&(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)),o=o<<6|s.indexOf(i.charAt(e));return r=n%4*6,r===0?(a.push(o>>16&255),a.push(o>>8&255),a.push(o&255)):r===18?(a.push(o>>10&255),a.push(o>>2&255)):r===12&&a.push(o>>4&255),new Uint8Array(a)}function gx(t){var e="",r=0,i,n,s=t.length,o=Oh;for(i=0;i<s;i++)i%3===0&&i&&(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]),r=(r<<8)+t[i];return n=s%3,n===0?(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]):n===2?(e+=o[r>>10&63],e+=o[r>>4&63],e+=o[r<<2&63],e+=o[64]):n===1&&(e+=o[r>>2&63],e+=o[r<<4&63],e+=o[64],e+=o[64]),e}function yx(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}s0.exports=new dx("tag:yaml.org,2002:binary",{kind:"scalar",resolve:px,construct:mx,predicate:yx,represent:gx})});var Ch=w((Qj,o0)=>{"use strict";var wx=je(),Ax=Object.prototype.hasOwnProperty,Ex=Object.prototype.toString;function Sx(t){if(t===null)return!0;var e=[],r,i,n,s,o,a=t;for(r=0,i=a.length;r<i;r+=1){if(n=a[r],o=!1,Ex.call(n)!=="[object Object]")return!1;for(s in n)if(Ax.call(n,s))if(!o)o=!0;else return!1;if(!o)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}function bx(t){return t!==null?t:[]}o0.exports=new wx("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Sx,construct:bx})});var Rh=w((Xj,a0)=>{"use strict";var _x=je(),vx=Object.prototype.toString;function Ox(t){if(t===null)return!0;var e,r,i,n,s,o=t;for(s=new Array(o.length),e=0,r=o.length;e<r;e+=1){if(i=o[e],vx.call(i)!=="[object Object]"||(n=Object.keys(i),n.length!==1))return!1;s[e]=[n[0],i[n[0]]]}return!0}function Tx(t){if(t===null)return[];var e,r,i,n,s,o=t;for(s=new Array(o.length),e=0,r=o.length;e<r;e+=1)i=o[e],n=Object.keys(i),s[e]=[n[0],i[n[0]]];return s}a0.exports=new _x("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Ox,construct:Tx})});var Ih=w((Kj,l0)=>{"use strict";var Cx=je(),Rx=Object.prototype.hasOwnProperty;function Ix(t){if(t===null)return!0;var e,r=t;for(e in r)if(Rx.call(r,e)&&r[e]!==null)return!1;return!0}function Nx(t){return t!==null?t:{}}l0.exports=new Cx("tag:yaml.org,2002:set",{kind:"mapping",resolve:Ix,construct:Nx})});var Qa=w((Jj,u0)=>{"use strict";u0.exports=bh().extend({implicit:[_h(),vh()],explicit:[Th(),Ch(),Rh(),Ih()]})});var O0=w((Zj,Ph)=>{"use strict";var Bi=Bn(),g0=jn(),xx=Mw(),Dx=Qa(),ri=Object.prototype.hasOwnProperty,Xa=1,y0=2,w0=3,Ka=4,Nh=1,Px=2,c0=3,Fx=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Lx=/[\x85\u2028\u2029]/,$x=/[,\[\]\{\}]/,A0=/^(?:!|!!|![a-z\-]+!)$/i,E0=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function h0(t){return Object.prototype.toString.call(t)}function rr(t){return t===10||t===13}function ji(t){return t===9||t===32}function ft(t){return t===9||t===32||t===10||t===13}function Hn(t){return t===44||t===91||t===93||t===123||t===125}function kx(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}function qx(t){return t===120?2:t===117?4:t===85?8:0}function Mx(t){return 48<=t&&t<=57?t-48:-1}function f0(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?"\n":t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"\x85":t===95?"\xA0":t===76?"\u2028":t===80?"\u2029":""}function Ux(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}var S0=new Array(256),b0=new Array(256);for(Ui=0;Ui<256;Ui++)S0[Ui]=f0(Ui)?1:0,b0[Ui]=f0(Ui);var Ui;function Bx(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||Dx,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function _0(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=xx(r),new g0(e,r)}function $(t,e){throw _0(t,e)}function Ja(t,e){t.onWarning&&t.onWarning.call(null,_0(t,e))}var d0={YAML:function(e,r,i){var n,s,o;e.version!==null&&$(e,"duplication of %YAML directive"),i.length!==1&&$(e,"YAML directive accepts exactly one argument"),n=/^([0-9]+)\.([0-9]+)$/.exec(i[0]),n===null&&$(e,"ill-formed argument of the YAML directive"),s=parseInt(n[1],10),o=parseInt(n[2],10),s!==1&&$(e,"unacceptable YAML version of the document"),e.version=i[0],e.checkLineBreaks=o<2,o!==1&&o!==2&&Ja(e,"unsupported YAML version of the document")},TAG:function(e,r,i){var n,s;i.length!==2&&$(e,"TAG directive accepts exactly two arguments"),n=i[0],s=i[1],A0.test(n)||$(e,"ill-formed tag handle (first argument) of the TAG directive"),ri.call(e.tagMap,n)&&$(e,'there is a previously declared suffix for "'+n+'" tag handle'),E0.test(s)||$(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{$(e,"tag prefix is malformed: "+s)}e.tagMap[n]=s}};function ti(t,e,r,i){var n,s,o,a;if(e<r){if(a=t.input.slice(e,r),i)for(n=0,s=a.length;n<s;n+=1)o=a.charCodeAt(n),o===9||32<=o&&o<=1114111||$(t,"expected valid JSON character");else Fx.test(a)&&$(t,"the stream contains non-printable characters");t.result+=a}}function p0(t,e,r,i){var n,s,o,a;for(Bi.isObject(r)||$(t,"cannot merge mappings; the provided source object is unacceptable"),n=Object.keys(r),o=0,a=n.length;o<a;o+=1)s=n[o],ri.call(e,s)||(e[s]=r[s],i[s]=!0)}function Wn(t,e,r,i,n,s,o,a,l){var c,u;if(Array.isArray(n))for(n=Array.prototype.slice.call(n),c=0,u=n.length;c<u;c+=1)Array.isArray(n[c])&&$(t,"nested arrays are not supported inside keys"),typeof n=="object"&&h0(n[c])==="[object Object]"&&(n[c]="[object Object]");if(typeof n=="object"&&h0(n)==="[object Object]"&&(n="[object Object]"),n=String(n),e===null&&(e={}),i==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(c=0,u=s.length;c<u;c+=1)p0(t,e,s[c],r);else p0(t,e,s,r);else!t.json&&!ri.call(r,n)&&ri.call(e,n)&&(t.line=o||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,$(t,"duplicated mapping key")),n==="__proto__"?Object.defineProperty(e,n,{configurable:!0,enumerable:!0,writable:!0,value:s}):e[n]=s,delete r[n];return e}function xh(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):$(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function _e(t,e,r){for(var i=0,n=t.input.charCodeAt(t.position);n!==0;){for(;ji(n);)n===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),n=t.input.charCodeAt(++t.position);if(e&&n===35)do n=t.input.charCodeAt(++t.position);while(n!==10&&n!==13&&n!==0);if(rr(n))for(xh(t),n=t.input.charCodeAt(t.position),i++,t.lineIndent=0;n===32;)t.lineIndent++,n=t.input.charCodeAt(++t.position);else break}return r!==-1&&i!==0&&t.lineIndent<r&&Ja(t,"deficient indentation"),i}function Za(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||ft(r)))}function Dh(t,e){e===1?t.result+=" ":e>1&&(t.result+=Bi.repeat("\n",e-1))}function jx(t,e,r){var i,n,s,o,a,l,c,u,h=t.kind,f=t.result,d;if(d=t.input.charCodeAt(t.position),ft(d)||Hn(d)||d===35||d===38||d===42||d===33||d===124||d===62||d===39||d===34||d===37||d===64||d===96||(d===63||d===45)&&(n=t.input.charCodeAt(t.position+1),ft(n)||r&&Hn(n)))return!1;for(t.kind="scalar",t.result="",s=o=t.position,a=!1;d!==0;){if(d===58){if(n=t.input.charCodeAt(t.position+1),ft(n)||r&&Hn(n))break}else if(d===35){if(i=t.input.charCodeAt(t.position-1),ft(i))break}else{if(t.position===t.lineStart&&Za(t)||r&&Hn(d))break;if(rr(d))if(l=t.line,c=t.lineStart,u=t.lineIndent,_e(t,!1,-1),t.lineIndent>=e){a=!0,d=t.input.charCodeAt(t.position);continue}else{t.position=o,t.line=l,t.lineStart=c,t.lineIndent=u;break}}a&&(ti(t,s,o,!1),Dh(t,t.line-l),s=o=t.position,a=!1),ji(d)||(o=t.position+1),d=t.input.charCodeAt(++t.position)}return ti(t,s,o,!1),t.result?!0:(t.kind=h,t.result=f,!1)}function Hx(t,e){var r,i,n;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,i=n=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(ti(t,i,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)i=t.position,t.position++,n=t.position;else return!0;else rr(r)?(ti(t,i,n,!0),Dh(t,_e(t,!1,e)),i=n=t.position):t.position===t.lineStart&&Za(t)?$(t,"unexpected end of the document within a single quoted scalar"):(t.position++,n=t.position);$(t,"unexpected end of the stream within a single quoted scalar")}function Wx(t,e){var r,i,n,s,o,a;if(a=t.input.charCodeAt(t.position),a!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=i=t.position;(a=t.input.charCodeAt(t.position))!==0;){if(a===34)return ti(t,r,t.position,!0),t.position++,!0;if(a===92){if(ti(t,r,t.position,!0),a=t.input.charCodeAt(++t.position),rr(a))_e(t,!1,e);else if(a<256&&S0[a])t.result+=b0[a],t.position++;else if((o=qx(a))>0){for(n=o,s=0;n>0;n--)a=t.input.charCodeAt(++t.position),(o=kx(a))>=0?s=(s<<4)+o:$(t,"expected hexadecimal character");t.result+=Ux(s),t.position++}else $(t,"unknown escape sequence");r=i=t.position}else rr(a)?(ti(t,r,i,!0),Dh(t,_e(t,!1,e)),r=i=t.position):t.position===t.lineStart&&Za(t)?$(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}$(t,"unexpected end of the stream within a double quoted scalar")}function Gx(t,e){var r=!0,i,n,s,o=t.tag,a,l=t.anchor,c,u,h,f,d,y=Object.create(null),A,E,v,O;if(O=t.input.charCodeAt(t.position),O===91)u=93,d=!1,a=[];else if(O===123)u=125,d=!0,a={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=a),O=t.input.charCodeAt(++t.position);O!==0;){if(_e(t,!0,e),O=t.input.charCodeAt(t.position),O===u)return t.position++,t.tag=o,t.anchor=l,t.kind=d?"mapping":"sequence",t.result=a,!0;r?O===44&&$(t,"expected the node content, but found ','"):$(t,"missed comma between flow collection entries"),E=A=v=null,h=f=!1,O===63&&(c=t.input.charCodeAt(t.position+1),ft(c)&&(h=f=!0,t.position++,_e(t,!0,e))),i=t.line,n=t.lineStart,s=t.position,Gn(t,e,Xa,!1,!0),E=t.tag,A=t.result,_e(t,!0,e),O=t.input.charCodeAt(t.position),(f||t.line===i)&&O===58&&(h=!0,O=t.input.charCodeAt(++t.position),_e(t,!0,e),Gn(t,e,Xa,!1,!0),v=t.result),d?Wn(t,a,y,E,A,v,i,n,s):h?a.push(Wn(t,null,y,E,A,v,i,n,s)):a.push(A),_e(t,!0,e),O=t.input.charCodeAt(t.position),O===44?(r=!0,O=t.input.charCodeAt(++t.position)):r=!1}$(t,"unexpected end of the stream within a flow collection")}function zx(t,e){var r,i,n=Nh,s=!1,o=!1,a=e,l=0,c=!1,u,h;if(h=t.input.charCodeAt(t.position),h===124)i=!1;else if(h===62)i=!0;else return!1;for(t.kind="scalar",t.result="";h!==0;)if(h=t.input.charCodeAt(++t.position),h===43||h===45)Nh===n?n=h===43?c0:Px:$(t,"repeat of a chomping mode identifier");else if((u=Mx(h))>=0)u===0?$(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?$(t,"repeat of an indentation width identifier"):(a=e+u-1,o=!0);else break;if(ji(h)){do h=t.input.charCodeAt(++t.position);while(ji(h));if(h===35)do h=t.input.charCodeAt(++t.position);while(!rr(h)&&h!==0)}for(;h!==0;){for(xh(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!o||t.lineIndent<a)&&h===32;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!o&&t.lineIndent>a&&(a=t.lineIndent),rr(h)){l++;continue}if(t.lineIndent<a){n===c0?t.result+=Bi.repeat("\n",s?1+l:l):n===Nh&&s&&(t.result+="\n");break}for(i?ji(h)?(c=!0,t.result+=Bi.repeat("\n",s?1+l:l)):c?(c=!1,t.result+=Bi.repeat("\n",l+1)):l===0?s&&(t.result+=" "):t.result+=Bi.repeat("\n",l):t.result+=Bi.repeat("\n",s?1+l:l),s=!0,o=!0,l=0,r=t.position;!rr(h)&&h!==0;)h=t.input.charCodeAt(++t.position);ti(t,r,t.position,!1)}return!0}function m0(t,e){var r,i=t.tag,n=t.anchor,s=[],o,a=!1,l;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=s),l=t.input.charCodeAt(t.position);l!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,$(t,"tab characters must not be used in indentation")),!(l!==45||(o=t.input.charCodeAt(t.position+1),!ft(o))));){if(a=!0,t.position++,_e(t,!0,-1)&&t.lineIndent<=e){s.push(null),l=t.input.charCodeAt(t.position);continue}if(r=t.line,Gn(t,e,w0,!1,!0),s.push(t.result),_e(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&l!==0)$(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return a?(t.tag=i,t.anchor=n,t.kind="sequence",t.result=s,!0):!1}function Vx(t,e,r){var i,n,s,o,a,l,c=t.tag,u=t.anchor,h={},f=Object.create(null),d=null,y=null,A=null,E=!1,v=!1,O;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=h),O=t.input.charCodeAt(t.position);O!==0;){if(!E&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,$(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),s=t.line,(O===63||O===58)&&ft(i))O===63?(E&&(Wn(t,h,f,d,y,null,o,a,l),d=y=A=null),v=!0,E=!0,n=!0):E?(E=!1,n=!0):$(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,O=i;else{if(o=t.line,a=t.lineStart,l=t.position,!Gn(t,r,y0,!1,!0))break;if(t.line===s){for(O=t.input.charCodeAt(t.position);ji(O);)O=t.input.charCodeAt(++t.position);if(O===58)O=t.input.charCodeAt(++t.position),ft(O)||$(t,"a whitespace character is expected after the key-value separator within a block mapping"),E&&(Wn(t,h,f,d,y,null,o,a,l),d=y=A=null),v=!0,E=!1,n=!1,d=t.tag,y=t.result;else if(v)$(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=c,t.anchor=u,!0}else if(v)$(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=c,t.anchor=u,!0}if((t.line===s||t.lineIndent>e)&&(E&&(o=t.line,a=t.lineStart,l=t.position),Gn(t,e,Ka,!0,n)&&(E?y=t.result:A=t.result),E||(Wn(t,h,f,d,y,A,o,a,l),d=y=A=null),_e(t,!0,-1),O=t.input.charCodeAt(t.position)),(t.line===s||t.lineIndent>e)&&O!==0)$(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return E&&Wn(t,h,f,d,y,null,o,a,l),v&&(t.tag=c,t.anchor=u,t.kind="mapping",t.result=h),v}function Yx(t){var e,r=!1,i=!1,n,s,o;if(o=t.input.charCodeAt(t.position),o!==33)return!1;if(t.tag!==null&&$(t,"duplication of a tag property"),o=t.input.charCodeAt(++t.position),o===60?(r=!0,o=t.input.charCodeAt(++t.position)):o===33?(i=!0,n="!!",o=t.input.charCodeAt(++t.position)):n="!",e=t.position,r){do o=t.input.charCodeAt(++t.position);while(o!==0&&o!==62);t.position<t.length?(s=t.input.slice(e,t.position),o=t.input.charCodeAt(++t.position)):$(t,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!ft(o);)o===33&&(i?$(t,"tag suffix cannot contain exclamation marks"):(n=t.input.slice(e-1,t.position+1),A0.test(n)||$(t,"named tag handle cannot contain such characters"),i=!0,e=t.position+1)),o=t.input.charCodeAt(++t.position);s=t.input.slice(e,t.position),$x.test(s)&&$(t,"tag suffix cannot contain flow indicator characters")}s&&!E0.test(s)&&$(t,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{$(t,"tag name is malformed: "+s)}return r?t.tag=s:ri.call(t.tagMap,n)?t.tag=t.tagMap[n]+s:n==="!"?t.tag="!"+s:n==="!!"?t.tag="tag:yaml.org,2002:"+s:$(t,'undeclared tag handle "'+n+'"'),!0}function Qx(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&$(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!ft(r)&&!Hn(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&$(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}function Xx(t){var e,r,i;if(i=t.input.charCodeAt(t.position),i!==42)return!1;for(i=t.input.charCodeAt(++t.position),e=t.position;i!==0&&!ft(i)&&!Hn(i);)i=t.input.charCodeAt(++t.position);return t.position===e&&$(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),ri.call(t.anchorMap,r)||$(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],_e(t,!0,-1),!0}function Gn(t,e,r,i,n){var s,o,a,l=1,c=!1,u=!1,h,f,d,y,A,E;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,s=o=a=Ka===r||w0===r,i&&_e(t,!0,-1)&&(c=!0,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)),l===1)for(;Yx(t)||Qx(t);)_e(t,!0,-1)?(c=!0,a=s,t.lineIndent>e?l=1:t.lineIndent===e?l=0:t.lineIndent<e&&(l=-1)):a=!1;if(a&&(a=c||n),(l===1||Ka===r)&&(Xa===r||y0===r?A=e:A=e+1,E=t.position-t.lineStart,l===1?a&&(m0(t,E)||Vx(t,E,A))||Gx(t,A)?u=!0:(o&&zx(t,A)||Hx(t,A)||Wx(t,A)?u=!0:Xx(t)?(u=!0,(t.tag!==null||t.anchor!==null)&&$(t,"alias node should not have any properties")):jx(t,A,Xa===r)&&(u=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):l===0&&(u=a&&m0(t,E))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&$(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),h=0,f=t.implicitTypes.length;h<f;h+=1)if(y=t.implicitTypes[h],y.resolve(t.result)){t.result=y.construct(t.result),t.tag=y.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(ri.call(t.typeMap[t.kind||"fallback"],t.tag))y=t.typeMap[t.kind||"fallback"][t.tag];else for(y=null,d=t.typeMap.multi[t.kind||"fallback"],h=0,f=d.length;h<f;h+=1)if(t.tag.slice(0,d[h].tag.length)===d[h].tag){y=d[h];break}y||$(t,"unknown tag !<"+t.tag+">"),t.result!==null&&y.kind!==t.kind&&$(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+y.kind+'", not "'+t.kind+'"'),y.resolve(t.result,t.tag)?(t.result=y.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):$(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||u}function Kx(t){var e=t.position,r,i,n,s=!1,o;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(o=t.input.charCodeAt(t.position))!==0&&(_e(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||o!==37));){for(s=!0,o=t.input.charCodeAt(++t.position),r=t.position;o!==0&&!ft(o);)o=t.input.charCodeAt(++t.position);for(i=t.input.slice(r,t.position),n=[],i.length<1&&$(t,"directive name must not be less than one character in length");o!==0;){for(;ji(o);)o=t.input.charCodeAt(++t.position);if(o===35){do o=t.input.charCodeAt(++t.position);while(o!==0&&!rr(o));break}if(rr(o))break;for(r=t.position;o!==0&&!ft(o);)o=t.input.charCodeAt(++t.position);n.push(t.input.slice(r,t.position))}o!==0&&xh(t),ri.call(d0,i)?d0[i](t,i,n):Ja(t,'unknown document directive "'+i+'"')}if(_e(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,_e(t,!0,-1)):s&&$(t,"directives end mark is expected"),Gn(t,t.lineIndent-1,Ka,!1,!0),_e(t,!0,-1),t.checkLineBreaks&&Lx.test(t.input.slice(e,t.position))&&Ja(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Za(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,_e(t,!0,-1));return}if(t.position<t.length-1)$(t,"end of the stream or a document separator is expected");else return}function v0(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+="\n"),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new Bx(t,e),i=t.indexOf("\0");for(i!==-1&&(r.position=i,$(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)Kx(r);return r.documents}function Jx(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var i=v0(t,r);if(typeof e!="function")return i;for(var n=0,s=i.length;n<s;n+=1)e(i[n])}function Zx(t,e){var r=v0(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new g0("expected a single document in the stream, but found more")}}Ph.exports.loadAll=Jx;Ph.exports.load=Zx});var z0=w((eH,G0)=>{"use strict";var rl=Bn(),Eo=jn(),eD=Qa(),F0=Object.prototype.toString,L0=Object.prototype.hasOwnProperty,qh=65279,tD=9,yo=10,rD=13,iD=32,nD=33,sD=34,Fh=35,oD=37,aD=38,lD=39,uD=42,$0=44,cD=45,el=58,hD=61,fD=62,dD=63,pD=64,k0=91,q0=93,mD=96,M0=123,gD=124,U0=125,He={};He[0]="\\0";He[7]="\\a";He[8]="\\b";He[9]="\\t";He[10]="\\n";He[11]="\\v";He[12]="\\f";He[13]="\\r";He[27]="\\e";He[34]='\\"';He[92]="\\\\";He[133]="\\N";He[160]="\\_";He[8232]="\\L";He[8233]="\\P";var yD=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],wD=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function AD(t,e){var r,i,n,s,o,a,l;if(e===null)return{};for(r={},i=Object.keys(e),n=0,s=i.length;n<s;n+=1)o=i[n],a=String(e[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),l=t.compiledTypeMap.fallback[o],l&&L0.call(l.styleAliases,a)&&(a=l.styleAliases[a]),r[o]=a;return r}function ED(t){var e,r,i;if(e=t.toString(16).toUpperCase(),t<=255)r="x",i=2;else if(t<=65535)r="u",i=4;else if(t<=4294967295)r="U",i=8;else throw new Eo("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+rl.repeat("0",i-e.length)+e}var SD=1,wo=2;function bD(t){this.schema=t.schema||eD,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=rl.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=AD(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?wo:SD,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function T0(t,e){for(var r=rl.repeat(" ",e),i=0,n=-1,s="",o,a=t.length;i<a;)n=t.indexOf("\n",i),n===-1?(o=t.slice(i),i=a):(o=t.slice(i,n+1),i=n+1),o.length&&o!=="\n"&&(s+=r),s+=o;return s}function Lh(t,e){return"\n"+rl.repeat(" ",t.indent*e)}function _D(t,e){var r,i,n;for(r=0,i=t.implicitTypes.length;r<i;r+=1)if(n=t.implicitTypes[r],n.resolve(e))return!0;return!1}function tl(t){return t===iD||t===tD}function Ao(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==qh||65536<=t&&t<=1114111}function C0(t){return Ao(t)&&t!==qh&&t!==rD&&t!==yo}function R0(t,e,r){var i=C0(t),n=i&&!tl(t);return(r?i:i&&t!==$0&&t!==k0&&t!==q0&&t!==M0&&t!==U0)&&t!==Fh&&!(e===el&&!n)||C0(e)&&!tl(e)&&t===Fh||e===el&&n}function vD(t){return Ao(t)&&t!==qh&&!tl(t)&&t!==cD&&t!==dD&&t!==el&&t!==$0&&t!==k0&&t!==q0&&t!==M0&&t!==U0&&t!==Fh&&t!==aD&&t!==uD&&t!==nD&&t!==gD&&t!==hD&&t!==fD&&t!==lD&&t!==sD&&t!==oD&&t!==pD&&t!==mD}function OD(t){return!tl(t)&&t!==el}function go(t,e){var r=t.charCodeAt(e),i;return r>=55296&&r<=56319&&e+1<t.length&&(i=t.charCodeAt(e+1),i>=56320&&i<=57343)?(r-55296)*1024+i-56320+65536:r}function B0(t){var e=/^\n* /;return e.test(t)}var j0=1,$h=2,H0=3,W0=4,zn=5;function TD(t,e,r,i,n,s,o,a){var l,c=0,u=null,h=!1,f=!1,d=i!==-1,y=-1,A=vD(go(t,0))&&OD(go(t,t.length-1));if(e||o)for(l=0;l<t.length;c>=65536?l+=2:l++){if(c=go(t,l),!Ao(c))return zn;A=A&&R0(c,u,a),u=c}else{for(l=0;l<t.length;c>=65536?l+=2:l++){if(c=go(t,l),c===yo)h=!0,d&&(f=f||l-y-1>i&&t[y+1]!==" ",y=l);else if(!Ao(c))return zn;A=A&&R0(c,u,a),u=c}f=f||d&&l-y-1>i&&t[y+1]!==" "}return!h&&!f?A&&!o&&!n(t)?j0:s===wo?zn:$h:r>9&&B0(t)?zn:o?s===wo?zn:$h:f?W0:H0}function CD(t,e,r,i,n){t.dump=(function(){if(e.length===0)return t.quotingType===wo?'""':"''";if(!t.noCompatMode&&(yD.indexOf(e)!==-1||wD.test(e)))return t.quotingType===wo?'"'+e+'"':"'"+e+"'";var s=t.indent*Math.max(1,r),o=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-s),a=i||t.flowLevel>-1&&r>=t.flowLevel;function l(c){return _D(t,c)}switch(TD(e,a,t.indent,o,l,t.quotingType,t.forceQuotes&&!i,n)){case j0:return e;case $h:return"'"+e.replace(/'/g,"''")+"'";case H0:return"|"+I0(e,t.indent)+N0(T0(e,s));case W0:return">"+I0(e,t.indent)+N0(T0(RD(e,o),s));case zn:return'"'+ID(e,o)+'"';default:throw new Eo("impossible error: invalid scalar style")}})()}function I0(t,e){var r=B0(t)?String(e):"",i=t[t.length-1]==="\n",n=i&&(t[t.length-2]==="\n"||t==="\n"),s=n?"+":i?"":"-";return r+s+"\n"}function N0(t){return t[t.length-1]==="\n"?t.slice(0,-1):t}function RD(t,e){for(var r=/(\n+)([^\n]*)/g,i=(function(){var c=t.indexOf("\n");return c=c!==-1?c:t.length,r.lastIndex=c,x0(t.slice(0,c),e)})(),n=t[0]==="\n"||t[0]===" ",s,o;o=r.exec(t);){var a=o[1],l=o[2];s=l[0]===" ",i+=a+(!n&&!s&&l!==""?"\n":"")+x0(l,e),n=s}return i}function x0(t,e){if(t===""||t[0]===" ")return t;for(var r=/ [^ ]/g,i,n=0,s,o=0,a=0,l="";i=r.exec(t);)a=i.index,a-n>e&&(s=o>n?o:a,l+="\n"+t.slice(n,s),n=s+1),o=a;return l+="\n",t.length-n>e&&o>n?l+=t.slice(n,o)+"\n"+t.slice(o+1):l+=t.slice(n),l.slice(1)}function ID(t){for(var e="",r=0,i,n=0;n<t.length;r>=65536?n+=2:n++)r=go(t,n),i=He[r],!i&&Ao(r)?(e+=t[n],r>=65536&&(e+=t[n+1])):e+=i||ED(r);return e}function ND(t,e,r){var i="",n=t.tag,s,o,a;for(s=0,o=r.length;s<o;s+=1)a=r[s],t.replacer&&(a=t.replacer.call(r,String(s),a)),(Ar(t,e,a,!1,!1)||typeof a>"u"&&Ar(t,e,null,!1,!1))&&(i!==""&&(i+=","+(t.condenseFlow?"":" ")),i+=t.dump);t.tag=n,t.dump="["+i+"]"}function D0(t,e,r,i){var n="",s=t.tag,o,a,l;for(o=0,a=r.length;o<a;o+=1)l=r[o],t.replacer&&(l=t.replacer.call(r,String(o),l)),(Ar(t,e+1,l,!0,!0,!1,!0)||typeof l>"u"&&Ar(t,e+1,null,!0,!0,!1,!0))&&((!i||n!=="")&&(n+=Lh(t,e)),t.dump&&yo===t.dump.charCodeAt(0)?n+="-":n+="- ",n+=t.dump);t.tag=s,t.dump=n||"[]"}function xD(t,e,r){var i="",n=t.tag,s=Object.keys(r),o,a,l,c,u;for(o=0,a=s.length;o<a;o+=1)u="",i!==""&&(u+=", "),t.condenseFlow&&(u+='"'),l=s[o],c=r[l],t.replacer&&(c=t.replacer.call(r,l,c)),Ar(t,e,l,!1,!1)&&(t.dump.length>1024&&(u+="? "),u+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),Ar(t,e,c,!1,!1)&&(u+=t.dump,i+=u));t.tag=n,t.dump="{"+i+"}"}function DD(t,e,r,i){var n="",s=t.tag,o=Object.keys(r),a,l,c,u,h,f;if(t.sortKeys===!0)o.sort();else if(typeof t.sortKeys=="function")o.sort(t.sortKeys);else if(t.sortKeys)throw new Eo("sortKeys must be a boolean or a function");for(a=0,l=o.length;a<l;a+=1)f="",(!i||n!=="")&&(f+=Lh(t,e)),c=o[a],u=r[c],t.replacer&&(u=t.replacer.call(r,c,u)),Ar(t,e+1,c,!0,!0,!0)&&(h=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,h&&(t.dump&&yo===t.dump.charCodeAt(0)?f+="?":f+="? "),f+=t.dump,h&&(f+=Lh(t,e)),Ar(t,e+1,u,!0,h)&&(t.dump&&yo===t.dump.charCodeAt(0)?f+=":":f+=": ",f+=t.dump,n+=f));t.tag=s,t.dump=n||"{}"}function P0(t,e,r){var i,n,s,o,a,l;for(n=r?t.explicitTypes:t.implicitTypes,s=0,o=n.length;s<o;s+=1)if(a=n[s],(a.instanceOf||a.predicate)&&(!a.instanceOf||typeof e=="object"&&e instanceof a.instanceOf)&&(!a.predicate||a.predicate(e))){if(r?a.multi&&a.representName?t.tag=a.representName(e):t.tag=a.tag:t.tag="?",a.represent){if(l=t.styleMap[a.tag]||a.defaultStyle,F0.call(a.represent)==="[object Function]")i=a.represent(e,l);else if(L0.call(a.represent,l))i=a.represent[l](e,l);else throw new Eo("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');t.dump=i}return!0}return!1}function Ar(t,e,r,i,n,s,o){t.tag=null,t.dump=r,P0(t,r,!1)||P0(t,r,!0);var a=F0.call(t.dump),l=i,c;i&&(i=t.flowLevel<0||t.flowLevel>e);var u=a==="[object Object]"||a==="[object Array]",h,f;if(u&&(h=t.duplicates.indexOf(r),f=h!==-1),(t.tag!==null&&t.tag!=="?"||f||t.indent!==2&&e>0)&&(n=!1),f&&t.usedDuplicates[h])t.dump="*ref_"+h;else{if(u&&f&&!t.usedDuplicates[h]&&(t.usedDuplicates[h]=!0),a==="[object Object]")i&&Object.keys(t.dump).length!==0?(DD(t,e,t.dump,n),f&&(t.dump="&ref_"+h+t.dump)):(xD(t,e,t.dump),f&&(t.dump="&ref_"+h+" "+t.dump));else if(a==="[object Array]")i&&t.dump.length!==0?(t.noArrayIndent&&!o&&e>0?D0(t,e-1,t.dump,n):D0(t,e,t.dump,n),f&&(t.dump="&ref_"+h+t.dump)):(ND(t,e,t.dump),f&&(t.dump="&ref_"+h+" "+t.dump));else if(a==="[object String]")t.tag!=="?"&&CD(t,t.dump,e,s,l);else{if(a==="[object Undefined]")return!1;if(t.skipInvalid)return!1;throw new Eo("unacceptable kind of an object to dump "+a)}t.tag!==null&&t.tag!=="?"&&(c=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",t.dump=c+" "+t.dump)}return!0}function PD(t,e){var r=[],i=[],n,s;for(kh(t,r,i),n=0,s=i.length;n<s;n+=1)e.duplicates.push(r[i[n]]);e.usedDuplicates=new Array(s)}function kh(t,e,r){var i,n,s;if(t!==null&&typeof t=="object")if(n=e.indexOf(t),n!==-1)r.indexOf(n)===-1&&r.push(n);else if(e.push(t),Array.isArray(t))for(n=0,s=t.length;n<s;n+=1)kh(t[n],e,r);else for(i=Object.keys(t),n=0,s=i.length;n<s;n+=1)kh(t[i[n]],e,r)}function FD(t,e){e=e||{};var r=new bD(e);r.noRefs||PD(t,r);var i=t;return r.replacer&&(i=r.replacer.call({"":i},"",i)),Ar(r,0,i,!0,!0)?r.dump+"\n":""}G0.exports.dump=FD});var il=w((tH,Ze)=>{"use strict";var V0=O0(),LD=z0();function Mh(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}Ze.exports.Type=je();Ze.exports.Schema=fh();Ze.exports.FAILSAFE_SCHEMA=gh();Ze.exports.JSON_SCHEMA=Sh();Ze.exports.CORE_SCHEMA=bh();Ze.exports.DEFAULT_SCHEMA=Qa();Ze.exports.load=V0.load;Ze.exports.loadAll=V0.loadAll;Ze.exports.dump=LD.dump;Ze.exports.YAMLException=jn();Ze.exports.types={binary:Th(),float:Eh(),map:mh(),null:yh(),pairs:Rh(),set:Ih(),timestamp:_h(),bool:wh(),int:Ah(),merge:vh(),omap:Ch(),seq:ph(),str:dh()};Ze.exports.safeLoad=Mh("safeLoad","load");Ze.exports.safeLoadAll=Mh("safeLoadAll","loadAll");Ze.exports.safeDump=Mh("safeDump","dump")});var Y0=w(nl=>{"use strict";Object.defineProperty(nl,"__esModule",{value:!0});nl.Lazy=void 0;var Uh=class{constructor(e){this._value=null,this.creator=e}get hasValue(){return this.creator==null}get value(){if(this.creator==null)return this._value;let e=this.creator();return this.value=e,e}set value(e){this._value=e,this.creator=null}};nl.Lazy=Uh});var So=w((iH,Q0)=>{"use strict";var $D="2.0.0",kD=Number.MAX_SAFE_INTEGER||9007199254740991,qD=16,MD=250,UD=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Q0.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:qD,MAX_SAFE_BUILD_LENGTH:MD,MAX_SAFE_INTEGER:kD,RELEASE_TYPES:UD,SEMVER_SPEC_VERSION:$D,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var bo=w((nH,X0)=>{"use strict";var BD=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};X0.exports=BD});var Vn=w((ir,K0)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:Bh,MAX_SAFE_BUILD_LENGTH:jD,MAX_LENGTH:HD}=So(),WD=bo();ir=K0.exports={};var GD=ir.re=[],zD=ir.safeRe=[],x=ir.src=[],VD=ir.safeSrc=[],D=ir.t={},YD=0,jh="[a-zA-Z0-9-]",QD=[["\\s",1],["\\d",HD],[jh,jD]],XD=t=>{for(let[e,r]of QD)t=t.split("".concat(e,"*")).join("".concat(e,"{0,").concat(r,"}")).split("".concat(e,"+")).join("".concat(e,"{1,").concat(r,"}"));return t},j=(t,e,r)=>{let i=XD(e),n=YD++;WD(t,n,e),D[t]=n,x[n]=e,VD[n]=i,GD[n]=new RegExp(e,r?"g":void 0),zD[n]=new RegExp(i,r?"g":void 0)};j("NUMERICIDENTIFIER","0|[1-9]\\d*");j("NUMERICIDENTIFIERLOOSE","\\d+");j("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(jh,"*"));j("MAINVERSION","(".concat(x[D.NUMERICIDENTIFIER],")\\.")+"(".concat(x[D.NUMERICIDENTIFIER],")\\.")+"(".concat(x[D.NUMERICIDENTIFIER],")"));j("MAINVERSIONLOOSE","(".concat(x[D.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(x[D.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(x[D.NUMERICIDENTIFIERLOOSE],")"));j("PRERELEASEIDENTIFIER","(?:".concat(x[D.NONNUMERICIDENTIFIER],"|").concat(x[D.NUMERICIDENTIFIER],")"));j("PRERELEASEIDENTIFIERLOOSE","(?:".concat(x[D.NONNUMERICIDENTIFIER],"|").concat(x[D.NUMERICIDENTIFIERLOOSE],")"));j("PRERELEASE","(?:-(".concat(x[D.PRERELEASEIDENTIFIER],"(?:\\.").concat(x[D.PRERELEASEIDENTIFIER],")*))"));j("PRERELEASELOOSE","(?:-?(".concat(x[D.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(x[D.PRERELEASEIDENTIFIERLOOSE],")*))"));j("BUILDIDENTIFIER","".concat(jh,"+"));j("BUILD","(?:\\+(".concat(x[D.BUILDIDENTIFIER],"(?:\\.").concat(x[D.BUILDIDENTIFIER],")*))"));j("FULLPLAIN","v?".concat(x[D.MAINVERSION]).concat(x[D.PRERELEASE],"?").concat(x[D.BUILD],"?"));j("FULL","^".concat(x[D.FULLPLAIN],"$"));j("LOOSEPLAIN","[v=\\s]*".concat(x[D.MAINVERSIONLOOSE]).concat(x[D.PRERELEASELOOSE],"?").concat(x[D.BUILD],"?"));j("LOOSE","^".concat(x[D.LOOSEPLAIN],"$"));j("GTLT","((?:<|>)?=?)");j("XRANGEIDENTIFIERLOOSE","".concat(x[D.NUMERICIDENTIFIERLOOSE],"|x|X|\\*"));j("XRANGEIDENTIFIER","".concat(x[D.NUMERICIDENTIFIER],"|x|X|\\*"));j("XRANGEPLAIN","[v=\\s]*(".concat(x[D.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(x[D.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(x[D.XRANGEIDENTIFIER],")")+"(?:".concat(x[D.PRERELEASE],")?").concat(x[D.BUILD],"?")+")?)?");j("XRANGEPLAINLOOSE","[v=\\s]*(".concat(x[D.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(x[D.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(x[D.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(x[D.PRERELEASELOOSE],")?").concat(x[D.BUILD],"?")+")?)?");j("XRANGE","^".concat(x[D.GTLT],"\\s*").concat(x[D.XRANGEPLAIN],"$"));j("XRANGELOOSE","^".concat(x[D.GTLT],"\\s*").concat(x[D.XRANGEPLAINLOOSE],"$"));j("COERCEPLAIN","(^|[^\\d])(\\d{1,".concat(Bh,"})")+"(?:\\.(\\d{1,".concat(Bh,"}))?")+"(?:\\.(\\d{1,".concat(Bh,"}))?"));j("COERCE","".concat(x[D.COERCEPLAIN],"(?:$|[^\\d])"));j("COERCEFULL",x[D.COERCEPLAIN]+"(?:".concat(x[D.PRERELEASE],")?")+"(?:".concat(x[D.BUILD],")?")+"(?:$|[^\\d])");j("COERCERTL",x[D.COERCE],!0);j("COERCERTLFULL",x[D.COERCEFULL],!0);j("LONETILDE","(?:~>?)");j("TILDETRIM","(\\s*)".concat(x[D.LONETILDE],"\\s+"),!0);ir.tildeTrimReplace="$1~";j("TILDE","^".concat(x[D.LONETILDE]).concat(x[D.XRANGEPLAIN],"$"));j("TILDELOOSE","^".concat(x[D.LONETILDE]).concat(x[D.XRANGEPLAINLOOSE],"$"));j("LONECARET","(?:\\^)");j("CARETTRIM","(\\s*)".concat(x[D.LONECARET],"\\s+"),!0);ir.caretTrimReplace="$1^";j("CARET","^".concat(x[D.LONECARET]).concat(x[D.XRANGEPLAIN],"$"));j("CARETLOOSE","^".concat(x[D.LONECARET]).concat(x[D.XRANGEPLAINLOOSE],"$"));j("COMPARATORLOOSE","^".concat(x[D.GTLT],"\\s*(").concat(x[D.LOOSEPLAIN],")$|^$"));j("COMPARATOR","^".concat(x[D.GTLT],"\\s*(").concat(x[D.FULLPLAIN],")$|^$"));j("COMPARATORTRIM","(\\s*)".concat(x[D.GTLT],"\\s*(").concat(x[D.LOOSEPLAIN],"|").concat(x[D.XRANGEPLAIN],")"),!0);ir.comparatorTrimReplace="$1$2$3";j("HYPHENRANGE","^\\s*(".concat(x[D.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(x[D.XRANGEPLAIN],")")+"\\s*$");j("HYPHENRANGELOOSE","^\\s*(".concat(x[D.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(x[D.XRANGEPLAINLOOSE],")")+"\\s*$");j("STAR","(<|>)?=?\\s*\\*");j("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");j("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var sl=w((sH,J0)=>{"use strict";var KD=Object.freeze({loose:!0}),JD=Object.freeze({}),ZD=t=>t?typeof t!="object"?KD:t:JD;J0.exports=ZD});var Hh=w((oH,tA)=>{"use strict";var Z0=/^[0-9]+$/,eA=(t,e)=>{let r=Z0.test(t),i=Z0.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1},e1=(t,e)=>eA(e,t);tA.exports={compareIdentifiers:eA,rcompareIdentifiers:e1}});var We=w((aH,iA)=>{"use strict";var ol=bo(),{MAX_LENGTH:rA,MAX_SAFE_INTEGER:al}=So(),{safeRe:ll,t:ul}=Vn(),t1=sl(),{compareIdentifiers:Yn}=Hh(),Wh=class t{constructor(e,r){if(r=t1(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError('Invalid version. Must be a string. Got type "'.concat(typeof e,'".'));if(e.length>rA)throw new TypeError("version is longer than ".concat(rA," characters"));ol("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let i=e.trim().match(r.loose?ll[ul.LOOSE]:ll[ul.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>al||this.major<0)throw new TypeError("Invalid major version");if(this.minor>al||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>al||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let s=+n;if(s>=0&&s<al)return s}return n}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}toString(){return this.version}compare(e){if(ol("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),Yn(this.major,e.major)||Yn(this.minor,e.minor)||Yn(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let i=this.prerelease[r],n=e.prerelease[r];if(ol("prerelease compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return Yn(i,n)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let i=this.build[r],n=e.build[r];if(ol("build compare",r,i,n),i===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(i===void 0)return-1;if(i===n)continue;return Yn(i,n)}while(++r)}inc(e,r,i){if(e.startsWith("pre")){if(!r&&i===!1)throw new Error("invalid increment argument: identifier is empty");if(r){let n="-".concat(r).match(this.options.loose?ll[ul.PRERELEASELOOSE]:ll[ul.PRERELEASE]);if(!n||n[1]!==r)throw new Error("invalid identifier: ".concat(r))}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,i);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,i);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,i),this.inc("pre",r,i);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,i),this.inc("pre",r,i);break;case"release":if(this.prerelease.length===0)throw new Error("version ".concat(this.raw," is not a prerelease"));this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(i)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&i===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(r){let s=[r,n];i===!1&&(s=[r]),Yn(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error("invalid increment argument: ".concat(e))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}};iA.exports=Wh});var Hi=w((lH,sA)=>{"use strict";var nA=We(),r1=(t,e,r=!1)=>{if(t instanceof nA)return t;try{return new nA(t,e)}catch(i){if(!r)return null;throw i}};sA.exports=r1});var aA=w((uH,oA)=>{"use strict";var i1=Hi(),n1=(t,e)=>{let r=i1(t,e);return r?r.version:null};oA.exports=n1});var uA=w((cH,lA)=>{"use strict";var s1=Hi(),o1=(t,e)=>{let r=s1(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};lA.exports=o1});var fA=w((hH,hA)=>{"use strict";var cA=We(),a1=(t,e,r,i,n)=>{typeof r=="string"&&(n=i,i=r,r=void 0);try{return new cA(t instanceof cA?t.version:t,r).inc(e,i,n).version}catch{return null}};hA.exports=a1});var mA=w((fH,pA)=>{"use strict";var dA=Hi(),l1=(t,e)=>{let r=dA(t,null,!0),i=dA(e,null,!0),n=r.compare(i);if(n===0)return null;let s=n>0,o=s?r:i,a=s?i:r,l=!!o.prerelease.length;if(!!a.prerelease.length&&!l){if(!a.patch&&!a.minor)return"major";if(a.compareMain(o)===0)return a.minor&&!a.patch?"minor":"patch"}let u=l?"pre":"";return r.major!==i.major?u+"major":r.minor!==i.minor?u+"minor":r.patch!==i.patch?u+"patch":"prerelease"};pA.exports=l1});var yA=w((dH,gA)=>{"use strict";var u1=We(),c1=(t,e)=>new u1(t,e).major;gA.exports=c1});var AA=w((pH,wA)=>{"use strict";var h1=We(),f1=(t,e)=>new h1(t,e).minor;wA.exports=f1});var SA=w((mH,EA)=>{"use strict";var d1=We(),p1=(t,e)=>new d1(t,e).patch;EA.exports=p1});var _A=w((gH,bA)=>{"use strict";var m1=Hi(),g1=(t,e)=>{let r=m1(t,e);return r&&r.prerelease.length?r.prerelease:null};bA.exports=g1});var Dt=w((yH,OA)=>{"use strict";var vA=We(),y1=(t,e,r)=>new vA(t,r).compare(new vA(e,r));OA.exports=y1});var CA=w((wH,TA)=>{"use strict";var w1=Dt(),A1=(t,e,r)=>w1(e,t,r);TA.exports=A1});var IA=w((AH,RA)=>{"use strict";var E1=Dt(),S1=(t,e)=>E1(t,e,!0);RA.exports=S1});var cl=w((EH,xA)=>{"use strict";var NA=We(),b1=(t,e,r)=>{let i=new NA(t,r),n=new NA(e,r);return i.compare(n)||i.compareBuild(n)};xA.exports=b1});var PA=w((SH,DA)=>{"use strict";var _1=cl(),v1=(t,e)=>t.sort((r,i)=>_1(r,i,e));DA.exports=v1});var LA=w((bH,FA)=>{"use strict";var O1=cl(),T1=(t,e)=>t.sort((r,i)=>O1(i,r,e));FA.exports=T1});var _o=w((_H,$A)=>{"use strict";var C1=Dt(),R1=(t,e,r)=>C1(t,e,r)>0;$A.exports=R1});var hl=w((vH,kA)=>{"use strict";var I1=Dt(),N1=(t,e,r)=>I1(t,e,r)<0;kA.exports=N1});var Gh=w((OH,qA)=>{"use strict";var x1=Dt(),D1=(t,e,r)=>x1(t,e,r)===0;qA.exports=D1});var zh=w((TH,MA)=>{"use strict";var P1=Dt(),F1=(t,e,r)=>P1(t,e,r)!==0;MA.exports=F1});var fl=w((CH,UA)=>{"use strict";var L1=Dt(),$1=(t,e,r)=>L1(t,e,r)>=0;UA.exports=$1});var dl=w((RH,BA)=>{"use strict";var k1=Dt(),q1=(t,e,r)=>k1(t,e,r)<=0;BA.exports=q1});var Vh=w((IH,jA)=>{"use strict";var M1=Gh(),U1=zh(),B1=_o(),j1=fl(),H1=hl(),W1=dl(),G1=(t,e,r,i)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return M1(t,r,i);case"!=":return U1(t,r,i);case">":return B1(t,r,i);case">=":return j1(t,r,i);case"<":return H1(t,r,i);case"<=":return W1(t,r,i);default:throw new TypeError("Invalid operator: ".concat(e))}};jA.exports=G1});var WA=w((NH,HA)=>{"use strict";var z1=We(),V1=Hi(),{safeRe:pl,t:ml}=Vn(),Y1=(t,e)=>{if(t instanceof z1)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?pl[ml.COERCEFULL]:pl[ml.COERCE]);else{let l=e.includePrerelease?pl[ml.COERCERTLFULL]:pl[ml.COERCERTL],c;for(;(c=l.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||c.index+c[0].length!==r.index+r[0].length)&&(r=c),l.lastIndex=c.index+c[1].length+c[2].length;l.lastIndex=-1}if(r===null)return null;let i=r[2],n=r[3]||"0",s=r[4]||"0",o=e.includePrerelease&&r[5]?"-".concat(r[5]):"",a=e.includePrerelease&&r[6]?"+".concat(r[6]):"";return V1("".concat(i,".").concat(n,".").concat(s).concat(o).concat(a),e)};HA.exports=Y1});var zA=w((xH,GA)=>{"use strict";var Yh=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let n=this.map.keys().next().value;this.delete(n)}this.map.set(e,r)}return this}};GA.exports=Yh});var Pt=w((DH,XA)=>{"use strict";var Q1=/\s+/g,Qh=class t{constructor(e,r){if(r=K1(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Xh)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(Q1," "),this.set=this.raw.split("||").map(i=>this.parseRange(i.trim())).filter(i=>i.length),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){let i=this.set[0];if(this.set=this.set.filter(n=>!YA(n[0])),this.set.length===0)this.set=[i];else if(this.set.length>1){for(let n of this.set)if(n.length===1&&nP(n[0])){this.set=[n];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let r=this.set[e];for(let i=0;i<r.length;i++)i>0&&(this.formatted+=" "),this.formatted+=r[i].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let i=((this.options.includePrerelease&&rP)|(this.options.loose&&iP))+":"+e,n=VA.get(i);if(n)return n;let s=this.options.loose,o=s?dt[et.HYPHENRANGELOOSE]:dt[et.HYPHENRANGE];e=e.replace(o,pP(this.options.includePrerelease)),ce("hyphen replace",e),e=e.replace(dt[et.COMPARATORTRIM],Z1),ce("comparator trim",e),e=e.replace(dt[et.TILDETRIM],eP),ce("tilde trim",e),e=e.replace(dt[et.CARETTRIM],tP),ce("caret trim",e);let a=e.split(" ").map(h=>sP(h,this.options)).join(" ").split(/\s+/).map(h=>dP(h,this.options));s&&(a=a.filter(h=>(ce("loose invalid filter",h,this.options),!!h.match(dt[et.COMPARATORLOOSE])))),ce("range list",a);let l=new Map,c=a.map(h=>new Xh(h,this.options));for(let h of c){if(YA(h))return[h];l.set(h.value,h)}l.size>1&&l.has("")&&l.delete("");let u=[...l.values()];return VA.set(i,u),u}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(i=>QA(i,r)&&e.set.some(n=>QA(n,r)&&i.every(s=>n.every(o=>s.intersects(o,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new J1(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if(mP(this.set[r],e,this.options))return!0;return!1}};XA.exports=Qh;var X1=zA(),VA=new X1,K1=sl(),Xh=vo(),ce=bo(),J1=We(),{safeRe:dt,t:et,comparatorTrimReplace:Z1,tildeTrimReplace:eP,caretTrimReplace:tP}=Vn(),{FLAG_INCLUDE_PRERELEASE:rP,FLAG_LOOSE:iP}=So(),YA=t=>t.value==="<0.0.0-0",nP=t=>t.value==="",QA=(t,e)=>{let r=!0,i=t.slice(),n=i.pop();for(;r&&i.length;)r=i.every(s=>n.intersects(s,e)),n=i.pop();return r},sP=(t,e)=>(ce("comp",t,e),t=lP(t,e),ce("caret",t),t=oP(t,e),ce("tildes",t),t=cP(t,e),ce("xrange",t),t=fP(t,e),ce("stars",t),t),tt=t=>!t||t.toLowerCase()==="x"||t==="*",oP=(t,e)=>t.trim().split(/\s+/).map(r=>aP(r,e)).join(" "),aP=(t,e)=>{let r=e.loose?dt[et.TILDELOOSE]:dt[et.TILDE];return t.replace(r,(i,n,s,o,a)=>{ce("tilde",t,i,n,s,o,a);let l;return tt(n)?l="":tt(s)?l=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):tt(o)?l=">=".concat(n,".").concat(s,".0 <").concat(n,".").concat(+s+1,".0-0"):a?(ce("replaceTilde pr",a),l=">=".concat(n,".").concat(s,".").concat(o,"-").concat(a," <").concat(n,".").concat(+s+1,".0-0")):l=">=".concat(n,".").concat(s,".").concat(o," <").concat(n,".").concat(+s+1,".0-0"),ce("tilde return",l),l})},lP=(t,e)=>t.trim().split(/\s+/).map(r=>uP(r,e)).join(" "),uP=(t,e)=>{ce("caret",t,e);let r=e.loose?dt[et.CARETLOOSE]:dt[et.CARET],i=e.includePrerelease?"-0":"";return t.replace(r,(n,s,o,a,l)=>{ce("caret",t,n,s,o,a,l);let c;return tt(s)?c="":tt(o)?c=">=".concat(s,".0.0").concat(i," <").concat(+s+1,".0.0-0"):tt(a)?s==="0"?c=">=".concat(s,".").concat(o,".0").concat(i," <").concat(s,".").concat(+o+1,".0-0"):c=">=".concat(s,".").concat(o,".0").concat(i," <").concat(+s+1,".0.0-0"):l?(ce("replaceCaret pr",l),s==="0"?o==="0"?c=">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):c=">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(s,".").concat(+o+1,".0-0"):c=">=".concat(s,".").concat(o,".").concat(a,"-").concat(l," <").concat(+s+1,".0.0-0")):(ce("no pr"),s==="0"?o==="0"?c=">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(o,".").concat(+a+1,"-0"):c=">=".concat(s,".").concat(o,".").concat(a).concat(i," <").concat(s,".").concat(+o+1,".0-0"):c=">=".concat(s,".").concat(o,".").concat(a," <").concat(+s+1,".0.0-0")),ce("caret return",c),c})},cP=(t,e)=>(ce("replaceXRanges",t,e),t.split(/\s+/).map(r=>hP(r,e)).join(" ")),hP=(t,e)=>{t=t.trim();let r=e.loose?dt[et.XRANGELOOSE]:dt[et.XRANGE];return t.replace(r,(i,n,s,o,a,l)=>{ce("xRange",t,i,n,s,o,a,l);let c=tt(s),u=c||tt(o),h=u||tt(a),f=h;return n==="="&&f&&(n=""),l=e.includePrerelease?"-0":"",c?n===">"||n==="<"?i="<0.0.0-0":i="*":n&&f?(u&&(o=0),a=0,n===">"?(n=">=",u?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):n==="<="&&(n="<",u?s=+s+1:o=+o+1),n==="<"&&(l="-0"),i="".concat(n+s,".").concat(o,".").concat(a).concat(l)):u?i=">=".concat(s,".0.0").concat(l," <").concat(+s+1,".0.0-0"):h&&(i=">=".concat(s,".").concat(o,".0").concat(l," <").concat(s,".").concat(+o+1,".0-0")),ce("xRange return",i),i})},fP=(t,e)=>(ce("replaceStars",t,e),t.trim().replace(dt[et.STAR],"")),dP=(t,e)=>(ce("replaceGTE0",t,e),t.trim().replace(dt[e.includePrerelease?et.GTE0PRE:et.GTE0],"")),pP=t=>(e,r,i,n,s,o,a,l,c,u,h,f)=>(tt(i)?r="":tt(n)?r=">=".concat(i,".0.0").concat(t?"-0":""):tt(s)?r=">=".concat(i,".").concat(n,".0").concat(t?"-0":""):o?r=">=".concat(r):r=">=".concat(r).concat(t?"-0":""),tt(c)?l="":tt(u)?l="<".concat(+c+1,".0.0-0"):tt(h)?l="<".concat(c,".").concat(+u+1,".0-0"):f?l="<=".concat(c,".").concat(u,".").concat(h,"-").concat(f):t?l="<".concat(c,".").concat(u,".").concat(+h+1,"-0"):l="<=".concat(l),"".concat(r," ").concat(l).trim()),mP=(t,e,r)=>{for(let i=0;i<t.length;i++)if(!t[i].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let i=0;i<t.length;i++)if(ce(t[i].semver),t[i].semver!==Xh.ANY&&t[i].semver.prerelease.length>0){let n=t[i].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}return!1}return!0}});var vo=w((PH,rE)=>{"use strict";var Oo=Symbol("SemVer ANY"),Zh=class t{static get ANY(){return Oo}constructor(e,r){if(r=KA(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Jh("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Oo?this.value="":this.value=this.operator+this.semver.version,Jh("comp",this)}parse(e){let r=this.options.loose?JA[ZA.COMPARATORLOOSE]:JA[ZA.COMPARATOR],i=e.match(r);if(!i)throw new TypeError("Invalid comparator: ".concat(e));this.operator=i[1]!==void 0?i[1]:"",this.operator==="="&&(this.operator=""),i[2]?this.semver=new eE(i[2],this.options.loose):this.semver=Oo}toString(){return this.value}test(e){if(Jh("Comparator.test",e,this.options.loose),this.semver===Oo||e===Oo)return!0;if(typeof e=="string")try{e=new eE(e,this.options)}catch{return!1}return Kh(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new tE(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new tE(this.value,r).test(e.semver):(r=KA(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Kh(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Kh(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};rE.exports=Zh;var KA=sl(),{safeRe:JA,t:ZA}=Vn(),Kh=Vh(),Jh=bo(),eE=We(),tE=Pt()});var To=w((FH,iE)=>{"use strict";var gP=Pt(),yP=(t,e,r)=>{try{e=new gP(e,r)}catch{return!1}return e.test(t)};iE.exports=yP});var sE=w((LH,nE)=>{"use strict";var wP=Pt(),AP=(t,e)=>new wP(t,e).set.map(r=>r.map(i=>i.value).join(" ").trim().split(" "));nE.exports=AP});var aE=w(($H,oE)=>{"use strict";var EP=We(),SP=Pt(),bP=(t,e,r)=>{let i=null,n=null,s=null;try{s=new SP(e,r)}catch{return null}return t.forEach(o=>{s.test(o)&&(!i||n.compare(o)===-1)&&(i=o,n=new EP(i,r))}),i};oE.exports=bP});var uE=w((kH,lE)=>{"use strict";var _P=We(),vP=Pt(),OP=(t,e,r)=>{let i=null,n=null,s=null;try{s=new vP(e,r)}catch{return null}return t.forEach(o=>{s.test(o)&&(!i||n.compare(o)===1)&&(i=o,n=new _P(i,r))}),i};lE.exports=OP});var fE=w((qH,hE)=>{"use strict";var ef=We(),TP=Pt(),cE=_o(),CP=(t,e)=>{t=new TP(t,e);let r=new ef("0.0.0");if(t.test(r)||(r=new ef("0.0.0-0"),t.test(r)))return r;r=null;for(let i=0;i<t.set.length;++i){let n=t.set[i],s=null;n.forEach(o=>{let a=new ef(o.semver.version);switch(o.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!s||cE(a,s))&&(s=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(o.operator))}}),s&&(!r||cE(r,s))&&(r=s)}return r&&t.test(r)?r:null};hE.exports=CP});var pE=w((MH,dE)=>{"use strict";var RP=Pt(),IP=(t,e)=>{try{return new RP(t,e).range||"*"}catch{return null}};dE.exports=IP});var gl=w((UH,wE)=>{"use strict";var NP=We(),yE=vo(),{ANY:xP}=yE,DP=Pt(),PP=To(),mE=_o(),gE=hl(),FP=dl(),LP=fl(),$P=(t,e,r,i)=>{t=new NP(t,i),e=new DP(e,i);let n,s,o,a,l;switch(r){case">":n=mE,s=FP,o=gE,a=">",l=">=";break;case"<":n=gE,s=LP,o=mE,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(PP(t,e,i))return!1;for(let c=0;c<e.set.length;++c){let u=e.set[c],h=null,f=null;if(u.forEach(d=>{d.semver===xP&&(d=new yE(">=0.0.0")),h=h||d,f=f||d,n(d.semver,h.semver,i)?h=d:o(d.semver,f.semver,i)&&(f=d)}),h.operator===a||h.operator===l||(!f.operator||f.operator===a)&&s(t,f.semver))return!1;if(f.operator===l&&o(t,f.semver))return!1}return!0};wE.exports=$P});var EE=w((BH,AE)=>{"use strict";var kP=gl(),qP=(t,e,r)=>kP(t,e,">",r);AE.exports=qP});var bE=w((jH,SE)=>{"use strict";var MP=gl(),UP=(t,e,r)=>MP(t,e,"<",r);SE.exports=UP});var OE=w((HH,vE)=>{"use strict";var _E=Pt(),BP=(t,e,r)=>(t=new _E(t,r),e=new _E(e,r),t.intersects(e,r));vE.exports=BP});var CE=w((WH,TE)=>{"use strict";var jP=To(),HP=Dt();TE.exports=(t,e,r)=>{let i=[],n=null,s=null,o=t.sort((u,h)=>HP(u,h,r));for(let u of o)jP(u,e,r)?(s=u,n||(n=u)):(s&&i.push([n,s]),s=null,n=null);n&&i.push([n,null]);let a=[];for(let[u,h]of i)u===h?a.push(u):!h&&u===o[0]?a.push("*"):h?u===o[0]?a.push("<=".concat(h)):a.push("".concat(u," - ").concat(h)):a.push(">=".concat(u));let l=a.join(" || "),c=typeof e.raw=="string"?e.raw:String(e);return l.length<c.length?l:e}});var PE=w((GH,DE)=>{"use strict";var RE=Pt(),rf=vo(),{ANY:tf}=rf,Co=To(),nf=Dt(),WP=(t,e,r={})=>{if(t===e)return!0;t=new RE(t,r),e=new RE(e,r);let i=!1;e:for(let n of t.set){for(let s of e.set){let o=zP(n,s,r);if(i=i||o!==null,o)continue e}if(i)return!1}return!0},GP=[new rf(">=0.0.0-0")],IE=[new rf(">=0.0.0")],zP=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===tf){if(e.length===1&&e[0].semver===tf)return!0;r.includePrerelease?t=GP:t=IE}if(e.length===1&&e[0].semver===tf){if(r.includePrerelease)return!0;e=IE}let i=new Set,n,s;for(let d of t)d.operator===">"||d.operator===">="?n=NE(n,d,r):d.operator==="<"||d.operator==="<="?s=xE(s,d,r):i.add(d.semver);if(i.size>1)return null;let o;if(n&&s){if(o=nf(n.semver,s.semver,r),o>0)return null;if(o===0&&(n.operator!==">="||s.operator!=="<="))return null}for(let d of i){if(n&&!Co(d,String(n),r)||s&&!Co(d,String(s),r))return null;for(let y of e)if(!Co(d,String(y),r))return!1;return!0}let a,l,c,u,h=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,f=n&&!r.includePrerelease&&n.semver.prerelease.length?n.semver:!1;h&&h.prerelease.length===1&&s.operator==="<"&&h.prerelease[0]===0&&(h=!1);for(let d of e){if(u=u||d.operator===">"||d.operator===">=",c=c||d.operator==="<"||d.operator==="<=",n){if(f&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===f.major&&d.semver.minor===f.minor&&d.semver.patch===f.patch&&(f=!1),d.operator===">"||d.operator===">="){if(a=NE(n,d,r),a===d&&a!==n)return!1}else if(n.operator===">="&&!Co(n.semver,String(d),r))return!1}if(s){if(h&&d.semver.prerelease&&d.semver.prerelease.length&&d.semver.major===h.major&&d.semver.minor===h.minor&&d.semver.patch===h.patch&&(h=!1),d.operator==="<"||d.operator==="<="){if(l=xE(s,d,r),l===d&&l!==s)return!1}else if(s.operator==="<="&&!Co(s.semver,String(d),r))return!1}if(!d.operator&&(s||n)&&o!==0)return!1}return!(n&&c&&!s&&o!==0||s&&u&&!n&&o!==0||f||h)},NE=(t,e,r)=>{if(!t)return e;let i=nf(t.semver,e.semver,r);return i>0?t:i<0||e.operator===">"&&t.operator===">="?e:t},xE=(t,e,r)=>{if(!t)return e;let i=nf(t.semver,e.semver,r);return i<0?t:i>0||e.operator==="<"&&t.operator==="<="?e:t};DE.exports=WP});var of=w((zH,$E)=>{"use strict";var sf=Vn(),FE=So(),VP=We(),LE=Hh(),YP=Hi(),QP=aA(),XP=uA(),KP=fA(),JP=mA(),ZP=yA(),eF=AA(),tF=SA(),rF=_A(),iF=Dt(),nF=CA(),sF=IA(),oF=cl(),aF=PA(),lF=LA(),uF=_o(),cF=hl(),hF=Gh(),fF=zh(),dF=fl(),pF=dl(),mF=Vh(),gF=WA(),yF=vo(),wF=Pt(),AF=To(),EF=sE(),SF=aE(),bF=uE(),_F=fE(),vF=pE(),OF=gl(),TF=EE(),CF=bE(),RF=OE(),IF=CE(),NF=PE();$E.exports={parse:YP,valid:QP,clean:XP,inc:KP,diff:JP,major:ZP,minor:eF,patch:tF,prerelease:rF,compare:iF,rcompare:nF,compareLoose:sF,compareBuild:oF,sort:aF,rsort:lF,gt:uF,lt:cF,eq:hF,neq:fF,gte:dF,lte:pF,cmp:mF,coerce:gF,Comparator:yF,Range:wF,satisfies:AF,toComparators:EF,maxSatisfying:SF,minSatisfying:bF,minVersion:_F,validRange:vF,outside:OF,gtr:TF,ltr:CF,intersects:RF,simplifyRange:IF,subset:NF,SemVer:VP,re:sf.re,src:sf.src,tokens:sf.t,SEMVER_SPEC_VERSION:FE.SEMVER_SPEC_VERSION,RELEASE_TYPES:FE.RELEASE_TYPES,compareIdentifiers:LE.compareIdentifiers,rcompareIdentifiers:LE.rcompareIdentifiers}});var yS=w((Ro,Xn)=>{var xF=200,yf="__lodash_hash_undefined__",vl=1,YE=2,QE=9007199254740991,yl="[object Arguments]",cf="[object Array]",DF="[object AsyncFunction]",XE="[object Boolean]",KE="[object Date]",JE="[object Error]",ZE="[object Function]",PF="[object GeneratorFunction]",wl="[object Map]",eS="[object Number]",FF="[object Null]",Qn="[object Object]",kE="[object Promise]",LF="[object Proxy]",tS="[object RegExp]",Al="[object Set]",rS="[object String]",$F="[object Symbol]",kF="[object Undefined]",hf="[object WeakMap]",iS="[object ArrayBuffer]",El="[object DataView]",qF="[object Float32Array]",MF="[object Float64Array]",UF="[object Int8Array]",BF="[object Int16Array]",jF="[object Int32Array]",HF="[object Uint8Array]",WF="[object Uint8ClampedArray]",GF="[object Uint16Array]",zF="[object Uint32Array]",VF=/[\\^$.*+?()[\]{}|]/g,YF=/^\[object .+?Constructor\]$/,QF=/^(?:0|[1-9]\d*)$/,he={};he[qF]=he[MF]=he[UF]=he[BF]=he[jF]=he[HF]=he[WF]=he[GF]=he[zF]=!0;he[yl]=he[cf]=he[iS]=he[XE]=he[El]=he[KE]=he[JE]=he[ZE]=he[wl]=he[eS]=he[Qn]=he[tS]=he[Al]=he[rS]=he[hf]=!1;var nS=typeof global=="object"&&global&&global.Object===Object&&global,XF=typeof self=="object"&&self&&self.Object===Object&&self,Er=nS||XF||Function("return this")(),sS=typeof Ro=="object"&&Ro&&!Ro.nodeType&&Ro,qE=sS&&typeof Xn=="object"&&Xn&&!Xn.nodeType&&Xn,oS=qE&&qE.exports===sS,af=oS&&nS.process,ME=(function(){try{return af&&af.binding&&af.binding("util")}catch{}})(),UE=ME&&ME.isTypedArray;function KF(t,e){for(var r=-1,i=t==null?0:t.length,n=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[n++]=o)}return s}function JF(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}function ZF(t,e){for(var r=-1,i=t==null?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}function eL(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function tL(t){return function(e){return t(e)}}function rL(t,e){return t.has(e)}function iL(t,e){return t?.[e]}function nL(t){var e=-1,r=Array(t.size);return t.forEach(function(i,n){r[++e]=[n,i]}),r}function sL(t,e){return function(r){return t(e(r))}}function oL(t){var e=-1,r=Array(t.size);return t.forEach(function(i){r[++e]=i}),r}var aL=Array.prototype,lL=Function.prototype,Ol=Object.prototype,lf=Er["__core-js_shared__"],aS=lL.toString,nr=Ol.hasOwnProperty,BE=(function(){var t=/[^.]+$/.exec(lf&&lf.keys&&lf.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})(),lS=Ol.toString,uL=RegExp("^"+aS.call(nr).replace(VF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jE=oS?Er.Buffer:void 0,Sl=Er.Symbol,HE=Er.Uint8Array,uS=Ol.propertyIsEnumerable,cL=aL.splice,Wi=Sl?Sl.toStringTag:void 0,WE=Object.getOwnPropertySymbols,hL=jE?jE.isBuffer:void 0,fL=sL(Object.keys,Object),ff=Kn(Er,"DataView"),Io=Kn(Er,"Map"),df=Kn(Er,"Promise"),pf=Kn(Er,"Set"),mf=Kn(Er,"WeakMap"),No=Kn(Object,"create"),dL=Vi(ff),pL=Vi(Io),mL=Vi(df),gL=Vi(pf),yL=Vi(mf),GE=Sl?Sl.prototype:void 0,uf=GE?GE.valueOf:void 0;function Gi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function wL(){this.__data__=No?No(null):{},this.size=0}function AL(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function EL(t){var e=this.__data__;if(No){var r=e[t];return r===yf?void 0:r}return nr.call(e,t)?e[t]:void 0}function SL(t){var e=this.__data__;return No?e[t]!==void 0:nr.call(e,t)}function bL(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=No&&e===void 0?yf:e,this}Gi.prototype.clear=wL;Gi.prototype.delete=AL;Gi.prototype.get=EL;Gi.prototype.has=SL;Gi.prototype.set=bL;function Sr(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function _L(){this.__data__=[],this.size=0}function vL(t){var e=this.__data__,r=Tl(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():cL.call(e,r,1),--this.size,!0}function OL(t){var e=this.__data__,r=Tl(e,t);return r<0?void 0:e[r][1]}function TL(t){return Tl(this.__data__,t)>-1}function CL(t,e){var r=this.__data__,i=Tl(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}Sr.prototype.clear=_L;Sr.prototype.delete=vL;Sr.prototype.get=OL;Sr.prototype.has=TL;Sr.prototype.set=CL;function zi(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function RL(){this.size=0,this.__data__={hash:new Gi,map:new(Io||Sr),string:new Gi}}function IL(t){var e=Cl(this,t).delete(t);return this.size-=e?1:0,e}function NL(t){return Cl(this,t).get(t)}function xL(t){return Cl(this,t).has(t)}function DL(t,e){var r=Cl(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}zi.prototype.clear=RL;zi.prototype.delete=IL;zi.prototype.get=NL;zi.prototype.has=xL;zi.prototype.set=DL;function bl(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new zi;++e<r;)this.add(t[e])}function PL(t){return this.__data__.set(t,yf),this}function FL(t){return this.__data__.has(t)}bl.prototype.add=bl.prototype.push=PL;bl.prototype.has=FL;function ni(t){var e=this.__data__=new Sr(t);this.size=e.size}function LL(){this.__data__=new Sr,this.size=0}function $L(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function kL(t){return this.__data__.get(t)}function qL(t){return this.__data__.has(t)}function ML(t,e){var r=this.__data__;if(r instanceof Sr){var i=r.__data__;if(!Io||i.length<xF-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new zi(i)}return r.set(t,e),this.size=r.size,this}ni.prototype.clear=LL;ni.prototype.delete=$L;ni.prototype.get=kL;ni.prototype.has=qL;ni.prototype.set=ML;function UL(t,e){var r=_l(t),i=!r&&t$(t),n=!r&&!i&&gf(t),s=!r&&!i&&!n&&gS(t),o=r||i||n||s,a=o?eL(t.length,String):[],l=a.length;for(var c in t)(e||nr.call(t,c))&&!(o&&(c=="length"||n&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||XL(c,l)))&&a.push(c);return a}function Tl(t,e){for(var r=t.length;r--;)if(fS(t[r][0],e))return r;return-1}function BL(t,e,r){var i=e(t);return _l(t)?i:JF(i,r(t))}function Do(t){return t==null?t===void 0?kF:FF:Wi&&Wi in Object(t)?YL(t):e$(t)}function zE(t){return xo(t)&&Do(t)==yl}function cS(t,e,r,i,n){return t===e?!0:t==null||e==null||!xo(t)&&!xo(e)?t!==t&&e!==e:jL(t,e,r,i,cS,n)}function jL(t,e,r,i,n,s){var o=_l(t),a=_l(e),l=o?cf:ii(t),c=a?cf:ii(e);l=l==yl?Qn:l,c=c==yl?Qn:c;var u=l==Qn,h=c==Qn,f=l==c;if(f&&gf(t)){if(!gf(e))return!1;o=!0,u=!1}if(f&&!u)return s||(s=new ni),o||gS(t)?hS(t,e,r,i,n,s):zL(t,e,l,r,i,n,s);if(!(r&vl)){var d=u&&nr.call(t,"__wrapped__"),y=h&&nr.call(e,"__wrapped__");if(d||y){var A=d?t.value():t,E=y?e.value():e;return s||(s=new ni),n(A,E,r,i,s)}}return f?(s||(s=new ni),VL(t,e,r,i,n,s)):!1}function HL(t){if(!mS(t)||JL(t))return!1;var e=dS(t)?uL:YF;return e.test(Vi(t))}function WL(t){return xo(t)&&pS(t.length)&&!!he[Do(t)]}function GL(t){if(!ZL(t))return fL(t);var e=[];for(var r in Object(t))nr.call(t,r)&&r!="constructor"&&e.push(r);return e}function hS(t,e,r,i,n,s){var o=r&vl,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t);if(c&&s.get(e))return c==e;var u=-1,h=!0,f=r&YE?new bl:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var d=t[u],y=e[u];if(i)var A=o?i(y,d,u,e,t,s):i(d,y,u,t,e,s);if(A!==void 0){if(A)continue;h=!1;break}if(f){if(!ZF(e,function(E,v){if(!rL(f,v)&&(d===E||n(d,E,r,i,s)))return f.push(v)})){h=!1;break}}else if(!(d===y||n(d,y,r,i,s))){h=!1;break}}return s.delete(t),s.delete(e),h}function zL(t,e,r,i,n,s,o){switch(r){case El:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case iS:return!(t.byteLength!=e.byteLength||!s(new HE(t),new HE(e)));case XE:case KE:case eS:return fS(+t,+e);case JE:return t.name==e.name&&t.message==e.message;case tS:case rS:return t==e+"";case wl:var a=nL;case Al:var l=i&vl;if(a||(a=oL),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=YE,o.set(t,e);var u=hS(a(t),a(e),i,n,s,o);return o.delete(t),u;case $F:if(uf)return uf.call(t)==uf.call(e)}return!1}function VL(t,e,r,i,n,s){var o=r&vl,a=VE(t),l=a.length,c=VE(e),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var f=a[h];if(!(o?f in e:nr.call(e,f)))return!1}var d=s.get(t);if(d&&s.get(e))return d==e;var y=!0;s.set(t,e),s.set(e,t);for(var A=o;++h<l;){f=a[h];var E=t[f],v=e[f];if(i)var O=o?i(v,E,f,e,t,s):i(E,v,f,t,e,s);if(!(O===void 0?E===v||n(E,v,r,i,s):O)){y=!1;break}A||(A=f=="constructor")}if(y&&!A){var R=t.constructor,L=e.constructor;R!=L&&"constructor"in t&&"constructor"in e&&!(typeof R=="function"&&R instanceof R&&typeof L=="function"&&L instanceof L)&&(y=!1)}return s.delete(t),s.delete(e),y}function VE(t){return BL(t,n$,QL)}function Cl(t,e){var r=t.__data__;return KL(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Kn(t,e){var r=iL(t,e);return HL(r)?r:void 0}function YL(t){var e=nr.call(t,Wi),r=t[Wi];try{t[Wi]=void 0;var i=!0}catch{}var n=lS.call(t);return i&&(e?t[Wi]=r:delete t[Wi]),n}var QL=WE?function(t){return t==null?[]:(t=Object(t),KF(WE(t),function(e){return uS.call(t,e)}))}:s$,ii=Do;(ff&&ii(new ff(new ArrayBuffer(1)))!=El||Io&&ii(new Io)!=wl||df&&ii(df.resolve())!=kE||pf&&ii(new pf)!=Al||mf&&ii(new mf)!=hf)&&(ii=function(t){var e=Do(t),r=e==Qn?t.constructor:void 0,i=r?Vi(r):"";if(i)switch(i){case dL:return El;case pL:return wl;case mL:return kE;case gL:return Al;case yL:return hf}return e});function XL(t,e){return e=e??QE,!!e&&(typeof t=="number"||QF.test(t))&&t>-1&&t%1==0&&t<e}function KL(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function JL(t){return!!BE&&BE in t}function ZL(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Ol;return t===r}function e$(t){return lS.call(t)}function Vi(t){if(t!=null){try{return aS.call(t)}catch{}try{return t+""}catch{}}return""}function fS(t,e){return t===e||t!==t&&e!==e}var t$=zE((function(){return arguments})())?zE:function(t){return xo(t)&&nr.call(t,"callee")&&!uS.call(t,"callee")},_l=Array.isArray;function r$(t){return t!=null&&pS(t.length)&&!dS(t)}var gf=hL||o$;function i$(t,e){return cS(t,e)}function dS(t){if(!mS(t))return!1;var e=Do(t);return e==ZE||e==PF||e==DF||e==LF}function pS(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=QE}function mS(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function xo(t){return t!=null&&typeof t=="object"}var gS=UE?tL(UE):WL;function n$(t){return r$(t)?UL(t):GL(t)}function s$(){return[]}function o$(){return!1}Xn.exports=i$});var AS=w(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.DownloadedUpdateHelper=void 0;Fo.createTempUpdateFile=c$;var a$=require("crypto"),l$=require("fs"),wS=yS(),Yi=wr(),Po=require("path"),wf=class{constructor(e){this.cacheDir=e,this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,this._downloadedFileInfo=null}get downloadedFileInfo(){return this._downloadedFileInfo}get file(){return this._file}get packageFile(){return this._packageFile}get cacheDirForPendingUpdate(){return Po.join(this.cacheDir,"pending")}async validateDownloadedPath(e,r,i,n){if(this.versionInfo!=null&&this.file===e&&this.fileInfo!=null)return wS(this.versionInfo,r)&&wS(this.fileInfo.info,i.info)&&await(0,Yi.pathExists)(e)?e:null;let s=await this.getValidCachedUpdateFile(i,n);return s===null?null:(n.info("Update has already been downloaded to ".concat(e,").")),this._file=s,s)}async setDownloadedFile(e,r,i,n,s,o){this._file=e,this._packageFile=r,this.versionInfo=i,this.fileInfo=n,this._downloadedFileInfo={fileName:s,sha512:n.info.sha512,isAdminRightsRequired:n.info.isAdminRightsRequired===!0},o&&await(0,Yi.outputJson)(this.getUpdateInfoFile(),this._downloadedFileInfo)}async clear(){this._file=null,this._packageFile=null,this.versionInfo=null,this.fileInfo=null,await this.cleanCacheDirForPendingUpdate()}async cleanCacheDirForPendingUpdate(){try{await(0,Yi.emptyDir)(this.cacheDirForPendingUpdate)}catch{}}async getValidCachedUpdateFile(e,r){let i=this.getUpdateInfoFile();if(!await(0,Yi.pathExists)(i))return null;let s;try{s=await(0,Yi.readJson)(i)}catch(c){let u="No cached update info available";return c.code!=="ENOENT"&&(await this.cleanCacheDirForPendingUpdate(),u+=" (error on read: ".concat(c.message,")")),r.info(u),null}if(!(s?.fileName!==null))return r.warn("Cached update info is corrupted: no fileName, directory for cached update will be cleaned"),await this.cleanCacheDirForPendingUpdate(),null;if(e.info.sha512!==s.sha512)return r.info("Cached update sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ".concat(s.sha512,", expected: ").concat(e.info.sha512,". Directory for cached update will be cleaned")),await this.cleanCacheDirForPendingUpdate(),null;let a=Po.join(this.cacheDirForPendingUpdate,s.fileName);if(!await(0,Yi.pathExists)(a))return r.info("Cached update file doesn't exist"),null;let l=await u$(a);return e.info.sha512!==l?(r.warn("Sha512 checksum doesn't match the latest available update. New update must be downloaded. Cached: ".concat(l,", expected: ").concat(e.info.sha512)),await this.cleanCacheDirForPendingUpdate(),null):(this._downloadedFileInfo=s,a)}getUpdateInfoFile(){return Po.join(this.cacheDirForPendingUpdate,"update-info.json")}};Fo.DownloadedUpdateHelper=wf;function u$(t,e="sha512",r="base64",i){return new Promise((n,s)=>{let o=(0,a$.createHash)(e);o.on("error",s).setEncoding(r),(0,l$.createReadStream)(t,{...i,highWaterMark:1024*1024}).on("error",s).on("end",()=>{o.end(),n(o.read())}).pipe(o,{end:!1})})}async function c$(t,e,r){let i=0,n=Po.join(e,t);for(let s=0;s<3;s++)try{return await(0,Yi.unlink)(n),n}catch(o){if(o.code==="ENOENT")return n;r.warn("Error on remove temp update file: ".concat(o)),n=Po.join(e,"".concat(i++,"-").concat(t))}return n}});var ES=w(Ef=>{"use strict";Object.defineProperty(Ef,"__esModule",{value:!0});Ef.getAppCacheDir=f$;var Af=require("path"),h$=require("os");function f$(){let t=(0,h$.homedir)(),e;return process.platform==="win32"?e=process.env.LOCALAPPDATA||Af.join(t,"AppData","Local"):process.platform==="darwin"?e=Af.join(t,"Library","Caches"):e=process.env.XDG_CACHE_HOME||Af.join(t,".cache"),e}});var bS=w(Rl=>{"use strict";Object.defineProperty(Rl,"__esModule",{value:!0});Rl.ElectronAppAdapter=void 0;var SS=require("path"),d$=ES(),Sf=class{constructor(e=require("electron").app){this.app=e}whenReady(){return this.app.whenReady()}get version(){return this.app.getVersion()}get name(){return this.app.getName()}get isPackaged(){return this.app.isPackaged===!0}get appUpdateConfigPath(){return this.isPackaged?SS.join(process.resourcesPath,"app-update.yml"):SS.join(this.app.getAppPath(),"dev-app-update.yml")}get userDataPath(){return this.app.getPath("userData")}get baseCachePath(){return(0,d$.getAppCacheDir)()}quit(){this.app.quit()}relaunch(){this.app.relaunch()}onQuit(e){this.app.once("quit",(r,i)=>e(i))}};Rl.ElectronAppAdapter=Sf});var vS=w(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.ElectronHttpExecutor=si.NET_SESSION_NAME=void 0;si.getNetSession=_S;var Il=xe();si.NET_SESSION_NAME="electron-updater";function _S(){return require("electron").session.fromPartition(si.NET_SESSION_NAME,{cache:!1})}var bf=class extends Il.HttpExecutor{constructor(e){super(),this.proxyLoginCallback=e,this.cachedSession=null}async download(e,r,i){return await i.cancellationToken.createPromise((n,s,o)=>{let a={headers:i.headers||void 0,redirect:"manual"};(0,Il.configureRequestUrl)(e,a),(0,Il.configureRequestOptions)(a),this.doDownload(a,{destination:r,options:i,onCancel:o,callback:l=>{l==null?n(r):s(l)},responseHandler:null},0)})}createRequest(e,r){e.headers&&e.headers.Host&&(e.host=e.headers.Host,delete e.headers.Host),this.cachedSession==null&&(this.cachedSession=_S());let i=require("electron").net.request({...e,session:this.cachedSession});return i.on("response",r),this.proxyLoginCallback!=null&&i.on("login",this.proxyLoginCallback),i}addRedirectHandlers(e,r,i,n,s){e.on("redirect",(o,a,l)=>{e.abort(),n>this.maxRedirects?i(this.createMaxRedirectError()):s(Il.HttpExecutor.prepareRedirectUrlOptions(l,r))})}};si.ElectronHttpExecutor=bf});var NS=w((KH,IS)=>{var p$=1/0,m$="[object Symbol]",RS=/[\\^$.*+?()[\]{}|]/g,g$=RegExp(RS.source),y$=typeof global=="object"&&global&&global.Object===Object&&global,w$=typeof self=="object"&&self&&self.Object===Object&&self,A$=y$||w$||Function("return this")(),E$=Object.prototype,S$=E$.toString,OS=A$.Symbol,TS=OS?OS.prototype:void 0,CS=TS?TS.toString:void 0;function b$(t){if(typeof t=="string")return t;if(v$(t))return CS?CS.call(t):"";var e=t+"";return e=="0"&&1/t==-p$?"-0":e}function _$(t){return!!t&&typeof t=="object"}function v$(t){return typeof t=="symbol"||_$(t)&&S$.call(t)==m$}function O$(t){return t==null?"":b$(t)}function T$(t){return t=O$(t),t&&g$.test(t)?t.replace(RS,"\\$&"):t}IS.exports=T$});var oi=w(Jn=>{"use strict";Object.defineProperty(Jn,"__esModule",{value:!0});Jn.newBaseUrl=R$;Jn.newUrlFromBase=_f;Jn.getChannelFilename=I$;Jn.blockmapFiles=N$;var xS=require("url"),C$=NS();function R$(t){let e=new xS.URL(t);return e.pathname.endsWith("/")||(e.pathname+="/"),e}function _f(t,e,r=!1){let i=new xS.URL(t,e),n=e.search;return n!=null&&n.length!==0?i.search=n:r&&(i.search="noCache=".concat(Date.now().toString(32))),i}function I$(t){return"".concat(t,".yml")}function N$(t,e,r){let i=_f("".concat(t.pathname,".blockmap"),t);return[_f("".concat(t.pathname.replace(new RegExp(C$(r),"g"),e),".blockmap"),t),i]}});var _t=w(li=>{"use strict";Object.defineProperty(li,"__esModule",{value:!0});li.Provider=void 0;li.findFile=D$;li.parseUpdateInfo=P$;li.getFileList=PS;li.resolveFiles=F$;var ai=xe(),x$=il(),DS=oi(),vf=class{constructor(e){this.runtimeOptions=e,this.requestHeaders=null,this.executor=e.executor}get isUseMultipleRangeRequest(){return this.runtimeOptions.isUseMultipleRangeRequest!==!1}getChannelFilePrefix(){if(this.runtimeOptions.platform==="linux"){let e=process.env.TEST_UPDATER_ARCH||process.arch;return"-linux"+(e==="x64"?"":"-".concat(e))}else return this.runtimeOptions.platform==="darwin"?"-mac":""}getDefaultChannelName(){return this.getCustomChannelName("latest")}getCustomChannelName(e){return"".concat(e).concat(this.getChannelFilePrefix())}get fileExtraDownloadHeaders(){return null}setRequestHeaders(e){this.requestHeaders=e}httpRequest(e,r,i){return this.executor.request(this.createRequestOptions(e,r),i)}createRequestOptions(e,r){let i={};return this.requestHeaders==null?r!=null&&(i.headers=r):i.headers=r==null?this.requestHeaders:{...this.requestHeaders,...r},(0,ai.configureRequestUrl)(e,i),i}};li.Provider=vf;function D$(t,e,r){if(t.length===0)throw(0,ai.newError)("No files provided","ERR_UPDATER_NO_FILES_PROVIDED");let i=t.find(n=>n.url.pathname.toLowerCase().endsWith(".".concat(e)));return i??(r==null?t[0]:t.find(n=>!r.some(s=>n.url.pathname.toLowerCase().endsWith(".".concat(s)))))}function P$(t,e,r){if(t==null)throw(0,ai.newError)("Cannot parse update info from ".concat(e," in the latest release artifacts (").concat(r,"): rawData: null"),"ERR_UPDATER_INVALID_UPDATE_INFO");let i;try{i=(0,x$.load)(t)}catch(n){throw(0,ai.newError)("Cannot parse update info from ".concat(e," in the latest release artifacts (").concat(r,"): ").concat(n.stack||n.message,", rawData: ").concat(t),"ERR_UPDATER_INVALID_UPDATE_INFO")}return i}function PS(t){let e=t.files;if(e!=null&&e.length>0)return e;if(t.path!=null)return[{url:t.path,sha2:t.sha2,sha512:t.sha512}];throw(0,ai.newError)("No files provided: ".concat((0,ai.safeStringifyJson)(t)),"ERR_UPDATER_NO_FILES_PROVIDED")}function F$(t,e,r=i=>i){let n=PS(t).map(a=>{if(a.sha2==null&&a.sha512==null)throw(0,ai.newError)("Update info doesn't contain nor sha256 neither sha512 checksum: ".concat((0,ai.safeStringifyJson)(a)),"ERR_UPDATER_NO_CHECKSUM");return{url:(0,DS.newUrlFromBase)(r(a.url),e),info:a}}),s=t.packages,o=s==null?null:s[process.arch]||s.ia32;return o!=null&&(n[0].packageInfo={...o,path:(0,DS.newUrlFromBase)(r(o.path),e).href}),n}});var Rf=w(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});Nl.GenericProvider=void 0;var FS=xe(),Of=oi(),Tf=_t(),Cf=class extends Tf.Provider{constructor(e,r,i){super(i),this.configuration=e,this.updater=r,this.baseUrl=(0,Of.newBaseUrl)(this.configuration.url)}get channel(){let e=this.updater.channel||this.configuration.channel;return e==null?this.getDefaultChannelName():this.getCustomChannelName(e)}async getLatestVersion(){let e=(0,Of.getChannelFilename)(this.channel),r=(0,Of.newUrlFromBase)(e,this.baseUrl,this.updater.isAddNoCacheQuery);for(let i=0;;i++)try{return(0,Tf.parseUpdateInfo)(await this.httpRequest(r),e,r)}catch(n){if(n instanceof FS.HttpError&&n.statusCode===404)throw(0,FS.newError)('Cannot find channel "'.concat(e,'" update info: ').concat(n.stack||n.message),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");if(n.code==="ECONNREFUSED"&&i<3){await new Promise((s,o)=>{try{setTimeout(s,1e3*i)}catch(a){o(a)}});continue}throw n}}resolveFiles(e){return(0,Tf.resolveFiles)(e,this.baseUrl)}};Nl.GenericProvider=Cf});var $S=w(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});xl.BitbucketProvider=void 0;var LS=xe(),If=oi(),Nf=_t(),xf=class extends Nf.Provider{constructor(e,r,i){super({...i,isUseMultipleRangeRequest:!1}),this.configuration=e,this.updater=r;let{owner:n,slug:s}=e;this.baseUrl=(0,If.newBaseUrl)("https://api.bitbucket.org/2.0/repositories/".concat(n,"/").concat(s,"/downloads"))}get channel(){return this.updater.channel||this.configuration.channel||"latest"}async getLatestVersion(){let e=new LS.CancellationToken,r=(0,If.getChannelFilename)(this.getCustomChannelName(this.channel)),i=(0,If.newUrlFromBase)(r,this.baseUrl,this.updater.isAddNoCacheQuery);try{let n=await this.httpRequest(i,void 0,e);return(0,Nf.parseUpdateInfo)(n,r,i)}catch(n){throw(0,LS.newError)("Unable to find latest version on ".concat(this.toString(),", please ensure release exists: ").concat(n.stack||n.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(e){return(0,Nf.resolveFiles)(e,this.baseUrl)}toString(){let{owner:e,slug:r}=this.configuration;return"Bitbucket (owner: ".concat(e,", slug: ").concat(r,", channel: ").concat(this.channel,")")}};xl.BitbucketProvider=xf});var Lf=w(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.GitHubProvider=Qi.BaseGitHubProvider=void 0;Qi.computeReleaseNotes=qS;var br=xe(),Zn=of(),L$=require("url"),es=oi(),Pf=_t(),Df=/\/tag\/([^/]+)$/,Dl=class extends Pf.Provider{constructor(e,r,i){super({...i,isUseMultipleRangeRequest:!1}),this.options=e,this.baseUrl=(0,es.newBaseUrl)((0,br.githubUrl)(e,r));let n=r==="github.com"?"api.github.com":r;this.baseApiUrl=(0,es.newBaseUrl)((0,br.githubUrl)(e,n))}computeGithubBasePath(e){let r=this.options.host;return r&&!["github.com","api.github.com"].includes(r)?"/api/v3".concat(e):e}};Qi.BaseGitHubProvider=Dl;var Ff=class extends Dl{constructor(e,r,i){super(e,"github.com",i),this.options=e,this.updater=r}get channel(){let e=this.updater.channel||this.options.channel;return e==null?this.getDefaultChannelName():this.getCustomChannelName(e)}async getLatestVersion(){var e,r,i,n,s;let o=new br.CancellationToken,a=await this.httpRequest((0,es.newUrlFromBase)("".concat(this.basePath,".atom"),this.baseUrl),{accept:"application/xml, application/atom+xml, text/xml, */*"},o),l=(0,br.parseXml)(a),c=l.element("entry",!1,"No published versions on GitHub"),u=null;try{if(this.updater.allowPrerelease){let E=((e=this.updater)===null||e===void 0?void 0:e.channel)||((r=Zn.prerelease(this.updater.currentVersion))===null||r===void 0?void 0:r[0])||null;if(E===null)u=Df.exec(c.element("link").attribute("href"))[1];else for(let v of l.getElements("entry")){let O=Df.exec(v.element("link").attribute("href"));if(O===null)continue;let R=O[1],L=((i=Zn.prerelease(R))===null||i===void 0?void 0:i[0])||null,oe=!E||["alpha","beta"].includes(E),G=L!==null&&!["alpha","beta"].includes(String(L));if(oe&&!G&&!(E==="beta"&&L==="alpha")){u=R;break}if(L&&L===E){u=R;break}}}else{u=await this.getLatestTagName(o);for(let E of l.getElements("entry"))if(Df.exec(E.element("link").attribute("href"))[1]===u){c=E;break}}}catch(E){throw(0,br.newError)("Cannot parse releases feed: ".concat(E.stack||E.message,",\nXML:\n").concat(a),"ERR_UPDATER_INVALID_RELEASE_FEED")}if(u==null)throw(0,br.newError)("No published versions on GitHub","ERR_UPDATER_NO_PUBLISHED_VERSIONS");let h,f="",d="",y=async E=>{f=(0,es.getChannelFilename)(E),d=(0,es.newUrlFromBase)(this.getBaseDownloadPath(String(u),f),this.baseUrl);let v=this.createRequestOptions(d);try{return await this.executor.request(v,o)}catch(O){throw O instanceof br.HttpError&&O.statusCode===404?(0,br.newError)("Cannot find ".concat(f," in the latest release artifacts (").concat(d,"): ").concat(O.stack||O.message),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):O}};try{let E=this.channel;this.updater.allowPrerelease&&(!((n=Zn.prerelease(u))===null||n===void 0)&&n[0])&&(E=this.getCustomChannelName(String((s=Zn.prerelease(u))===null||s===void 0?void 0:s[0]))),h=await y(E)}catch(E){if(this.updater.allowPrerelease)h=await y(this.getDefaultChannelName());else throw E}let A=(0,Pf.parseUpdateInfo)(h,f,d);return A.releaseName==null&&(A.releaseName=c.elementValueOrEmpty("title")),A.releaseNotes==null&&(A.releaseNotes=qS(this.updater.currentVersion,this.updater.fullChangelog,l,c)),{tag:u,...A}}async getLatestTagName(e){let r=this.options,i=r.host==null||r.host==="github.com"?(0,es.newUrlFromBase)("".concat(this.basePath,"/latest"),this.baseUrl):new L$.URL("".concat(this.computeGithubBasePath("/repos/".concat(r.owner,"/").concat(r.repo,"/releases")),"/latest"),this.baseApiUrl);try{let n=await this.httpRequest(i,{Accept:"application/json"},e);return n==null?null:JSON.parse(n).tag_name}catch(n){throw(0,br.newError)("Unable to find latest version on GitHub (".concat(i,"), please ensure a production release exists: ").concat(n.stack||n.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return"/".concat(this.options.owner,"/").concat(this.options.repo,"/releases")}resolveFiles(e){return(0,Pf.resolveFiles)(e,this.baseUrl,r=>this.getBaseDownloadPath(e.tag,r.replace(/ /g,"-")))}getBaseDownloadPath(e,r){return"".concat(this.basePath,"/download/").concat(e,"/").concat(r)}};Qi.GitHubProvider=Ff;function kS(t){let e=t.elementValueOrEmpty("content");return e==="No content."?"":e}function qS(t,e,r,i){if(!e)return kS(i);let n=[];for(let s of r.getElements("entry")){let o=/\/tag\/v?([^/]+)$/.exec(s.element("link").attribute("href"))[1];Zn.lt(t,o)&&n.push({version:o,note:kS(s)})}return n.sort((s,o)=>Zn.rcompare(s.version,o.version))}});var US=w(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.KeygenProvider=void 0;var MS=xe(),$f=oi(),kf=_t(),qf=class extends kf.Provider{constructor(e,r,i){super({...i,isUseMultipleRangeRequest:!1}),this.configuration=e,this.updater=r,this.defaultHostname="api.keygen.sh";let n=this.configuration.host||this.defaultHostname;this.baseUrl=(0,$f.newBaseUrl)("https://".concat(n,"/v1/accounts/").concat(this.configuration.account,"/artifacts?product=").concat(this.configuration.product))}get channel(){return this.updater.channel||this.configuration.channel||"stable"}async getLatestVersion(){let e=new MS.CancellationToken,r=(0,$f.getChannelFilename)(this.getCustomChannelName(this.channel)),i=(0,$f.newUrlFromBase)(r,this.baseUrl,this.updater.isAddNoCacheQuery);try{let n=await this.httpRequest(i,{Accept:"application/vnd.api+json","Keygen-Version":"1.1"},e);return(0,kf.parseUpdateInfo)(n,r,i)}catch(n){throw(0,MS.newError)("Unable to find latest version on ".concat(this.toString(),", please ensure release exists: ").concat(n.stack||n.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}resolveFiles(e){return(0,kf.resolveFiles)(e,this.baseUrl)}toString(){let{account:e,product:r,platform:i}=this.configuration;return"Keygen (account: ".concat(e,", product: ").concat(r,", platform: ").concat(i,", channel: ").concat(this.channel,")")}};Pl.KeygenProvider=qf});var HS=w(Fl=>{"use strict";Object.defineProperty(Fl,"__esModule",{value:!0});Fl.PrivateGitHubProvider=void 0;var ts=xe(),$$=il(),k$=require("path"),BS=require("url"),jS=oi(),q$=Lf(),M$=_t(),Mf=class extends q$.BaseGitHubProvider{constructor(e,r,i,n){super(e,"api.github.com",n),this.updater=r,this.token=i}createRequestOptions(e,r){let i=super.createRequestOptions(e,r);return i.redirect="manual",i}async getLatestVersion(){let e=new ts.CancellationToken,r=(0,jS.getChannelFilename)(this.getDefaultChannelName()),i=await this.getLatestVersionInfo(e),n=i.assets.find(a=>a.name===r);if(n==null)throw(0,ts.newError)("Cannot find ".concat(r," in the release ").concat(i.html_url||i.name),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND");let s=new BS.URL(n.url),o;try{o=(0,$$.load)(await this.httpRequest(s,this.configureHeaders("application/octet-stream"),e))}catch(a){throw a instanceof ts.HttpError&&a.statusCode===404?(0,ts.newError)("Cannot find ".concat(r," in the latest release artifacts (").concat(s,"): ").concat(a.stack||a.message),"ERR_UPDATER_CHANNEL_FILE_NOT_FOUND"):a}return o.assets=i.assets,o}get fileExtraDownloadHeaders(){return this.configureHeaders("application/octet-stream")}configureHeaders(e){return{accept:e,authorization:"token ".concat(this.token)}}async getLatestVersionInfo(e){let r=this.updater.allowPrerelease,i=this.basePath;r||(i="".concat(i,"/latest"));let n=(0,jS.newUrlFromBase)(i,this.baseUrl);try{let s=JSON.parse(await this.httpRequest(n,this.configureHeaders("application/vnd.github.v3+json"),e));return r?s.find(o=>o.prerelease)||s[0]:s}catch(s){throw(0,ts.newError)("Unable to find latest version on GitHub (".concat(n,"), please ensure a production release exists: ").concat(s.stack||s.message),"ERR_UPDATER_LATEST_VERSION_NOT_FOUND")}}get basePath(){return this.computeGithubBasePath("/repos/".concat(this.options.owner,"/").concat(this.options.repo,"/releases"))}resolveFiles(e){return(0,M$.getFileList)(e).map(r=>{let i=k$.posix.basename(r.url).replace(/ /g,"-"),n=e.assets.find(s=>s!=null&&s.name===i);if(n==null)throw(0,ts.newError)('Cannot find asset "'.concat(i,'" in: ').concat(JSON.stringify(e.assets,null,2)),"ERR_UPDATER_ASSET_NOT_FOUND");return{url:new BS.URL(n.url),info:r}})}};Fl.PrivateGitHubProvider=Mf});var zS=w($l=>{"use strict";Object.defineProperty($l,"__esModule",{value:!0});$l.isUrlProbablySupportMultiRangeRequests=GS;$l.createClient=W$;var Ll=xe(),U$=$S(),WS=Rf(),B$=Lf(),j$=US(),H$=HS();function GS(t){return!t.includes("s3.amazonaws.com")}function W$(t,e,r){if(typeof t=="string")throw(0,Ll.newError)("Please pass PublishConfiguration object","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");let i=t.provider;switch(i){case"github":{let n=t,s=(n.private?process.env.GH_TOKEN||process.env.GITHUB_TOKEN:null)||n.token;return s==null?new B$.GitHubProvider(n,e,r):new H$.PrivateGitHubProvider(n,e,s,r)}case"bitbucket":return new U$.BitbucketProvider(t,e,r);case"keygen":return new j$.KeygenProvider(t,e,r);case"s3":case"spaces":return new WS.GenericProvider({provider:"generic",url:(0,Ll.getS3LikeProviderBaseUrl)(t),channel:t.channel||null},e,{...r,isUseMultipleRangeRequest:!1});case"generic":{let n=t;return new WS.GenericProvider(n,e,{...r,isUseMultipleRangeRequest:n.useMultipleRangeRequest!==!1&&GS(n.url)})}case"custom":{let n=t,s=n.updateProvider;if(!s)throw(0,Ll.newError)("Custom provider not specified","ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION");return new s(n,e,r)}default:throw(0,Ll.newError)("Unsupported provider: ".concat(i),"ERR_UPDATER_UNSUPPORTED_PROVIDER")}}});var kl=w(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.OperationKind=void 0;Lo.computeOperations=G$;var Xi;(function(t){t[t.COPY=0]="COPY",t[t.DOWNLOAD=1]="DOWNLOAD"})(Xi||(Lo.OperationKind=Xi={}));function G$(t,e,r){let i=YS(t.files),n=YS(e.files),s=null,o=e.files[0],a=[],l=o.name,c=i.get(l);if(c==null)throw new Error("no file ".concat(l," in old blockmap"));let u=n.get(l),h=0,{checksumToOffset:f,checksumToOldSize:d}=V$(i.get(l),c.offset,r),y=o.offset;for(let A=0;A<u.checksums.length;y+=u.sizes[A],A++){let E=u.sizes[A],v=u.checksums[A],O=f.get(v);O!=null&&d.get(v)!==E&&(r.warn('Checksum ("'.concat(v,'") matches, but size differs (old: ').concat(d.get(v),", new: ").concat(E,")")),O=void 0),O===void 0?(h++,s!=null&&s.kind===Xi.DOWNLOAD&&s.end===y?s.end+=E:(s={kind:Xi.DOWNLOAD,start:y,end:y+E},VS(s,a,v,A))):s!=null&&s.kind===Xi.COPY&&s.end===O?s.end+=E:(s={kind:Xi.COPY,start:O,end:O+E},VS(s,a,v,A))}return h>0&&r.info("File".concat(o.name==="file"?"":" "+o.name," has ").concat(h," changed blocks")),a}var z$=process.env.DIFFERENTIAL_DOWNLOAD_PLAN_BUILDER_VALIDATE_RANGES==="true";function VS(t,e,r,i){if(z$&&e.length!==0){let n=e[e.length-1];if(n.kind===t.kind&&t.start<n.end&&t.start>n.start){let s=[n.start,n.end,t.start,t.end].reduce((o,a)=>o<a?o:a);throw new Error("operation (block index: ".concat(i,", checksum: ").concat(r,", kind: ").concat(Xi[t.kind],") overlaps previous operation (checksum: ").concat(r,"):\n")+"abs: ".concat(n.start," until ").concat(n.end," and ").concat(t.start," until ").concat(t.end,"\n")+"rel: ".concat(n.start-s," until ").concat(n.end-s," and ").concat(t.start-s," until ").concat(t.end-s))}}e.push(t)}function V$(t,e,r){let i=new Map,n=new Map,s=e;for(let o=0;o<t.checksums.length;o++){let a=t.checksums[o],l=t.sizes[o],c=n.get(a);if(c===void 0)i.set(a,s),n.set(a,l);else if(r.debug!=null){let u=c===l?"(same size)":"(size: ".concat(c,", this size: ").concat(l,")");r.debug("".concat(a," duplicated in blockmap ").concat(u,", it doesn't lead to broken differential downloader, just corresponding block will be skipped)"))}s+=l}return{checksumToOffset:i,checksumToOldSize:n}}function YS(t){let e=new Map;for(let r of t)e.set(r.name,r);return e}});var Bf=w($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.DataSplitter=void 0;$o.copyData=XS;var ql=xe(),Y$=require("fs"),Q$=require("stream"),X$=kl(),QS=Buffer.from("\r\n\r\n"),ui;(function(t){t[t.INIT=0]="INIT",t[t.HEADER=1]="HEADER",t[t.BODY=2]="BODY"})(ui||(ui={}));function XS(t,e,r,i,n){let s=(0,Y$.createReadStream)("",{fd:r,autoClose:!1,start:t.start,end:t.end-1});s.on("error",i),s.once("end",n),s.pipe(e,{end:!1})}var Uf=class extends Q$.Writable{constructor(e,r,i,n,s,o){super(),this.out=e,this.options=r,this.partIndexToTaskIndex=i,this.partIndexToLength=s,this.finishHandler=o,this.partIndex=-1,this.headerListBuffer=null,this.readState=ui.INIT,this.ignoreByteCount=0,this.remainingPartDataCount=0,this.actualPartLength=0,this.boundaryLength=n.length+4,this.ignoreByteCount=this.boundaryLength-2}get isFinished(){return this.partIndex===this.partIndexToLength.length}_write(e,r,i){if(this.isFinished){console.error("Trailing ignored data: ".concat(e.length," bytes"));return}this.handleData(e).then(i).catch(i)}async handleData(e){let r=0;if(this.ignoreByteCount!==0&&this.remainingPartDataCount!==0)throw(0,ql.newError)("Internal error","ERR_DATA_SPLITTER_BYTE_COUNT_MISMATCH");if(this.ignoreByteCount>0){let i=Math.min(this.ignoreByteCount,e.length);this.ignoreByteCount-=i,r=i}else if(this.remainingPartDataCount>0){let i=Math.min(this.remainingPartDataCount,e.length);this.remainingPartDataCount-=i,await this.processPartData(e,0,i),r=i}if(r!==e.length){if(this.readState===ui.HEADER){let i=this.searchHeaderListEnd(e,r);if(i===-1)return;r=i,this.readState=ui.BODY,this.headerListBuffer=null}for(;;){if(this.readState===ui.BODY)this.readState=ui.INIT;else{this.partIndex++;let o=this.partIndexToTaskIndex.get(this.partIndex);if(o==null)if(this.isFinished)o=this.options.end;else throw(0,ql.newError)("taskIndex is null","ERR_DATA_SPLITTER_TASK_INDEX_IS_NULL");let a=this.partIndex===0?this.options.start:this.partIndexToTaskIndex.get(this.partIndex-1)+1;if(a<o)await this.copyExistingData(a,o);else if(a>o)throw(0,ql.newError)("prevTaskIndex must be < taskIndex","ERR_DATA_SPLITTER_TASK_INDEX_ASSERT_FAILED");if(this.isFinished){this.onPartEnd(),this.finishHandler();return}if(r=this.searchHeaderListEnd(e,r),r===-1){this.readState=ui.HEADER;return}}let i=this.partIndexToLength[this.partIndex],n=r+i,s=Math.min(n,e.length);if(await this.processPartStarted(e,r,s),this.remainingPartDataCount=i-(s-r),this.remainingPartDataCount>0)return;if(r=n+this.boundaryLength,r>=e.length){this.ignoreByteCount=this.boundaryLength-(e.length-n);return}}}}copyExistingData(e,r){return new Promise((i,n)=>{let s=()=>{if(e===r){i();return}let o=this.options.tasks[e];if(o.kind!==X$.OperationKind.COPY){n(new Error("Task kind must be COPY"));return}XS(o,this.out,this.options.oldFileFd,n,()=>{e++,s()})};s()})}searchHeaderListEnd(e,r){let i=e.indexOf(QS,r);if(i!==-1)return i+QS.length;let n=r===0?e:e.slice(r);return this.headerListBuffer==null?this.headerListBuffer=n:this.headerListBuffer=Buffer.concat([this.headerListBuffer,n]),-1}onPartEnd(){let e=this.partIndexToLength[this.partIndex-1];if(this.actualPartLength!==e)throw(0,ql.newError)("Expected length: ".concat(e," differs from actual: ").concat(this.actualPartLength),"ERR_DATA_SPLITTER_LENGTH_MISMATCH");this.actualPartLength=0}processPartStarted(e,r,i){return this.partIndex!==0&&this.onPartEnd(),this.processPartData(e,r,i)}processPartData(e,r,i){this.actualPartLength+=i-r;let n=this.out;return n.write(r===0&&e.length===i?e:e.slice(r,i))?Promise.resolve():new Promise((s,o)=>{n.on("error",o),n.once("drain",()=>{n.removeListener("error",o),s()})})}};$o.DataSplitter=Uf});var ZS=w(Ml=>{"use strict";Object.defineProperty(Ml,"__esModule",{value:!0});Ml.executeTasksUsingMultipleRangeRequests=K$;Ml.checkIsRangesSupported=Hf;var jf=xe(),KS=Bf(),JS=kl();function K$(t,e,r,i,n){let s=o=>{if(o>=e.length){t.fileMetadataBuffer!=null&&r.write(t.fileMetadataBuffer),r.end();return}let a=o+1e3;J$(t,{tasks:e,start:o,end:Math.min(e.length,a),oldFileFd:i},r,()=>s(a),n)};return s}function J$(t,e,r,i,n){let s="bytes=",o=0,a=new Map,l=[];for(let h=e.start;h<e.end;h++){let f=e.tasks[h];f.kind===JS.OperationKind.DOWNLOAD&&(s+="".concat(f.start,"-").concat(f.end-1,", "),a.set(o,h),o++,l.push(f.end-f.start))}if(o<=1){let h=f=>{if(f>=e.end){i();return}let d=e.tasks[f++];if(d.kind===JS.OperationKind.COPY)(0,KS.copyData)(d,r,e.oldFileFd,n,()=>h(f));else{let y=t.createRequestOptions();y.headers.Range="bytes=".concat(d.start,"-").concat(d.end-1);let A=t.httpExecutor.createRequest(y,E=>{Hf(E,n)&&(E.pipe(r,{end:!1}),E.once("end",()=>h(f)))});t.httpExecutor.addErrorAndTimeoutHandlers(A,n),A.end()}};h(e.start);return}let c=t.createRequestOptions();c.headers.Range=s.substring(0,s.length-2);let u=t.httpExecutor.createRequest(c,h=>{if(!Hf(h,n))return;let f=(0,jf.safeGetHeader)(h,"content-type"),d=/^multipart\/.+?(?:; boundary=(?:(?:"(.+)")|(?:([^\s]+))))$/i.exec(f);if(d==null){n(new Error('Content-Type "multipart/byteranges" is expected, but got "'.concat(f,'"')));return}let y=new KS.DataSplitter(r,e,a,d[1]||d[2],l,i);y.on("error",n),h.pipe(y),h.on("end",()=>{setTimeout(()=>{u.abort(),n(new Error("Response ends without calling any handlers"))},1e4)})});t.httpExecutor.addErrorAndTimeoutHandlers(u,n),u.end()}function Hf(t,e){if(t.statusCode>=400)return e((0,jf.createHttpError)(t)),!1;if(t.statusCode!==206){let r=(0,jf.safeGetHeader)(t,"accept-ranges");if(r==null||r==="none")return e(new Error("Server doesn't support Accept-Ranges (response code ".concat(t.statusCode,")"))),!1}return!0}});var eb=w(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});Ul.ProgressDifferentialDownloadCallbackTransform=void 0;var Z$=require("stream"),rs;(function(t){t[t.COPY=0]="COPY",t[t.DOWNLOAD=1]="DOWNLOAD"})(rs||(rs={}));var Wf=class extends Z$.Transform{constructor(e,r,i){super(),this.progressDifferentialDownloadInfo=e,this.cancellationToken=r,this.onProgress=i,this.start=Date.now(),this.transferred=0,this.delta=0,this.expectedBytes=0,this.index=0,this.operationType=rs.COPY,this.nextUpdate=this.start+1e3}_transform(e,r,i){if(this.cancellationToken.cancelled){i(new Error("cancelled"),null);return}if(this.operationType==rs.COPY){i(null,e);return}this.transferred+=e.length,this.delta+=e.length;let n=Date.now();n>=this.nextUpdate&&this.transferred!==this.expectedBytes&&this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&(this.nextUpdate=n+1e3,this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((n-this.start)/1e3))}),this.delta=0),i(null,e)}beginFileCopy(){this.operationType=rs.COPY}beginRangeDownload(){this.operationType=rs.DOWNLOAD,this.expectedBytes+=this.progressDifferentialDownloadInfo.expectedByteCounts[this.index++]}endRangeDownload(){this.transferred!==this.progressDifferentialDownloadInfo.grandTotal&&this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:this.transferred/this.progressDifferentialDownloadInfo.grandTotal*100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))})}_flush(e){if(this.cancellationToken.cancelled){e(new Error("cancelled"));return}this.onProgress({total:this.progressDifferentialDownloadInfo.grandTotal,delta:this.delta,transferred:this.transferred,percent:100,bytesPerSecond:Math.round(this.transferred/((Date.now()-this.start)/1e3))}),this.delta=0,this.transferred=0,e(null)}};Ul.ProgressDifferentialDownloadCallbackTransform=Wf});var Vf=w(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});jl.DifferentialDownloader=void 0;var ko=xe(),Gf=wr(),ek=require("fs"),tk=Bf(),rk=require("url"),Bl=kl(),tb=ZS(),ik=eb(),zf=class{constructor(e,r,i){this.blockAwareFileInfo=e,this.httpExecutor=r,this.options=i,this.fileMetadataBuffer=null,this.logger=i.logger}createRequestOptions(){let e={headers:{...this.options.requestHeaders,accept:"*/*"}};return(0,ko.configureRequestUrl)(this.options.newUrl,e),(0,ko.configureRequestOptions)(e),e}doDownload(e,r){if(e.version!==r.version)throw new Error("version is different (".concat(e.version," - ").concat(r.version,"), full download is required"));let i=this.logger,n=(0,Bl.computeOperations)(e,r,i);i.debug!=null&&i.debug(JSON.stringify(n,null,2));let s=0,o=0;for(let l of n){let c=l.end-l.start;l.kind===Bl.OperationKind.DOWNLOAD?s+=c:o+=c}let a=this.blockAwareFileInfo.size;if(s+o+(this.fileMetadataBuffer==null?0:this.fileMetadataBuffer.length)!==a)throw new Error("Internal error, size mismatch: downloadSize: ".concat(s,", copySize: ").concat(o,", newSize: ").concat(a));return i.info("Full: ".concat(rb(a),", To download: ").concat(rb(s)," (").concat(Math.round(s/(a/100)),"%)")),this.downloadFile(n)}downloadFile(e){let r=[],i=()=>Promise.all(r.map(n=>(0,Gf.close)(n.descriptor).catch(s=>{this.logger.error('cannot close file "'.concat(n.path,'": ').concat(s))})));return this.doDownloadFile(e,r).then(i).catch(n=>i().catch(s=>{try{this.logger.error("cannot close files: ".concat(s))}catch(o){try{console.error(o)}catch{}}throw n}).then(()=>{throw n}))}async doDownloadFile(e,r){let i=await(0,Gf.open)(this.options.oldFile,"r");r.push({descriptor:i,path:this.options.oldFile});let n=await(0,Gf.open)(this.options.newFile,"w");r.push({descriptor:n,path:this.options.newFile});let s=(0,ek.createWriteStream)(this.options.newFile,{fd:n});await new Promise((o,a)=>{let l=[],c;if(!this.options.isUseMultipleRangeRequest&&this.options.onProgress){let v=[],O=0;for(let L of e)L.kind===Bl.OperationKind.DOWNLOAD&&(v.push(L.end-L.start),O+=L.end-L.start);let R={expectedByteCounts:v,grandTotal:O};c=new ik.ProgressDifferentialDownloadCallbackTransform(R,this.options.cancellationToken,this.options.onProgress),l.push(c)}let u=new ko.DigestTransform(this.blockAwareFileInfo.sha512);u.isValidateOnEnd=!1,l.push(u),s.on("finish",()=>{s.close(()=>{r.splice(1,1);try{u.validate()}catch(v){a(v);return}o(void 0)})}),l.push(s);let h=null;for(let v of l)v.on("error",a),h==null?h=v:h=h.pipe(v);let f=l[0],d;if(this.options.isUseMultipleRangeRequest){d=(0,tb.executeTasksUsingMultipleRangeRequests)(this,e,f,i,a),d(0);return}let y=0,A=null;this.logger.info("Differential download: ".concat(this.options.newUrl));let E=this.createRequestOptions();E.redirect="manual",d=v=>{var O,R;if(v>=e.length){this.fileMetadataBuffer!=null&&f.write(this.fileMetadataBuffer),f.end();return}let L=e[v++];if(L.kind===Bl.OperationKind.COPY){c&&c.beginFileCopy(),(0,tk.copyData)(L,f,i,a,()=>d(v));return}let oe="bytes=".concat(L.start,"-").concat(L.end-1);E.headers.range=oe,(R=(O=this.logger)===null||O===void 0?void 0:O.debug)===null||R===void 0||R.call(O,"download range: ".concat(oe)),c&&c.beginRangeDownload();let G=this.httpExecutor.createRequest(E,z=>{z.on("error",a),z.on("aborted",()=>{a(new Error("response has been aborted by the server"))}),z.statusCode>=400&&a((0,ko.createHttpError)(z)),z.pipe(f,{end:!1}),z.once("end",()=>{c&&c.endRangeDownload(),++y===100?(y=0,setTimeout(()=>d(v),1e3)):d(v)})});G.on("redirect",(z,S,N)=>{this.logger.info("Redirect to ".concat(nk(N))),A=N,(0,ko.configureRequestUrl)(new rk.URL(A),E),G.followRedirect()}),this.httpExecutor.addErrorAndTimeoutHandlers(G,a),G.end()},d(0)})}async readRemoteBytes(e,r){let i=Buffer.allocUnsafe(r+1-e),n=this.createRequestOptions();n.headers.range="bytes=".concat(e,"-").concat(r);let s=0;if(await this.request(n,o=>{o.copy(i,s),s+=o.length}),s!==i.length)throw new Error("Received data length ".concat(s," is not equal to expected ").concat(i.length));return i}request(e,r){return new Promise((i,n)=>{let s=this.httpExecutor.createRequest(e,o=>{(0,tb.checkIsRangesSupported)(o,n)&&(o.on("error",n),o.on("aborted",()=>{n(new Error("response has been aborted by the server"))}),o.on("data",r),o.on("end",()=>i()))});this.httpExecutor.addErrorAndTimeoutHandlers(s,n),s.end()})}};jl.DifferentialDownloader=zf;function rb(t,e=" KB"){return new Intl.NumberFormat("en").format((t/1024).toFixed(2))+e}function nk(t){let e=t.indexOf("?");return e<0?t:t.substring(0,e)}});var ib=w(Hl=>{"use strict";Object.defineProperty(Hl,"__esModule",{value:!0});Hl.GenericDifferentialDownloader=void 0;var sk=Vf(),Yf=class extends sk.DifferentialDownloader{download(e,r){return this.doDownload(e,r)}};Hl.GenericDifferentialDownloader=Yf});var ci=w(vt=>{"use strict";Object.defineProperty(vt,"__esModule",{value:!0});vt.UpdaterSignal=vt.UPDATE_DOWNLOADED=vt.DOWNLOAD_PROGRESS=vt.CancellationToken=void 0;vt.addHandler=qo;var ok=xe();Object.defineProperty(vt,"CancellationToken",{enumerable:!0,get:function(){return ok.CancellationToken}});vt.DOWNLOAD_PROGRESS="download-progress";vt.UPDATE_DOWNLOADED="update-downloaded";var Qf=class{constructor(e){this.emitter=e}login(e){qo(this.emitter,"login",e)}progress(e){qo(this.emitter,vt.DOWNLOAD_PROGRESS,e)}updateDownloaded(e){qo(this.emitter,vt.UPDATE_DOWNLOADED,e)}updateCancelled(e){qo(this.emitter,"update-cancelled",e)}};vt.UpdaterSignal=Qf;var ak=!1;function qo(t,e,r){ak?t.on(e,(...i)=>{console.log("%s %s",e,i),r(...i)}):t.on(e,r)}});var Gl=w(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.NoOpLogger=ss.AppUpdater=void 0;var rt=xe(),lk=require("crypto"),uk=require("os"),ck=require("events"),is=wr(),hk=il(),Xf=Y0(),Ki=require("path"),Ji=of(),nb=AS(),fk=bS(),sb=vS(),dk=Rf(),Kf=zS(),pk=require("zlib"),mk=oi(),gk=ib(),ns=ci(),Jf=class t extends ck.EventEmitter{get channel(){return this._channel}set channel(e){if(this._channel!=null){if(typeof e!="string")throw(0,rt.newError)("Channel must be a string, but got: ".concat(e),"ERR_UPDATER_INVALID_CHANNEL");if(e.length===0)throw(0,rt.newError)("Channel must be not an empty string","ERR_UPDATER_INVALID_CHANNEL")}this._channel=e,this.allowDowngrade=!0}addAuthHeader(e){this.requestHeaders=Object.assign({},this.requestHeaders,{authorization:e})}get netSession(){return(0,sb.getNetSession)()}get logger(){return this._logger}set logger(e){this._logger=e??new Wl}set updateConfigPath(e){this.clientPromise=null,this._appUpdateConfigPath=e,this.configOnDisk=new Xf.Lazy(()=>this.loadUpdateConfig())}get isUpdateSupported(){return this._isUpdateSupported}set isUpdateSupported(e){e&&(this._isUpdateSupported=e)}constructor(e,r){super(),this.autoDownload=!0,this.autoInstallOnAppQuit=!0,this.autoRunAppAfterInstall=!0,this.allowPrerelease=!1,this.fullChangelog=!1,this.allowDowngrade=!1,this.disableWebInstaller=!1,this.disableDifferentialDownload=!1,this.forceDevUpdateConfig=!1,this._channel=null,this.downloadedUpdateHelper=null,this.requestHeaders=null,this._logger=console,this.signals=new ns.UpdaterSignal(this),this._appUpdateConfigPath=null,this._isUpdateSupported=s=>this.checkIfUpdateSupported(s),this.clientPromise=null,this.stagingUserIdPromise=new Xf.Lazy(()=>this.getOrCreateStagingUserId()),this.configOnDisk=new Xf.Lazy(()=>this.loadUpdateConfig()),this.checkForUpdatesPromise=null,this.downloadPromise=null,this.updateInfoAndProvider=null,this._testOnlyOptions=null,this.on("error",s=>{this._logger.error("Error: ".concat(s.stack||s.message))}),r==null?(this.app=new fk.ElectronAppAdapter,this.httpExecutor=new sb.ElectronHttpExecutor((s,o)=>this.emit("login",s,o))):(this.app=r,this.httpExecutor=null);let i=this.app.version,n=(0,Ji.parse)(i);if(n==null)throw(0,rt.newError)('App version is not a valid semver version: "'.concat(i,'"'),"ERR_UPDATER_INVALID_VERSION");this.currentVersion=n,this.allowPrerelease=yk(n),e!=null&&(this.setFeedURL(e),typeof e!="string"&&e.requestHeaders&&(this.requestHeaders=e.requestHeaders))}getFeedURL(){return"Deprecated. Do not use it."}setFeedURL(e){let r=this.createProviderRuntimeOptions(),i;typeof e=="string"?i=new dk.GenericProvider({provider:"generic",url:e},this,{...r,isUseMultipleRangeRequest:(0,Kf.isUrlProbablySupportMultiRangeRequests)(e)}):i=(0,Kf.createClient)(e,this,r),this.clientPromise=Promise.resolve(i)}checkForUpdates(){if(!this.isUpdaterActive())return Promise.resolve(null);let e=this.checkForUpdatesPromise;if(e!=null)return this._logger.info("Checking for update (already in progress)"),e;let r=()=>this.checkForUpdatesPromise=null;return this._logger.info("Checking for update"),e=this.doCheckForUpdates().then(i=>(r(),i)).catch(i=>{throw r(),this.emit("error",i,"Cannot check for updates: ".concat((i.stack||i).toString())),i}),this.checkForUpdatesPromise=e,e}isUpdaterActive(){return this.app.isPackaged||this.forceDevUpdateConfig?!0:(this._logger.info("Skip checkForUpdates because application is not packed and dev update config is not forced"),!1)}checkForUpdatesAndNotify(e){return this.checkForUpdates().then(r=>r?.downloadPromise?(r.downloadPromise.then(()=>{let i=t.formatDownloadNotification(r.updateInfo.version,this.app.name,e);new(require("electron")).Notification(i).show()}),r):(this._logger.debug!=null&&this._logger.debug("checkForUpdatesAndNotify called, downloadPromise is null"),r))}static formatDownloadNotification(e,r,i){return i==null&&(i={title:"A new update is ready to install",body:"{appName} version {version} has been downloaded and will be automatically installed on exit"}),i={title:i.title.replace("{appName}",r).replace("{version}",e),body:i.body.replace("{appName}",r).replace("{version}",e)},i}async isStagingMatch(e){let r=e.stagingPercentage,i=r;if(i==null)return!0;if(i=parseInt(i,10),isNaN(i))return this._logger.warn("Staging percentage is NaN: ".concat(r)),!0;i=i/100;let n=await this.stagingUserIdPromise.value,o=rt.UUID.parse(n).readUInt32BE(12)/4294967295;return this._logger.info("Staging percentage: ".concat(i,", percentage: ").concat(o,", user id: ").concat(n)),o<i}computeFinalHeaders(e){return this.requestHeaders!=null&&Object.assign(e,this.requestHeaders),e}async isUpdateAvailable(e){let r=(0,Ji.parse)(e.version);if(r==null)throw(0,rt.newError)('This file could not be downloaded, or the latest version (from update server) does not have a valid semver version: "'.concat(e.version,'"'),"ERR_UPDATER_INVALID_VERSION");let i=this.currentVersion;if((0,Ji.eq)(r,i)||!await Promise.resolve(this.isUpdateSupported(e))||!await this.isStagingMatch(e))return!1;let s=(0,Ji.gt)(r,i),o=(0,Ji.lt)(r,i);return s?!0:this.allowDowngrade&&o}checkIfUpdateSupported(e){let r=e?.minimumSystemVersion,i=(0,uk.release)();if(r)try{if((0,Ji.lt)(i,r))return this._logger.info("Current OS version ".concat(i," is less than the minimum OS version required ").concat(r," for version ").concat(i)),!1}catch(n){this._logger.warn("Failed to compare current OS version(".concat(i,") with minimum OS version(").concat(r,"): ").concat((n.message||n).toString()))}return!0}async getUpdateInfoAndProvider(){await this.app.whenReady(),this.clientPromise==null&&(this.clientPromise=this.configOnDisk.value.then(i=>(0,Kf.createClient)(i,this,this.createProviderRuntimeOptions())));let e=await this.clientPromise,r=await this.stagingUserIdPromise.value;return e.setRequestHeaders(this.computeFinalHeaders({"x-user-staging-id":r})),{info:await e.getLatestVersion(),provider:e}}createProviderRuntimeOptions(){return{isUseMultipleRangeRequest:!0,platform:this._testOnlyOptions==null?process.platform:this._testOnlyOptions.platform,executor:this.httpExecutor}}async doCheckForUpdates(){this.emit("checking-for-update");let e=await this.getUpdateInfoAndProvider(),r=e.info;if(!await this.isUpdateAvailable(r))return this._logger.info("Update for version ".concat(this.currentVersion.format()," is not available (latest version: ").concat(r.version,", downgrade is ").concat(this.allowDowngrade?"allowed":"disallowed",").")),this.emit("update-not-available",r),{isUpdateAvailable:!1,versionInfo:r,updateInfo:r};this.updateInfoAndProvider=e,this.onUpdateAvailable(r);let i=new rt.CancellationToken;return{isUpdateAvailable:!0,versionInfo:r,updateInfo:r,cancellationToken:i,downloadPromise:this.autoDownload?this.downloadUpdate(i):null}}onUpdateAvailable(e){this._logger.info("Found version ".concat(e.version," (url: ").concat((0,rt.asArray)(e.files).map(r=>r.url).join(", "),")")),this.emit("update-available",e)}downloadUpdate(e=new rt.CancellationToken){let r=this.updateInfoAndProvider;if(r==null){let n=new Error("Please check update first");return this.dispatchError(n),Promise.reject(n)}if(this.downloadPromise!=null)return this._logger.info("Downloading update (already in progress)"),this.downloadPromise;this._logger.info("Downloading update from ".concat((0,rt.asArray)(r.info.files).map(n=>n.url).join(", ")));let i=n=>{if(!(n instanceof rt.CancellationError))try{this.dispatchError(n)}catch(s){this._logger.warn("Cannot dispatch error event: ".concat(s.stack||s))}return n};return this.downloadPromise=this.doDownloadUpdate({updateInfoAndProvider:r,requestHeaders:this.computeRequestHeaders(r.provider),cancellationToken:e,disableWebInstaller:this.disableWebInstaller,disableDifferentialDownload:this.disableDifferentialDownload}).catch(n=>{throw i(n)}).finally(()=>{this.downloadPromise=null}),this.downloadPromise}dispatchError(e){this.emit("error",e,(e.stack||e).toString())}dispatchUpdateDownloaded(e){this.emit(ns.UPDATE_DOWNLOADED,e)}async loadUpdateConfig(){return this._appUpdateConfigPath==null&&(this._appUpdateConfigPath=this.app.appUpdateConfigPath),(0,hk.load)(await(0,is.readFile)(this._appUpdateConfigPath,"utf-8"))}computeRequestHeaders(e){let r=e.fileExtraDownloadHeaders;if(r!=null){let i=this.requestHeaders;return i==null?r:{...r,...i}}return this.computeFinalHeaders({accept:"*/*"})}async getOrCreateStagingUserId(){let e=Ki.join(this.app.userDataPath,".updaterId");try{let i=await(0,is.readFile)(e,"utf-8");if(rt.UUID.check(i))return i;this._logger.warn("Staging user id file exists, but content was invalid: ".concat(i))}catch(i){i.code!=="ENOENT"&&this._logger.warn("Couldn't read staging user ID, creating a blank one: ".concat(i))}let r=rt.UUID.v5((0,lk.randomBytes)(4096),rt.UUID.OID);this._logger.info("Generated new staging user ID: ".concat(r));try{await(0,is.outputFile)(e,r)}catch(i){this._logger.warn("Couldn't write out staging user ID: ".concat(i))}return r}get isAddNoCacheQuery(){let e=this.requestHeaders;if(e==null)return!0;for(let r of Object.keys(e)){let i=r.toLowerCase();if(i==="authorization"||i==="private-token")return!1}return!0}async getOrCreateDownloadHelper(){let e=this.downloadedUpdateHelper;if(e==null){let r=(await this.configOnDisk.value).updaterCacheDirName,i=this._logger;r==null&&i.error("updaterCacheDirName is not specified in app-update.yml Was app build using at least electron-builder 20.34.0?");let n=Ki.join(this.app.baseCachePath,r||this.app.name);i.debug!=null&&i.debug("updater cache dir: ".concat(n)),e=new nb.DownloadedUpdateHelper(n),this.downloadedUpdateHelper=e}return e}async executeDownload(e){let r=e.fileInfo,i={headers:e.downloadUpdateOptions.requestHeaders,cancellationToken:e.downloadUpdateOptions.cancellationToken,sha2:r.info.sha2,sha512:r.info.sha512};this.listenerCount(ns.DOWNLOAD_PROGRESS)>0&&(i.onProgress=O=>this.emit(ns.DOWNLOAD_PROGRESS,O));let n=e.downloadUpdateOptions.updateInfoAndProvider.info,s=n.version,o=r.packageInfo;function a(){let O=decodeURIComponent(e.fileInfo.url.pathname);return O.endsWith(".".concat(e.fileExtension))?Ki.basename(O):e.fileInfo.info.url}let l=await this.getOrCreateDownloadHelper(),c=l.cacheDirForPendingUpdate;await(0,is.mkdir)(c,{recursive:!0});let u=a(),h=Ki.join(c,u),f=o==null?null:Ki.join(c,"package-".concat(s).concat(Ki.extname(o.path)||".7z")),d=async O=>(await l.setDownloadedFile(h,f,n,r,u,O),await e.done({...n,downloadedFile:h}),f==null?[h]:[h,f]),y=this._logger,A=await l.validateDownloadedPath(h,n,r,y);if(A!=null)return h=A,await d(!1);let E=async()=>(await l.clear().catch(()=>{}),await(0,is.unlink)(h).catch(()=>{})),v=await(0,nb.createTempUpdateFile)("temp-".concat(u),c,y);try{await e.task(v,i,f,E),await(0,rt.retry)(()=>(0,is.rename)(v,h),60,500,0,0,O=>O instanceof Error&&/^EBUSY:/.test(O.message))}catch(O){throw await E(),O instanceof rt.CancellationError&&(y.info("cancelled"),this.emit("update-cancelled",n)),O}return y.info("New version ".concat(s," has been downloaded to ").concat(h)),await d(!0)}async differentialDownloadInstaller(e,r,i,n,s){try{if(this._testOnlyOptions!=null&&!this._testOnlyOptions.isUseDifferentialDownload)return!0;let o=(0,mk.blockmapFiles)(e.url,this.app.version,r.updateInfoAndProvider.info.version);this._logger.info('Download block maps (old: "'.concat(o[0],'", new: ').concat(o[1],")"));let a=async u=>{let h=await this.httpExecutor.downloadToBuffer(u,{headers:r.requestHeaders,cancellationToken:r.cancellationToken});if(h==null||h.length===0)throw new Error('Blockmap "'.concat(u.href,'" is empty'));try{return JSON.parse((0,pk.gunzipSync)(h).toString())}catch(f){throw new Error('Cannot parse blockmap "'.concat(u.href,'", error: ').concat(f))}},l={newUrl:e.url,oldFile:Ki.join(this.downloadedUpdateHelper.cacheDir,s),logger:this._logger,newFile:i,isUseMultipleRangeRequest:n.isUseMultipleRangeRequest,requestHeaders:r.requestHeaders,cancellationToken:r.cancellationToken};this.listenerCount(ns.DOWNLOAD_PROGRESS)>0&&(l.onProgress=u=>this.emit(ns.DOWNLOAD_PROGRESS,u));let c=await Promise.all(o.map(u=>a(u)));return await new gk.GenericDifferentialDownloader(e.info,this.httpExecutor,l).download(c[0],c[1]),!1}catch(o){if(this._logger.error("Cannot download differentially, fallback to full download: ".concat(o.stack||o)),this._testOnlyOptions!=null)throw o;return!0}}};ss.AppUpdater=Jf;function yk(t){let e=(0,Ji.prerelease)(t);return e!=null&&e.length>0}var Wl=class{info(e){}warn(e){}error(e){}};ss.NoOpLogger=Wl});var Zi=w(zl=>{"use strict";Object.defineProperty(zl,"__esModule",{value:!0});zl.BaseUpdater=void 0;var ob=require("child_process"),wk=Gl(),Zf=class extends wk.AppUpdater{constructor(e,r){super(e,r),this.quitAndInstallCalled=!1,this.quitHandlerAdded=!1}quitAndInstall(e=!1,r=!1){this._logger.info("Install on explicit quitAndInstall"),this.install(e,e?r:this.autoRunAppAfterInstall)?setImmediate(()=>{require("electron").autoUpdater.emit("before-quit-for-update"),this.app.quit()}):this.quitAndInstallCalled=!1}executeDownload(e){return super.executeDownload({...e,done:r=>(this.dispatchUpdateDownloaded(r),this.addQuitHandler(),Promise.resolve())})}get installerPath(){return this.downloadedUpdateHelper==null?null:this.downloadedUpdateHelper.file}install(e=!1,r=!1){if(this.quitAndInstallCalled)return this._logger.warn("install call ignored: quitAndInstallCalled is set to true"),!1;let i=this.downloadedUpdateHelper,n=this.installerPath,s=i==null?null:i.downloadedFileInfo;if(n==null||s==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;this.quitAndInstallCalled=!0;try{return this._logger.info("Install: isSilent: ".concat(e,", isForceRunAfter: ").concat(r)),this.doInstall({isSilent:e,isForceRunAfter:r,isAdminRightsRequired:s.isAdminRightsRequired})}catch(o){return this.dispatchError(o),!1}}addQuitHandler(){this.quitHandlerAdded||!this.autoInstallOnAppQuit||(this.quitHandlerAdded=!0,this.app.onQuit(e=>{if(this.quitAndInstallCalled){this._logger.info("Update installer has already been triggered. Quitting application.");return}if(!this.autoInstallOnAppQuit){this._logger.info("Update will not be installed on quit because autoInstallOnAppQuit is set to false.");return}if(e!==0){this._logger.info("Update will be not installed on quit because application is quitting with exit code ".concat(e));return}this._logger.info("Auto install update on quit"),this.install(!0,!1)}))}wrapSudo(){let{name:e}=this.app,r='"'.concat(e,' would like to update"'),i=this.spawnSyncLog("which gksudo || which kdesudo || which pkexec || which beesu"),n=[i];return/kdesudo/i.test(i)?(n.push("--comment",r),n.push("-c")):/gksudo/i.test(i)?n.push("--message",r):/pkexec/i.test(i)&&n.push("--disable-internal-agent"),n.join(" ")}spawnSyncLog(e,r=[],i={}){this._logger.info("Executing: ".concat(e," with args: ").concat(r));let n=(0,ob.spawnSync)(e,r,{env:{...process.env,...i},encoding:"utf-8",shell:!0}),{error:s,status:o,stdout:a,stderr:l}=n;if(s!=null)throw this._logger.error(l),s;if(o!=null&&o!==0)throw this._logger.error(l),new Error("Command ".concat(e," exited with code ").concat(o));return a.trim()}async spawnLog(e,r=[],i=void 0,n="ignore"){return this._logger.info("Executing: ".concat(e," with args: ").concat(r)),new Promise((s,o)=>{try{let a={stdio:n,env:i,detached:!0},l=(0,ob.spawn)(e,r,a);l.on("error",c=>{o(c)}),l.unref(),l.pid!==void 0&&s(!0)}catch(a){o(a)}})}};zl.BaseUpdater=Zf});var td=w(Vl=>{"use strict";Object.defineProperty(Vl,"__esModule",{value:!0});Vl.FileWithEmbeddedBlockMapDifferentialDownloader=void 0;var os=wr(),Ak=Vf(),Ek=require("zlib"),ed=class extends Ak.DifferentialDownloader{async download(){let e=this.blockAwareFileInfo,r=e.size,i=r-(e.blockMapSize+4);this.fileMetadataBuffer=await this.readRemoteBytes(i,r-1);let n=ab(this.fileMetadataBuffer.slice(0,this.fileMetadataBuffer.length-4));await this.doDownload(await Sk(this.options.oldFile),n)}};Vl.FileWithEmbeddedBlockMapDifferentialDownloader=ed;function ab(t){return JSON.parse((0,Ek.inflateRawSync)(t).toString())}async function Sk(t){let e=await(0,os.open)(t,"r");try{let r=(await(0,os.fstat)(e)).size,i=Buffer.allocUnsafe(4);await(0,os.read)(e,i,0,i.length,r-i.length);let n=Buffer.allocUnsafe(i.readUInt32BE(0));return await(0,os.read)(e,n,0,n.length,r-i.length-n.length),await(0,os.close)(e),ab(n)}catch(r){throw await(0,os.close)(e),r}}});var id=w(Yl=>{"use strict";Object.defineProperty(Yl,"__esModule",{value:!0});Yl.AppImageUpdater=void 0;var lb=xe(),ub=require("child_process"),bk=wr(),_k=require("fs"),Mo=require("path"),vk=Zi(),Ok=td(),Tk=_t(),cb=ci(),rd=class extends vk.BaseUpdater{constructor(e,r){super(e,r)}isUpdaterActive(){return process.env.APPIMAGE==null?(process.env.SNAP==null?this._logger.warn("APPIMAGE env is not defined, current application is not an AppImage"):this._logger.info("SNAP env is defined, updater is disabled"),!1):super.isUpdaterActive()}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Tk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"AppImage",["rpm","deb","pacman"]);return this.executeDownload({fileExtension:"AppImage",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{let o=process.env.APPIMAGE;if(o==null)throw(0,lb.newError)("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");(e.disableDifferentialDownload||await this.downloadDifferential(i,o,n,r,e))&&await this.httpExecutor.download(i.url,n,s),await(0,bk.chmod)(n,493)}})}async downloadDifferential(e,r,i,n,s){try{let o={newUrl:e.url,oldFile:r,logger:this._logger,newFile:i,isUseMultipleRangeRequest:n.isUseMultipleRangeRequest,requestHeaders:s.requestHeaders,cancellationToken:s.cancellationToken};return this.listenerCount(cb.DOWNLOAD_PROGRESS)>0&&(o.onProgress=a=>this.emit(cb.DOWNLOAD_PROGRESS,a)),await new Ok.FileWithEmbeddedBlockMapDifferentialDownloader(e.info,this.httpExecutor,o).download(),!1}catch(o){return this._logger.error("Cannot download differentially, fallback to full download: ".concat(o.stack||o)),process.platform==="linux"}}doInstall(e){let r=process.env.APPIMAGE;if(r==null)throw(0,lb.newError)("APPIMAGE env is not defined","ERR_UPDATER_OLD_FILE_NOT_FOUND");(0,_k.unlinkSync)(r);let i,n=Mo.basename(r),s=this.installerPath;if(s==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;Mo.basename(s)===n||!/\d+\.\d+\.\d+/.test(n)?i=r:i=Mo.join(Mo.dirname(r),Mo.basename(s)),(0,ub.execFileSync)("mv",["-f",s,i]),i!==r&&this.emit("appimage-filename-updated",i);let o={...process.env,APPIMAGE_SILENT_INSTALL:"true"};return e.isForceRunAfter?this.spawnLog(i,[],o):(o.APPIMAGE_EXIT_AFTER_INSTALL="true",(0,ub.execFileSync)(i,[],{env:o})),!0}};Yl.AppImageUpdater=rd});var sd=w(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});Ql.DebUpdater=void 0;var Ck=Zi(),Rk=_t(),hb=ci(),nd=class extends Ck.BaseUpdater{constructor(e,r){super(e,r)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Rk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"deb",["AppImage","rpm","pacman"]);return this.executeDownload({fileExtension:"deb",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{this.listenerCount(hb.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(hb.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(i.url,n,s)}})}get installerPath(){var e,r;return(r=(e=super.installerPath)===null||e===void 0?void 0:e.replace(/ /g,"\\ "))!==null&&r!==void 0?r:null}doInstall(e){let r=this.wrapSudo(),i=/pkexec/i.test(r)?"":'"',n=this.installerPath;if(n==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;let s=["dpkg","-i",n,"||","apt-get","install","-f","-y"];return this.spawnSyncLog(r,["".concat(i,"/bin/bash"),"-c","'".concat(s.join(" "),"'").concat(i)]),e.isForceRunAfter&&this.app.relaunch(),!0}};Ql.DebUpdater=nd});var ad=w(Xl=>{"use strict";Object.defineProperty(Xl,"__esModule",{value:!0});Xl.PacmanUpdater=void 0;var Ik=Zi(),fb=ci(),Nk=_t(),od=class extends Ik.BaseUpdater{constructor(e,r){super(e,r)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Nk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"pacman",["AppImage","deb","rpm"]);return this.executeDownload({fileExtension:"pacman",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{this.listenerCount(fb.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(fb.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(i.url,n,s)}})}get installerPath(){var e,r;return(r=(e=super.installerPath)===null||e===void 0?void 0:e.replace(/ /g,"\\ "))!==null&&r!==void 0?r:null}doInstall(e){let r=this.wrapSudo(),i=/pkexec/i.test(r)?"":'"',n=this.installerPath;if(n==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;let s=["pacman","-U","--noconfirm",n];return this.spawnSyncLog(r,["".concat(i,"/bin/bash"),"-c","'".concat(s.join(" "),"'").concat(i)]),e.isForceRunAfter&&this.app.relaunch(),!0}};Xl.PacmanUpdater=od});var ud=w(Kl=>{"use strict";Object.defineProperty(Kl,"__esModule",{value:!0});Kl.RpmUpdater=void 0;var xk=Zi(),db=ci(),Dk=_t(),ld=class extends xk.BaseUpdater{constructor(e,r){super(e,r)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Dk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"rpm",["AppImage","deb","pacman"]);return this.executeDownload({fileExtension:"rpm",fileInfo:i,downloadUpdateOptions:e,task:async(n,s)=>{this.listenerCount(db.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(db.DOWNLOAD_PROGRESS,o)),await this.httpExecutor.download(i.url,n,s)}})}get installerPath(){var e,r;return(r=(e=super.installerPath)===null||e===void 0?void 0:e.replace(/ /g,"\\ "))!==null&&r!==void 0?r:null}doInstall(e){let r=this.wrapSudo(),i=/pkexec/i.test(r)?"":'"',n=this.spawnSyncLog("which zypper"),s=this.installerPath;if(s==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;let o;return n?o=[n,"--no-refresh","install","--allow-unsigned-rpm","-y","-f",s]:o=[this.spawnSyncLog("which dnf || which yum"),"-y","install",s],this.spawnSyncLog(r,["".concat(i,"/bin/bash"),"-c","'".concat(o.join(" "),"'").concat(i)]),e.isForceRunAfter&&this.app.relaunch(),!0}};Kl.RpmUpdater=ld});var fd=w(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});Jl.MacUpdater=void 0;var pb=xe(),cd=wr(),Pk=require("fs"),mb=require("path"),Fk=require("http"),Lk=Gl(),$k=_t(),gb=require("child_process"),yb=require("crypto"),hd=class extends Lk.AppUpdater{constructor(e,r){super(e,r),this.nativeUpdater=require("electron").autoUpdater,this.squirrelDownloadedUpdate=!1,this.nativeUpdater.on("error",i=>{this._logger.warn(i),this.emit("error",i)}),this.nativeUpdater.on("update-downloaded",()=>{this.squirrelDownloadedUpdate=!0,this.debug("nativeUpdater.update-downloaded")})}debug(e){this._logger.debug!=null&&this._logger.debug(e)}closeServerIfExists(){this.server&&(this.debug("Closing proxy server"),this.server.close(e=>{e&&this.debug("proxy server wasn't already open, probably attempted closing again as a safety check before quit")}))}async doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider.resolveFiles(e.updateInfoAndProvider.info),i=this._logger,n="sysctl.proc_translated",s=!1;try{this.debug("Checking for macOS Rosetta environment"),s=(0,gb.execFileSync)("sysctl",[n],{encoding:"utf8"}).includes("".concat(n,": 1")),i.info("Checked for macOS Rosetta environment (isRosetta=".concat(s,")"))}catch(h){i.warn("sysctl shell command to check for macOS Rosetta environment failed: ".concat(h))}let o=!1;try{this.debug("Checking for arm64 in uname");let f=(0,gb.execFileSync)("uname",["-a"],{encoding:"utf8"}).includes("ARM");i.info("Checked 'uname -a': arm64=".concat(f)),o=o||f}catch(h){i.warn("uname shell command to check for arm64 failed: ".concat(h))}o=o||process.arch==="arm64"||s;let a=h=>{var f;return h.url.pathname.includes("arm64")||((f=h.info.url)===null||f===void 0?void 0:f.includes("arm64"))};o&&r.some(a)?r=r.filter(h=>o===a(h)):r=r.filter(h=>!a(h));let l=(0,$k.findFile)(r,"zip",["pkg","dmg"]);if(l==null)throw(0,pb.newError)("ZIP file not provided: ".concat((0,pb.safeStringifyJson)(r)),"ERR_UPDATER_ZIP_FILE_NOT_FOUND");let c=e.updateInfoAndProvider.provider,u="update.zip";return this.executeDownload({fileExtension:"zip",fileInfo:l,downloadUpdateOptions:e,task:async(h,f)=>{let d=mb.join(this.downloadedUpdateHelper.cacheDir,u),y=()=>(0,cd.pathExistsSync)(d)?!e.disableDifferentialDownload:(i.info("Unable to locate previous update.zip for differential download (is this first install?), falling back to full download"),!1),A=!0;y()&&(A=await this.differentialDownloadInstaller(l,e,h,c,u)),A&&await this.httpExecutor.download(l.url,h,f)},done:async h=>{if(!e.disableDifferentialDownload)try{let f=mb.join(this.downloadedUpdateHelper.cacheDir,u);await(0,cd.copyFile)(h.downloadedFile,f)}catch(f){this._logger.warn("Unable to copy file for caching for future differential downloads: ".concat(f.message))}return this.updateDownloaded(l,h)}})}async updateDownloaded(e,r){var i;let n=r.downloadedFile,s=(i=e.info.size)!==null&&i!==void 0?i:(await(0,cd.stat)(n)).size,o=this._logger,a="fileToProxy=".concat(e.url.href);this.closeServerIfExists(),this.debug("Creating proxy server for native Squirrel.Mac (".concat(a,")")),this.server=(0,Fk.createServer)(),this.debug("Proxy server for native Squirrel.Mac is created (".concat(a,")")),this.server.on("close",()=>{o.info("Proxy server for native Squirrel.Mac is closed (".concat(a,")"))});let l=c=>{let u=c.address();return typeof u=="string"?u:"http://127.0.0.1:".concat(u?.port)};return await new Promise((c,u)=>{let h=(0,yb.randomBytes)(64).toString("base64").replace(/\//g,"_").replace(/\+/g,"-"),f=Buffer.from("autoupdater:".concat(h),"ascii"),d="/".concat((0,yb.randomBytes)(64).toString("hex"),".zip");this.server.on("request",(y,A)=>{let E=y.url;if(o.info("".concat(E," requested")),E==="/"){if(!y.headers.authorization||y.headers.authorization.indexOf("Basic ")===-1){A.statusCode=401,A.statusMessage="Invalid Authentication Credentials",A.end(),o.warn("No authenthication info");return}let R=y.headers.authorization.split(" ")[1],L=Buffer.from(R,"base64").toString("ascii"),[oe,G]=L.split(":");if(oe!=="autoupdater"||G!==h){A.statusCode=401,A.statusMessage="Invalid Authentication Credentials",A.end(),o.warn("Invalid authenthication credentials");return}let z=Buffer.from('{ "url": "'.concat(l(this.server)).concat(d,'" }'));A.writeHead(200,{"Content-Type":"application/json","Content-Length":z.length}),A.end(z);return}if(!E.startsWith(d)){o.warn("".concat(E," requested, but not supported")),A.writeHead(404),A.end();return}o.info("".concat(d," requested by Squirrel.Mac, pipe ").concat(n));let v=!1;A.on("finish",()=>{v||(this.nativeUpdater.removeListener("error",u),c([]))});let O=(0,Pk.createReadStream)(n);O.on("error",R=>{try{A.end()}catch(L){o.warn("cannot end response: ".concat(L))}v=!0,this.nativeUpdater.removeListener("error",u),u(new Error('Cannot pipe "'.concat(n,'": ').concat(R)))}),A.writeHead(200,{"Content-Type":"application/zip","Content-Length":s}),O.pipe(A)}),this.debug("Proxy server for native Squirrel.Mac is starting to listen (".concat(a,")")),this.server.listen(0,"127.0.0.1",()=>{this.debug("Proxy server for native Squirrel.Mac is listening (address=".concat(l(this.server),", ").concat(a,")")),this.nativeUpdater.setFeedURL({url:l(this.server),headers:{"Cache-Control":"no-cache",Authorization:"Basic ".concat(f.toString("base64"))}}),this.dispatchUpdateDownloaded(r),this.autoInstallOnAppQuit?(this.nativeUpdater.once("error",u),this.nativeUpdater.checkForUpdates()):c([])})})}handleUpdateDownloaded(){this.autoRunAppAfterInstall?this.nativeUpdater.quitAndInstall():this.app.quit(),this.closeServerIfExists()}quitAndInstall(){this.squirrelDownloadedUpdate?this.handleUpdateDownloaded():(this.nativeUpdater.on("update-downloaded",()=>this.handleUpdateDownloaded()),this.autoInstallOnAppQuit||this.nativeUpdater.checkForUpdates())}};Jl.MacUpdater=hd});var Sb=w(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.verifySignature=qk;var wb=xe(),Eb=require("child_process"),kk=require("os"),Ab=require("path");function qk(t,e,r){return new Promise((i,n)=>{let s=e.replace(/'/g,"''");r.info("Verifying signature ".concat(s)),(0,Eb.execFile)('set "PSModulePath=" & chcp 65001 >NUL & powershell.exe',["-NoProfile","-NonInteractive","-InputFormat","None","-Command","\"Get-AuthenticodeSignature -LiteralPath '".concat(s,"' | ConvertTo-Json -Compress\"")],{shell:!0,timeout:20*1e3},(o,a,l)=>{var c;try{if(o!=null||l){dd(r,o,l,n),i(null);return}let u=Mk(a);if(u.Status===0){try{let y=Ab.normalize(u.Path),A=Ab.normalize(e);if(r.info("LiteralPath: ".concat(y,". Update Path: ").concat(A)),y!==A){dd(r,new Error("LiteralPath of ".concat(y," is different than ").concat(A)),l,n),i(null);return}}catch(y){r.warn("Unable to verify LiteralPath of update asset due to missing data.Path. Skipping this step of validation. Message: ".concat((c=y.message)!==null&&c!==void 0?c:y.stack))}let f=(0,wb.parseDn)(u.SignerCertificate.Subject),d=!1;for(let y of t){let A=(0,wb.parseDn)(y);if(A.size?d=Array.from(A.keys()).every(v=>A.get(v)===f.get(v)):y===f.get("CN")&&(r.warn("Signature validated using only CN ".concat(y,". Please add your full Distinguished Name (DN) to publisherNames configuration")),d=!0),d){i(null);return}}}let h="publisherNames: ".concat(t.join(" | "),", raw info: ")+JSON.stringify(u,(f,d)=>f==="RawData"?void 0:d,2);r.warn("Sign verification failed, installer signed with incorrect certificate: ".concat(h)),i(h)}catch(u){dd(r,u,null,n),i(null);return}})})}function Mk(t){let e=JSON.parse(t);delete e.PrivateKey,delete e.IsOSBinary,delete e.SignatureType;let r=e.SignerCertificate;return r!=null&&(delete r.Archived,delete r.Extensions,delete r.Handle,delete r.HasPrivateKey,delete r.SubjectName),e}function dd(t,e,r,i){if(Uk()){t.warn("Cannot execute Get-AuthenticodeSignature: ".concat(e||r,". Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher."));return}try{(0,Eb.execFileSync)("powershell.exe",["-NoProfile","-NonInteractive","-Command","ConvertTo-Json test"],{timeout:10*1e3})}catch(n){t.warn("Cannot execute ConvertTo-Json: ".concat(n.message,". Ignoring signature validation due to unsupported powershell version. Please upgrade to powershell 3 or higher."));return}e!=null&&i(e),r&&i(new Error("Cannot execute Get-AuthenticodeSignature, stderr: ".concat(r,". Failing signature validation due to unknown stderr.")))}function Uk(){let t=kk.release();return t.startsWith("6.")&&!t.startsWith("6.3")}});var gd=w(eu=>{"use strict";Object.defineProperty(eu,"__esModule",{value:!0});eu.NsisUpdater=void 0;var Zl=xe(),bb=require("path"),Bk=Zi(),jk=td(),_b=ci(),Hk=_t(),Wk=wr(),Gk=Sb(),vb=require("url"),md=class extends Bk.BaseUpdater{constructor(e,r){super(e,r),this._verifyUpdateCodeSignature=(i,n)=>(0,Gk.verifySignature)(i,n,this._logger)}get verifyUpdateCodeSignature(){return this._verifyUpdateCodeSignature}set verifyUpdateCodeSignature(e){e&&(this._verifyUpdateCodeSignature=e)}doDownloadUpdate(e){let r=e.updateInfoAndProvider.provider,i=(0,Hk.findFile)(r.resolveFiles(e.updateInfoAndProvider.info),"exe");return this.executeDownload({fileExtension:"exe",downloadUpdateOptions:e,fileInfo:i,task:async(n,s,o,a)=>{let l=i.packageInfo,c=l!=null&&o!=null;if(c&&e.disableWebInstaller)throw(0,Zl.newError)("Unable to download new version ".concat(e.updateInfoAndProvider.info.version,". Web Installers are disabled"),"ERR_UPDATER_WEB_INSTALLER_DISABLED");!c&&!e.disableWebInstaller&&this._logger.warn("disableWebInstaller is set to false, you should set it to true if you do not plan on using a web installer. This will default to true in a future version."),(c||e.disableDifferentialDownload||await this.differentialDownloadInstaller(i,e,n,r,Zl.CURRENT_APP_INSTALLER_FILE_NAME))&&await this.httpExecutor.download(i.url,n,s);let u=await this.verifySignature(n);if(u!=null)throw await a(),(0,Zl.newError)("New version ".concat(e.updateInfoAndProvider.info.version," is not signed by the application owner: ").concat(u),"ERR_UPDATER_INVALID_SIGNATURE");if(c&&await this.differentialDownloadWebPackage(e,l,o,r))try{await this.httpExecutor.download(new vb.URL(l.path),o,{headers:e.requestHeaders,cancellationToken:e.cancellationToken,sha512:l.sha512})}catch(h){try{await(0,Wk.unlink)(o)}catch{}throw h}}})}async verifySignature(e){let r;try{if(r=(await this.configOnDisk.value).publisherName,r==null)return null}catch(i){if(i.code==="ENOENT")return null;throw i}return await this._verifyUpdateCodeSignature(Array.isArray(r)?r:[r],e)}doInstall(e){let r=this.installerPath;if(r==null)return this.dispatchError(new Error("No valid update available, can't quit and install")),!1;let i=["--updated"];e.isSilent&&i.push("/S"),e.isForceRunAfter&&i.push("--force-run"),this.installDirectory&&i.push("/D=".concat(this.installDirectory));let n=this.downloadedUpdateHelper==null?null:this.downloadedUpdateHelper.packageFile;n!=null&&i.push("--package-file=".concat(n));let s=()=>{this.spawnLog(bb.join(process.resourcesPath,"elevate.exe"),[r].concat(i)).catch(o=>this.dispatchError(o))};return e.isAdminRightsRequired?(this._logger.info("isAdminRightsRequired is set to true, run installer using elevate.exe"),s(),!0):(this.spawnLog(r,i).catch(o=>{let a=o.code;this._logger.info("Cannot run installer: error code: ".concat(a,', error message: "').concat(o.message,'", will be executed again using elevate if EACCES, and will try to use electron.shell.openItem if ENOENT')),a==="UNKNOWN"||a==="EACCES"?s():a==="ENOENT"?require("electron").shell.openPath(r).catch(l=>this.dispatchError(l)):this.dispatchError(o)}),!0)}async differentialDownloadWebPackage(e,r,i,n){if(r.blockMapSize==null)return!0;try{let s={newUrl:new vb.URL(r.path),oldFile:bb.join(this.downloadedUpdateHelper.cacheDir,Zl.CURRENT_APP_PACKAGE_FILE_NAME),logger:this._logger,newFile:i,requestHeaders:this.requestHeaders,isUseMultipleRangeRequest:n.isUseMultipleRangeRequest,cancellationToken:e.cancellationToken};this.listenerCount(_b.DOWNLOAD_PROGRESS)>0&&(s.onProgress=o=>this.emit(_b.DOWNLOAD_PROGRESS,o)),await new jk.FileWithEmbeddedBlockMapDifferentialDownloader(r,this.httpExecutor,s).download()}catch(s){return this._logger.error("Cannot download differentially, fallback to full download: ".concat(s.stack||s)),process.platform==="win32"}return!1}};eu.NsisUpdater=md});var Cb=w(ne=>{"use strict";var zk=ne&&ne.__createBinding||(Object.create?(function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}):(function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]})),Vk=ne&&ne.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&zk(e,t,r)};Object.defineProperty(ne,"__esModule",{value:!0});ne.NsisUpdater=ne.MacUpdater=ne.RpmUpdater=ne.PacmanUpdater=ne.DebUpdater=ne.AppImageUpdater=ne.Provider=ne.NoOpLogger=ne.AppUpdater=ne.BaseUpdater=void 0;var Ob=wr(),Yk=require("path"),Qk=Zi();Object.defineProperty(ne,"BaseUpdater",{enumerable:!0,get:function(){return Qk.BaseUpdater}});var Tb=Gl();Object.defineProperty(ne,"AppUpdater",{enumerable:!0,get:function(){return Tb.AppUpdater}});Object.defineProperty(ne,"NoOpLogger",{enumerable:!0,get:function(){return Tb.NoOpLogger}});var Xk=_t();Object.defineProperty(ne,"Provider",{enumerable:!0,get:function(){return Xk.Provider}});var Kk=id();Object.defineProperty(ne,"AppImageUpdater",{enumerable:!0,get:function(){return Kk.AppImageUpdater}});var Jk=sd();Object.defineProperty(ne,"DebUpdater",{enumerable:!0,get:function(){return Jk.DebUpdater}});var Zk=ad();Object.defineProperty(ne,"PacmanUpdater",{enumerable:!0,get:function(){return Zk.PacmanUpdater}});var eq=ud();Object.defineProperty(ne,"RpmUpdater",{enumerable:!0,get:function(){return eq.RpmUpdater}});var tq=fd();Object.defineProperty(ne,"MacUpdater",{enumerable:!0,get:function(){return tq.MacUpdater}});var rq=gd();Object.defineProperty(ne,"NsisUpdater",{enumerable:!0,get:function(){return rq.NsisUpdater}});Vk(ci(),ne);var _r;function iq(){if(process.platform==="win32")_r=new(gd()).NsisUpdater;else if(process.platform==="darwin")_r=new(fd()).MacUpdater;else{_r=new(id()).AppImageUpdater;try{let t=Yk.join(process.resourcesPath,"package-type");if(!(0,Ob.existsSync)(t))return _r;console.info("Checking for beta autoupdate feature for deb/rpm distributions");let e=(0,Ob.readFileSync)(t).toString().trim();switch(console.info("Found package-type:",e),e){case"deb":_r=new(sd()).DebUpdater;break;case"rpm":_r=new(ud()).RpmUpdater;break;case"pacman":_r=new(ad()).PacmanUpdater;break;default:break}}catch(t){console.warn("Unable to detect 'package-type' for autoUpdater (beta rpm/deb support). If you'd like to expand support, please consider contributing to electron-builder",t.message)}}return _r}Object.defineProperty(ne,"autoUpdater",{enumerable:!0,get:()=>_r||iq()})});var Pb=w((vW,Db)=>{var F={child:require("child_process"),crypto:require("crypto"),fs:require("fs"),os:require("os"),path:require("path"),process,util:require("util")};function nq(t,e){var r=F.process.platform;if(r==="darwin")return lq(t,e);if(r==="linux")return oq(t,e);if(r==="win32")return mq(t,e);e(new Error("Platform not yet supported."))}function Ft(t){if(typeof t!="string")throw new Error("Expected a string.");return t.replace(/"/g,'\\"')}function sq(){if(arguments.length<1||arguments.length>3)throw new Error("Wrong number of arguments.");var t=arguments[0],e={},r=function(){};if(typeof t!="string")throw new Error("Command should be a string.");if(arguments.length===2)if(F.util.isObject(arguments[1]))e=arguments[1];else if(F.util.isFunction(arguments[1]))r=arguments[1];else throw new Error("Expected options or callback.");else if(arguments.length===3){if(F.util.isObject(arguments[1]))e=arguments[1];else throw new Error("Expected options to be an object.");if(F.util.isFunction(arguments[2]))r=arguments[2];else throw new Error("Expected callback to be a function.")}if(/^sudo/i.test(t))return r(new Error('Command should not be prefixed with "sudo".'));if(typeof e.name>"u"){var i=F.process.title;if(Rb(i))e.name=i;else return r(new Error("process.title cannot be used as a valid name."))}else if(!Rb(e.name)){var n="";return n+="options.name must be alphanumeric only ",n+="(spaces are allowed) and <= 70 characters.",r(new Error(n))}if(typeof e.icns<"u"){if(typeof e.icns!="string")return r(new Error("options.icns must be a string if provided."));if(e.icns.trim().length===0)return r(new Error("options.icns must not be empty if provided."))}if(typeof e.env<"u"){if(typeof e.env!="object")return r(new Error("options.env must be an object if provided."));if(Object.keys(e.env).length===0)return r(new Error("options.env must not be empty if provided."));for(var s in e.env){var o=e.env[s];if(typeof s!="string"||typeof o!="string")return r(new Error("options.env environment variables must be strings."));if(!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(s))return r(new Error("options.env has an invalid environment variable name: "+JSON.stringify(s)));if(/[\r\n]/.test(o))return r(new Error("options.env has an invalid environment variable value: "+JSON.stringify(o)))}}var a=F.process.platform;if(a!=="darwin"&&a!=="linux"&&a!=="win32")return r(new Error("Platform not yet supported."));var l={command:t,options:e,uuid:void 0,path:void 0};nq(l,r)}function oq(t,e){aq(t,function(r,i){if(r)return e(r);var n=[];n.push('cd "'+Ft(F.process.cwd())+'";');for(var s in t.options.env){var o=t.options.env[s];n.push("export "+s+'="'+Ft(o)+'";')}n.push('"'+Ft(i)+'"'),/kdesudo/i.test(i)?(n.push("--comment",'"'+t.options.name+' wants to make changes. Enter your password to allow this."'),n.push("-d"),n.push("--")):/pkexec/i.test(i)&&n.push("--disable-internal-agent");var a="SUDOPROMPT\n";n.push('/bin/bash -c "echo '+Ft(a.trim())+"; "+Ft(t.command)+'"'),n=n.join(" "),F.child.exec(n,{encoding:"utf-8",maxBuffer:bq},function(l,c,u){var h=c&&c.slice(0,a.length)===a;h&&(c=c.slice(a.length)),l&&!h&&(/No authentication agent found/.test(u)?l.message=Sq:l.message=tu),e(l,c,u)})})}function aq(t,e){var r=0,i=["/usr/bin/kdesudo","/usr/bin/pkexec"];function n(){if(r===i.length)return e(new Error("Unable to find pkexec or kdesudo."));var s=i[r++];F.fs.stat(s,function(o){if(o){if(o.code==="ENOTDIR"||o.code==="ENOENT")return n();e(o)}else e(void 0,s)})}n()}function lq(t,e){var r=F.os.tmpdir();if(!r)return e(new Error("os.tmpdir() not defined."));var i=F.process.env.USER;if(!i)return e(new Error("env['USER'] not defined."));Nb(t,function(n,s){if(n)return e(n);t.uuid=s,t.path=F.path.join(r,t.uuid,t.options.name+".app");function o(a,l,c){Ib(F.path.dirname(t.path),function(u){if(a)return e(a);if(u)return e(u);e(void 0,l,c)})}uq(t,function(a,l,c){if(a)return o(a,l,c);hq(t,function(u){if(u)return o(u);dq(t,function(h,f,d){if(h)return o(h,f,d);cq(t,function(y){if(y)return o(y);fq(t,function(A,E,v){if(A)return o(A,E,v);pq(t,o)})})})})})})}function uq(t,e){var r=F.path.dirname(t.path);F.fs.mkdir(r,function(i){if(i)return e(i);var n=F.path.join(r,"sudo-prompt-applet.zip");F.fs.writeFile(n,Eq,"base64",function(s){if(s)return e(s);var o=[];o.push("/usr/bin/unzip"),o.push("-o"),o.push('"'+Ft(n)+'"'),o.push('-d "'+Ft(t.path)+'"'),o=o.join(" "),F.child.exec(o,{encoding:"utf-8"},e)})})}function cq(t,e){var r=F.path.join(t.path,"Contents","MacOS","sudo-prompt-command"),i=[];i.push('cd "'+Ft(F.process.cwd())+'"');for(var n in t.options.env){var s=t.options.env[n];i.push("export "+n+'="'+Ft(s)+'"')}i.push(t.command),i=i.join("\n"),F.fs.writeFile(r,i,"utf-8",e)}function hq(t,e){if(!t.options.icns)return e();F.fs.readFile(t.options.icns,function(r,i){if(r)return e(r);var n=F.path.join(t.path,"Contents","Resources","applet.icns");F.fs.writeFile(n,i,e)})}function fq(t,e){var r=F.path.join(t.path,"Contents","MacOS","applet"),i={cwd:F.path.dirname(r),encoding:"utf-8"};F.child.exec("./"+F.path.basename(r),i,e)}function dq(t,e){var r=F.path.join(t.path,"Contents","Info.plist"),i=Ft(r),n=Ft("CFBundleName"),s=t.options.name+" Password Prompt";if(/'/.test(s))return e(new Error("Value should not contain single quotes."));var o=[];o.push("/usr/bin/defaults"),o.push("write"),o.push('"'+i+'"'),o.push('"'+n+'"'),o.push("'"+s+"'"),o=o.join(" "),F.child.exec(o,{encoding:"utf-8"},e)}function pq(t,e){var r=F.path.join(t.path,"Contents","MacOS");F.fs.readFile(F.path.join(r,"code"),"utf-8",function(i,n){if(i){if(i.code==="ENOENT")return e(new Error(tu));e(i)}else F.fs.readFile(F.path.join(r,"stdout"),"utf-8",function(s,o){if(s)return e(s);F.fs.readFile(F.path.join(r,"stderr"),"utf-8",function(a,l){if(a)return e(a);n=parseInt(n.trim(),10),n===0?e(void 0,o,l):(a=new Error("Command failed: "+t.command+"\n"+l),a.code=n,e(a,o,l))})})})}function Ib(t,e){if(typeof t!="string"||!t.trim())return e(new Error("Argument path not defined."));var r=[];if(F.process.platform==="win32"){if(/"/.test(t))return e(new Error("Argument path cannot contain double-quotes."));r.push('rmdir /s /q "'+t+'"')}else r.push("/bin/rm"),r.push("-rf"),r.push('"'+Ft(F.path.normalize(t))+'"');r=r.join(" "),F.child.exec(r,{encoding:"utf-8"},e)}function Nb(t,e){F.crypto.randomBytes(256,function(r,i){r&&(i=Date.now()+""+Math.random());var n=F.crypto.createHash("SHA256");n.update("sudo-prompt-3"),n.update(t.options.name),n.update(t.command),n.update(i);var s=n.digest("hex").slice(-32);if(!s||typeof s!="string"||s.length!==32)return e(new Error("Expected a valid UUID."));e(void 0,s)})}function Rb(t){return!(!/^[a-z0-9 ]+$/i.test(t)||t.trim().length===0||t.length>70)}function mq(t,e){var r=F.os.tmpdir();if(!r)return e(new Error("os.tmpdir() not defined."));Nb(t,function(i,n){if(i)return e(i);if(t.uuid=n,t.path=F.path.join(r,t.uuid),/"/.test(t.path))return e(new Error("instance.path cannot contain double-quotes."));t.pathElevate=F.path.join(t.path,"elevate.vbs"),t.pathExecute=F.path.join(t.path,"execute.bat"),t.pathCommand=F.path.join(t.path,"command.bat"),t.pathStdout=F.path.join(t.path,"stdout"),t.pathStderr=F.path.join(t.path,"stderr"),t.pathStatus=F.path.join(t.path,"status"),F.fs.mkdir(t.path,function(s){if(s)return e(s);function o(a,l,c){Ib(t.path,function(u){if(a)return e(a);if(u)return e(u);e(void 0,l,c)})}Aq(t,function(a){if(a)return o(a);wq(t,function(l){if(l)return o(l);gq(t,function(c,u,h){if(c)return o(c,u,h);xb(t,function(f){if(f)return o(f);yq(t,o)})})})})})})}function gq(t,e){var r=[];r.push("powershell.exe"),r.push("Start-Process"),r.push("-FilePath"),r.push("\"'"+t.pathExecute.replace(/'/g,"`'")+"'\""),r.push("-WindowStyle hidden"),r.push("-Verb runAs"),r=r.join(" ");var i=F.child.exec(r,{encoding:"utf-8"},function(n,s,o){if(n)return e(new Error(tu),s,o);e()});i.stdin.end()}function yq(t,e){F.fs.readFile(t.pathStatus,"utf-8",function(r,i){if(r)return e(r);F.fs.readFile(t.pathStdout,"utf-8",function(n,s){if(n)return e(n);F.fs.readFile(t.pathStderr,"utf-8",function(o,a){if(o)return e(o);i=parseInt(i.trim(),10),i===0?e(void 0,s,a):(o=new Error("Command failed: "+t.command+"\r\n"+a),o.code=i,e(o,s,a))})})})}function xb(t,e){F.fs.stat(t.pathStatus,function(r,i){r&&r.code==="ENOENT"||i.size<2?setTimeout(function(){F.fs.stat(t.pathStdout,function(n){if(n)return e(new Error(tu));xb(t,e)})},1e3):r?e(r):e()})}function wq(t,e){var r=F.process.cwd();if(/"/.test(r))return e(new Error("process.cwd() cannot contain double-quotes."));var i=[];i.push("@echo off"),i.push("chcp 65001>nul"),i.push('cd /d "'+r+'"');for(var n in t.options.env){var s=t.options.env[n];i.push("set "+n+"="+s.replace(/([<>\\|&^])/g,"^$1"))}i.push(t.command),i=i.join("\r\n"),F.fs.writeFile(t.pathCommand,i,"utf-8",e)}function Aq(t,e){var r=[];r.push("@echo off"),r.push('call "'+t.pathCommand+'" > "'+t.pathStdout+'" 2> "'+t.pathStderr+'"'),r.push('(echo %ERRORLEVEL%) > "'+t.pathStatus+'"'),r=r.join("\r\n"),F.fs.writeFile(t.pathExecute,r,"utf-8",e)}Db.exports.exec=sq;var Eq="UEsDBAoAAAAAAO1YcEcAAAAAAAAAAAAAAAAJABwAQ29udGVudHMvVVQJAAPNnElWLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACACgeXBHlHaGqKEBAAC+AwAAEwAcAENvbnRlbnRzL0luZm8ucGxpc3RVVAkAA1zWSVYtkRBXdXgLAAEE9QEAAAQUAAAAfZNRb5swFIWfl1/BeA9OpSmqJkqVBCJFop1VyKQ9Ta59S6wa27NNCfv1M0naJWTsEXO+c8+9vo7v97UI3sBYruRdeBPNwgAkVYzL6i7cluvpbXifTOLP6bdV+QNngRbcugBvl/lmFYRThBZaC0AoLdMA55uiDLwHQtljGIQ75/RXhNq2jUiviqiqe6FF2CgNxnW5N5t6IGKOhb7M0f0ijj9lnLpk8il+hS5ZrZeNZAIWQqj2ge+B5YoSwX8T5xEbo17ktc40gIZQCm8glK5BuieovP5Dbp3xHSeZrHyCXYxO3wM+2wNtHHkWMAQP/bkxbkOVXPMxKuK0Dz6CMh+Wv3AwQ9gPM7INU1NtVK3Ha8sXlfoB+m6J6b4fRzv0mkezMf6R1Fe5MbG2VYYF+L+lMaGvpIKy01cOC4zzMazYKeNOQYuDYkjfjMcteCWJa8w/Zi2ugubFA5e8buqisw7qU81ltzB0xx3QC5/TFh7J/e385/zL+7+/wWbR/LwIOl/dvHiCXw03YFfEPJ9dwsWu5sV2kwnod3QoeLeL0eGdJJM/UEsDBAoAAAAAAHSBjkgAAAAAAAAAAAAAAAAPABwAQ29udGVudHMvTWFjT1MvVVQJAAMbpQ9XLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACABVHBdH7Dk4KTIIAADIYQAAFQAcAENvbnRlbnRzL01hY09TL2FwcGxldFVUCQADMiPZVVOlD1d1eAsAAQT1AQAABBQAAADtnG9sHEcVwGfti7M1/rONLNVtXHqpzsipis+pHOSWFOzEm25at3XrJI2ozbK+W/suuds79vaSuCKSpaOIxRy1+NSPRPAhlWj7AVRaQCWpTRz+CEo+RSKCCho4K67kVhUyAeV4b3fWt17fXZqKFgHvp8zO3/dmdmfPmtl5L7+8/uPXGWMNELZCaGRMgmjHIlxaBCibdcoGsewCljGCIAiCIAiCIAiCIP7r+M21d67zjb/zEaAdwr1bGHuWMQH2/2wAgqqODj0kf0F+8nGfoFRbJ8p9U0C5g/KRgwEZqZLGfrfwwJx+LP2kVWkelD9zJ2NfBr1nWt2xrhNisxWZ3Ex6MpNSc1Z+soqOO+5i7JMYt7vj9BC5jiZXBwirCT2V1c0qOgZAxwMYt9cbRyxnmUljusa9mKBjGON2tgG/PlXNGyeSRlxNGlOZKjpeBR0KxsFx+MB7VJy5GB46OOSrCLPKfEjrH3/gFry+4zOpuH8sm+VF5srW6ltVjZQ3HVnL3KRDDLsflMSADpyDyjuR0urp6AAdHRgHdOD9iOs6Ypl0OmPUupeecOW19OsQAmn3tzBy4LFH5OED3jz0MbYouM8D460BOdTXCaEF6tsgLkF8GeJPQBj16Rb4PTf5xl2NH4J8a5Vy1N3F3OcZzefMaCo5GeVTuJ2P4cUf/aH5qbbP73/utpfeevdbLzwfYfy+Q80woGan/1E+ljo/703g77IaOJY479t5rqFLDag9OjaTs/R0dCQ5aWrmTHS/qaX1ExnzWC66L2PqY7p5PBnTc71TXnn0sG7mkhkjFx3a0IL30e/rQxB+EXL68J4BBLe73r298DySk5tlGPtJY1BmOhZTc727PBH2Ke+ZhF35nTyP80oQBEEQBPFRcJTZVwpvrxZWpLmJkN0VKT4q2iORUGFBOPfnBuFX9nhELOG67f1D9pWxpw4XVrrmTklz+ZY5Wfwurm/t3ffi9cE+uM41vYbbj2fP5kNXt9sXiopwVRj6xhPlr160mttfuVi4Fs2vXv2rfc5u7UeZfxQ+y4pPh/JrpyUUBjmrofzmadGXKf0eui7KK/ZwJLQUiuRAe+mLUFQ+tFKUV3npd7AU9ytz8iqIiXYoUnoBsqdxDbXk3CXcRov9lYhoW5EQjBxb4NoSY9iQsvn5+QSuusrduAybL3eHIIIbLqyIS9CHlY3loB8rldVKuLfyOsE1+a6zhUVxYsFp3Amqz8tr7Lz8dza1JF8TmC3/syivYVtcfxcWOycWQDvuLcrdnc61y7mGnWsErgmsXDbK5TKkscnypJvGhsuH3TQ2X37YTaPQ8ucw7W6t1LR2TFfjekqb0SGTiedTOmz0klZSSyWf0U01pqVSufXGmThsjs20OpU3Yrjuxbnu4u+GP8b1LO6PcX2L4Q6+v8Q07u9aQFLy71Ckt54TIfjfNdzfDkMYhTAOIXHXh39vCYIgCIIgCIIgCIL4z3Nm+84/Ci1Nn8b0ryHsgbBX1rbgOXD7LZJzNtrC0/gFqYOn8csQ/GONguQchPXzcvy+9CBzvk84HxkO+tJH3bRz5Fb0pb/nS3/fl/6BL/2aL43faLzz3Wbmju8W5p6pttaoR9THjgyZ0zEeH2eqqmbNzLShpXVIpxOqflKP5S1dTehaXDeZqhvHk2bGYOo+LZXal0lnM4ZuWMPJXFazYgmmPp7VjWF9SsunrPVa1HpMn0lPm2r8hGZO3aea+nQyZ+mmmtNjFp5i4oG0lTChE+eDj2pm8lbSgDFoln4yCRp00zQyEDmZtBZLbGxnanHzgWh092d29e/uv+/f+DIQBEEQBEEQBEEQ/7P81rX/FxoZm/Xs/5UmtP8PO/W3M9fGvKoPAEfYXLQJ1HOpmk+AJx80OOb5m/URGG9z9c378rVs9F15tPXP1dS3wvVtC+Q9/H4DFX21fQcY9zvo9eXrj6++D0Af1zfqy9eyx3f16QnVMayufr+zXN+sL99YRx/O69er+RdIgXkNxJv9DfBTDIxLPa6Zudr6enz5euO6ke9Bj7TRzr0noK+JbczfyA9hgOvr9OX98t57XNFX3ydhlOsL+2T8+oK/ucrvNOCfEHbbXhAqeebLB/0V7oYp7+Pt8PsZWnl1+urRpAn7SUCcYBX/hkth95kd2cFYllX3bxB4+xCrzcCO6v4PbXzo1fwbEM/H4ds/f/nCgZH+8k+j0vNPv7Jlz7qPQ1PFx+FVPoZ76ozj42K87YP9/cT7xuf9UfpSeP0MsJvzp0A8/4g3w+78ef4R+F4QBEEQBPH/w1Gm2FeUwturytwpUSnmJfta4Q3h3J8aFeE9xf7d1ZBSOCcqhftZ/m+YKuG6wV4qaQzdGED0Z2jJ/zpa9ZcegjIF7fkVaIBrt11nJxYOOepXpPPyKjsvvytOLcnvCWxJfh87V+xTa0rx1Kpj0a8UFqWJhXL3fgHt9xXn+rCz7Bop3rkTEkNj5e7bIZ7HNRZb/ku5XE6g58HyZUzdj6mLjh1/Pbt7XMt5dvfvtLl1Fbv7BtbhrtyEPW6V038H1yE88yQTTkqC1LJVnIeaCNe7dr3sEPEe6lCb9LWGfa3efvNG8pe5fF8NeW8g3n7jCI+/xOOEVH19KvF9oudHH2n/YOtYgiAIgiAIgiAIgiA+fm69mx3aO8bYtkHn/xlwDq8nkwaavz9h9swzc+DWwRrm71A5CJVVjeChTtk26Fqwu0fxQjUL+9vqHVV/KC53OUd+bJxVfBkw7/gzCO5pr3dOK/g+WUQDeZlV/A2QRwJ5THjn1/xcd9BfhlT1KbgpVwLn+W2amGr2//8CUEsDBBQAAAAIAAVHj0ga7FYjfQEAAKoCAAAhABwAQ29udGVudHMvTWFjT1Mvc3Vkby1wcm9tcHQtc2NyaXB0VVQJAAOJkBBXipAQV3V4CwABBPUBAAAEFAAAAI1SO08cMRDu91cMHIKGxUB5xSGEUqTlFKWMvPYca+EXnjGXy6/PeNcg0qVay+PvObs5U5OLatI0DxvYIwNVm4BdQGIdMhxSkauJ8K1i7FOjvSdwB2A+/WJnXpEJdEGwjvTk0W6HhTW8WldgzKDedVF2Ug2tLn7svz3DDpTFdxWr93C/u7wbVKWyoDhVM/8XZAOPOXvcm+IyXxGcizeaUca0XJ1D0CfQnlEysE2VwbuII0br4gvdCMF37m9IoC39+oxTO2EpS8oZJdtRS0aIKY5/sCQoyLVEMMki6Ghl0BGN9SeuICkPIctXDHDDSB9oGEQi1yZWUAda8EZnIcR/eIOOVao+9TrbkpYFjLmkkHk0KYSGvdt12/e71cP6Hs2c4OJBemtsYusplVX+GLHQ7DKkQ098/ZF38dLEpRCeNUMlMW90BIseeQkWtuu2qKmIyDHCuqFuo1N11Ud/1Cf6CHb7Sfxld2ATklQoUGEDActfZ5326WU74G/HcDv8BVBLAwQKAAAAAADtWHBHqiAGewgAAAAIAAAAEAAcAENvbnRlbnRzL1BrZ0luZm9VVAkAA82cSVYqkRBXdXgLAAEE9QEAAAQUAAAAQVBQTGFwbHRQSwMECgAAAAAAm3lwRwAAAAAAAAAAAAAAABMAHABDb250ZW50cy9SZXNvdXJjZXMvVVQJAANW1klWLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACACAeXBHfrnysfYGAAAf3AAAHgAcAENvbnRlbnRzL1Jlc291cmNlcy9hcHBsZXQuaWNuc1VUCQADH9ZJVnGlD1d1eAsAAQT1AQAABBQAAADt3Xk81Hkcx/Hvb5yVo5bGsVlKbcpRRqFlGZGS5JikRBIdI0OZttMZloqiYwrVjD1UqJaUokTRubG72bZVjqR1VZNjp2XEGo9H+9gt+9h/9tHx8H7N4/fw5MHjYeaPz+P7+P7x/bL9griEPNBm+001J0S+ZbvL/NmKwzWHE0IUHebYuRFCEckjL9v/xSvk2EpCpBXZtrYuDra2Oi4hwSvZgSsIMU9MdPdePcZd1aqQu0p3fDkrcFrs+mPWihMU9y6clp5XEFFdbRrEczCtGtfkL3pWfvBGublJ4ct051kuocYtaaqll/IjdfR+V75vlTdl//AJVZU6elZ5f0S7NO3MaE2xMElhF+TUrHgW2nFYeGTrs/OrhDJN5zMX8ZJVKXrqSUM1Rj03bnf85/pJMXECNdl0D1ctfe/j82imziM2nllSa3t5q8+vP1f38k/k22uN1lmnvfz0b8dGxO+mnh91v7WB2tKdrG3d4vmJaHlTvjGzdMqWcw/9frnCtQpPZK9sMKi/Ey/jzgqIPzBy9/dlf9griI2/u+sjcApozWx6/NXytC+qBTlrhb69fE7J6tgOzpWjFSl8qxihr5dYf/qExoeupY6Ze/j2PfL1azhhZ8fU3eelJY+ylk16UJN6KmOU0M4r+75cZhH/mxNndowNb4wx7TCoN4yvMGu8ySq5l5W5t+xQyYbS/Ome7e0W0sXbC5aktl0LEXNYR9obH7dMT721dbNdT/eFzXNEYSH8GU+bQ5s6YniGcj3fHtgXPbo0Oj4i3d5G1Fjfm/Ng7kgpjQDNxw4RRnu+Vloy5ZE3J6OpwlFBzaxS25He2h3lJuizO70zJPLUYtks14RE5yrD8y2tXa5l5Wqh/NBY06yoiCLF08Nk9A5Ojbs43GmR1Ch/PaZsLf3e6uPRSrIM1ROqGjt80leqfdxYbNn+WV7K7ZKiy/t6r1/3ie46V5432T/Oahs9V7NnVzb9zoq2rFgvPxXrcAMzmvWnGjof/RpdsZThIEpex6DGbd5h6STaOyZXxV/YfW9u4KyllmZ3X15IMHHLSJtVPSOvULCsz2TyPC/WL9kGSme/1L01SSzjfbHnqk+OV7OBmevZeo3DBR7lXT5drT0MkX5PwDd1EQ0ebfkh1zy/L8ydd+VJ4CLuRndNjuwj+vMfU8q2l2l1rGtr8FC2D+fdSGk81eltuTjYSMk++4BMd0DXQo35iXbZndGdcXkGFyeG6b28evF22M2w22HlYSXetGSLW4cfFT00WqvN9bkqCujQ9KzdSt+snr+qmbcme+5Y3cDRn9BDLps+dPVltE9UkPeb6XovineiVUznTznyuZaSn/ZvR8VeRUYLqe3iHFqnU6+7+4LmtfsmaS0MdjIvslFJGG/rn7DPdMGLcx4d6eP2Oz92Y49kWbBUjudU2ijHnc7YIODQxD1aPx8PynVr+cmvJoy2+M5nQa2Kt0dvdPxp73LNU6aTeaktTfHH1L+8Pm/XalZcFcfzYxlhTefuzjRGobLKEqPZh8QKxUXWbU/ERvW78ghvTGTUNd0g9YqbcjUy5h0xVbn3S7SS54SOqKt88UR0qZuxKfxlZfODUm52o2HkGTOLw5dqhevvWjH7ssiqxAhKwA91d1nWG9w/GJIc7GwWbKKe/mAsGRqXBb87P10jH8/0LY6kpGQV1KcuAwAAeCt4LiVFWRJKs4DJ6p9GxGHWfLuTM5dt61/pzCCE7vLmSodGJM/ASqdzU2U3VjpY6WClg5XOICudUaI3VjocuWCsdAAAAAAAAAAAAAAAAD5o1Gmr054TSoqWxPvnfrLxVEIc29/cT5YmkmdgPzlCSz8a+8nYT8Z+MvaTB9lPZpJX+8lRktFyRdDF0m6IdcF2MgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC8ddD8G5oJkUuQnAXwnvxLAAAAADDkEFURRckVE6rIv+Tb1078MiZEetubJ34RHckzcOIXd8uWTpz4hRO/cOIXTvwa5MQvoidZ5S8a9h8nfl1QVhipQ6jyyWeuvTaBGP3D5fwgE4gpeQYmUCZ7XQ0mECYQJhAm0GATyOfVmYOU4sAdNi+cOUpm/9cdNv2Di8kkFN3mYOtrg8sE14xicGFwYXDhmlEAAD5w/Os1o8bTcM0oVjpY6WClg2tGAQAAAAAAAAAAAAAAgL/wb9eMBpow+r817yN/fwnJf33P5g78nWofEZNXD3u95GdSkh3o135/aL2i3vl/gHf/7t59oDlnDSHS8gQhNGQL8uWs6P+iwPYLDuIOzARqyM+E9QOfA3PIfw4IIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhND70J9QSwMEFAAAAAgA7VhwR/dYplZAAAAAagEAAB4AHABDb250ZW50cy9SZXNvdXJjZXMvYXBwbGV0LnJzcmNVVAkAA82cSVZTpQ9XdXgLAAEE9QEAAAQUAAAAY2BgZGBgYFQBEiDsxjDygJQDPlkmEIEaRpJAQg8kLAMML8bi5OIqIFuouKA4A0jLMTD8/w+S5AdrB7PlBIAEAFBLAwQKAAAAAADtWHBHAAAAAAAAAAAAAAAAJAAcAENvbnRlbnRzL1Jlc291cmNlcy9kZXNjcmlwdGlvbi5ydGZkL1VUCQADzZxJVi2REFd1eAsAAQT1AQAABBQAAABQSwMEFAAAAAgA7VhwRzPLNU9TAAAAZgAAACsAHABDb250ZW50cy9SZXNvdXJjZXMvZGVzY3JpcHRpb24ucnRmZC9UWFQucnRmVVQJAAPNnElWU6UPV3V4CwABBPUBAAAEFAAAACWJOw6AIBAFe08DCBVX2QbWhZgQ1vCpCHcXtHkzkzegtCDB5Xp/g0+UyihARnb70kL/UbvffYpjQODcmk9zKXListxCoUsZA7EQ5S0+dVq085gvUEsDBAoAAAAAAIeBjkgAAAAAAAAAAAAAAAAbABwAQ29udGVudHMvUmVzb3VyY2VzL1NjcmlwdHMvVVQJAAM9pQ9XLZEQV3V4CwABBPUBAAAEFAAAAFBLAwQUAAAACAAJgI5ICl5liTUBAADMAQAAJAAcAENvbnRlbnRzL1Jlc291cmNlcy9TY3JpcHRzL21haW4uc2NwdFVUCQADcaIPV1OlD1d1eAsAAQT1AQAABBQAAAB9UMtOAkEQrNldd9dhH3Dz6NGYiPIJHjTxLCZeF9iDcXEJC0RvfoI/4sEfIvoHPEQEhbIHvOok01U16emu7vOkaF2dXu7XqrUTcyMATkxCwYKthCAUbmciAQ8O11yFcGBfbF/4jR24WmCvWjwUeXqfNutn13XyEeYYHkqKam+kghdJGfUCvwIfB6jiGAX6aCHHETroCrYFe6IKNEXfGOXChc0v7HKpBRzdSFrtELvbumKVC80F/FIjzwe9bj91uZRuXJuwAiLjNi7DlsxPaJSUAMrCFOeac3GfpINennQ6d/0sA4z7JxzKiVCCV+YHAs74LuuIONUi//4RIoC63czrIbYQS3PFicWJcTMTv1JHmocmROLJ45gjzfHvXJqjf7ZZ4RT+61uaBbDipGh2ZanBcjh8/gFQSwECHgMKAAAAAADtWHBHAAAAAAAAAAAAAAAACQAYAAAAAAAAABAA7UEAAAAAQ29udGVudHMvVVQFAAPNnElWdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgAoHlwR5R2hqihAQAAvgMAABMAGAAAAAAAAQAAAKSBQwAAAENvbnRlbnRzL0luZm8ucGxpc3RVVAUAA1zWSVZ1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAAB0gY5IAAAAAAAAAAAAAAAADwAYAAAAAAAAABAA7UExAgAAQ29udGVudHMvTWFjT1MvVVQFAAMbpQ9XdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgAVRwXR+w5OCkyCAAAyGEAABUAGAAAAAAAAAAAAO2BegIAAENvbnRlbnRzL01hY09TL2FwcGxldFVUBQADMiPZVXV4CwABBPUBAAAEFAAAAFBLAQIeAxQAAAAIAAVHj0ga7FYjfQEAAKoCAAAhABgAAAAAAAEAAADtgfsKAABDb250ZW50cy9NYWNPUy9zdWRvLXByb21wdC1zY3JpcHRVVAUAA4mQEFd1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAADtWHBHqiAGewgAAAAIAAAAEAAYAAAAAAABAAAApIHTDAAAQ29udGVudHMvUGtnSW5mb1VUBQADzZxJVnV4CwABBPUBAAAEFAAAAFBLAQIeAwoAAAAAAJt5cEcAAAAAAAAAAAAAAAATABgAAAAAAAAAEADtQSUNAABDb250ZW50cy9SZXNvdXJjZXMvVVQFAANW1klWdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgAgHlwR3658rH2BgAAH9wAAB4AGAAAAAAAAAAAAKSBcg0AAENvbnRlbnRzL1Jlc291cmNlcy9hcHBsZXQuaWNuc1VUBQADH9ZJVnV4CwABBPUBAAAEFAAAAFBLAQIeAxQAAAAIAO1YcEf3WKZWQAAAAGoBAAAeABgAAAAAAAAAAACkgcAUAABDb250ZW50cy9SZXNvdXJjZXMvYXBwbGV0LnJzcmNVVAUAA82cSVZ1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAADtWHBHAAAAAAAAAAAAAAAAJAAYAAAAAAAAABAA7UFYFQAAQ29udGVudHMvUmVzb3VyY2VzL2Rlc2NyaXB0aW9uLnJ0ZmQvVVQFAAPNnElWdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgA7VhwRzPLNU9TAAAAZgAAACsAGAAAAAAAAQAAAKSBthUAAENvbnRlbnRzL1Jlc291cmNlcy9kZXNjcmlwdGlvbi5ydGZkL1RYVC5ydGZVVAUAA82cSVZ1eAsAAQT1AQAABBQAAABQSwECHgMKAAAAAACHgY5IAAAAAAAAAAAAAAAAGwAYAAAAAAAAABAA7UFuFgAAQ29udGVudHMvUmVzb3VyY2VzL1NjcmlwdHMvVVQFAAM9pQ9XdXgLAAEE9QEAAAQUAAAAUEsBAh4DFAAAAAgACYCOSApeZYk1AQAAzAEAACQAGAAAAAAAAAAAAKSBwxYAAENvbnRlbnRzL1Jlc291cmNlcy9TY3JpcHRzL21haW4uc2NwdFVUBQADcaIPV3V4CwABBPUBAAAEFAAAAFBLBQYAAAAADQANANwEAABWGAAAAAA=",tu="User did not grant permission.",Sq="No polkit authentication agent found.",bq=134217728});var Gb=w((TW,Wb)=>{var{autoUpdater:as}=Cb(),{app:yd,session:Fb}=require("electron"),_q=Pb(),Lb=require("path"),ru=require("fs"),$b=zt(),vq=Zt(),kb=vn(),Oq=ga(),Tq=(t,e)=>{let r="".concat(typeof t=="string"?t:"0").split(".").map(Number),i="".concat(typeof e=="string"?e:"0").split(".").map(Number),n=Math.max(r.length,i.length);for(let s=0;s<n;s++){let o=r[s]||0,a=i[s]||0;if(o>a)return!0;if(o<a)return!1}return!1},en,Uo,Or,tn,Bo,Me,hi,fe,vr,iu,Mb,Ub,Bb,jb,Hb,qb;Wb.exports=(qb=class extends vq{constructor(r){super(r);I(this,fe);I(this,en,!0);I(this,Uo,!1);I(this,Or,!1);I(this,tn,!1);I(this,Bo,!1);I(this,Me,{version:null,filePath:null,progress:0});I(this,hi,null);_(this,"check",()=>{if(!p(this,en)||p(this,Or))return!1;U(this,Or,!0);try{U(this,Me,{version:null,filePath:null,progress:0}),k(this,fe,vr).call(this),kb.LINUX===process.platform?k(this,fe,Mb).call(this):k(this,fe,Ub).call(this)}catch{}return!0});_(this,"install",async()=>{if(!p(this,en)||typeof p(this,Me).version!="string"||typeof p(this,Me).filePath!="string"||p(this,tn))return!1;U(this,tn,!0);try{if(typeof p(this,Me).filePath!="string")throw new Error("Nothing to install");k(this,fe,iu).call(this),kb.LINUX===process.platform?await k(this,fe,Bb).call(this):k(this,fe,jb).call(this),k(this,fe,iu).call(this,!1)}catch(r){k(this,fe,iu).call(this,!1,"".concat(r.message??r))}return!0});U(this,en,!0),this._register("updater"),U(this,hi,Lb.join(Oq.getPathCache(),"pending"))}async start(){if(!p(this,Uo)&&(U(this,Uo,!0),!!p(this,en)))try{ru.existsSync(p(this,hi))&&ru.rmSync(p(this,hi),{recursive:!0,force:!0}),ru.mkdirSync(p(this,hi),{recursive:!0})}catch{}}isChecking(){return p(this,Or)}isInstalling(){return p(this,tn)}},en=new WeakMap,Uo=new WeakMap,Or=new WeakMap,tn=new WeakMap,Bo=new WeakMap,Me=new WeakMap,hi=new WeakMap,fe=new WeakSet,vr=function(){if(typeof this._oglama.main?.view.webContents?.send=="function"){let r=["ipc:updater:check",[p(this,Me)],{type:"req"}];this._oglama.main?.view.webContents?.send($b.WINDOW_MAIN,r)}},iu=function(r=!0,i=null){if(r||U(this,tn,!1),typeof this._oglama.main?.view.webContents?.send=="function"){let n=["ipc:updater:install",[{working:r,error:i}],{type:"req"}];this._oglama.main?.view.webContents?.send($b.WINDOW_MAIN,n)}},Mb=async function(){try{let r=await(await fetch("https://api.github.com/repos/oglama/oglama/releases/latest")).json(),i=(Array.isArray(r?.assets)?r.assets:[]).find(s=>typeof s?.name=="string"&&s.name.endsWith(".deb")&&typeof s.browser_download_url=="string");if(!i)throw new Error("No assets released");let n=i.browser_download_url.replace(/^.*?\-(\d+\.\d+\.\d+)\.deb$/,"$1");if(!Tq(n,yd.getVersion()))throw new Error("No update available");p(this,Me).version=n,k(this,fe,vr).call(this),p(this,Me).filePath=await k(this,fe,Hb).call(this,i.browser_download_url,i.name)}catch{}k(this,fe,vr).call(this),U(this,Or,!1)},Ub=async function(){p(this,Bo)||(U(this,Bo,!0),as.on("update-not-available",r=>{k(this,fe,vr).call(this),U(this,Or,!1)}),as.on("update-available",r=>{p(this,Me).version=r?.version??null,k(this,fe,vr).call(this)}),as.on("download-progress",r=>{p(this,Me).progress=parseInt(r.percent,10),k(this,fe,vr).call(this)}),as.on("update-downloaded",r=>{p(this,Me).filePath=r.downloadedFile,p(this,Me).progress=100,k(this,fe,vr).call(this),U(this,Or,!1)})),as.checkForUpdates()},Bb=async function(){return new Promise((r,i)=>{let n='"'.concat(p(this,Me).filePath.replace(/(["\\$`])/g,"\\$1"),'"');_q.exec("dpkg -i ".concat(n),{name:"Oglama"},s=>{if(s){i(s);return}r(),setTimeout(()=>yd.relaunch(),yd.quit(),250)})})},jb=function(){as.quitAndInstall()},Hb=async function(r,i){let n=Lb.join(p(this,hi),i);return ru.existsSync(n)?(p(this,Me).progress=100,n):new Promise((s,o)=>{let a=(l,c)=>{c.setSavePath(n),c.on("updated",(u,h)=>{h==="progressing"&&(p(this,Me).progress=Math.floor(c.getReceivedBytes()/c.getTotalBytes()*100),k(this,fe,vr).call(this))}),c.once("done",(u,h)=>{if(Fb.defaultSession.removeListener("will-download",a),h==="completed"){s(c.getSavePath());return}o(new Error("Download failed: ".concat(h)))})};Fb.defaultSession.once("will-download",a),this._oglama.main?.view.webContents.downloadURL(r)})},qb)});var Qb=w((IW,Yb)=>{var{execSync:wd}=require("child_process"),{shell:Cq}=require("electron"),zb=require("crypto"),Ad=require("os"),Rq=require("fs"),Iq=Zt(),it=vn(),ls,us,cs,fi,Vb;Yb.exports=(Vb=class extends Iq{constructor(r){super(r);I(this,ls,null);I(this,us,null);I(this,cs,null);I(this,fi,null);_(this,"getOS",()=>{if(typeof p(this,fi)!="string")switch(process.platform){case it.MACOS:U(this,fi,"macos");break;case it.WINDOWS:U(this,fi,"windows");break;case it.LINUX:U(this,fi,"linux");break}return p(this,fi)});_(this,"getName",()=>{if(typeof p(this,us)!="string"){let r=null;switch(process.platform){case it.MACOS:r="echo $(scutil --get LocalHostName).local";break;case it.WINDOWS:case it.LINUX:r="hostname";break}if(r!==null)try{let i=wd(r).toString();U(this,us,i.replace(/[\r\n\s]+/g,"").toLowerCase())}catch{}}return p(this,us)});_(this,"getUUID",()=>{if(typeof p(this,ls)!="string"){let r=null,i=process.arch==="ia32"&&process.env.hasOwnProperty("PROCESSOR_ARCHITEW6432")?"%windir%\\sysnative\\cmd.exe /c %windir%\\System32":"%windir%\\System32";switch(process.platform){case it.MACOS:r="ioreg -rd1 -c IOPlatformExpertDevice";break;case it.WINDOWS:r="".concat(i,"\\REG.exe")+" QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid";break;case it.LINUX:r="( cat /var/lib/dbus/machine-id /etc/machine-id 2> /dev/null || hostname ) | head -n 1 || :";break}if(r!==null)try{let n=wd(r).toString();switch(process.platform){case it.MACOS:n=n.replace(/^.*?\bIOPlatformUUID"\s*=\s*"(.*?)".*$/gs,"$1");break;case it.WINDOWS:n=n.split("REG_SZ")[1];break}n=n.replace(/[\r\n\s]+/g,"");let s=zb.createHash("md5").update([n,n,n].join("::")).digest("hex");U(this,ls,[s.slice(0,8),s.slice(8,12),s.slice(12,16),s.slice(16,20),s.slice(20)].join("-"))}catch{}}return p(this,ls)});_(this,"getSerialNumber",()=>{if(typeof p(this,cs)!="string"){let r=null;switch(process.platform){case it.MACOS:r="ioreg -l | grep IOPlatformSerialNumber";break;case it.WINDOWS:r='powershell -Command "(Get-CimInstance -ClassName Win32_BIOS).SerialNumber"';break;case it.LINUX:r='lsblk -o UUID -n /dev/sda* | grep -v "^$" | grep -vE "^.{,20}$" | sed -n 1p';break}if(r!==null)try{let i=wd(r).toString();switch(process.platform){case it.MACOS:i=i.replace(/^.*?\bIOPlatformSerialNumber"\s*=\s*"(.*?)".*$/gs,"$1");break}i=i.replace(/[\r\n\s]+/g,"");let n=zb.createHash("md5").update([i,i,i].join("::")).digest("hex");U(this,cs,[n.slice(0,8),n.slice(8,12),n.slice(12,16),n.slice(16,20),n.slice(20)].join("-"))}catch{}}return p(this,cs)});_(this,"getRam",()=>Math.ceil(Ad.totalmem()/1024**3));_(this,"getCpuArch",()=>Ad.arch());_(this,"getCpuName",()=>{let r="",i=Ad.cpus();return Array.isArray(i)&&i.length&&(r=i[0].model),r});_(this,"setPostAuth",r=>this._oglama.setPostAuth(!!r));_(this,"getPostAuth",()=>this._oglama.getPostAuth());_(this,"showFileInFolder",r=>{let i=!1;do{if(typeof r!="string"||!r.length)break;try{if(!Rq.existsSync(r))break;Cq.showItemInFolder(r),i=!0}catch{}}while(!1);return i});_(this,"request",async(r,i="GET",n={},s={},o=!0,a=60,l=!0)=>{i=typeof i=="string"?i.replace(/[^a-z]+/i,"").toUpperCase():"",["GET","HEAD","POST","PUT","DELETE","CONNECT","OPTIONS","TRACE","PATCH"].includes(i)||(i="GET"),(typeof n!="object"||n===null)&&(n={}),(typeof s!="object"||s===null)&&(s={});let c=new AbortController,u=setTimeout(()=>c.abort("Request timed out after ".concat(a,"s")),a*1e3);try{let h={method:i,headers:{...o?{"content-type":"application/json"}:{},...s},signal:c.signal,priority:"high",redirect:"follow"};Object.keys(n).length&&(h.body=JSON.stringify(n));let f=await fetch(r,h);return!l&&f.body?.cancel?.(),{ok:f.ok,status:f.status,headers:Object.fromEntries(f.headers.entries()),data:l?o?await f.json():await f.text():null}}catch(h){throw new Error("".concat(h.message??h))}finally{clearTimeout(u)}});this._register("device")}},ls=new WeakMap,us=new WeakMap,cs=new WeakMap,fi=new WeakMap,Vb)});var t_=w((DW,e_)=>{var{ipcMain:Xb,session:Nq,BrowserWindow:Kb}=require("electron"),Jb=require("path"),xq=zt(),Dq=Zt(),ge,Tr,Zb;e_.exports=(Zb=class extends Dq{constructor(r){super(r);I(this,ge,{});I(this,Tr,{});_(this,"list",()=>Object.keys(p(this,ge)));_(this,"closeAll",()=>{let r=Object.keys(p(this,ge)).length>0;for(let i of Object.keys(p(this,ge)))this.close(i);return r});_(this,"open",r=>{let i=!1;do{if(typeof r!="string"||!r.length)break;if(typeof p(this,ge)[r]<"u"){typeof p(this,ge)[r]?.webContents?.focus=="function"&&p(this,ge)[r].webContents.focus();break}p(this,ge)[r]=new Kb({show:!1,minWidth:this._oglama.config.getSourceMinWidth(),minHeight:this._oglama.config.getSourceMinHeight(),width:this._oglama.config.getSourceMinWidth(),height:this._oglama.config.getSourceMinHeight(),icon:Jb.join(this._oglama.rootPath,"res/icons/icon.png"),resizable:!0,fullscreenable:!1,titleBarStyle:"default",title:"Agent source code",useContentSize:!0,autoHideMenuBar:!0,backgroundColor:"#000",webPreferences:{backgroundThrottling:!1,imageAnimationPolicy:"noAnimation",spellcheck:!1,preload:Jb.join(this._oglama.rootPath,"lib/preloader/entry/source.js"),nodeIntegration:!0,devTools:!1,session:Nq.defaultSession,cache:!1,webSecurity:!1,allowRunningInsecureContent:!0,additionalArguments:["--agent-id=".concat(r)]}});let n=xq.getSourceChannelName(r);p(this,Tr)[r]={channel:n,listener:(s,...o)=>{o.length>=3&&p(this,ge)[r].webContents.send(n,o)}},Xb.on(p(this,Tr)[r].channel,p(this,Tr)[r].listener),p(this,ge)[r].setMenu(null),p(this,ge)[r].on("closed",()=>{Xb.off(p(this,Tr)[r].channel,p(this,Tr)[r].listener),delete p(this,Tr)[r],delete p(this,ge)[r]}),p(this,ge)[r].webContents.on("did-finish-load",()=>{p(this,ge)[r].show(),p(this,ge)[r].webContents.focus()}),p(this,ge)[r].loadURL("http://localhost:".concat(this._oglama.config.getServerPort(),"/source-code/")),i=!0}while(!1);return i});_(this,"close",r=>{let i=!1;return typeof p(this,ge)[r]?.destroy=="function"&&(p(this,ge)[r].destroy(),i=!0),i});_(this,"webContents",async(r,i,n)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(!(p(this,ge)[r]instanceof Kb))throw new Error("Invalid agent ID");if(typeof i!="string"||typeof p(this,ge)[r].webContents[i]!="function")throw new Error("Invalid source webContents method: ".concat(i));return Array.isArray(n)||(n=[]),await p(this,ge)[r].webContents[i](...n)});this._register("source")}},ge=new WeakMap,Tr=new WeakMap,Zb)});var o_=w((LW,s_)=>{var{ipcMain:r_,WebContentsView:te,BrowserWindow:Pq,session:Fq}=require("electron"),i_=require("path"),n_=require("fs"),Lt=zt(),Lq=Zt(),rn,jo,Ho,hs,W,sr,or,nn,fs,di,sn,Ed,Wo,nu,on,Cr;s_.exports=(rn=class extends Lq{constructor(r){super(r);I(this,jo);I(this,Ho);I(this,hs,{});I(this,W,{});I(this,sr,{});I(this,or,"");I(this,nn,[]);I(this,fs,{});I(this,di,{});I(this,sn,()=>{if(!Object.keys(p(this,W)).length)return;let r=p(this,jo)-this.constructor.MARGIN_LEFT,i=p(this,Ho)-(this.constructor.MARGIN_TOP+this.constructor.MARGIN_BOTTOM);for(let n of Object.keys(p(this,W))){let s=n===p(this,or)?this.constructor.MARGIN_LEFT:100-r,o=n===p(this,or)?this.constructor.MARGIN_TOP:50-i,a=p(this,W)[n];a instanceof te&&a.setBounds({x:s,y:o,width:r,height:i})}});I(this,Ed,async r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(p(this,nn).reduce((n,s)=>s.agentId===r?s:n,null)!==null)throw new Error("Previous focus request pending");return new Promise((n,s)=>{p(this,nn).push({agentId:r,resolve:n,reject:s})})});I(this,Wo,r=>{r="".concat(r);let i=null,n=!1;do{if(r.match(/^[a-z\d]$/gi)){i=r,n=r!==r.toLowerCase();break}if('~!@#$%^&*()_+{}:"|<>?'.indexOf(r)!==-1&&r.length===1){i=r,n=!0;break}if(" `-=[];'\\,./".indexOf(r)!==-1&&r.length===1){i=r,n=!1;break}let s={backspace:"Backspace",capslock:"CapsLock",pagedown:"PageDown",pageup:"PageUp",insert:"Insert",delete:"Delete",escape:"Escape",space:"Space",enter:"Enter",right:"Right",home:"Home",down:"Down",left:"Left",end:"End",tab:"Tab",up:"Up",f1:"F1",f2:"F2",f3:"F3",f4:"F4",f5:"F5",f6:"F6",f7:"F7",f8:"F8",f9:"F9",f10:"F10",f11:"F11",f12:"F12"};typeof s[r]<"u"&&(i=s[r])}while(!1);return{keyCode:i,shift:n}});I(this,nu,async(r,i,n)=>{if(typeof r!="string"||!r.length)return!1;let s=p(this,W)[r];if(!(s instanceof te)||typeof i!="string"||i.length!==1)return!1;if(!s.metadata.controlled)throw new Error("Typing aborted");let{keyCode:o,shift:a}=p(this,Wo).call(this,i);if(o!==null){let c=a?["shift"]:[];a&&s.webContents.sendInputEvent({type:"keyDown",keyCode:"Shift",modifiers:c}),s.webContents.sendInputEvent({type:"keyDown",keyCode:o,modifiers:c}),s.webContents.sendInputEvent({type:"char",keyCode:i,modifiers:c}),s.webContents.sendInputEvent({type:"keyUp",keyCode:o,modifiers:c}),a&&s.webContents.sendInputEvent({type:"keyUp",keyCode:"Shift",modifiers:[]})}else s.webContents.sendInputEvent({type:"char",keyCode:i});let l=Math.round(1e3/n-2)+Math.floor(Math.random()*5);return await new Promise(c=>setTimeout(c,l)),!0});I(this,on,(r,i=!0)=>{if(typeof r=="string"){let n=["http://localhost:".concat(this._oglama.config.getServerPort(),"/home"),"about:home"],s=n[i?0:1],o=n[i?1:0];if(r.indexOf(s)===0)return"".concat(o).concat(r.substring(s.length))}return r});I(this,Cr,r=>{let i=p(this,W)[r];i instanceof te&&(i.metadata.statusCode=null,i.metadata.domReady=!1,i.metadata.domError=null)});_(this,"setControlled",(r,i=!0)=>{let n=p(this,W)[r];if(!(n instanceof te))return!1;let s=!!i!==n.metadata.controlled;return n.metadata.controlled=!!i,s});_(this,"setWindowSize",(r,i)=>{U(this,jo,r),U(this,Ho,i),p(this,sn).call(this)});_(this,"list",()=>Object.keys(p(this,W)));_(this,"removeAll",()=>{let r=Object.keys(p(this,W)).length>0;for(let i of Object.keys(p(this,W)))this.remove(i);return r});_(this,"add",(r,i,n=!1)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(p(this,W)[r]instanceof te)return!1;if(i=p(this,on).call(this,i,!1),typeof i!="string"||!i.match(/^https?:\/\//gi))throw new Error("Invalid URL");let s=new te({width:this._oglama.config.getMainMinWidth()-this.constructor.MARGIN_LEFT,height:this._oglama.config.getMainMinHeight()-(this.constructor.MARGIN_TOP+this.constructor.MARGIN_BOTTOM),resizable:!1,backgroundColor:"#333",webPreferences:{transparent:!0,disableBlinkFeatures:["FreezeFramesOnVisibility","DispatchHiddenVisibilityTransitions"].join(","),preload:i_.join(this._oglama.rootPath,"lib/preloader/entry/target.js"),additionalArguments:["--agent-id=".concat(r)],partition:"persist:target-".concat(r),imageAnimationPolicy:"noAnimation",allowRunningInsecureContent:!0,backgroundThrottling:!1,contextIsolation:!0,nodeIntegration:!0,spellcheck:!1,devTools:!0}});s.metadata={agentId:r,controlled:!1,homeUrl:i,statusCode:null,domReady:!1,domError:null,downloads:{pending:[],files:{}}},s.webContents.on("ready-to-show",()=>{s.webContents.setZoomFactor(1),s.webContents.setVisualZoomLevelLimits(1,1)}),s.webContents.setZoomLevel(0),s.webContents.setAudioMuted(!0),s.webContents.on("will-prevent-unload",u=>{u.preventDefault()});let o=u=>{this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:nav:start",[r,p(this,on).call(this,u)],{type:"req"}])},a=(u=!0)=>{u&&this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:cancel-promises",r,s.metadata.domError]),this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:nav:end",[r,s.metadata.domError===null?1:0,s.webContents?.navigationHistory.canGoBack()??!1,s.webContents?.navigationHistory.canGoForward()??!1],{type:"req"}])};s.webContents.on("did-navigate-in-page",(u,h,f)=>{f&&(o(h),a(!1))}),s.webContents.on("did-start-navigation",u=>{u.isMainFrame&&!u.isSameDocument&&(p(this,Cr).call(this,r),o(u.url))}),s.webContents.on("did-finish-load",()=>{if(Number.isInteger(s.metadata.statusCode)&&s.metadata.statusCode>=400){s.metadata.domReady||(s.metadata.domError="Status code ".concat(s.metadata.statusCode),s.metadata.domReady=!0,a());return}s.webContents.executeJavaScript('new Promise(resolve => {\n                        const a = window.alert;\n                        const c = window.confirm;\n                        const s = JSON.stringify;\n\n                        window.alert = (m) => a("::"+s({t:"alert",a:"'.concat(r,'",m:m??""}));\n                        Object.defineProperty(window.alert, "name", { value: "alert", configurable: true });\n                        Object.defineProperty(window.alert, "length", { value: 0, configurable: true });\n\n                        window.confirm = (m) => c("::"+s({t:"confirm",a:"').concat(r,'",m:m??""}));\n                        Object.defineProperty(window.confirm, "name", { value: "confirm", configurable: true });\n                        Object.defineProperty(window.confirm, "length", { value: 0, configurable: true });\n\n                        window.prompt = (m, d) => (a("::"+s({t:"prompt",a:"').concat(r,'",m:m??"",d:d??""})),d??"");\n                        Object.defineProperty(window.prompt, "name", { value: "prompt", configurable: true });\n                        Object.defineProperty(window.prompt, "length", { value: 0, configurable: true });\n\n                        const originalToString = Function.prototype.toString;\n                        Function.prototype.toString = function (...args) {\n                            if (this === window.alert) {\n                                return "function alert() { [native code] }";\n                            }\n                            if (this === window.confirm) {\n                                return "function confirm() { [native code] }";\n                            }\n                            if (this === window.prompt) {\n                                return "function prompt() { [native code] }";\n                            }\n                            if (this === Function.prototype.toString) {\n                                return "function toString() { [native code] }";\n                            }\n                            return originalToString.apply(this, args);\n                        };\n\n                        "complete" === document.readyState \n                            ? resolve() \n                            : window.addEventListener("load", () => resolve());\n                    });').replace(/[\n\s]{2,}/g," ")).then(()=>{setTimeout(()=>{s.metadata.domReady||(s.metadata.domReady=!0,a())},1e3)})}),s.webContents.session.webRequest.onCompleted({urls:["*://*/*"]},u=>{u.resourceType==="mainFrame"&&(s.metadata.statusCode=u.statusCode)}),s.webContents.on("did-fail-load",(u,h,f,d,y)=>{y&&(s.metadata.domError=f,s.metadata.domReady=!0,a())});let l=Fq.fromPartition("persist:target-".concat(r));l.setPermissionCheckHandler((u,h,f,d)=>!0),l.setPermissionRequestHandler((u,h,f,d)=>{f(!0)}),l.removeAllListeners("will-download"),l.on("will-download",(u,h)=>{let f=new Date().getTime(),d=s.metadata.downloads.pending.shift();if(typeof d!="string"){s.metadata.controlled&&(this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:download:skipped",[r,h.getFilename()],{type:"req"}]),u.preventDefault()),h.once("done",(N,H)=>{a()});return}let y=h.getTotalBytes(),{runId:A,outputKey:E,timeout:v,extension:O}=s.metadata.downloads.files[d],{fileName:R,filePath:L,minSize:oe,maxSize:G}=this._oglama.diskStorage.outputFilesInit(r,A,E,typeof O=="string"&&O.length?O:i_.extname(h.getFilename()).substring(1)),z=(N=null)=>{typeof s.metadata.downloads.files[d]=="object"&&!s.metadata.downloads.files[d].done&&(s.metadata.downloads.files[d].done=!0,s.metadata.downloads.files[d].error=N,this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:download:info",[r,d,{fileName:R,totalBytes:y,progress:"100",done:!0,error:N}],{type:"req"}]),N!==null&&(h.cancel(),this._oglama.diskStorage.outputFilesDelete(r,A,R)))};if(y>0){if(Number.isInteger(oe)&&y<oe*1048576){z('Minimum file size not met for "'.concat(R,'" (').concat((y/1048576).toFixed(3),"MB)"));return}if(Number.isInteger(G)&&y>G*1048576){z('Maximum file size exceeded for "'.concat(R,'" (').concat((y/1048576).toFixed(3),"MB)"));return}}if(!s.metadata.controlled){z('Download cancelled for "'.concat(R,'"'));return}h.setSavePath(L),s.metadata.downloads.files[d].filePath=L;let S=!1;h.on("updated",(N,H)=>{if(new Date().getTime()-f>=v*1e3){N.preventDefault(),z('Download timed out for "'.concat(R,'" after ').concat(v,"s"));return}if(!s.metadata.controlled){N.preventDefault(),z('Download cancelled for "'.concat(R,'"'));return}if(H==="progressing"&&(!S||y>0)){S=!0;let P=h.getReceivedBytes(),Q=y>0?(P/y*100).toFixed(2):"0";this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:download:info",[r,d,{fileName:R,totalBytes:y,progress:Q,done:!1,error:null}],{type:"req"}])}}),h.once("done",(N,H)=>{z()})}),this._oglama.mainWindow().contentView.addChildView(s),this._oglama.main.view instanceof te&&(this._oglama.mainWindow().contentView.removeChildView(this._oglama.main.view),this._oglama.mainWindow().contentView.addChildView(this._oglama.main.view));let c=Lt.getTargetChannelName(r);return p(this,sr)[r]={channel:c,listener:(u,...h)=>{h.length>=3&&s.webContents.send(c,h)}},r_.on(p(this,sr)[r].channel,p(this,sr)[r].listener),s.webContents.loadURL(s.metadata.homeUrl),p(this,W)[r]=s,n?this.select(r):p(this,sn).call(this),!0});_(this,"remove",r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");if(!(p(this,W)[r]instanceof te)||typeof p(this,sr)[r]>"u")return!1;r_.off(p(this,sr)[r].channel,p(this,sr)[r].listener),delete p(this,sr)[r];try{this._oglama.mainWindow().contentView.removeChildView(p(this,W)[r])}catch{}try{p(this,W)[r].webContents.destroy()}catch{}return delete p(this,W)[r],r===p(this,or)&&U(this,or,""),p(this,sn).call(this),!0});_(this,"select",r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let i=p(this,W)[r];if(i instanceof te&&p(this,or)!==r){U(this,or,r);let n={};for(let s of Object.keys(p(this,W)).filter(o=>o!==r))n[s]=p(this,W)[s];return n[r]=i,U(this,W,n),this._oglama.mainWindow().contentView.removeChildView(i),this._oglama.mainWindow().contentView.removeChildView(this._oglama.main.view),this._oglama.main.onTop?(this._oglama.mainWindow().contentView.addChildView(i),this._oglama.mainWindow().contentView.addChildView(this._oglama.main.view)):(this._oglama.mainWindow().contentView.addChildView(this._oglama.main.view),this._oglama.mainWindow().contentView.addChildView(i)),p(this,sn).call(this),!0}return!1});_(this,"getSelected",()=>p(this,or));_(this,"openDevTools",(r,i=null)=>{let n=!1;do{if(typeof r!="string"||!r.length)break;let s=p(this,W)[r];if(!(s instanceof te)||p(this,hs)[r])break;s.webContents?.openDevTools({mode:"detach",title:"Developer Tools ".concat(typeof i=="string"?"- ".concat(i," "):"","- Oglama")}),n=!0}while(!1);return n});_(this,"getBounds",r=>{let i=null;do{if(typeof r!="string"||!r.length)break;let n=p(this,W)[r];if(!(n instanceof te))break;i=n.getBounds()}while(!1);return i});_(this,"getTargets",()=>p(this,W));_(this,"webContents",async(r,i,n=[],s=null,o=[])=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let a=p(this,W)[r];if(!(a instanceof te))throw new Error("Missing agent ".concat(r));if(typeof i!="string"||typeof a.webContents[i]!="function")throw new Error("Invalid target method: webContents.".concat(i,"()"));Array.isArray(n)||(n=[]),Array.isArray(o)||(o=[]);let l=await a.webContents[i](...n)??null;return typeof s=="string"?l!==null&&typeof l[s]=="function"?await l[s](...o):null:l});_(this,"sendKeys",async(r,i,n={})=>{if(typeof r!="string"||!r.length)return!1;let s=p(this,W)[r];if(!(s instanceof te))return!1;if(!s.metadata.controlled)throw new Error("Keyboard input aborted");(typeof n!="object"||n===null)&&(n={});let{keyCode:o,shift:a}=p(this,Wo).call(this,i);if(o===null)return!1;n.shift=a;let l=[n.ctrl?process.platform==="darwin"?"meta":"control":null,n.shift?"shift":null,n.alt?"alt":null].filter(u=>u!==null),c=[...l.map(u=>u.charAt(0).toUpperCase()+u.slice(1)),o].join(" + ");return s.webContents.sendInputEvent({type:"keyDown",keyCode:o,modifiers:l}),o.length===1&&s.webContents.sendInputEvent({type:"char",keyCode:o,modifiers:l}),s.webContents.sendInputEvent({type:"keyUp",keyCode:o,modifiers:l}),await new Promise(u=>setTimeout(u,150+Math.floor(Math.random()*51))),!0});_(this,"mouse",async(r,i,n,s=null,o=!1,a=[])=>{if(typeof r!="string"||!r.length)return!1;let l=p(this,W)[r];if(!(l instanceof te)||p(this,fs)[r])return!1;if(!l.metadata.controlled)throw new Error("Mouse move aborted");if(i=parseInt(i,10),n=parseInt(n,10),!Number.isInteger(i)||!Number.isInteger(n))return!1;a=(Array.isArray(a)?a:[]).map(h=>{if(typeof h!="object"||h===null)return null;let f={};for(let d of["x","y","w","h"]){if(!Number.isInteger(h[d]))return null;f[d]=h[d]}return f}).filter(Boolean),i<0&&(i=0),n<0&&(n=0);let c=this.getBounds(r);if(typeof c=="object"&&c!==null){let{width:h,height:f}=c;i>h&&(i=h),n>f&&(n=f)}p(this,fs)[r]=!0,typeof p(this,di)[r]!="object"&&(p(this,di)[r]={x:0,y:0,name:null});let u=(h,f)=>{for(let d of a)if(h>=d.x&&h<=d.x+d.w&&f>=d.y&&f<=d.y+d.h)return!1;return!0};return new Promise(h=>{let f=(o?25:150)+Math.floor(Math.random()*(o?25:150)),d=(o?10:14)+Math.floor(Math.random()*3);this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:mouse:move",[r,i,n,f],{type:"req"}]);let y=p(this,di)[r].x,A=p(this,di)[r].y,E=i,v=n;p(this,di)[r]={x:i,y:n,name:s};let O={x:null,y:null},R=!1,L=z=>z<.5?2*z*z:-1+(4-2*z)*z,oe=0,G=setInterval(async()=>{let z=Date.now();oe===0&&(oe=z);let N=(z-oe)/f;(N>1||!l.metadata.controlled)&&(N=1);let H=L(N),P=Math.round(y+(E-y)*H),Q=Math.round(A+(v-A)*H);if(O.x!==P||O.y!==Q){let pe=O.x!==null?P-O.x:0,J=O.y!==null?Q-O.y:0;O={x:P,y:Q},u(P,Q)&&l.webContents?.sendInputEvent({type:"mouseMove",x:P,y:Q,movementX:pe,movementY:J})}if(N===1&&!R){if(clearInterval(G),R=!0,l.metadata.controlled&&["click","double-click"].includes(s)){await new Promise(V=>setTimeout(V,50)),this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:mouse:click",[r,P,Q,s],{type:"req"}]),await new Promise(V=>setTimeout(V,50));let J={x:E,y:v,button:0,clickCount:1};if(l.webContents?.sendInputEvent({type:"mouseDown",...J}),l.webContents?.sendInputEvent({type:"mouseUp",...J}),s==="double-click"){let V={x:E,y:v,button:0,clickCount:2};l.webContents?.sendInputEvent({type:"mouseDown",...V}),l.webContents?.sendInputEvent({type:"mouseUp",...V})}}let pe=(["click","double-click"].includes(s)?450:100)+Math.floor(Math.random()*150);setTimeout(async()=>{p(this,fs)[r]=!1,h(!0)},o?10:pe)}},d)})});_(this,"typeAt",async(r,i,n,s,o=!1,a=5,l=250)=>{if(typeof r!="string"||!r.length)return!1;let c=p(this,W)[r];if(!(c instanceof te)||!c.metadata.controlled)return!1;s=typeof s=="string"?s.replace(/\r\n|\n/g,"\r\n"):"",a=parseInt(a,10),a=Number.isInteger(a)?a>250?250:a<1?1:a:5,l=parseInt(l,10),l=Number.isInteger(l)?l>1e3?1e3:l<10?10:l:250,await this.mouse(r,i,n,"click");let u=i+10+Math.floor(Math.random()*90),h=Math.abs(n-50+Math.floor(Math.random()*100));await this.mouse(r,u,h),c.webContents.selectAll(),await new Promise(f=>setTimeout(f,250)),await this.sendKeys(r,o?"backspace":"right"),await new Promise(f=>setTimeout(f,150)),s.length>l&&(c.webContents.insertText(s.substring(0,s.length-l)),s=s.substring(s.length-l),await new Promise(f=>setTimeout(f,150)));for(let f of s)await p(this,nu).call(this,r,f,a);return!0});_(this,"loadUrl",async(r,i)=>{if(typeof r!="string"||!r.length)return!1;let n=p(this,W)[r];if(!(n instanceof te))return!1;if(i=p(this,on).call(this,i,!1),typeof i!="string"||!i.match(/^https?:\/\//gi))throw new Error("Invalid URL");p(this,Cr).call(this,r);try{await n.webContents.loadURL(i)}catch(s){if(s?.errno!==-2)throw s}return await this.waitForDomReady(r)});_(this,"getUrl",async r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let i=p(this,W)[r];if(!(i instanceof te))throw new Error("Missing agent ".concat(r));return p(this,on).call(this,i.webContents.getURL())});_(this,"getTitle",async r=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let i=p(this,W)[r];if(!(i instanceof te))throw new Error("Missing agent ".concat(r));return i.webContents.getTitle()});_(this,"reload",async(r,i=!1)=>{if(typeof r!="string"||!r.length)return!1;let n=p(this,W)[r];return n instanceof te?(p(this,Cr).call(this,r),i?n.webContents.reloadIgnoringCache():n.webContents.reload(),await this.waitForDomReady(r)):!1});_(this,"goHome",async r=>{if(typeof r!="string"||!r.length)return!1;let i=p(this,W)[r];return i instanceof te?(p(this,Cr).call(this,r),await i.webContents.loadURL(i.metadata.homeUrl),await this.waitForDomReady(r)):!1});_(this,"goBack",async r=>{if(typeof r!="string"||!r.length)return!1;let i=p(this,W)[r];return!(i instanceof te)||!i.webContents?.navigationHistory.canGoBack()?!1:(p(this,Cr).call(this,r),i.webContents.navigationHistory.goBack(),await this.waitForDomReady(r))});_(this,"goForward",async r=>{if(typeof r!="string"||!r.length)return!1;let i=p(this,W)[r];return!(i instanceof te)||!i.webContents?.navigationHistory.canGoForward()?!1:(p(this,Cr).call(this,r),i.webContents.navigationHistory.goForward(),await this.waitForDomReady(r))});_(this,"saveDownload",async(r,i,n,s=600,o=null)=>{if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let a=p(this,W)[r];if(!(a instanceof te))throw new Error("Missing agent ".concat(r));let l="".concat(i,"-").concat(n);if(typeof a.metadata.downloads.files[l]=="object")throw new Error("Download in progress for ".concat(n));return a.metadata.downloads.pending.push(l),a.metadata.downloads.files[l]={runId:i,outputKey:n,timeout:s,extension:o,filePath:null,done:!1,error:null},new Promise(c=>{let u=new Date().getTime(),h=setInterval(()=>{if(!(a instanceof te)||!a.metadata.controlled||new Date().getTime()-u>=s*1e3){clearInterval(h),c(null);return}if(a.metadata.downloads.files[l].done){clearInterval(h);let{filePath:f,error:d}=a.metadata.downloads.files[l];delete a.metadata.downloads.files[l];let y=typeof d=="string"?null:f;setTimeout(()=>c(y),250)}},750)})});_(this,"saveScreenshot",async(r,i,n,s=null)=>{let o=null;if(typeof r!="string"||!r.length)throw new Error("Invalid agent ID");let a=p(this,W)[r];if(!(a instanceof te))throw new Error("Missing agent ".concat(r));let{fileName:l,filePath:c,minSize:u,maxSize:h}=this._oglama.diskStorage.outputFilesInit(r,i,n,typeof s=="string"&&s.length?s:"png"),f="".concat(i,"-").concat(n);this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:download:info",[r,f,{fileName:"\u{1F4F8} ".concat(l),totalBytes:0,progress:0,done:!1,error:null}],{type:"req"}]);let d=await a.webContents.capturePage(null,{stayHidden:!0});d!==null&&(n_.writeFileSync(c,l.match(/\.jpe?g$/g)?d.toJPEG(75):d.toPNG()),d=null);let y=n_.statSync(c).size,A=(E=null)=>{this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:download:info",[r,f,{fileName:"\u{1F4F8} ".concat(l),totalBytes:y,progress:"100",done:!0,error:E}],{type:"req"}]),this._oglama.diskStorage.outputFilesDelete(r,i,l)};do{if(y<=0){A('Failed to grab screenshot as "'.concat(l,'"'));break}if(Number.isInteger(u)&&y<u*1048576){A('Minimum file size not met for "'.concat(l,'" (').concat((y/1048576).toFixed(3),"MB)"));break}if(Number.isInteger(h)&&y>h*1048576){A('Maximum file size exceeded for "'.concat(l,'" (').concat((y/1048576).toFixed(3),"MB)"));break}this._oglama.main?.view.webContents?.send(Lt.WINDOW_MAIN,["ibc-target:download:info",[r,f,{fileName:"\u{1F4F8} ".concat(l),totalBytes:y,progress:100,done:!0,error:null}],{type:"req"}]),o=c}while(!1);return o});_(this,"setFileInput",async(r,i,n)=>{if(typeof r!="string"||!r.length)return!1;let s=p(this,W)[r];if(!(s instanceof te)||!s.metadata.controlled)return!1;let o=!1;p(this,hs)[r]=!0,s.webContents.isDevToolsOpened()&&s.webContents.closeDevTools();try{s.webContents.debugger.attach("1.1");let{root:a}=await s.webContents.debugger.sendCommand("DOM.getDocument",{});if(typeof a?.nodeId<"u"){let{nodeId:l}=await s.webContents.debugger.sendCommand("DOM.querySelector",{nodeId:a.nodeId,selector:i});typeof l<"u"&&(await s.webContents.debugger.sendCommand("DOM.setFileInputFiles",{nodeId:l,files:n}),o=!0)}}finally{s.webContents.debugger.detach(),p(this,hs)[r]=!1}return o});_(this,"openInNewWindow",async(r,i)=>{if(i="".concat(i??"").trim(),!i.length||!(p(this,W)[r]instanceof te))return!1;let s=new Pq({minWidth:this._oglama.config.getSourceMinWidth(),minHeight:this._oglama.config.getSourceMinHeight(),width:this._oglama.config.getSourceMinWidth(),height:this._oglama.config.getSourceMinHeight(),webPreferences:{partition:"persist:target-".concat(r),contextIsolation:!0,nodeIntegration:!1,devTools:!0}});s.on("closed",()=>{s=null});try{s.loadURL(i)}catch{}});_(this,"waitForDomReady",async(r,i=120)=>{if(typeof r!="string"||!r.length)return!1;let n=p(this,W)[r];if(!(n instanceof te)||!n.metadata.controlled)return!1;if(n.metadata.domReady){if(n.metadata.domError!==null)throw new Error(n.metadata.domError);return n.metadata.domError===null}return new Promise((s,o)=>{let a=new Date().getTime(),l=setInterval(()=>{if(n.metadata.controlled||(clearInterval(l),o(new Error("Page load aborted"))),n.metadata.domReady){clearInterval(l),typeof n.metadata.domError=="string"?o(new Error(n.metadata.domError)):setTimeout(()=>s(!0),250);return}new Date().getTime()-a>=i*1e3&&(clearInterval(l),o(new Error("Page load timed out")))},500)})});let i=async()=>{do{if(!p(this,nn).length)break;let{agentId:n,resolve:s,reject:o}=p(this,nn).shift();if(typeof n!="string"||!n.length){o(new Error("Invalid agent ID"));break}let a=p(this,W)[n];if(!(a instanceof te)){o(new Error("Missing agent ".concat(n)));break}if(typeof s!="function"||typeof o!="function")break;a.webContents.isFocused()||(a.webContents.focus(),await new Promise(l=>setTimeout(l,100))),await new Promise(l=>{let c=setTimeout(()=>{o(new Error("Focused action has timed out")),l(!1)},this.constructor.FOCUS_TIMEOUT*1e3);s(async()=>{clearTimeout(c),l(!0),await new Promise(u=>setTimeout(u,100))})})}while(!1);await new Promise(n=>setTimeout(n,500)),i()};this.constructor.FOCUS_ENABLED&&i(),this._register("target")}},jo=new WeakMap,Ho=new WeakMap,hs=new WeakMap,W=new WeakMap,sr=new WeakMap,or=new WeakMap,nn=new WeakMap,fs=new WeakMap,di=new WeakMap,sn=new WeakMap,Ed=new WeakMap,Wo=new WeakMap,nu=new WeakMap,on=new WeakMap,Cr=new WeakMap,_(rn,"MARGIN_LEFT",250),_(rn,"MARGIN_TOP",50),_(rn,"MARGIN_BOTTOM",50),_(rn,"FOCUS_ENABLED",!1),_(rn,"FOCUS_TIMEOUT",60),rn)});var c_=w((qW,u_)=>{var{session:$q,shell:kq,ipcMain:qq,WebContentsView:Sd}=require("electron"),Mq=require("path"),a_=zt(),Uq=Zt(),su,l_;u_.exports=(l_=class extends Uq{constructor(r){super(r);_(this,"windowWidth");_(this,"windowHeight");_(this,"view",null);_(this,"darkMode",!0);I(this,su,()=>this.view instanceof Sd?(this.view.setBounds({x:0,y:0,width:this.windowWidth,height:this.windowHeight}),!0):!1);_(this,"init",()=>this.view instanceof Sd?!1:(this.windowWidth=this._oglama.config.getMainLoginWidth(),this.windowHeight=this._oglama.config.getMainLoginHeight(),this.view=new Sd({width:this.windowWidth,height:this.windowHeight,backgroundColor:"#00000000",resizable:!1,webPreferences:{transparent:!0,backgroundThrottling:!1,imageAnimationPolicy:"noAnimation",spellcheck:!1,preload:Mq.join(this._oglama.rootPath,"lib/preloader/entry/main.js"),nodeIntegration:!0,devTools:!1,session:$q.defaultSession,cache:!1,webSecurity:!1,allowRunningInsecureContent:!0,additionalArguments:["--win-type=main/login"]}}),this.view.webContents.on("ready-to-show",()=>this.view.webContents.setZoomFactor(1)),this.view.webContents.setZoomLevel(0),this.view.webContents.setAudioMuted(!1),this.view.webContents.loadURL("http://localhost:".concat(this._oglama.config.getServerPort(),"/login/")),this.view.webContents.on("dom-ready",()=>this.view.webContents.focus()),qq.on(a_.WINDOW_MAIN_LOGIN,(r,...i)=>{i.length>=3&&this.view.webContents.send(a_.WINDOW_MAIN_LOGIN,i)}),this._oglama.mainLoginWindow().contentView.addChildView(this.view),p(this,su).call(this),!0));_(this,"openExternal",r=>{typeof r=="string"&&kq.openExternal(r)});this._register("main/login")}},su=new WeakMap,l_)});var g_=w((BW,m_)=>{var{app:Bq,session:jq,shell:Hq,ipcMain:Wq,WebContentsView:ou,nativeTheme:Gq,dialog:zq}=require("electron"),h_=require("path"),f_=require("fs"),d_=zt(),Vq=c_(),Yq=Zt(),ds,p_;m_.exports=(p_=class extends Yq{constructor(r){super(r);_(this,"windowWidth");_(this,"windowHeight");_(this,"view",null);_(this,"onTop",!1);_(this,"darkMode",null);_(this,"login",null);I(this,ds,()=>this.view instanceof ou?(this.view.setBounds({x:0,y:0,width:this.windowWidth,height:this.windowHeight}),!0):!1);_(this,"init",()=>this.view instanceof ou?!1:(this.windowWidth=this._oglama.config.getMainMinWidth(),this.windowHeight=this._oglama.config.getMainMinHeight(),this.view=new ou({width:this.windowWidth,height:this.windowHeight,resizable:!1,backgroundColor:"#00000000",webPreferences:{transparent:!0,preload:h_.join(this._oglama.rootPath,"lib/preloader/entry/main.js"),imageAnimationPolicy:"noAnimation",allowRunningInsecureContent:!0,session:jq.defaultSession,devTools:!1,backgroundThrottling:!1,nodeIntegration:!0,webSecurity:!1,spellcheck:!1,cache:!1}}),this.view.webContents.on("ready-to-show",()=>{this.view.webContents.setZoomFactor(1),this.view.webContents.setVisualZoomLevelLimits(1,1)}),this.view.webContents.setZoomLevel(0),this.view.webContents.setAudioMuted(!1),this.view.webContents.loadURL("http://localhost:".concat(this._oglama.config.getServerPort(),"/")),this.view.webContents.on("dom-ready",()=>this.view.webContents.focus()),this.view.webContents.on("page-title-updated",(r,i)=>{this._oglama.mainWindow().setTitle(i)}),Wq.on(d_.WINDOW_MAIN,(r,...i)=>{i.length>=3&&this.view.webContents.send(d_.WINDOW_MAIN,i)}),this._oglama.mainWindow().contentView.addChildView(this.view),p(this,ds).call(this),!0));_(this,"setWindowSize",(r,i)=>{this.windowWidth=r,this.windowHeight=i,p(this,ds).call(this)});_(this,"focus",()=>{let r=typeof this.view?.webContents?.focus=="function";return r&&!this.view?.webContents?.isFocused()&&this.view?.webContents?.focus(),r});_(this,"setOnTop",(r=!0)=>{let i=!1;if(r=!!r,this.getOnTop()!==r){if(this.onTop=r,this.onTop)this._oglama.mainWindow().contentView.removeChildView(this.view),this._oglama.mainWindow().contentView.addChildView(this.view);else{let n=this._oglama.target.getSelected();if(typeof n=="string"&&n.length){let s=this._oglama.target.getTargets()[n];s instanceof ou&&(this._oglama.mainWindow().contentView.removeChildView(s),this._oglama.mainWindow().contentView.removeChildView(this.view),this._oglama.mainWindow().contentView.addChildView(this.view),this._oglama.mainWindow().contentView.addChildView(s))}}p(this,ds).call(this),i=!0}return i});_(this,"getOnTop",()=>this.onTop);_(this,"setDarkMode",r=>{let i=!1;return r=!!r,this.getDarkMode()!==r&&(this.darkMode=r,Gq.themeSource=r?"dark":"light",this._oglama.mainWindow().setBackgroundColor(r?"#333":"#fff"),i=!0),i});_(this,"quit",()=>Bq.quit());_(this,"getProcessVersions",()=>process.versions);_(this,"getDarkMode",()=>this.darkMode);_(this,"openExternal",r=>{typeof r=="string"&&Hq.openExternal(r)});_(this,"showOpenDialog",async(r,i=[],n=!1)=>{let s=[];i=(Array.isArray(i)?i:[]).map(a=>"".concat(a).replace(/^\.+/g,"").trim()).filter(Boolean);let o=await zq.showOpenDialog({properties:["openFile",...n?["multiSelections"]:[]],filters:[{name:typeof r=="string"&&r.length?r:n?"Select files":"Select file",extensions:i}]});return o.canceled||(s=(Array.isArray(o.filePaths)?o.filePaths:[]).map(a=>{if(f_.existsSync(a))try{return{path:a,name:h_.basename(a),size:f_.statSync(a).size}}catch{}return null}).filter(a=>a!==null)),s});this._register("main"),this.login=new Vq(r)}},ds=new WeakMap,p_)});var ps=w((HW,w_)=>{"use strict";var y_=new Map([["C","cwd"],["f","file"],["z","gzip"],["P","preservePaths"],["U","unlink"],["strip-components","strip"],["stripComponents","strip"],["keep-newer","newer"],["keepNewer","newer"],["keep-newer-files","newer"],["keepNewerFiles","newer"],["k","keep"],["keep-existing","keep"],["keepExisting","keep"],["m","noMtime"],["no-mtime","noMtime"],["p","preserveOwner"],["L","follow"],["h","follow"]]);w_.exports=t=>t?Object.keys(t).map(e=>[y_.has(e)?y_.get(e):e,t[e]]).reduce((e,r)=>(e[r[0]]=r[1],e),Object.create(null)):{}});var du=w(R_=>{"use strict";var A_=typeof process=="object"&&process?process:{stdout:null,stderr:null},Qq=require("events"),E_=require("stream"),Xq=require("string_decoder"),S_=Xq.StringDecoder,Rr=Symbol("EOF"),Ir=Symbol("maybeEmitEnd"),pi=Symbol("emittedEnd"),au=Symbol("emittingEnd"),Go=Symbol("emittedError"),lu=Symbol("closed"),b_=Symbol("read"),uu=Symbol("flush"),__=Symbol("flushChunk"),pt=Symbol("encoding"),Nr=Symbol("decoder"),cu=Symbol("flowing"),zo=Symbol("paused"),ms=Symbol("resume"),Ee=Symbol("buffer"),ar=Symbol("pipes"),De=Symbol("bufferLength"),bd=Symbol("bufferPush"),_d=Symbol("bufferShift"),Ue=Symbol("objectMode"),Se=Symbol("destroyed"),vd=Symbol("error"),Od=Symbol("emitData"),v_=Symbol("emitEnd"),Td=Symbol("emitEnd2"),xr=Symbol("async"),Cd=Symbol("abort"),hu=Symbol("aborted"),an=Symbol("signal"),Vo=t=>Promise.resolve().then(t),C_=global._MP_NO_ITERATOR_SYMBOLS_!=="1",O_=C_&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),T_=C_&&Symbol.iterator||Symbol("iterator not implemented"),Kq=t=>t==="end"||t==="finish"||t==="prefinish",Jq=t=>t instanceof ArrayBuffer||typeof t=="object"&&t.constructor&&t.constructor.name==="ArrayBuffer"&&t.byteLength>=0,Zq=t=>!Buffer.isBuffer(t)&&ArrayBuffer.isView(t),fu=class{constructor(e,r,i){this.src=e,this.dest=r,this.opts=i,this.ondrain=()=>e[ms](),r.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Rd=class extends fu{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,r,i){super(e,r,i),this.proxyErrors=n=>r.emit("error",n),e.on("error",this.proxyErrors)}},Id=class t extends E_{constructor(e){super(),this[cu]=!1,this[zo]=!1,this[ar]=[],this[Ee]=[],this[Ue]=e&&e.objectMode||!1,this[Ue]?this[pt]=null:this[pt]=e&&e.encoding||null,this[pt]==="buffer"&&(this[pt]=null),this[xr]=e&&!!e.async||!1,this[Nr]=this[pt]?new S_(this[pt]):null,this[Rr]=!1,this[pi]=!1,this[au]=!1,this[lu]=!1,this[Go]=null,this.writable=!0,this.readable=!0,this[De]=0,this[Se]=!1,e&&e.debugExposeBuffer===!0&&Object.defineProperty(this,"buffer",{get:()=>this[Ee]}),e&&e.debugExposePipes===!0&&Object.defineProperty(this,"pipes",{get:()=>this[ar]}),this[an]=e&&e.signal,this[hu]=!1,this[an]&&(this[an].addEventListener("abort",()=>this[Cd]()),this[an].aborted&&this[Cd]())}get bufferLength(){return this[De]}get encoding(){return this[pt]}set encoding(e){if(this[Ue])throw new Error("cannot set encoding in objectMode");if(this[pt]&&e!==this[pt]&&(this[Nr]&&this[Nr].lastNeed||this[De]))throw new Error("cannot change encoding");this[pt]!==e&&(this[Nr]=e?new S_(e):null,this[Ee].length&&(this[Ee]=this[Ee].map(r=>this[Nr].write(r)))),this[pt]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[Ue]}set objectMode(e){this[Ue]=this[Ue]||!!e}get async(){return this[xr]}set async(e){this[xr]=this[xr]||!!e}[Cd](){this[hu]=!0,this.emit("abort",this[an].reason),this.destroy(this[an].reason)}get aborted(){return this[hu]}set aborted(e){}write(e,r,i){if(this[hu])return!1;if(this[Rr])throw new Error("write after end");if(this[Se])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof r=="function"&&(i=r,r="utf8"),r||(r="utf8");let n=this[xr]?Vo:s=>s();return!this[Ue]&&!Buffer.isBuffer(e)&&(Zq(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):Jq(e)?e=Buffer.from(e):typeof e!="string"&&(this.objectMode=!0)),this[Ue]?(this.flowing&&this[De]!==0&&this[uu](!0),this.flowing?this.emit("data",e):this[bd](e),this[De]!==0&&this.emit("readable"),i&&n(i),this.flowing):e.length?(typeof e=="string"&&!(r===this[pt]&&!this[Nr].lastNeed)&&(e=Buffer.from(e,r)),Buffer.isBuffer(e)&&this[pt]&&(e=this[Nr].write(e)),this.flowing&&this[De]!==0&&this[uu](!0),this.flowing?this.emit("data",e):this[bd](e),this[De]!==0&&this.emit("readable"),i&&n(i),this.flowing):(this[De]!==0&&this.emit("readable"),i&&n(i),this.flowing)}read(e){if(this[Se])return null;if(this[De]===0||e===0||e>this[De])return this[Ir](),null;this[Ue]&&(e=null),this[Ee].length>1&&!this[Ue]&&(this.encoding?this[Ee]=[this[Ee].join("")]:this[Ee]=[Buffer.concat(this[Ee],this[De])]);let r=this[b_](e||null,this[Ee][0]);return this[Ir](),r}[b_](e,r){return e===r.length||e===null?this[_d]():(this[Ee][0]=r.slice(e),r=r.slice(0,e),this[De]-=e),this.emit("data",r),!this[Ee].length&&!this[Rr]&&this.emit("drain"),r}end(e,r,i){return typeof e=="function"&&(i=e,e=null),typeof r=="function"&&(i=r,r="utf8"),e&&this.write(e,r),i&&this.once("end",i),this[Rr]=!0,this.writable=!1,(this.flowing||!this[zo])&&this[Ir](),this}[ms](){this[Se]||(this[zo]=!1,this[cu]=!0,this.emit("resume"),this[Ee].length?this[uu]():this[Rr]?this[Ir]():this.emit("drain"))}resume(){return this[ms]()}pause(){this[cu]=!1,this[zo]=!0}get destroyed(){return this[Se]}get flowing(){return this[cu]}get paused(){return this[zo]}[bd](e){this[Ue]?this[De]+=1:this[De]+=e.length,this[Ee].push(e)}[_d](){return this[Ue]?this[De]-=1:this[De]-=this[Ee][0].length,this[Ee].shift()}[uu](e){do;while(this[__](this[_d]())&&this[Ee].length);!e&&!this[Ee].length&&!this[Rr]&&this.emit("drain")}[__](e){return this.emit("data",e),this.flowing}pipe(e,r){if(this[Se])return;let i=this[pi];return r=r||{},e===A_.stdout||e===A_.stderr?r.end=!1:r.end=r.end!==!1,r.proxyErrors=!!r.proxyErrors,i?r.end&&e.end():(this[ar].push(r.proxyErrors?new Rd(this,e,r):new fu(this,e,r)),this[xr]?Vo(()=>this[ms]()):this[ms]()),e}unpipe(e){let r=this[ar].find(i=>i.dest===e);r&&(this[ar].splice(this[ar].indexOf(r),1),r.unpipe())}addListener(e,r){return this.on(e,r)}on(e,r){let i=super.on(e,r);return e==="data"&&!this[ar].length&&!this.flowing?this[ms]():e==="readable"&&this[De]!==0?super.emit("readable"):Kq(e)&&this[pi]?(super.emit(e),this.removeAllListeners(e)):e==="error"&&this[Go]&&(this[xr]?Vo(()=>r.call(this,this[Go])):r.call(this,this[Go])),i}get emittedEnd(){return this[pi]}[Ir](){!this[au]&&!this[pi]&&!this[Se]&&this[Ee].length===0&&this[Rr]&&(this[au]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[lu]&&this.emit("close"),this[au]=!1)}emit(e,r,...i){if(e!=="error"&&e!=="close"&&e!==Se&&this[Se])return;if(e==="data")return!this[Ue]&&!r?!1:this[xr]?Vo(()=>this[Od](r)):this[Od](r);if(e==="end")return this[v_]();if(e==="close"){if(this[lu]=!0,!this[pi]&&!this[Se])return;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[Go]=r,super.emit(vd,r);let s=!this[an]||this.listeners("error").length?super.emit("error",r):!1;return this[Ir](),s}else if(e==="resume"){let s=super.emit("resume");return this[Ir](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,r,...i);return this[Ir](),n}[Od](e){for(let i of this[ar])i.dest.write(e)===!1&&this.pause();let r=super.emit("data",e);return this[Ir](),r}[v_](){this[pi]||(this[pi]=!0,this.readable=!1,this[xr]?Vo(()=>this[Td]()):this[Td]())}[Td](){if(this[Nr]){let r=this[Nr].end();if(r){for(let i of this[ar])i.dest.write(r);super.emit("data",r)}}for(let r of this[ar])r.end();let e=super.emit("end");return this.removeAllListeners("end"),e}collect(){let e=[];this[Ue]||(e.dataLength=0);let r=this.promise();return this.on("data",i=>{e.push(i),this[Ue]||(e.dataLength+=i.length)}),r.then(()=>e)}concat(){return this[Ue]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then(e=>this[Ue]?Promise.reject(new Error("cannot concat in objectMode")):this[pt]?e.join(""):Buffer.concat(e,e.dataLength))}promise(){return new Promise((e,r)=>{this.on(Se,()=>r(new Error("stream destroyed"))),this.on("error",i=>r(i)),this.on("end",()=>e())})}[O_](){let e=!1,r=()=>(this.pause(),e=!0,Promise.resolve({done:!0}));return{next:()=>{if(e)return r();let n=this.read();if(n!==null)return Promise.resolve({done:!1,value:n});if(this[Rr])return r();let s=null,o=null,a=h=>{this.removeListener("data",l),this.removeListener("end",c),this.removeListener(Se,u),r(),o(h)},l=h=>{this.removeListener("error",a),this.removeListener("end",c),this.removeListener(Se,u),this.pause(),s({value:h,done:!!this[Rr]})},c=()=>{this.removeListener("error",a),this.removeListener("data",l),this.removeListener(Se,u),r(),s({done:!0})},u=()=>a(new Error("stream destroyed"));return new Promise((h,f)=>{o=f,s=h,this.once(Se,u),this.once("error",a),this.once("end",c),this.once("data",l)})},throw:r,return:r,[O_](){return this}}}[T_](){let e=!1,r=()=>(this.pause(),this.removeListener(vd,r),this.removeListener(Se,r),this.removeListener("end",r),e=!0,{done:!0}),i=()=>{if(e)return r();let n=this.read();return n===null?r():{value:n}};return this.once("end",r),this.once(vd,r),this.once(Se,r),{next:i,throw:r,return:r,[T_](){return this}}}destroy(e){return this[Se]?(e?this.emit("error",e):this.emit(Se),this):(this[Se]=!0,this[Ee].length=0,this[De]=0,typeof this.close=="function"&&!this[lu]&&this.close(),e?this.emit("error",e):this.emit(Se),this)}static isStream(e){return!!e&&(e instanceof t||e instanceof E_||e instanceof Qq&&(typeof e.pipe=="function"||typeof e.write=="function"&&typeof e.end=="function"))}};R_.Minipass=Id});var N_=w((GW,I_)=>{var eM=require("zlib").constants||{ZLIB_VERNUM:4736};I_.exports=Object.freeze(Object.assign(Object.create(null),{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_VERSION_ERROR:-6,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,BROTLI_DECODE:8,BROTLI_ENCODE:9,Z_MIN_WINDOWBITS:8,Z_MAX_WINDOWBITS:15,Z_DEFAULT_WINDOWBITS:15,Z_MIN_CHUNK:64,Z_MAX_CHUNK:1/0,Z_DEFAULT_CHUNK:16384,Z_MIN_MEMLEVEL:1,Z_MAX_MEMLEVEL:9,Z_DEFAULT_MEMLEVEL:8,Z_MIN_LEVEL:-1,Z_MAX_LEVEL:9,Z_DEFAULT_LEVEL:-1,BROTLI_OPERATION_PROCESS:0,BROTLI_OPERATION_FLUSH:1,BROTLI_OPERATION_FINISH:2,BROTLI_OPERATION_EMIT_METADATA:3,BROTLI_MODE_GENERIC:0,BROTLI_MODE_TEXT:1,BROTLI_MODE_FONT:2,BROTLI_DEFAULT_MODE:0,BROTLI_MIN_QUALITY:0,BROTLI_MAX_QUALITY:11,BROTLI_DEFAULT_QUALITY:11,BROTLI_MIN_WINDOW_BITS:10,BROTLI_MAX_WINDOW_BITS:24,BROTLI_LARGE_MAX_WINDOW_BITS:30,BROTLI_DEFAULT_WINDOW:22,BROTLI_MIN_INPUT_BLOCK_BITS:16,BROTLI_MAX_INPUT_BLOCK_BITS:24,BROTLI_PARAM_MODE:0,BROTLI_PARAM_QUALITY:1,BROTLI_PARAM_LGWIN:2,BROTLI_PARAM_LGBLOCK:3,BROTLI_PARAM_DISABLE_LITERAL_CONTEXT_MODELING:4,BROTLI_PARAM_SIZE_HINT:5,BROTLI_PARAM_LARGE_WINDOW:6,BROTLI_PARAM_NPOSTFIX:7,BROTLI_PARAM_NDIRECT:8,BROTLI_DECODER_RESULT_ERROR:0,BROTLI_DECODER_RESULT_SUCCESS:1,BROTLI_DECODER_RESULT_NEEDS_MORE_INPUT:2,BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_PARAM_DISABLE_RING_BUFFER_REALLOCATION:0,BROTLI_DECODER_PARAM_LARGE_WINDOW:1,BROTLI_DECODER_NO_ERROR:0,BROTLI_DECODER_SUCCESS:1,BROTLI_DECODER_NEEDS_MORE_INPUT:2,BROTLI_DECODER_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_NIBBLE:-1,BROTLI_DECODER_ERROR_FORMAT_RESERVED:-2,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_META_NIBBLE:-3,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_ALPHABET:-4,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_SAME:-5,BROTLI_DECODER_ERROR_FORMAT_CL_SPACE:-6,BROTLI_DECODER_ERROR_FORMAT_HUFFMAN_SPACE:-7,BROTLI_DECODER_ERROR_FORMAT_CONTEXT_MAP_REPEAT:-8,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_1:-9,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_2:-10,BROTLI_DECODER_ERROR_FORMAT_TRANSFORM:-11,BROTLI_DECODER_ERROR_FORMAT_DICTIONARY:-12,BROTLI_DECODER_ERROR_FORMAT_WINDOW_BITS:-13,BROTLI_DECODER_ERROR_FORMAT_PADDING_1:-14,BROTLI_DECODER_ERROR_FORMAT_PADDING_2:-15,BROTLI_DECODER_ERROR_FORMAT_DISTANCE:-16,BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET:-19,BROTLI_DECODER_ERROR_INVALID_ARGUMENTS:-20,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MODES:-21,BROTLI_DECODER_ERROR_ALLOC_TREE_GROUPS:-22,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MAP:-25,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_1:-26,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_2:-27,BROTLI_DECODER_ERROR_ALLOC_BLOCK_TYPE_TREES:-30,BROTLI_DECODER_ERROR_UNREACHABLE:-31},eM))});var U_=w((zW,M_)=>{"use strict";var x_=typeof process=="object"&&process?process:{stdout:null,stderr:null},tM=require("events"),D_=require("stream"),P_=require("string_decoder").StringDecoder,Dr=Symbol("EOF"),Pr=Symbol("maybeEmitEnd"),mi=Symbol("emittedEnd"),pu=Symbol("emittingEnd"),Yo=Symbol("emittedError"),mu=Symbol("closed"),F_=Symbol("read"),gu=Symbol("flush"),L_=Symbol("flushChunk"),mt=Symbol("encoding"),Fr=Symbol("decoder"),yu=Symbol("flowing"),Qo=Symbol("paused"),gs=Symbol("resume"),Pe=Symbol("bufferLength"),Nd=Symbol("bufferPush"),xd=Symbol("bufferShift"),Ge=Symbol("objectMode"),ze=Symbol("destroyed"),Dd=Symbol("emitData"),$_=Symbol("emitEnd"),Pd=Symbol("emitEnd2"),Lr=Symbol("async"),Xo=t=>Promise.resolve().then(t),k_=global._MP_NO_ITERATOR_SYMBOLS_!=="1",rM=k_&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),iM=k_&&Symbol.iterator||Symbol("iterator not implemented"),nM=t=>t==="end"||t==="finish"||t==="prefinish",sM=t=>t instanceof ArrayBuffer||typeof t=="object"&&t.constructor&&t.constructor.name==="ArrayBuffer"&&t.byteLength>=0,oM=t=>!Buffer.isBuffer(t)&&ArrayBuffer.isView(t),wu=class{constructor(e,r,i){this.src=e,this.dest=r,this.opts=i,this.ondrain=()=>e[gs](),r.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Fd=class extends wu{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,r,i){super(e,r,i),this.proxyErrors=n=>r.emit("error",n),e.on("error",this.proxyErrors)}};M_.exports=class q_ extends D_{constructor(e){super(),this[yu]=!1,this[Qo]=!1,this.pipes=[],this.buffer=[],this[Ge]=e&&e.objectMode||!1,this[Ge]?this[mt]=null:this[mt]=e&&e.encoding||null,this[mt]==="buffer"&&(this[mt]=null),this[Lr]=e&&!!e.async||!1,this[Fr]=this[mt]?new P_(this[mt]):null,this[Dr]=!1,this[mi]=!1,this[pu]=!1,this[mu]=!1,this[Yo]=null,this.writable=!0,this.readable=!0,this[Pe]=0,this[ze]=!1}get bufferLength(){return this[Pe]}get encoding(){return this[mt]}set encoding(e){if(this[Ge])throw new Error("cannot set encoding in objectMode");if(this[mt]&&e!==this[mt]&&(this[Fr]&&this[Fr].lastNeed||this[Pe]))throw new Error("cannot change encoding");this[mt]!==e&&(this[Fr]=e?new P_(e):null,this.buffer.length&&(this.buffer=this.buffer.map(r=>this[Fr].write(r)))),this[mt]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[Ge]}set objectMode(e){this[Ge]=this[Ge]||!!e}get async(){return this[Lr]}set async(e){this[Lr]=this[Lr]||!!e}write(e,r,i){if(this[Dr])throw new Error("write after end");if(this[ze])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof r=="function"&&(i=r,r="utf8"),r||(r="utf8");let n=this[Lr]?Xo:s=>s();return!this[Ge]&&!Buffer.isBuffer(e)&&(oM(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):sM(e)?e=Buffer.from(e):typeof e!="string"&&(this.objectMode=!0)),this[Ge]?(this.flowing&&this[Pe]!==0&&this[gu](!0),this.flowing?this.emit("data",e):this[Nd](e),this[Pe]!==0&&this.emit("readable"),i&&n(i),this.flowing):e.length?(typeof e=="string"&&!(r===this[mt]&&!this[Fr].lastNeed)&&(e=Buffer.from(e,r)),Buffer.isBuffer(e)&&this[mt]&&(e=this[Fr].write(e)),this.flowing&&this[Pe]!==0&&this[gu](!0),this.flowing?this.emit("data",e):this[Nd](e),this[Pe]!==0&&this.emit("readable"),i&&n(i),this.flowing):(this[Pe]!==0&&this.emit("readable"),i&&n(i),this.flowing)}read(e){if(this[ze])return null;if(this[Pe]===0||e===0||e>this[Pe])return this[Pr](),null;this[Ge]&&(e=null),this.buffer.length>1&&!this[Ge]&&(this.encoding?this.buffer=[this.buffer.join("")]:this.buffer=[Buffer.concat(this.buffer,this[Pe])]);let r=this[F_](e||null,this.buffer[0]);return this[Pr](),r}[F_](e,r){return e===r.length||e===null?this[xd]():(this.buffer[0]=r.slice(e),r=r.slice(0,e),this[Pe]-=e),this.emit("data",r),!this.buffer.length&&!this[Dr]&&this.emit("drain"),r}end(e,r,i){return typeof e=="function"&&(i=e,e=null),typeof r=="function"&&(i=r,r="utf8"),e&&this.write(e,r),i&&this.once("end",i),this[Dr]=!0,this.writable=!1,(this.flowing||!this[Qo])&&this[Pr](),this}[gs](){this[ze]||(this[Qo]=!1,this[yu]=!0,this.emit("resume"),this.buffer.length?this[gu]():this[Dr]?this[Pr]():this.emit("drain"))}resume(){return this[gs]()}pause(){this[yu]=!1,this[Qo]=!0}get destroyed(){return this[ze]}get flowing(){return this[yu]}get paused(){return this[Qo]}[Nd](e){this[Ge]?this[Pe]+=1:this[Pe]+=e.length,this.buffer.push(e)}[xd](){return this.buffer.length&&(this[Ge]?this[Pe]-=1:this[Pe]-=this.buffer[0].length),this.buffer.shift()}[gu](e){do;while(this[L_](this[xd]()));!e&&!this.buffer.length&&!this[Dr]&&this.emit("drain")}[L_](e){return e?(this.emit("data",e),this.flowing):!1}pipe(e,r){if(this[ze])return;let i=this[mi];return r=r||{},e===x_.stdout||e===x_.stderr?r.end=!1:r.end=r.end!==!1,r.proxyErrors=!!r.proxyErrors,i?r.end&&e.end():(this.pipes.push(r.proxyErrors?new Fd(this,e,r):new wu(this,e,r)),this[Lr]?Xo(()=>this[gs]()):this[gs]()),e}unpipe(e){let r=this.pipes.find(i=>i.dest===e);r&&(this.pipes.splice(this.pipes.indexOf(r),1),r.unpipe())}addListener(e,r){return this.on(e,r)}on(e,r){let i=super.on(e,r);return e==="data"&&!this.pipes.length&&!this.flowing?this[gs]():e==="readable"&&this[Pe]!==0?super.emit("readable"):nM(e)&&this[mi]?(super.emit(e),this.removeAllListeners(e)):e==="error"&&this[Yo]&&(this[Lr]?Xo(()=>r.call(this,this[Yo])):r.call(this,this[Yo])),i}get emittedEnd(){return this[mi]}[Pr](){!this[pu]&&!this[mi]&&!this[ze]&&this.buffer.length===0&&this[Dr]&&(this[pu]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[mu]&&this.emit("close"),this[pu]=!1)}emit(e,r,...i){if(e!=="error"&&e!=="close"&&e!==ze&&this[ze])return;if(e==="data")return r?this[Lr]?Xo(()=>this[Dd](r)):this[Dd](r):!1;if(e==="end")return this[$_]();if(e==="close"){if(this[mu]=!0,!this[mi]&&!this[ze])return;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[Yo]=r;let s=super.emit("error",r);return this[Pr](),s}else if(e==="resume"){let s=super.emit("resume");return this[Pr](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,r,...i);return this[Pr](),n}[Dd](e){for(let i of this.pipes)i.dest.write(e)===!1&&this.pause();let r=super.emit("data",e);return this[Pr](),r}[$_](){this[mi]||(this[mi]=!0,this.readable=!1,this[Lr]?Xo(()=>this[Pd]()):this[Pd]())}[Pd](){if(this[Fr]){let r=this[Fr].end();if(r){for(let i of this.pipes)i.dest.write(r);super.emit("data",r)}}for(let r of this.pipes)r.end();let e=super.emit("end");return this.removeAllListeners("end"),e}collect(){let e=[];this[Ge]||(e.dataLength=0);let r=this.promise();return this.on("data",i=>{e.push(i),this[Ge]||(e.dataLength+=i.length)}),r.then(()=>e)}concat(){return this[Ge]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then(e=>this[Ge]?Promise.reject(new Error("cannot concat in objectMode")):this[mt]?e.join(""):Buffer.concat(e,e.dataLength))}promise(){return new Promise((e,r)=>{this.on(ze,()=>r(new Error("stream destroyed"))),this.on("error",i=>r(i)),this.on("end",()=>e())})}[rM](){return{next:()=>{let r=this.read();if(r!==null)return Promise.resolve({done:!1,value:r});if(this[Dr])return Promise.resolve({done:!0});let i=null,n=null,s=c=>{this.removeListener("data",o),this.removeListener("end",a),n(c)},o=c=>{this.removeListener("error",s),this.removeListener("end",a),this.pause(),i({value:c,done:!!this[Dr]})},a=()=>{this.removeListener("error",s),this.removeListener("data",o),i({done:!0})},l=()=>s(new Error("stream destroyed"));return new Promise((c,u)=>{n=u,i=c,this.once(ze,l),this.once("error",s),this.once("end",a),this.once("data",o)})}}}[iM](){return{next:()=>{let r=this.read();return{value:r,done:r===null}}}}destroy(e){return this[ze]?(e?this.emit("error",e):this.emit(ze),this):(this[ze]=!0,this.buffer.length=0,this[Pe]=0,typeof this.close=="function"&&!this[mu]&&this.close(),e?this.emit("error",e):this.emit(ze),this)}static isStream(e){return!!e&&(e instanceof q_||e instanceof D_||e instanceof tM&&(typeof e.pipe=="function"||typeof e.write=="function"&&typeof e.end=="function"))}}});var Xd=w(Ot=>{"use strict";var Md=require("assert"),gi=require("buffer").Buffer,H_=require("zlib"),ln=Ot.constants=N_(),aM=U_(),B_=gi.concat,un=Symbol("_superWrite"),ws=class extends Error{constructor(e){super("zlib: "+e.message),this.code=e.code,this.errno=e.errno,this.code||(this.code="ZLIB_ERROR"),this.message="zlib: "+e.message,Error.captureStackTrace(this,this.constructor)}get name(){return"ZlibError"}},lM=Symbol("opts"),Ko=Symbol("flushFlag"),j_=Symbol("finishFlushFlag"),Qd=Symbol("fullFlushFlag"),le=Symbol("handle"),Au=Symbol("onError"),ys=Symbol("sawError"),Ld=Symbol("level"),$d=Symbol("strategy"),kd=Symbol("ended"),VW=Symbol("_defaultFullFlush"),Eu=class extends aM{constructor(e,r){if(!e||typeof e!="object")throw new TypeError("invalid options for ZlibBase constructor");super(e),this[ys]=!1,this[kd]=!1,this[lM]=e,this[Ko]=e.flush,this[j_]=e.finishFlush;try{this[le]=new H_[r](e)}catch(i){throw new ws(i)}this[Au]=i=>{this[ys]||(this[ys]=!0,this.close(),this.emit("error",i))},this[le].on("error",i=>this[Au](new ws(i))),this.once("end",()=>this.close)}close(){this[le]&&(this[le].close(),this[le]=null,this.emit("close"))}reset(){if(!this[ys])return Md(this[le],"zlib binding closed"),this[le].reset()}flush(e){this.ended||(typeof e!="number"&&(e=this[Qd]),this.write(Object.assign(gi.alloc(0),{[Ko]:e})))}end(e,r,i){return e&&this.write(e,r),this.flush(this[j_]),this[kd]=!0,super.end(null,null,i)}get ended(){return this[kd]}write(e,r,i){if(typeof r=="function"&&(i=r,r="utf8"),typeof e=="string"&&(e=gi.from(e,r)),this[ys])return;Md(this[le],"zlib binding closed");let n=this[le]._handle,s=n.close;n.close=()=>{};let o=this[le].close;this[le].close=()=>{},gi.concat=c=>c;let a;try{let c=typeof e[Ko]=="number"?e[Ko]:this[Ko];a=this[le]._processChunk(e,c),gi.concat=B_}catch(c){gi.concat=B_,this[Au](new ws(c))}finally{this[le]&&(this[le]._handle=n,n.close=s,this[le].close=o,this[le].removeAllListeners("error"))}this[le]&&this[le].on("error",c=>this[Au](new ws(c)));let l;if(a)if(Array.isArray(a)&&a.length>0){l=this[un](gi.from(a[0]));for(let c=1;c<a.length;c++)l=this[un](a[c])}else l=this[un](gi.from(a));return i&&i(),l}[un](e){return super.write(e)}},$r=class extends Eu{constructor(e,r){e=e||{},e.flush=e.flush||ln.Z_NO_FLUSH,e.finishFlush=e.finishFlush||ln.Z_FINISH,super(e,r),this[Qd]=ln.Z_FULL_FLUSH,this[Ld]=e.level,this[$d]=e.strategy}params(e,r){if(!this[ys]){if(!this[le])throw new Error("cannot switch params when binding is closed");if(!this[le].params)throw new Error("not supported in this implementation");if(this[Ld]!==e||this[$d]!==r){this.flush(ln.Z_SYNC_FLUSH),Md(this[le],"zlib binding closed");let i=this[le].flush;this[le].flush=(n,s)=>{this.flush(n),s()};try{this[le].params(e,r)}finally{this[le].flush=i}this[le]&&(this[Ld]=e,this[$d]=r)}}}},Ud=class extends $r{constructor(e){super(e,"Deflate")}},Bd=class extends $r{constructor(e){super(e,"Inflate")}},qd=Symbol("_portable"),jd=class extends $r{constructor(e){super(e,"Gzip"),this[qd]=e&&!!e.portable}[un](e){return this[qd]?(this[qd]=!1,e[9]=255,super[un](e)):super[un](e)}},Hd=class extends $r{constructor(e){super(e,"Gunzip")}},Wd=class extends $r{constructor(e){super(e,"DeflateRaw")}},Gd=class extends $r{constructor(e){super(e,"InflateRaw")}},zd=class extends $r{constructor(e){super(e,"Unzip")}},Su=class extends Eu{constructor(e,r){e=e||{},e.flush=e.flush||ln.BROTLI_OPERATION_PROCESS,e.finishFlush=e.finishFlush||ln.BROTLI_OPERATION_FINISH,super(e,r),this[Qd]=ln.BROTLI_OPERATION_FLUSH}},Vd=class extends Su{constructor(e){super(e,"BrotliCompress")}},Yd=class extends Su{constructor(e){super(e,"BrotliDecompress")}};Ot.Deflate=Ud;Ot.Inflate=Bd;Ot.Gzip=jd;Ot.Gunzip=Hd;Ot.DeflateRaw=Wd;Ot.InflateRaw=Gd;Ot.Unzip=zd;typeof H_.BrotliCompress=="function"?(Ot.BrotliCompress=Vd,Ot.BrotliDecompress=Yd):Ot.BrotliCompress=Ot.BrotliDecompress=class{constructor(){throw new Error("Brotli is not supported in this version of Node.js")}}});var As=w((XW,W_)=>{var uM=process.env.TESTING_TAR_FAKE_PLATFORM||process.platform;W_.exports=uM!=="win32"?t=>t:t=>t&&t.replace(/\\/g,"/")});var bu=w((JW,G_)=>{"use strict";var{Minipass:cM}=du(),Kd=As(),Jd=Symbol("slurp");G_.exports=class extends cM{constructor(e,r,i){switch(super(),this.pause(),this.extended=r,this.globalExtended=i,this.header=e,this.startBlockSize=512*Math.ceil(e.size/512),this.blockRemain=this.startBlockSize,this.remain=e.size,this.type=e.type,this.meta=!1,this.ignore=!1,this.type){case"File":case"OldFile":case"Link":case"SymbolicLink":case"CharacterDevice":case"BlockDevice":case"Directory":case"FIFO":case"ContiguousFile":case"GNUDumpDir":break;case"NextFileHasLongLinkpath":case"NextFileHasLongPath":case"OldGnuLongPath":case"GlobalExtendedHeader":case"ExtendedHeader":case"OldExtendedHeader":this.meta=!0;break;default:this.ignore=!0}this.path=Kd(e.path),this.mode=e.mode,this.mode&&(this.mode=this.mode&4095),this.uid=e.uid,this.gid=e.gid,this.uname=e.uname,this.gname=e.gname,this.size=e.size,this.mtime=e.mtime,this.atime=e.atime,this.ctime=e.ctime,this.linkpath=Kd(e.linkpath),this.uname=e.uname,this.gname=e.gname,r&&this[Jd](r),i&&this[Jd](i,!0)}write(e){let r=e.length;if(r>this.blockRemain)throw new Error("writing more to entry than is appropriate");let i=this.remain,n=this.blockRemain;return this.remain=Math.max(0,i-r),this.blockRemain=Math.max(0,n-r),this.ignore?!0:i>=r?super.write(e):super.write(e.slice(0,i))}[Jd](e,r){for(let i in e)e[i]!==null&&e[i]!==void 0&&!(r&&i==="path")&&(this[i]=i==="path"||i==="linkpath"?Kd(e[i]):e[i])}}});var Zd=w(_u=>{"use strict";_u.name=new Map([["0","File"],["","OldFile"],["1","Link"],["2","SymbolicLink"],["3","CharacterDevice"],["4","BlockDevice"],["5","Directory"],["6","FIFO"],["7","ContiguousFile"],["g","GlobalExtendedHeader"],["x","ExtendedHeader"],["A","SolarisACL"],["D","GNUDumpDir"],["I","Inode"],["K","NextFileHasLongLinkpath"],["L","NextFileHasLongPath"],["M","ContinuationFile"],["N","OldGnuLongPath"],["S","SparseFile"],["V","TapeVolumeHeader"],["X","OldExtendedHeader"]]);_u.code=new Map(Array.from(_u.name).map(t=>[t[1],t[0]]))});var Q_=w((e3,Y_)=>{"use strict";var hM=(t,e)=>{if(Number.isSafeInteger(t))t<0?dM(t,e):fM(t,e);else throw Error("cannot encode number outside of javascript safe integer range");return e},fM=(t,e)=>{e[0]=128;for(var r=e.length;r>1;r--)e[r-1]=t&255,t=Math.floor(t/256)},dM=(t,e)=>{e[0]=255;var r=!1;t=t*-1;for(var i=e.length;i>1;i--){var n=t&255;t=Math.floor(t/256),r?e[i-1]=z_(n):n===0?e[i-1]=0:(r=!0,e[i-1]=V_(n))}},pM=t=>{let e=t[0],r=e===128?gM(t.slice(1,t.length)):e===255?mM(t):null;if(r===null)throw Error("invalid base256 encoding");if(!Number.isSafeInteger(r))throw Error("parsed number outside of javascript safe integer range");return r},mM=t=>{for(var e=t.length,r=0,i=!1,n=e-1;n>-1;n--){var s=t[n],o;i?o=z_(s):s===0?o=s:(i=!0,o=V_(s)),o!==0&&(r-=o*Math.pow(256,e-n-1))}return r},gM=t=>{for(var e=t.length,r=0,i=e-1;i>-1;i--){var n=t[i];n!==0&&(r+=n*Math.pow(256,e-i-1))}return r},z_=t=>(255^t)&255,V_=t=>(255^t)+1&255;Y_.exports={encode:hM,parse:pM}});var Ss=w((t3,K_)=>{"use strict";var ep=Zd(),Es=require("path").posix,X_=Q_(),tp=Symbol("slurp"),Tt=Symbol("type"),np=class{constructor(e,r,i,n){this.cksumValid=!1,this.needPax=!1,this.nullBlock=!1,this.block=null,this.path=null,this.mode=null,this.uid=null,this.gid=null,this.size=null,this.mtime=null,this.cksum=null,this[Tt]="0",this.linkpath=null,this.uname=null,this.gname=null,this.devmaj=0,this.devmin=0,this.atime=null,this.ctime=null,Buffer.isBuffer(e)?this.decode(e,r||0,i,n):e&&this.set(e)}decode(e,r,i,n){if(r||(r=0),!e||!(e.length>=r+512))throw new Error("need 512 bytes for header");if(this.path=cn(e,r,100),this.mode=yi(e,r+100,8),this.uid=yi(e,r+108,8),this.gid=yi(e,r+116,8),this.size=yi(e,r+124,12),this.mtime=rp(e,r+136,12),this.cksum=yi(e,r+148,12),this[tp](i),this[tp](n,!0),this[Tt]=cn(e,r+156,1),this[Tt]===""&&(this[Tt]="0"),this[Tt]==="0"&&this.path.slice(-1)==="/"&&(this[Tt]="5"),this[Tt]==="5"&&(this.size=0),this.linkpath=cn(e,r+157,100),e.slice(r+257,r+265).toString()==="ustar\x0000")if(this.uname=cn(e,r+265,32),this.gname=cn(e,r+297,32),this.devmaj=yi(e,r+329,8),this.devmin=yi(e,r+337,8),e[r+475]!==0){let o=cn(e,r+345,155);this.path=o+"/"+this.path}else{let o=cn(e,r+345,130);o&&(this.path=o+"/"+this.path),this.atime=rp(e,r+476,12),this.ctime=rp(e,r+488,12)}let s=256;for(let o=r;o<r+148;o++)s+=e[o];for(let o=r+156;o<r+512;o++)s+=e[o];this.cksumValid=s===this.cksum,this.cksum===null&&s===256&&(this.nullBlock=!0)}[tp](e,r){for(let i in e)e[i]!==null&&e[i]!==void 0&&!(r&&i==="path")&&(this[i]=e[i])}encode(e,r){if(e||(e=this.block=Buffer.alloc(512),r=0),r||(r=0),!(e.length>=r+512))throw new Error("need 512 bytes for header");let i=this.ctime||this.atime?130:155,n=yM(this.path||"",i),s=n[0],o=n[1];this.needPax=n[2],this.needPax=hn(e,r,100,s)||this.needPax,this.needPax=wi(e,r+100,8,this.mode)||this.needPax,this.needPax=wi(e,r+108,8,this.uid)||this.needPax,this.needPax=wi(e,r+116,8,this.gid)||this.needPax,this.needPax=wi(e,r+124,12,this.size)||this.needPax,this.needPax=ip(e,r+136,12,this.mtime)||this.needPax,e[r+156]=this[Tt].charCodeAt(0),this.needPax=hn(e,r+157,100,this.linkpath)||this.needPax,e.write("ustar\x0000",r+257,8),this.needPax=hn(e,r+265,32,this.uname)||this.needPax,this.needPax=hn(e,r+297,32,this.gname)||this.needPax,this.needPax=wi(e,r+329,8,this.devmaj)||this.needPax,this.needPax=wi(e,r+337,8,this.devmin)||this.needPax,this.needPax=hn(e,r+345,i,o)||this.needPax,e[r+475]!==0?this.needPax=hn(e,r+345,155,o)||this.needPax:(this.needPax=hn(e,r+345,130,o)||this.needPax,this.needPax=ip(e,r+476,12,this.atime)||this.needPax,this.needPax=ip(e,r+488,12,this.ctime)||this.needPax);let a=256;for(let l=r;l<r+148;l++)a+=e[l];for(let l=r+156;l<r+512;l++)a+=e[l];return this.cksum=a,wi(e,r+148,8,this.cksum),this.cksumValid=!0,this.needPax}set(e){for(let r in e)e[r]!==null&&e[r]!==void 0&&(this[r]=e[r])}get type(){return ep.name.get(this[Tt])||this[Tt]}get typeKey(){return this[Tt]}set type(e){ep.code.has(e)?this[Tt]=ep.code.get(e):this[Tt]=e}},yM=(t,e)=>{let i=t,n="",s,o=Es.parse(t).root||".";if(Buffer.byteLength(i)<100)s=[i,n,!1];else{n=Es.dirname(i),i=Es.basename(i);do Buffer.byteLength(i)<=100&&Buffer.byteLength(n)<=e?s=[i,n,!1]:Buffer.byteLength(i)>100&&Buffer.byteLength(n)<=e?s=[i.slice(0,99),n,!0]:(i=Es.join(Es.basename(n),i),n=Es.dirname(n));while(n!==o&&!s);s||(s=[t.slice(0,99),"",!0])}return s},cn=(t,e,r)=>t.slice(e,e+r).toString("utf8").replace(/\0.*/,""),rp=(t,e,r)=>wM(yi(t,e,r)),wM=t=>t===null?null:new Date(t*1e3),yi=(t,e,r)=>t[e]&128?X_.parse(t.slice(e,e+r)):EM(t,e,r),AM=t=>isNaN(t)?null:t,EM=(t,e,r)=>AM(parseInt(t.slice(e,e+r).toString("utf8").replace(/\0.*$/,"").trim(),8)),SM={12:8589934591,8:2097151},wi=(t,e,r,i)=>i===null?!1:i>SM[r]||i<0?(X_.encode(i,t.slice(e,e+r)),!0):(bM(t,e,r,i),!1),bM=(t,e,r,i)=>t.write(_M(i,r),e,r,"ascii"),_M=(t,e)=>vM(Math.floor(t).toString(8),e),vM=(t,e)=>(t.length===e-1?t:new Array(e-t.length-1).join("0")+t+" ")+"\0",ip=(t,e,r,i)=>i===null?!1:wi(t,e,r,i.getTime()/1e3),OM=new Array(156).join("\0"),hn=(t,e,r,i)=>i===null?!1:(t.write(i+OM,e,r,"utf8"),i.length!==Buffer.byteLength(i)||i.length>r);K_.exports=np});var vu=w((r3,J_)=>{"use strict";var TM=Ss(),CM=require("path"),Jo=class{constructor(e,r){this.atime=e.atime||null,this.charset=e.charset||null,this.comment=e.comment||null,this.ctime=e.ctime||null,this.gid=e.gid||null,this.gname=e.gname||null,this.linkpath=e.linkpath||null,this.mtime=e.mtime||null,this.path=e.path||null,this.size=e.size||null,this.uid=e.uid||null,this.uname=e.uname||null,this.dev=e.dev||null,this.ino=e.ino||null,this.nlink=e.nlink||null,this.global=r||!1}encode(){let e=this.encodeBody();if(e==="")return null;let r=Buffer.byteLength(e),i=512*Math.ceil(1+r/512),n=Buffer.allocUnsafe(i);for(let s=0;s<512;s++)n[s]=0;new TM({path:("PaxHeader/"+CM.basename(this.path)).slice(0,99),mode:this.mode||420,uid:this.uid||null,gid:this.gid||null,size:r,mtime:this.mtime||null,type:this.global?"GlobalExtendedHeader":"ExtendedHeader",linkpath:"",uname:this.uname||"",gname:this.gname||"",devmaj:0,devmin:0,atime:this.atime||null,ctime:this.ctime||null}).encode(n),n.write(e,512,r,"utf8");for(let s=r+512;s<n.length;s++)n[s]=0;return n}encodeBody(){return this.encodeField("path")+this.encodeField("ctime")+this.encodeField("atime")+this.encodeField("dev")+this.encodeField("ino")+this.encodeField("nlink")+this.encodeField("charset")+this.encodeField("comment")+this.encodeField("gid")+this.encodeField("gname")+this.encodeField("linkpath")+this.encodeField("mtime")+this.encodeField("size")+this.encodeField("uid")+this.encodeField("uname")}encodeField(e){if(this[e]===null||this[e]===void 0)return"";let r=this[e]instanceof Date?this[e].getTime()/1e3:this[e],i=" "+(e==="dev"||e==="ino"||e==="nlink"?"SCHILY.":"")+e+"="+r+"\n",n=Buffer.byteLength(i),s=Math.floor(Math.log(n)/Math.log(10))+1;return n+s>=Math.pow(10,s)&&(s+=1),s+n+i}};Jo.parse=(t,e,r)=>new Jo(RM(IM(t),e),r);var RM=(t,e)=>e?Object.keys(t).reduce((r,i)=>(r[i]=t[i],r),e):t,IM=t=>t.replace(/\n$/,"").split("\n").reduce(NM,Object.create(null)),NM=(t,e)=>{let r=parseInt(e,10);if(r!==Buffer.byteLength(e)+1)return t;e=e.slice((r+" ").length);let i=e.split("="),n=i.shift().replace(/^SCHILY\.(dev|ino|nlink)/,"$1");if(!n)return t;let s=i.join("=");return t[n]=/^([A-Z]+\.)?([mac]|birth|creation)time$/.test(n)?new Date(s*1e3):/^[0-9]+$/.test(s)?+s:s,t};J_.exports=Jo});var bs=w((i3,Z_)=>{Z_.exports=t=>{let e=t.length-1,r=-1;for(;e>-1&&t.charAt(e)==="/";)r=e,e--;return r===-1?t:t.slice(0,r)}});var Ou=w((n3,ev)=>{"use strict";ev.exports=t=>class extends t{warn(e,r,i={}){this.file&&(i.file=this.file),this.cwd&&(i.cwd=this.cwd),i.code=r instanceof Error&&r.code||e,i.tarCode=e,!this.strict&&i.recoverable!==!1?(r instanceof Error&&(i=Object.assign(r,i),r=r.message),this.emit("warn",i.tarCode,r,i)):r instanceof Error?this.emit("error",Object.assign(r,i)):this.emit("error",Object.assign(new Error("".concat(e,": ").concat(r)),i))}}});var op=w((o3,tv)=>{"use strict";var Tu=["|","<",">","?",":"],sp=Tu.map(t=>String.fromCharCode(61440+t.charCodeAt(0))),xM=new Map(Tu.map((t,e)=>[t,sp[e]])),DM=new Map(sp.map((t,e)=>[t,Tu[e]]));tv.exports={encode:t=>Tu.reduce((e,r)=>e.split(r).join(xM.get(r)),t),decode:t=>sp.reduce((e,r)=>e.split(r).join(DM.get(r)),t)}});var ap=w((a3,iv)=>{var{isAbsolute:PM,parse:rv}=require("path").win32;iv.exports=t=>{let e="",r=rv(t);for(;PM(t)||r.root;){let i=t.charAt(0)==="/"&&t.slice(0,4)!=="//?/"?"/":r.root;t=t.slice(i.length),e+=i,r=rv(t)}return[e,t]}});var sv=w((l3,nv)=>{"use strict";nv.exports=(t,e,r)=>(t&=4095,r&&(t=(t|384)&-19),e&&(t&256&&(t|=64),t&32&&(t|=8),t&4&&(t|=1)),t)});var yp=w((h3,Av)=>{"use strict";var{Minipass:fv}=du(),dv=vu(),pv=Ss(),ur=require("fs"),ov=require("path"),lr=As(),FM=bs(),mv=(t,e)=>e?(t=lr(t).replace(/^\.(\/|$)/,""),FM(e)+"/"+t):lr(t),LM=16*1024*1024,av=Symbol("process"),lv=Symbol("file"),uv=Symbol("directory"),up=Symbol("symlink"),cv=Symbol("hardlink"),Zo=Symbol("header"),Cu=Symbol("read"),cp=Symbol("lstat"),Ru=Symbol("onlstat"),hp=Symbol("onread"),fp=Symbol("onreadlink"),dp=Symbol("openfile"),pp=Symbol("onopenfile"),Ai=Symbol("close"),Iu=Symbol("mode"),mp=Symbol("awaitDrain"),lp=Symbol("ondrain"),cr=Symbol("prefix"),hv=Symbol("hadError"),gv=Ou(),$M=op(),yv=ap(),wv=sv(),Nu=gv(class extends fv{constructor(e,r){if(r=r||{},super(r),typeof e!="string")throw new TypeError("path is required");this.path=lr(e),this.portable=!!r.portable,this.myuid=process.getuid&&process.getuid()||0,this.myuser=process.env.USER||"",this.maxReadSize=r.maxReadSize||LM,this.linkCache=r.linkCache||new Map,this.statCache=r.statCache||new Map,this.preservePaths=!!r.preservePaths,this.cwd=lr(r.cwd||process.cwd()),this.strict=!!r.strict,this.noPax=!!r.noPax,this.noMtime=!!r.noMtime,this.mtime=r.mtime||null,this.prefix=r.prefix?lr(r.prefix):null,this.fd=null,this.blockLen=null,this.blockRemain=null,this.buf=null,this.offset=null,this.length=null,this.pos=null,this.remain=null,typeof r.onwarn=="function"&&this.on("warn",r.onwarn);let i=!1;if(!this.preservePaths){let[n,s]=yv(this.path);n&&(this.path=s,i=n)}this.win32=!!r.win32||process.platform==="win32",this.win32&&(this.path=$M.decode(this.path.replace(/\\/g,"/")),e=e.replace(/\\/g,"/")),this.absolute=lr(r.absolute||ov.resolve(this.cwd,e)),this.path===""&&(this.path="./"),i&&this.warn("TAR_ENTRY_INFO","stripping ".concat(i," from absolute path"),{entry:this,path:i+this.path}),this.statCache.has(this.absolute)?this[Ru](this.statCache.get(this.absolute)):this[cp]()}emit(e,...r){return e==="error"&&(this[hv]=!0),super.emit(e,...r)}[cp](){ur.lstat(this.absolute,(e,r)=>{if(e)return this.emit("error",e);this[Ru](r)})}[Ru](e){this.statCache.set(this.absolute,e),this.stat=e,e.isFile()||(e.size=0),this.type=qM(e),this.emit("stat",e),this[av]()}[av](){switch(this.type){case"File":return this[lv]();case"Directory":return this[uv]();case"SymbolicLink":return this[up]();default:return this.end()}}[Iu](e){return wv(e,this.type==="Directory",this.portable)}[cr](e){return mv(e,this.prefix)}[Zo](){this.type==="Directory"&&this.portable&&(this.noMtime=!0),this.header=new pv({path:this[cr](this.path),linkpath:this.type==="Link"?this[cr](this.linkpath):this.linkpath,mode:this[Iu](this.stat.mode),uid:this.portable?null:this.stat.uid,gid:this.portable?null:this.stat.gid,size:this.stat.size,mtime:this.noMtime?null:this.mtime||this.stat.mtime,type:this.type,uname:this.portable?null:this.stat.uid===this.myuid?this.myuser:"",atime:this.portable?null:this.stat.atime,ctime:this.portable?null:this.stat.ctime}),this.header.encode()&&!this.noPax&&super.write(new dv({atime:this.portable?null:this.header.atime,ctime:this.portable?null:this.header.ctime,gid:this.portable?null:this.header.gid,mtime:this.noMtime?null:this.mtime||this.header.mtime,path:this[cr](this.path),linkpath:this.type==="Link"?this[cr](this.linkpath):this.linkpath,size:this.header.size,uid:this.portable?null:this.header.uid,uname:this.portable?null:this.header.uname,dev:this.portable?null:this.stat.dev,ino:this.portable?null:this.stat.ino,nlink:this.portable?null:this.stat.nlink}).encode()),super.write(this.header.block)}[uv](){this.path.slice(-1)!=="/"&&(this.path+="/"),this.stat.size=0,this[Zo](),this.end()}[up](){ur.readlink(this.absolute,(e,r)=>{if(e)return this.emit("error",e);this[fp](r)})}[fp](e){this.linkpath=lr(e),this[Zo](),this.end()}[cv](e){this.type="Link",this.linkpath=lr(ov.relative(this.cwd,e)),this.stat.size=0,this[Zo](),this.end()}[lv](){if(this.stat.nlink>1){let e=this.stat.dev+":"+this.stat.ino;if(this.linkCache.has(e)){let r=this.linkCache.get(e);if(r.indexOf(this.cwd)===0)return this[cv](r)}this.linkCache.set(e,this.absolute)}if(this[Zo](),this.stat.size===0)return this.end();this[dp]()}[dp](){ur.open(this.absolute,"r",(e,r)=>{if(e)return this.emit("error",e);this[pp](r)})}[pp](e){if(this.fd=e,this[hv])return this[Ai]();this.blockLen=512*Math.ceil(this.stat.size/512),this.blockRemain=this.blockLen;let r=Math.min(this.blockLen,this.maxReadSize);this.buf=Buffer.allocUnsafe(r),this.offset=0,this.pos=0,this.remain=this.stat.size,this.length=this.buf.length,this[Cu]()}[Cu](){let{fd:e,buf:r,offset:i,length:n,pos:s}=this;ur.read(e,r,i,n,s,(o,a)=>{if(o)return this[Ai](()=>this.emit("error",o));this[hp](a)})}[Ai](e){ur.close(this.fd,e)}[hp](e){if(e<=0&&this.remain>0){let n=new Error("encountered unexpected EOF");return n.path=this.absolute,n.syscall="read",n.code="EOF",this[Ai](()=>this.emit("error",n))}if(e>this.remain){let n=new Error("did not encounter expected EOF");return n.path=this.absolute,n.syscall="read",n.code="EOF",this[Ai](()=>this.emit("error",n))}if(e===this.remain)for(let n=e;n<this.length&&e<this.blockRemain;n++)this.buf[n+this.offset]=0,e++,this.remain++;let r=this.offset===0&&e===this.buf.length?this.buf:this.buf.slice(this.offset,this.offset+e);this.write(r)?this[lp]():this[mp](()=>this[lp]())}[mp](e){this.once("drain",e)}write(e){if(this.blockRemain<e.length){let r=new Error("writing more data than expected");return r.path=this.absolute,this.emit("error",r)}return this.remain-=e.length,this.blockRemain-=e.length,this.pos+=e.length,this.offset+=e.length,super.write(e)}[lp](){if(!this.remain)return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),this[Ai](e=>e?this.emit("error",e):this.end());this.offset>=this.length&&(this.buf=Buffer.allocUnsafe(Math.min(this.blockRemain,this.buf.length)),this.offset=0),this.length=this.buf.length-this.offset,this[Cu]()}}),gp=class extends Nu{[cp](){this[Ru](ur.lstatSync(this.absolute))}[up](){this[fp](ur.readlinkSync(this.absolute))}[dp](){this[pp](ur.openSync(this.absolute,"r"))}[Cu](){let e=!0;try{let{fd:r,buf:i,offset:n,length:s,pos:o}=this,a=ur.readSync(r,i,n,s,o);this[hp](a),e=!1}finally{if(e)try{this[Ai](()=>{})}catch{}}}[mp](e){e()}[Ai](e){ur.closeSync(this.fd),e()}},kM=gv(class extends fv{constructor(e,r){r=r||{},super(r),this.preservePaths=!!r.preservePaths,this.portable=!!r.portable,this.strict=!!r.strict,this.noPax=!!r.noPax,this.noMtime=!!r.noMtime,this.readEntry=e,this.type=e.type,this.type==="Directory"&&this.portable&&(this.noMtime=!0),this.prefix=r.prefix||null,this.path=lr(e.path),this.mode=this[Iu](e.mode),this.uid=this.portable?null:e.uid,this.gid=this.portable?null:e.gid,this.uname=this.portable?null:e.uname,this.gname=this.portable?null:e.gname,this.size=e.size,this.mtime=this.noMtime?null:r.mtime||e.mtime,this.atime=this.portable?null:e.atime,this.ctime=this.portable?null:e.ctime,this.linkpath=lr(e.linkpath),typeof r.onwarn=="function"&&this.on("warn",r.onwarn);let i=!1;if(!this.preservePaths){let[n,s]=yv(this.path);n&&(this.path=s,i=n)}this.remain=e.size,this.blockRemain=e.startBlockSize,this.header=new pv({path:this[cr](this.path),linkpath:this.type==="Link"?this[cr](this.linkpath):this.linkpath,mode:this.mode,uid:this.portable?null:this.uid,gid:this.portable?null:this.gid,size:this.size,mtime:this.noMtime?null:this.mtime,type:this.type,uname:this.portable?null:this.uname,atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime}),i&&this.warn("TAR_ENTRY_INFO","stripping ".concat(i," from absolute path"),{entry:this,path:i+this.path}),this.header.encode()&&!this.noPax&&super.write(new dv({atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime,gid:this.portable?null:this.gid,mtime:this.noMtime?null:this.mtime,path:this[cr](this.path),linkpath:this.type==="Link"?this[cr](this.linkpath):this.linkpath,size:this.size,uid:this.portable?null:this.uid,uname:this.portable?null:this.uname,dev:this.portable?null:this.readEntry.dev,ino:this.portable?null:this.readEntry.ino,nlink:this.portable?null:this.readEntry.nlink}).encode()),super.write(this.header.block),e.pipe(this)}[cr](e){return mv(e,this.prefix)}[Iu](e){return wv(e,this.type==="Directory",this.portable)}write(e){let r=e.length;if(r>this.blockRemain)throw new Error("writing more to entry than is appropriate");return this.blockRemain-=r,super.write(e)}end(){return this.blockRemain&&super.write(Buffer.alloc(this.blockRemain)),super.end()}});Nu.Sync=gp;Nu.Tar=kM;var qM=t=>t.isFile()?"File":t.isDirectory()?"Directory":t.isSymbolicLink()?"SymbolicLink":"Unsupported";Av.exports=Nu});var Sv=w((f3,Ev)=>{"use strict";Ev.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var wp=w((d3,bv)=>{"use strict";bv.exports=X;X.Node=fn;X.create=X;function X(t){var e=this;if(e instanceof X||(e=new X),e.tail=null,e.head=null,e.length=0,t&&typeof t.forEach=="function")t.forEach(function(n){e.push(n)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}X.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e};X.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}};X.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}};X.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)UM(this,arguments[t]);return this.length};X.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)BM(this,arguments[t]);return this.length};X.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}};X.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}};X.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,i=0;r!==null;i++)t.call(e,r.value,i,this),r=r.next};X.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,i=this.length-1;r!==null;i--)t.call(e,r.value,i,this),r=r.prev};X.prototype.get=function(t){for(var e=0,r=this.head;r!==null&&e<t;e++)r=r.next;if(e===t&&r!==null)return r.value};X.prototype.getReverse=function(t){for(var e=0,r=this.tail;r!==null&&e<t;e++)r=r.prev;if(e===t&&r!==null)return r.value};X.prototype.map=function(t,e){e=e||this;for(var r=new X,i=this.head;i!==null;)r.push(t.call(e,i.value,this)),i=i.next;return r};X.prototype.mapReverse=function(t,e){e=e||this;for(var r=new X,i=this.tail;i!==null;)r.push(t.call(e,i.value,this)),i=i.prev;return r};X.prototype.reduce=function(t,e){var r,i=this.head;if(arguments.length>1)r=e;else if(this.head)i=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=0;i!==null;n++)r=t(r,i.value,n),i=i.next;return r};X.prototype.reduceReverse=function(t,e){var r,i=this.tail;if(arguments.length>1)r=e;else if(this.tail)i=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var n=this.length-1;i!==null;n--)r=t(r,i.value,n),i=i.prev;return r};X.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;r!==null;e++)t[e]=r.value,r=r.next;return t};X.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;r!==null;e++)t[e]=r.value,r=r.prev;return t};X.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new X;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,n=this.head;n!==null&&i<t;i++)n=n.next;for(;n!==null&&i<e;i++,n=n.next)r.push(n.value);return r};X.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new X;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,n=this.tail;n!==null&&i>e;i--)n=n.prev;for(;n!==null&&i>t;i--,n=n.prev)r.push(n.value);return r};X.prototype.splice=function(t,e,...r){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var i=0,n=this.head;n!==null&&i<t;i++)n=n.next;for(var s=[],i=0;n&&i<e;i++)s.push(n.value),n=this.removeNode(n);n===null&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(var i=0;i<r.length;i++)n=MM(this,n,r[i]);return s};X.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;r!==null;r=r.prev){var i=r.prev;r.prev=r.next,r.next=i}return this.head=e,this.tail=t,this};function MM(t,e,r){var i=e===t.head?new fn(r,null,e,t):new fn(r,e,e.next,t);return i.next===null&&(t.tail=i),i.prev===null&&(t.head=i),t.length++,i}function UM(t,e){t.tail=new fn(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function BM(t,e){t.head=new fn(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function fn(t,e,r,i){if(!(this instanceof fn))return new fn(t,e,r,i);this.list=i,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{Sv()(X)}catch{}});var Mu=w((m3,Nv)=>{"use strict";var ku=class{constructor(e,r){this.path=e||"./",this.absolute=r,this.entry=null,this.stat=null,this.readdir=null,this.pending=!1,this.ignore=!1,this.piped=!1}},{Minipass:jM}=du(),_v=Xd(),HM=bu(),Cp=yp(),WM=Cp.Sync,GM=Cp.Tar,zM=wp(),vv=Buffer.alloc(1024),Pu=Symbol("onStat"),xu=Symbol("ended"),hr=Symbol("queue"),_s=Symbol("current"),dn=Symbol("process"),Du=Symbol("processing"),Ov=Symbol("processJob"),fr=Symbol("jobs"),Ap=Symbol("jobDone"),Fu=Symbol("addFSEntry"),Tv=Symbol("addTarEntry"),_p=Symbol("stat"),vp=Symbol("readdir"),Lu=Symbol("onreaddir"),$u=Symbol("pipe"),Cv=Symbol("entry"),Ep=Symbol("entryOpt"),Op=Symbol("writeEntryClass"),Iv=Symbol("write"),Sp=Symbol("ondrain"),qu=require("fs"),Rv=require("path"),VM=Ou(),bp=As(),Rp=VM(class extends jM{constructor(e){if(super(e),e=e||Object.create(null),this.opt=e,this.file=e.file||"",this.cwd=e.cwd||process.cwd(),this.maxReadSize=e.maxReadSize,this.preservePaths=!!e.preservePaths,this.strict=!!e.strict,this.noPax=!!e.noPax,this.prefix=bp(e.prefix||""),this.linkCache=e.linkCache||new Map,this.statCache=e.statCache||new Map,this.readdirCache=e.readdirCache||new Map,this[Op]=Cp,typeof e.onwarn=="function"&&this.on("warn",e.onwarn),this.portable=!!e.portable,this.zip=null,e.gzip||e.brotli){if(e.gzip&&e.brotli)throw new TypeError("gzip and brotli are mutually exclusive");e.gzip&&(typeof e.gzip!="object"&&(e.gzip={}),this.portable&&(e.gzip.portable=!0),this.zip=new _v.Gzip(e.gzip)),e.brotli&&(typeof e.brotli!="object"&&(e.brotli={}),this.zip=new _v.BrotliCompress(e.brotli)),this.zip.on("data",r=>super.write(r)),this.zip.on("end",r=>super.end()),this.zip.on("drain",r=>this[Sp]()),this.on("resume",r=>this.zip.resume())}else this.on("drain",this[Sp]);this.noDirRecurse=!!e.noDirRecurse,this.follow=!!e.follow,this.noMtime=!!e.noMtime,this.mtime=e.mtime||null,this.filter=typeof e.filter=="function"?e.filter:r=>!0,this[hr]=new zM,this[fr]=0,this.jobs=+e.jobs||4,this[Du]=!1,this[xu]=!1}[Iv](e){return super.write(e)}add(e){return this.write(e),this}end(e){return e&&this.write(e),this[xu]=!0,this[dn](),this}write(e){if(this[xu])throw new Error("write after end");return e instanceof HM?this[Tv](e):this[Fu](e),this.flowing}[Tv](e){let r=bp(Rv.resolve(this.cwd,e.path));if(!this.filter(e.path,e))e.resume();else{let i=new ku(e.path,r,!1);i.entry=new GM(e,this[Ep](i)),i.entry.on("end",n=>this[Ap](i)),this[fr]+=1,this[hr].push(i)}this[dn]()}[Fu](e){let r=bp(Rv.resolve(this.cwd,e));this[hr].push(new ku(e,r)),this[dn]()}[_p](e){e.pending=!0,this[fr]+=1;let r=this.follow?"stat":"lstat";qu[r](e.absolute,(i,n)=>{e.pending=!1,this[fr]-=1,i?this.emit("error",i):this[Pu](e,n)})}[Pu](e,r){this.statCache.set(e.absolute,r),e.stat=r,this.filter(e.path,r)||(e.ignore=!0),this[dn]()}[vp](e){e.pending=!0,this[fr]+=1,qu.readdir(e.absolute,(r,i)=>{if(e.pending=!1,this[fr]-=1,r)return this.emit("error",r);this[Lu](e,i)})}[Lu](e,r){this.readdirCache.set(e.absolute,r),e.readdir=r,this[dn]()}[dn](){if(!this[Du]){this[Du]=!0;for(let e=this[hr].head;e!==null&&this[fr]<this.jobs;e=e.next)if(this[Ov](e.value),e.value.ignore){let r=e.next;this[hr].removeNode(e),e.next=r}this[Du]=!1,this[xu]&&!this[hr].length&&this[fr]===0&&(this.zip?this.zip.end(vv):(super.write(vv),super.end()))}}get[_s](){return this[hr]&&this[hr].head&&this[hr].head.value}[Ap](e){this[hr].shift(),this[fr]-=1,this[dn]()}[Ov](e){if(!e.pending){if(e.entry){e===this[_s]&&!e.piped&&this[$u](e);return}if(e.stat||(this.statCache.has(e.absolute)?this[Pu](e,this.statCache.get(e.absolute)):this[_p](e)),!!e.stat&&!e.ignore&&!(!this.noDirRecurse&&e.stat.isDirectory()&&!e.readdir&&(this.readdirCache.has(e.absolute)?this[Lu](e,this.readdirCache.get(e.absolute)):this[vp](e),!e.readdir))){if(e.entry=this[Cv](e),!e.entry){e.ignore=!0;return}e===this[_s]&&!e.piped&&this[$u](e)}}}[Ep](e){return{onwarn:(r,i,n)=>this.warn(r,i,n),noPax:this.noPax,cwd:this.cwd,absolute:e.absolute,preservePaths:this.preservePaths,maxReadSize:this.maxReadSize,strict:this.strict,portable:this.portable,linkCache:this.linkCache,statCache:this.statCache,noMtime:this.noMtime,mtime:this.mtime,prefix:this.prefix}}[Cv](e){this[fr]+=1;try{return new this[Op](e.path,this[Ep](e)).on("end",()=>this[Ap](e)).on("error",r=>this.emit("error",r))}catch(r){this.emit("error",r)}}[Sp](){this[_s]&&this[_s].entry&&this[_s].entry.resume()}[$u](e){e.piped=!0,e.readdir&&e.readdir.forEach(n=>{let s=e.path,o=s==="./"?"":s.replace(/\/*$/,"/");this[Fu](o+n)});let r=e.entry,i=this.zip;i?r.on("data",n=>{i.write(n)||r.pause()}):r.on("data",n=>{super.write(n)||r.pause()})}pause(){return this.zip&&this.zip.pause(),super.pause()}}),Tp=class extends Rp{constructor(e){super(e),this[Op]=WM}pause(){}resume(){}[_p](e){let r=this.follow?"statSync":"lstatSync";this[Pu](e,qu[r](e.absolute))}[vp](e,r){this[Lu](e,qu.readdirSync(e.absolute))}[$u](e){let r=e.entry,i=this.zip;e.readdir&&e.readdir.forEach(n=>{let s=e.path,o=s==="./"?"":s.replace(/\/*$/,"/");this[Fu](o+n)}),i?r.on("data",n=>{i.write(n)}):r.on("data",n=>{super[Iv](n)})}};Rp.Sync=Tp;Nv.exports=Rp});var Uv=w((g3,Mv)=>{"use strict";var xv=typeof process=="object"&&process?process:{stdout:null,stderr:null},YM=require("events"),Dv=require("stream"),Pv=require("string_decoder").StringDecoder,kr=Symbol("EOF"),qr=Symbol("maybeEmitEnd"),Ei=Symbol("emittedEnd"),Uu=Symbol("emittingEnd"),ea=Symbol("emittedError"),Bu=Symbol("closed"),Fv=Symbol("read"),ju=Symbol("flush"),Lv=Symbol("flushChunk"),gt=Symbol("encoding"),Mr=Symbol("decoder"),Hu=Symbol("flowing"),ta=Symbol("paused"),vs=Symbol("resume"),Fe=Symbol("bufferLength"),Ip=Symbol("bufferPush"),Np=Symbol("bufferShift"),Ve=Symbol("objectMode"),Ye=Symbol("destroyed"),xp=Symbol("emitData"),$v=Symbol("emitEnd"),Dp=Symbol("emitEnd2"),Ur=Symbol("async"),ra=t=>Promise.resolve().then(t),kv=global._MP_NO_ITERATOR_SYMBOLS_!=="1",QM=kv&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),XM=kv&&Symbol.iterator||Symbol("iterator not implemented"),KM=t=>t==="end"||t==="finish"||t==="prefinish",JM=t=>t instanceof ArrayBuffer||typeof t=="object"&&t.constructor&&t.constructor.name==="ArrayBuffer"&&t.byteLength>=0,ZM=t=>!Buffer.isBuffer(t)&&ArrayBuffer.isView(t),Wu=class{constructor(e,r,i){this.src=e,this.dest=r,this.opts=i,this.ondrain=()=>e[vs](),r.on("drain",this.ondrain)}unpipe(){this.dest.removeListener("drain",this.ondrain)}proxyErrors(){}end(){this.unpipe(),this.opts.end&&this.dest.end()}},Pp=class extends Wu{unpipe(){this.src.removeListener("error",this.proxyErrors),super.unpipe()}constructor(e,r,i){super(e,r,i),this.proxyErrors=n=>r.emit("error",n),e.on("error",this.proxyErrors)}};Mv.exports=class qv extends Dv{constructor(e){super(),this[Hu]=!1,this[ta]=!1,this.pipes=[],this.buffer=[],this[Ve]=e&&e.objectMode||!1,this[Ve]?this[gt]=null:this[gt]=e&&e.encoding||null,this[gt]==="buffer"&&(this[gt]=null),this[Ur]=e&&!!e.async||!1,this[Mr]=this[gt]?new Pv(this[gt]):null,this[kr]=!1,this[Ei]=!1,this[Uu]=!1,this[Bu]=!1,this[ea]=null,this.writable=!0,this.readable=!0,this[Fe]=0,this[Ye]=!1}get bufferLength(){return this[Fe]}get encoding(){return this[gt]}set encoding(e){if(this[Ve])throw new Error("cannot set encoding in objectMode");if(this[gt]&&e!==this[gt]&&(this[Mr]&&this[Mr].lastNeed||this[Fe]))throw new Error("cannot change encoding");this[gt]!==e&&(this[Mr]=e?new Pv(e):null,this.buffer.length&&(this.buffer=this.buffer.map(r=>this[Mr].write(r)))),this[gt]=e}setEncoding(e){this.encoding=e}get objectMode(){return this[Ve]}set objectMode(e){this[Ve]=this[Ve]||!!e}get async(){return this[Ur]}set async(e){this[Ur]=this[Ur]||!!e}write(e,r,i){if(this[kr])throw new Error("write after end");if(this[Ye])return this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0;typeof r=="function"&&(i=r,r="utf8"),r||(r="utf8");let n=this[Ur]?ra:s=>s();return!this[Ve]&&!Buffer.isBuffer(e)&&(ZM(e)?e=Buffer.from(e.buffer,e.byteOffset,e.byteLength):JM(e)?e=Buffer.from(e):typeof e!="string"&&(this.objectMode=!0)),this[Ve]?(this.flowing&&this[Fe]!==0&&this[ju](!0),this.flowing?this.emit("data",e):this[Ip](e),this[Fe]!==0&&this.emit("readable"),i&&n(i),this.flowing):e.length?(typeof e=="string"&&!(r===this[gt]&&!this[Mr].lastNeed)&&(e=Buffer.from(e,r)),Buffer.isBuffer(e)&&this[gt]&&(e=this[Mr].write(e)),this.flowing&&this[Fe]!==0&&this[ju](!0),this.flowing?this.emit("data",e):this[Ip](e),this[Fe]!==0&&this.emit("readable"),i&&n(i),this.flowing):(this[Fe]!==0&&this.emit("readable"),i&&n(i),this.flowing)}read(e){if(this[Ye])return null;if(this[Fe]===0||e===0||e>this[Fe])return this[qr](),null;this[Ve]&&(e=null),this.buffer.length>1&&!this[Ve]&&(this.encoding?this.buffer=[this.buffer.join("")]:this.buffer=[Buffer.concat(this.buffer,this[Fe])]);let r=this[Fv](e||null,this.buffer[0]);return this[qr](),r}[Fv](e,r){return e===r.length||e===null?this[Np]():(this.buffer[0]=r.slice(e),r=r.slice(0,e),this[Fe]-=e),this.emit("data",r),!this.buffer.length&&!this[kr]&&this.emit("drain"),r}end(e,r,i){return typeof e=="function"&&(i=e,e=null),typeof r=="function"&&(i=r,r="utf8"),e&&this.write(e,r),i&&this.once("end",i),this[kr]=!0,this.writable=!1,(this.flowing||!this[ta])&&this[qr](),this}[vs](){this[Ye]||(this[ta]=!1,this[Hu]=!0,this.emit("resume"),this.buffer.length?this[ju]():this[kr]?this[qr]():this.emit("drain"))}resume(){return this[vs]()}pause(){this[Hu]=!1,this[ta]=!0}get destroyed(){return this[Ye]}get flowing(){return this[Hu]}get paused(){return this[ta]}[Ip](e){this[Ve]?this[Fe]+=1:this[Fe]+=e.length,this.buffer.push(e)}[Np](){return this.buffer.length&&(this[Ve]?this[Fe]-=1:this[Fe]-=this.buffer[0].length),this.buffer.shift()}[ju](e){do;while(this[Lv](this[Np]()));!e&&!this.buffer.length&&!this[kr]&&this.emit("drain")}[Lv](e){return e?(this.emit("data",e),this.flowing):!1}pipe(e,r){if(this[Ye])return;let i=this[Ei];return r=r||{},e===xv.stdout||e===xv.stderr?r.end=!1:r.end=r.end!==!1,r.proxyErrors=!!r.proxyErrors,i?r.end&&e.end():(this.pipes.push(r.proxyErrors?new Pp(this,e,r):new Wu(this,e,r)),this[Ur]?ra(()=>this[vs]()):this[vs]()),e}unpipe(e){let r=this.pipes.find(i=>i.dest===e);r&&(this.pipes.splice(this.pipes.indexOf(r),1),r.unpipe())}addListener(e,r){return this.on(e,r)}on(e,r){let i=super.on(e,r);return e==="data"&&!this.pipes.length&&!this.flowing?this[vs]():e==="readable"&&this[Fe]!==0?super.emit("readable"):KM(e)&&this[Ei]?(super.emit(e),this.removeAllListeners(e)):e==="error"&&this[ea]&&(this[Ur]?ra(()=>r.call(this,this[ea])):r.call(this,this[ea])),i}get emittedEnd(){return this[Ei]}[qr](){!this[Uu]&&!this[Ei]&&!this[Ye]&&this.buffer.length===0&&this[kr]&&(this[Uu]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[Bu]&&this.emit("close"),this[Uu]=!1)}emit(e,r,...i){if(e!=="error"&&e!=="close"&&e!==Ye&&this[Ye])return;if(e==="data")return r?this[Ur]?ra(()=>this[xp](r)):this[xp](r):!1;if(e==="end")return this[$v]();if(e==="close"){if(this[Bu]=!0,!this[Ei]&&!this[Ye])return;let s=super.emit("close");return this.removeAllListeners("close"),s}else if(e==="error"){this[ea]=r;let s=super.emit("error",r);return this[qr](),s}else if(e==="resume"){let s=super.emit("resume");return this[qr](),s}else if(e==="finish"||e==="prefinish"){let s=super.emit(e);return this.removeAllListeners(e),s}let n=super.emit(e,r,...i);return this[qr](),n}[xp](e){for(let i of this.pipes)i.dest.write(e)===!1&&this.pause();let r=super.emit("data",e);return this[qr](),r}[$v](){this[Ei]||(this[Ei]=!0,this.readable=!1,this[Ur]?ra(()=>this[Dp]()):this[Dp]())}[Dp](){if(this[Mr]){let r=this[Mr].end();if(r){for(let i of this.pipes)i.dest.write(r);super.emit("data",r)}}for(let r of this.pipes)r.end();let e=super.emit("end");return this.removeAllListeners("end"),e}collect(){let e=[];this[Ve]||(e.dataLength=0);let r=this.promise();return this.on("data",i=>{e.push(i),this[Ve]||(e.dataLength+=i.length)}),r.then(()=>e)}concat(){return this[Ve]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then(e=>this[Ve]?Promise.reject(new Error("cannot concat in objectMode")):this[gt]?e.join(""):Buffer.concat(e,e.dataLength))}promise(){return new Promise((e,r)=>{this.on(Ye,()=>r(new Error("stream destroyed"))),this.on("error",i=>r(i)),this.on("end",()=>e())})}[QM](){return{next:()=>{let r=this.read();if(r!==null)return Promise.resolve({done:!1,value:r});if(this[kr])return Promise.resolve({done:!0});let i=null,n=null,s=c=>{this.removeListener("data",o),this.removeListener("end",a),n(c)},o=c=>{this.removeListener("error",s),this.removeListener("end",a),this.pause(),i({value:c,done:!!this[kr]})},a=()=>{this.removeListener("error",s),this.removeListener("data",o),i({done:!0})},l=()=>s(new Error("stream destroyed"));return new Promise((c,u)=>{n=u,i=c,this.once(Ye,l),this.once("error",s),this.once("end",a),this.once("data",o)})}}}[XM](){return{next:()=>{let r=this.read();return{value:r,done:r===null}}}}destroy(e){return this[Ye]?(e?this.emit("error",e):this.emit(Ye),this):(this[Ye]=!0,this.buffer.length=0,this[Fe]=0,typeof this.close=="function"&&!this[Bu]&&this.close(),e?this.emit("error",e):this.emit(Ye),this)}static isStream(e){return!!e&&(e instanceof qv||e instanceof Dv||e instanceof YM&&(typeof e.pipe=="function"||typeof e.write=="function"&&typeof e.end=="function"))}}});var Ds=w(na=>{"use strict";var eU=Uv(),tU=require("events").EventEmitter,yt=require("fs"),$p=yt.writev;if(!$p){let t=process.binding("fs"),e=t.FSReqWrap||t.FSReqCallback;$p=(r,i,n,s)=>{let o=(l,c)=>s(l,c,i),a=new e;a.oncomplete=o,t.writeBuffers(r,i,n,a)}}var Ns=Symbol("_autoClose"),Kt=Symbol("_close"),ia=Symbol("_ended"),se=Symbol("_fd"),Bv=Symbol("_finished"),bi=Symbol("_flags"),Fp=Symbol("_flush"),kp=Symbol("_handleChunk"),qp=Symbol("_makeBuf"),Qu=Symbol("_mode"),Gu=Symbol("_needDrain"),Rs=Symbol("_onerror"),xs=Symbol("_onopen"),Lp=Symbol("_onread"),Ts=Symbol("_onwrite"),_i=Symbol("_open"),Br=Symbol("_path"),pn=Symbol("_pos"),dr=Symbol("_queue"),Cs=Symbol("_read"),jv=Symbol("_readSize"),Si=Symbol("_reading"),zu=Symbol("_remain"),Hv=Symbol("_size"),Vu=Symbol("_write"),Os=Symbol("_writing"),Yu=Symbol("_defaultFlag"),Is=Symbol("_errored"),Xu=class extends eU{constructor(e,r){if(r=r||{},super(r),this.readable=!0,this.writable=!1,typeof e!="string")throw new TypeError("path must be a string");this[Is]=!1,this[se]=typeof r.fd=="number"?r.fd:null,this[Br]=e,this[jv]=r.readSize||16*1024*1024,this[Si]=!1,this[Hv]=typeof r.size=="number"?r.size:1/0,this[zu]=this[Hv],this[Ns]=typeof r.autoClose=="boolean"?r.autoClose:!0,typeof this[se]=="number"?this[Cs]():this[_i]()}get fd(){return this[se]}get path(){return this[Br]}write(){throw new TypeError("this is a readable stream")}end(){throw new TypeError("this is a readable stream")}[_i](){yt.open(this[Br],"r",(e,r)=>this[xs](e,r))}[xs](e,r){e?this[Rs](e):(this[se]=r,this.emit("open",r),this[Cs]())}[qp](){return Buffer.allocUnsafe(Math.min(this[jv],this[zu]))}[Cs](){if(!this[Si]){this[Si]=!0;let e=this[qp]();if(e.length===0)return process.nextTick(()=>this[Lp](null,0,e));yt.read(this[se],e,0,e.length,null,(r,i,n)=>this[Lp](r,i,n))}}[Lp](e,r,i){this[Si]=!1,e?this[Rs](e):this[kp](r,i)&&this[Cs]()}[Kt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.close(e,r=>r?this.emit("error",r):this.emit("close"))}}[Rs](e){this[Si]=!0,this[Kt](),this.emit("error",e)}[kp](e,r){let i=!1;return this[zu]-=e,e>0&&(i=super.write(e<r.length?r.slice(0,e):r)),(e===0||this[zu]<=0)&&(i=!1,this[Kt](),super.end()),i}emit(e,r){switch(e){case"prefinish":case"finish":break;case"drain":typeof this[se]=="number"&&this[Cs]();break;case"error":return this[Is]?void 0:(this[Is]=!0,super.emit(e,r));default:return super.emit(e,r)}}},Mp=class extends Xu{[_i](){let e=!0;try{this[xs](null,yt.openSync(this[Br],"r")),e=!1}finally{e&&this[Kt]()}}[Cs](){let e=!0;try{if(!this[Si]){this[Si]=!0;do{let r=this[qp](),i=r.length===0?0:yt.readSync(this[se],r,0,r.length,null);if(!this[kp](i,r))break}while(!0);this[Si]=!1}e=!1}finally{e&&this[Kt]()}}[Kt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.closeSync(e),this.emit("close")}}},Ku=class extends tU{constructor(e,r){r=r||{},super(r),this.readable=!1,this.writable=!0,this[Is]=!1,this[Os]=!1,this[ia]=!1,this[Gu]=!1,this[dr]=[],this[Br]=e,this[se]=typeof r.fd=="number"?r.fd:null,this[Qu]=r.mode===void 0?438:r.mode,this[pn]=typeof r.start=="number"?r.start:null,this[Ns]=typeof r.autoClose=="boolean"?r.autoClose:!0;let i=this[pn]!==null?"r+":"w";this[Yu]=r.flags===void 0,this[bi]=this[Yu]?i:r.flags,this[se]===null&&this[_i]()}emit(e,r){if(e==="error"){if(this[Is])return;this[Is]=!0}return super.emit(e,r)}get fd(){return this[se]}get path(){return this[Br]}[Rs](e){this[Kt](),this[Os]=!0,this.emit("error",e)}[_i](){yt.open(this[Br],this[bi],this[Qu],(e,r)=>this[xs](e,r))}[xs](e,r){this[Yu]&&this[bi]==="r+"&&e&&e.code==="ENOENT"?(this[bi]="w",this[_i]()):e?this[Rs](e):(this[se]=r,this.emit("open",r),this[Fp]())}end(e,r){return e&&this.write(e,r),this[ia]=!0,!this[Os]&&!this[dr].length&&typeof this[se]=="number"&&this[Ts](null,0),this}write(e,r){return typeof e=="string"&&(e=Buffer.from(e,r)),this[ia]?(this.emit("error",new Error("write() after end()")),!1):this[se]===null||this[Os]||this[dr].length?(this[dr].push(e),this[Gu]=!0,!1):(this[Os]=!0,this[Vu](e),!0)}[Vu](e){yt.write(this[se],e,0,e.length,this[pn],(r,i)=>this[Ts](r,i))}[Ts](e,r){e?this[Rs](e):(this[pn]!==null&&(this[pn]+=r),this[dr].length?this[Fp]():(this[Os]=!1,this[ia]&&!this[Bv]?(this[Bv]=!0,this[Kt](),this.emit("finish")):this[Gu]&&(this[Gu]=!1,this.emit("drain"))))}[Fp](){if(this[dr].length===0)this[ia]&&this[Ts](null,0);else if(this[dr].length===1)this[Vu](this[dr].pop());else{let e=this[dr];this[dr]=[],$p(this[se],e,this[pn],(r,i)=>this[Ts](r,i))}}[Kt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.close(e,r=>r?this.emit("error",r):this.emit("close"))}}},Up=class extends Ku{[_i](){let e;if(this[Yu]&&this[bi]==="r+")try{e=yt.openSync(this[Br],this[bi],this[Qu])}catch(r){if(r.code==="ENOENT")return this[bi]="w",this[_i]();throw r}else e=yt.openSync(this[Br],this[bi],this[Qu]);this[xs](null,e)}[Kt](){if(this[Ns]&&typeof this[se]=="number"){let e=this[se];this[se]=null,yt.closeSync(e),this.emit("close")}}[Vu](e){let r=!0;try{this[Ts](null,yt.writeSync(this[se],e,0,e.length,this[pn])),r=!1}finally{if(r)try{this[Kt]()}catch{}}}};na.ReadStream=Xu;na.ReadStreamSync=Mp;na.WriteStream=Ku;na.WriteStreamSync=Up});var nc=w((A3,Zv)=>{"use strict";var rU=Ou(),Wv=Ss(),iU=require("events"),nU=wp(),sU=1024*1024,oU=bu(),Gv=vu(),zv=Xd(),{nextTick:aU}=require("process"),Bp=Buffer.from([31,139]),$t=Symbol("state"),mn=Symbol("writeEntry"),jr=Symbol("readEntry"),jp=Symbol("nextEntry"),Vv=Symbol("processEntry"),kt=Symbol("extendedHeader"),sa=Symbol("globalExtendedHeader"),vi=Symbol("meta"),Yv=Symbol("emitMeta"),ue=Symbol("buffer"),Hr=Symbol("queue"),Oi=Symbol("ended"),Qv=Symbol("emittedEnd"),gn=Symbol("emit"),Le=Symbol("unzip"),Ju=Symbol("consumeChunk"),Zu=Symbol("consumeChunkSub"),Hp=Symbol("consumeBody"),Xv=Symbol("consumeMeta"),Kv=Symbol("consumeHeader"),ec=Symbol("consuming"),Wp=Symbol("bufferConcat"),Gp=Symbol("maybeEnd"),oa=Symbol("writing"),Ti=Symbol("aborted"),tc=Symbol("onDone"),yn=Symbol("sawValidEntry"),rc=Symbol("sawNullBlock"),ic=Symbol("sawEOF"),Jv=Symbol("closeStream"),lU=t=>!0;Zv.exports=rU(class extends iU{constructor(e){e=e||{},super(e),this.file=e.file||"",this[yn]=null,this.on(tc,i=>{(this[$t]==="begin"||this[yn]===!1)&&this.warn("TAR_BAD_ARCHIVE","Unrecognized archive format")}),e.ondone?this.on(tc,e.ondone):this.on(tc,i=>{this.emit("prefinish"),this.emit("finish"),this.emit("end")}),this.strict=!!e.strict,this.maxMetaEntrySize=e.maxMetaEntrySize||sU,this.filter=typeof e.filter=="function"?e.filter:lU;let r=e.file&&(e.file.endsWith(".tar.br")||e.file.endsWith(".tbr"));this.brotli=!e.gzip&&e.brotli!==void 0?e.brotli:r?void 0:!1,this.writable=!0,this.readable=!1,this[Hr]=new nU,this[ue]=null,this[jr]=null,this[mn]=null,this[$t]="begin",this[vi]="",this[kt]=null,this[sa]=null,this[Oi]=!1,this[Le]=null,this[Ti]=!1,this[rc]=!1,this[ic]=!1,this.on("end",()=>this[Jv]()),typeof e.onwarn=="function"&&this.on("warn",e.onwarn),typeof e.onentry=="function"&&this.on("entry",e.onentry)}[Kv](e,r){this[yn]===null&&(this[yn]=!1);let i;try{i=new Wv(e,r,this[kt],this[sa])}catch(n){return this.warn("TAR_ENTRY_INVALID",n)}if(i.nullBlock)this[rc]?(this[ic]=!0,this[$t]==="begin"&&(this[$t]="header"),this[gn]("eof")):(this[rc]=!0,this[gn]("nullBlock"));else if(this[rc]=!1,!i.cksumValid)this.warn("TAR_ENTRY_INVALID","checksum failure",{header:i});else if(!i.path)this.warn("TAR_ENTRY_INVALID","path is required",{header:i});else{let n=i.type;if(/^(Symbolic)?Link$/.test(n)&&!i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath required",{header:i});else if(!/^(Symbolic)?Link$/.test(n)&&i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath forbidden",{header:i});else{let s=this[mn]=new oU(i,this[kt],this[sa]);if(!this[yn])if(s.remain){let o=()=>{s.invalid||(this[yn]=!0)};s.on("end",o)}else this[yn]=!0;s.meta?s.size>this.maxMetaEntrySize?(s.ignore=!0,this[gn]("ignoredEntry",s),this[$t]="ignore",s.resume()):s.size>0&&(this[vi]="",s.on("data",o=>this[vi]+=o),this[$t]="meta"):(this[kt]=null,s.ignore=s.ignore||!this.filter(s.path,s),s.ignore?(this[gn]("ignoredEntry",s),this[$t]=s.remain?"ignore":"header",s.resume()):(s.remain?this[$t]="body":(this[$t]="header",s.end()),this[jr]?this[Hr].push(s):(this[Hr].push(s),this[jp]())))}}}[Jv](){aU(()=>this.emit("close"))}[Vv](e){let r=!0;return e?Array.isArray(e)?this.emit.apply(this,e):(this[jr]=e,this.emit("entry",e),e.emittedEnd||(e.on("end",i=>this[jp]()),r=!1)):(this[jr]=null,r=!1),r}[jp](){do;while(this[Vv](this[Hr].shift()));if(!this[Hr].length){let e=this[jr];!e||e.flowing||e.size===e.remain?this[oa]||this.emit("drain"):e.once("drain",i=>this.emit("drain"))}}[Hp](e,r){let i=this[mn],n=i.blockRemain,s=n>=e.length&&r===0?e:e.slice(r,r+n);return i.write(s),i.blockRemain||(this[$t]="header",this[mn]=null,i.end()),s.length}[Xv](e,r){let i=this[mn],n=this[Hp](e,r);return this[mn]||this[Yv](i),n}[gn](e,r,i){!this[Hr].length&&!this[jr]?this.emit(e,r,i):this[Hr].push([e,r,i])}[Yv](e){switch(this[gn]("meta",this[vi]),e.type){case"ExtendedHeader":case"OldExtendedHeader":this[kt]=Gv.parse(this[vi],this[kt],!1);break;case"GlobalExtendedHeader":this[sa]=Gv.parse(this[vi],this[sa],!0);break;case"NextFileHasLongPath":case"OldGnuLongPath":this[kt]=this[kt]||Object.create(null),this[kt].path=this[vi].replace(/\0.*/,"");break;case"NextFileHasLongLinkpath":this[kt]=this[kt]||Object.create(null),this[kt].linkpath=this[vi].replace(/\0.*/,"");break;default:throw new Error("unknown meta: "+e.type)}}abort(e){this[Ti]=!0,this.emit("abort",e),this.warn("TAR_ABORT",e,{recoverable:!1})}write(e){if(this[Ti])return;if((this[Le]===null||this.brotli===void 0&&this[Le]===!1)&&e){if(this[ue]&&(e=Buffer.concat([this[ue],e]),this[ue]=null),e.length<Bp.length)return this[ue]=e,!0;for(let s=0;this[Le]===null&&s<Bp.length;s++)e[s]!==Bp[s]&&(this[Le]=!1);let n=this.brotli===void 0;if(this[Le]===!1&&n)if(e.length<512)if(this[Oi])this.brotli=!0;else return this[ue]=e,!0;else try{new Wv(e.slice(0,512)),this.brotli=!1}catch{this.brotli=!0}if(this[Le]===null||this[Le]===!1&&this.brotli){let s=this[Oi];this[Oi]=!1,this[Le]=this[Le]===null?new zv.Unzip:new zv.BrotliDecompress,this[Le].on("data",a=>this[Ju](a)),this[Le].on("error",a=>this.abort(a)),this[Le].on("end",a=>{this[Oi]=!0,this[Ju]()}),this[oa]=!0;let o=this[Le][s?"end":"write"](e);return this[oa]=!1,o}}this[oa]=!0,this[Le]?this[Le].write(e):this[Ju](e),this[oa]=!1;let i=this[Hr].length?!1:this[jr]?this[jr].flowing:!0;return!i&&!this[Hr].length&&this[jr].once("drain",n=>this.emit("drain")),i}[Wp](e){e&&!this[Ti]&&(this[ue]=this[ue]?Buffer.concat([this[ue],e]):e)}[Gp](){if(this[Oi]&&!this[Qv]&&!this[Ti]&&!this[ec]){this[Qv]=!0;let e=this[mn];if(e&&e.blockRemain){let r=this[ue]?this[ue].length:0;this.warn("TAR_BAD_ARCHIVE","Truncated input (needed ".concat(e.blockRemain," more bytes, only ").concat(r," available)"),{entry:e}),this[ue]&&e.write(this[ue]),e.end()}this[gn](tc)}}[Ju](e){if(this[ec])this[Wp](e);else if(!e&&!this[ue])this[Gp]();else{if(this[ec]=!0,this[ue]){this[Wp](e);let r=this[ue];this[ue]=null,this[Zu](r)}else this[Zu](e);for(;this[ue]&&this[ue].length>=512&&!this[Ti]&&!this[ic];){let r=this[ue];this[ue]=null,this[Zu](r)}this[ec]=!1}(!this[ue]||this[Oi])&&this[Gp]()}[Zu](e){let r=0,i=e.length;for(;r+512<=i&&!this[Ti]&&!this[ic];)switch(this[$t]){case"begin":case"header":this[Kv](e,r),r+=512;break;case"ignore":case"body":r+=this[Hp](e,r);break;case"meta":r+=this[Xv](e,r);break;default:throw new Error("invalid state: "+this[$t])}r<i&&(this[ue]?this[ue]=Buffer.concat([e.slice(r),this[ue]]):this[ue]=e.slice(r))}end(e){this[Ti]||(this[Le]?this[Le].end(e):(this[Oi]=!0,this.brotli===void 0&&(e=e||Buffer.alloc(0)),this.write(e)))}})});var sc=w((E3,iO)=>{"use strict";var uU=ps(),tO=nc(),Ps=require("fs"),cU=Ds(),eO=require("path"),zp=bs();iO.exports=(t,e,r)=>{typeof t=="function"?(r=t,e=null,t={}):Array.isArray(t)&&(e=t,t={}),typeof e=="function"&&(r=e,e=null),e?e=Array.from(e):e=[];let i=uU(t);if(i.sync&&typeof r=="function")throw new TypeError("callback not supported for sync tar functions");if(!i.file&&typeof r=="function")throw new TypeError("callback only supported with file option");return e.length&&fU(i,e),i.noResume||hU(i),i.file&&i.sync?dU(i):i.file?pU(i,r):rO(i)};var hU=t=>{let e=t.onentry;t.onentry=e?r=>{e(r),r.resume()}:r=>r.resume()},fU=(t,e)=>{let r=new Map(e.map(s=>[zp(s),!0])),i=t.filter,n=(s,o)=>{let a=o||eO.parse(s).root||".",l=s===a?!1:r.has(s)?r.get(s):n(eO.dirname(s),a);return r.set(s,l),l};t.filter=i?(s,o)=>i(s,o)&&n(zp(s)):s=>n(zp(s))},dU=t=>{let e=rO(t),r=t.file,i=!0,n;try{let s=Ps.statSync(r),o=t.maxReadSize||16*1024*1024;if(s.size<o)e.end(Ps.readFileSync(r));else{let a=0,l=Buffer.allocUnsafe(o);for(n=Ps.openSync(r,"r");a<s.size;){let c=Ps.readSync(n,l,0,o,a);a+=c,e.write(l.slice(0,c))}e.end()}i=!1}finally{if(i&&n)try{Ps.closeSync(n)}catch{}}},pU=(t,e)=>{let r=new tO(t),i=t.maxReadSize||16*1024*1024,n=t.file,s=new Promise((o,a)=>{r.on("error",a),r.on("end",o),Ps.stat(n,(l,c)=>{if(l)a(l);else{let u=new cU.ReadStream(n,{readSize:i,size:c.size});u.on("error",a),u.pipe(r)}})});return e?s.then(e,e):s},rO=t=>new tO(t)});var uO=w((S3,lO)=>{"use strict";var mU=ps(),oc=Mu(),nO=Ds(),sO=sc(),oO=require("path");lO.exports=(t,e,r)=>{if(typeof e=="function"&&(r=e),Array.isArray(t)&&(e=t,t={}),!e||!Array.isArray(e)||!e.length)throw new TypeError("no files or directories specified");e=Array.from(e);let i=mU(t);if(i.sync&&typeof r=="function")throw new TypeError("callback not supported for sync tar functions");if(!i.file&&typeof r=="function")throw new TypeError("callback only supported with file option");return i.file&&i.sync?gU(i,e):i.file?yU(i,e,r):i.sync?wU(i,e):AU(i,e)};var gU=(t,e)=>{let r=new oc.Sync(t),i=new nO.WriteStreamSync(t.file,{mode:t.mode||438});r.pipe(i),aO(r,e)},yU=(t,e,r)=>{let i=new oc(t),n=new nO.WriteStream(t.file,{mode:t.mode||438});i.pipe(n);let s=new Promise((o,a)=>{n.on("error",a),n.on("close",o),i.on("error",a)});return Vp(i,e),r?s.then(r,r):s},aO=(t,e)=>{e.forEach(r=>{r.charAt(0)==="@"?sO({file:oO.resolve(t.cwd,r.slice(1)),sync:!0,noResume:!0,onentry:i=>t.add(i)}):t.add(r)}),t.end()},Vp=(t,e)=>{for(;e.length;){let r=e.shift();if(r.charAt(0)==="@")return sO({file:oO.resolve(t.cwd,r.slice(1)),noResume:!0,onentry:i=>t.add(i)}).then(i=>Vp(t,e));t.add(r)}t.end()},wU=(t,e)=>{let r=new oc.Sync(t);return aO(r,e),r},AU=(t,e)=>{let r=new oc(t);return Vp(r,e),r}});var Yp=w((b3,gO)=>{"use strict";var EU=ps(),cO=Mu(),Ct=require("fs"),hO=Ds(),fO=sc(),dO=require("path"),pO=Ss();gO.exports=(t,e,r)=>{let i=EU(t);if(!i.file)throw new TypeError("file is required");if(i.gzip||i.brotli||i.file.endsWith(".br")||i.file.endsWith(".tbr"))throw new TypeError("cannot append to compressed archives");if(!e||!Array.isArray(e)||!e.length)throw new TypeError("no files or directories specified");return e=Array.from(e),i.sync?SU(i,e):_U(i,e,r)};var SU=(t,e)=>{let r=new cO.Sync(t),i=!0,n,s;try{try{n=Ct.openSync(t.file,"r+")}catch(l){if(l.code==="ENOENT")n=Ct.openSync(t.file,"w+");else throw l}let o=Ct.fstatSync(n),a=Buffer.alloc(512);e:for(s=0;s<o.size;s+=512){for(let u=0,h=0;u<512;u+=h){if(h=Ct.readSync(n,a,u,a.length-u,s+u),s===0&&a[0]===31&&a[1]===139)throw new Error("cannot append to compressed archives");if(!h)break e}let l=new pO(a);if(!l.cksumValid)break;let c=512*Math.ceil(l.size/512);if(s+c+512>o.size)break;s+=c,t.mtimeCache&&t.mtimeCache.set(l.path,l.mtime)}i=!1,bU(t,r,s,n,e)}finally{if(i)try{Ct.closeSync(n)}catch{}}},bU=(t,e,r,i,n)=>{let s=new hO.WriteStreamSync(t.file,{fd:i,start:r});e.pipe(s),vU(e,n)},_U=(t,e,r)=>{e=Array.from(e);let i=new cO(t),n=(o,a,l)=>{let c=(y,A)=>{y?Ct.close(o,E=>l(y)):l(null,A)},u=0;if(a===0)return c(null,0);let h=0,f=Buffer.alloc(512),d=(y,A)=>{if(y)return c(y);if(h+=A,h<512&&A)return Ct.read(o,f,h,f.length-h,u+h,d);if(u===0&&f[0]===31&&f[1]===139)return c(new Error("cannot append to compressed archives"));if(h<512)return c(null,u);let E=new pO(f);if(!E.cksumValid)return c(null,u);let v=512*Math.ceil(E.size/512);if(u+v+512>a||(u+=v+512,u>=a))return c(null,u);t.mtimeCache&&t.mtimeCache.set(E.path,E.mtime),h=0,Ct.read(o,f,0,512,u,d)};Ct.read(o,f,0,512,u,d)},s=new Promise((o,a)=>{i.on("error",a);let l="r+",c=(u,h)=>{if(u&&u.code==="ENOENT"&&l==="r+")return l="w+",Ct.open(t.file,l,c);if(u)return a(u);Ct.fstat(h,(f,d)=>{if(f)return Ct.close(h,()=>a(f));n(h,d.size,(y,A)=>{if(y)return a(y);let E=new hO.WriteStream(t.file,{fd:h,start:A});i.pipe(E),E.on("error",a),E.on("close",o),mO(i,e)})})};Ct.open(t.file,l,c)});return r?s.then(r,r):s},vU=(t,e)=>{e.forEach(r=>{r.charAt(0)==="@"?fO({file:dO.resolve(t.cwd,r.slice(1)),sync:!0,noResume:!0,onentry:i=>t.add(i)}):t.add(r)}),t.end()},mO=(t,e)=>{for(;e.length;){let r=e.shift();if(r.charAt(0)==="@")return fO({file:dO.resolve(t.cwd,r.slice(1)),noResume:!0,onentry:i=>t.add(i)}).then(i=>mO(t,e));t.add(r)}t.end()}});var wO=w((_3,yO)=>{"use strict";var OU=ps(),TU=Yp();yO.exports=(t,e,r)=>{let i=OU(t);if(!i.file)throw new TypeError("file is required");if(i.gzip||i.brotli||i.file.endsWith(".br")||i.file.endsWith(".tbr"))throw new TypeError("cannot append to compressed archives");if(!e||!Array.isArray(e)||!e.length)throw new TypeError("no files or directories specified");return e=Array.from(e),CU(i),TU(i,e,r)};var CU=t=>{let e=t.filter;t.mtimeCache||(t.mtimeCache=new Map),t.filter=e?(r,i)=>e(r,i)&&!(t.mtimeCache.get(r)>i.mtime):(r,i)=>!(t.mtimeCache.get(r)>i.mtime)}});var SO=w((v3,EO)=>{var{promisify:AO}=require("util"),Ci=require("fs"),RU=t=>{if(!t)t={mode:511,fs:Ci};else if(typeof t=="object")t={mode:511,fs:Ci,...t};else if(typeof t=="number")t={mode:t,fs:Ci};else if(typeof t=="string")t={mode:parseInt(t,8),fs:Ci};else throw new TypeError("invalid options argument");return t.mkdir=t.mkdir||t.fs.mkdir||Ci.mkdir,t.mkdirAsync=AO(t.mkdir),t.stat=t.stat||t.fs.stat||Ci.stat,t.statAsync=AO(t.stat),t.statSync=t.statSync||t.fs.statSync||Ci.statSync,t.mkdirSync=t.mkdirSync||t.fs.mkdirSync||Ci.mkdirSync,t};EO.exports=RU});var _O=w((O3,bO)=>{var IU=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:NU,parse:xU}=require("path"),DU=t=>{if(/\0/.test(t))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:t,code:"ERR_INVALID_ARG_VALUE"});if(t=NU(t),IU==="win32"){let e=/[*|"<>?:]/,{root:r}=xU(t);if(e.test(t.substr(r.length)))throw Object.assign(new Error("Illegal characters in path."),{path:t,code:"EINVAL"})}return t};bO.exports=DU});var RO=w((T3,CO)=>{var{dirname:vO}=require("path"),OO=(t,e,r=void 0)=>r===e?Promise.resolve():t.statAsync(e).then(i=>i.isDirectory()?r:void 0,i=>i.code==="ENOENT"?OO(t,vO(e),e):void 0),TO=(t,e,r=void 0)=>{if(r!==e)try{return t.statSync(e).isDirectory()?r:void 0}catch(i){return i.code==="ENOENT"?TO(t,vO(e),e):void 0}};CO.exports={findMade:OO,findMadeSync:TO}});var Kp=w((C3,NO)=>{var{dirname:IO}=require("path"),Qp=(t,e,r)=>{e.recursive=!1;let i=IO(t);return i===t?e.mkdirAsync(t,e).catch(n=>{if(n.code!=="EISDIR")throw n}):e.mkdirAsync(t,e).then(()=>r||t,n=>{if(n.code==="ENOENT")return Qp(i,e).then(s=>Qp(t,e,s));if(n.code!=="EEXIST"&&n.code!=="EROFS")throw n;return e.statAsync(t).then(s=>{if(s.isDirectory())return r;throw n},()=>{throw n})})},Xp=(t,e,r)=>{let i=IO(t);if(e.recursive=!1,i===t)try{return e.mkdirSync(t,e)}catch(n){if(n.code!=="EISDIR")throw n;return}try{return e.mkdirSync(t,e),r||t}catch(n){if(n.code==="ENOENT")return Xp(t,e,Xp(i,e,r));if(n.code!=="EEXIST"&&n.code!=="EROFS")throw n;try{if(!e.statSync(t).isDirectory())throw n}catch{throw n}}};NO.exports={mkdirpManual:Qp,mkdirpManualSync:Xp}});var PO=w((R3,DO)=>{var{dirname:xO}=require("path"),{findMade:PU,findMadeSync:FU}=RO(),{mkdirpManual:LU,mkdirpManualSync:$U}=Kp(),kU=(t,e)=>(e.recursive=!0,xO(t)===t?e.mkdirAsync(t,e):PU(e,t).then(i=>e.mkdirAsync(t,e).then(()=>i).catch(n=>{if(n.code==="ENOENT")return LU(t,e);throw n}))),qU=(t,e)=>{if(e.recursive=!0,xO(t)===t)return e.mkdirSync(t,e);let i=FU(e,t);try{return e.mkdirSync(t,e),i}catch(n){if(n.code==="ENOENT")return $U(t,e);throw n}};DO.exports={mkdirpNative:kU,mkdirpNativeSync:qU}});var kO=w((I3,$O)=>{var FO=require("fs"),MU=process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version,Jp=MU.replace(/^v/,"").split("."),LO=+Jp[0]>10||+Jp[0]==10&&+Jp[1]>=12,UU=LO?t=>t.mkdir===FO.mkdir:()=>!1,BU=LO?t=>t.mkdirSync===FO.mkdirSync:()=>!1;$O.exports={useNative:UU,useNativeSync:BU}});var HO=w((N3,jO)=>{var Fs=SO(),Ls=_O(),{mkdirpNative:qO,mkdirpNativeSync:MO}=PO(),{mkdirpManual:UO,mkdirpManualSync:BO}=Kp(),{useNative:jU,useNativeSync:HU}=kO(),$s=(t,e)=>(t=Ls(t),e=Fs(e),jU(e)?qO(t,e):UO(t,e)),WU=(t,e)=>(t=Ls(t),e=Fs(e),HU(e)?MO(t,e):BO(t,e));$s.sync=WU;$s.native=(t,e)=>qO(Ls(t),Fs(e));$s.manual=(t,e)=>UO(Ls(t),Fs(e));$s.nativeSync=(t,e)=>MO(Ls(t),Fs(e));$s.manualSync=(t,e)=>BO(Ls(t),Fs(e));jO.exports=$s});var XO=w((x3,QO)=>{"use strict";var qt=require("fs"),wn=require("path"),GU=qt.lchown?"lchown":"chown",zU=qt.lchownSync?"lchownSync":"chownSync",GO=qt.lchown&&!process.version.match(/v1[1-9]+\./)&&!process.version.match(/v10\.[6-9]/),WO=(t,e,r)=>{try{return qt[zU](t,e,r)}catch(i){if(i.code!=="ENOENT")throw i}},VU=(t,e,r)=>{try{return qt.chownSync(t,e,r)}catch(i){if(i.code!=="ENOENT")throw i}},YU=GO?(t,e,r,i)=>n=>{!n||n.code!=="EISDIR"?i(n):qt.chown(t,e,r,i)}:(t,e,r,i)=>i,Zp=GO?(t,e,r)=>{try{return WO(t,e,r)}catch(i){if(i.code!=="EISDIR")throw i;VU(t,e,r)}}:(t,e,r)=>WO(t,e,r),QU=process.version,zO=(t,e,r)=>qt.readdir(t,e,r),XU=(t,e)=>qt.readdirSync(t,e);/^v4\./.test(QU)&&(zO=(t,e,r)=>qt.readdir(t,r));var ac=(t,e,r,i)=>{qt[GU](t,e,r,YU(t,e,r,n=>{i(n&&n.code!=="ENOENT"?n:null)}))},VO=(t,e,r,i,n)=>{if(typeof e=="string")return qt.lstat(wn.resolve(t,e),(s,o)=>{if(s)return n(s.code!=="ENOENT"?s:null);o.name=e,VO(t,o,r,i,n)});if(e.isDirectory())em(wn.resolve(t,e.name),r,i,s=>{if(s)return n(s);let o=wn.resolve(t,e.name);ac(o,r,i,n)});else{let s=wn.resolve(t,e.name);ac(s,r,i,n)}},em=(t,e,r,i)=>{zO(t,{withFileTypes:!0},(n,s)=>{if(n){if(n.code==="ENOENT")return i();if(n.code!=="ENOTDIR"&&n.code!=="ENOTSUP")return i(n)}if(n||!s.length)return ac(t,e,r,i);let o=s.length,a=null,l=c=>{if(!a){if(c)return i(a=c);if(--o===0)return ac(t,e,r,i)}};s.forEach(c=>VO(t,c,e,r,l))})},KU=(t,e,r,i)=>{if(typeof e=="string")try{let n=qt.lstatSync(wn.resolve(t,e));n.name=e,e=n}catch(n){if(n.code==="ENOENT")return;throw n}e.isDirectory()&&YO(wn.resolve(t,e.name),r,i),Zp(wn.resolve(t,e.name),r,i)},YO=(t,e,r)=>{let i;try{i=XU(t,{withFileTypes:!0})}catch(n){if(n.code==="ENOENT")return;if(n.code==="ENOTDIR"||n.code==="ENOTSUP")return Zp(t,e,r);throw n}return i&&i.length&&i.forEach(n=>KU(t,n,e,r)),Zp(t,e,r)};QO.exports=em;em.sync=YO});var eT=w((D3,tm)=>{"use strict";var KO=HO(),Mt=require("fs"),lc=require("path"),JO=XO(),Jt=As(),uc=class extends Error{constructor(e,r){super("Cannot extract through symbolic link"),this.path=r,this.symlink=e}get name(){return"SylinkError"}},cc=class extends Error{constructor(e,r){super(r+": Cannot cd into '"+e+"'"),this.path=e,this.code=r}get name(){return"CwdError"}},hc=(t,e)=>t.get(Jt(e)),aa=(t,e,r)=>t.set(Jt(e),r),JU=(t,e)=>{Mt.stat(t,(r,i)=>{(r||!i.isDirectory())&&(r=new cc(t,r&&r.code||"ENOTDIR")),e(r)})};tm.exports=(t,e,r)=>{t=Jt(t);let i=e.umask,n=e.mode|448,s=(n&i)!==0,o=e.uid,a=e.gid,l=typeof o=="number"&&typeof a=="number"&&(o!==e.processUid||a!==e.processGid),c=e.preserve,u=e.unlink,h=e.cache,f=Jt(e.cwd),d=(E,v)=>{E?r(E):(aa(h,t,!0),v&&l?JO(v,o,a,O=>d(O)):s?Mt.chmod(t,n,r):r())};if(h&&hc(h,t)===!0)return d();if(t===f)return JU(t,d);if(c)return KO(t,{mode:n}).then(E=>d(null,E),d);let A=Jt(lc.relative(f,t)).split("/");fc(f,A,n,h,u,f,null,d)};var fc=(t,e,r,i,n,s,o,a)=>{if(!e.length)return a(null,o);let l=e.shift(),c=Jt(lc.resolve(t+"/"+l));if(hc(i,c))return fc(c,e,r,i,n,s,o,a);Mt.mkdir(c,r,ZO(c,e,r,i,n,s,o,a))},ZO=(t,e,r,i,n,s,o,a)=>l=>{l?Mt.lstat(t,(c,u)=>{if(c)c.path=c.path&&Jt(c.path),a(c);else if(u.isDirectory())fc(t,e,r,i,n,s,o,a);else if(n)Mt.unlink(t,h=>{if(h)return a(h);Mt.mkdir(t,r,ZO(t,e,r,i,n,s,o,a))});else{if(u.isSymbolicLink())return a(new uc(t,t+"/"+e.join("/")));a(l)}}):(o=o||t,fc(t,e,r,i,n,s,o,a))},ZU=t=>{let e=!1,r="ENOTDIR";try{e=Mt.statSync(t).isDirectory()}catch(i){r=i.code}finally{if(!e)throw new cc(t,r)}};tm.exports.sync=(t,e)=>{t=Jt(t);let r=e.umask,i=e.mode|448,n=(i&r)!==0,s=e.uid,o=e.gid,a=typeof s=="number"&&typeof o=="number"&&(s!==e.processUid||o!==e.processGid),l=e.preserve,c=e.unlink,u=e.cache,h=Jt(e.cwd),f=E=>{aa(u,t,!0),E&&a&&JO.sync(E,s,o),n&&Mt.chmodSync(t,i)};if(u&&hc(u,t)===!0)return f();if(t===h)return ZU(h),f();if(l)return f(KO.sync(t,i));let y=Jt(lc.relative(h,t)).split("/"),A=null;for(let E=y.shift(),v=h;E&&(v+="/"+E);E=y.shift())if(v=Jt(lc.resolve(v)),!hc(u,v))try{Mt.mkdirSync(v,i),A=A||v,aa(u,v,!0)}catch{let R=Mt.lstatSync(v);if(R.isDirectory()){aa(u,v,!0);continue}else if(c){Mt.unlinkSync(v),Mt.mkdirSync(v,i),A=A||v,aa(u,v,!0);continue}else if(R.isSymbolicLink())return new uc(v,v+"/"+y.join("/"))}return f(A)}});var im=w((P3,tT)=>{var rm=Object.create(null),{hasOwnProperty:e2}=Object.prototype;tT.exports=t=>(e2.call(rm,t)||(rm[t]=t.normalize("NFD")),rm[t])});var sT=w((F3,nT)=>{var rT=require("assert"),t2=im(),r2=bs(),{join:iT}=require("path"),i2=process.env.TESTING_TAR_FAKE_PLATFORM||process.platform,n2=i2==="win32";nT.exports=()=>{let t=new Map,e=new Map,r=c=>c.split("/").slice(0,-1).reduce((h,f)=>(h.length&&(f=iT(h[h.length-1],f)),h.push(f||"/"),h),[]),i=new Set,n=c=>{let u=e.get(c);if(!u)throw new Error("function does not have any path reservations");return{paths:u.paths.map(h=>t.get(h)),dirs:[...u.dirs].map(h=>t.get(h))}},s=c=>{let{paths:u,dirs:h}=n(c);return u.every(f=>f[0]===c)&&h.every(f=>f[0]instanceof Set&&f[0].has(c))},o=c=>i.has(c)||!s(c)?!1:(i.add(c),c(()=>a(c)),!0),a=c=>{if(!i.has(c))return!1;let{paths:u,dirs:h}=e.get(c),f=new Set;return u.forEach(d=>{let y=t.get(d);rT.equal(y[0],c),y.length===1?t.delete(d):(y.shift(),typeof y[0]=="function"?f.add(y[0]):y[0].forEach(A=>f.add(A)))}),h.forEach(d=>{let y=t.get(d);rT(y[0]instanceof Set),y[0].size===1&&y.length===1?t.delete(d):y[0].size===1?(y.shift(),f.add(y[0])):y[0].delete(c)}),i.delete(c),f.forEach(d=>o(d)),!0};return{check:s,reserve:(c,u)=>{c=n2?["win32 parallelization disabled"]:c.map(f=>r2(iT(t2(f))).toLowerCase());let h=new Set(c.map(f=>r(f)).reduce((f,d)=>f.concat(d)));return e.set(u,{dirs:h,paths:c}),c.forEach(f=>{let d=t.get(f);d?d.push(u):t.set(f,[u])}),h.forEach(f=>{let d=t.get(f);d?d[d.length-1]instanceof Set?d[d.length-1].add(u):d.push(new Set([u])):t.set(f,[new Set([u])])}),o(u)}}}});var lT=w((L3,aT)=>{var s2=process.env.__FAKE_PLATFORM__||process.platform,o2=s2==="win32",a2=global.__FAKE_TESTING_FS__||require("fs"),{O_CREAT:l2,O_TRUNC:u2,O_WRONLY:c2,UV_FS_O_FILEMAP:oT=0}=a2.constants,h2=o2&&!!oT,f2=512*1024,d2=oT|u2|l2|c2;aT.exports=h2?t=>t<f2?d2:"w":()=>"w"});var fm=w(($3,bT)=>{"use strict";var p2=require("assert"),m2=nc(),K=require("fs"),g2=Ds(),Wr=require("path"),AT=eT(),uT=op(),y2=sT(),w2=ap(),Ut=As(),A2=bs(),E2=im(),cT=Symbol("onEntry"),om=Symbol("checkFs"),hT=Symbol("checkFs2"),mc=Symbol("pruneCache"),am=Symbol("isReusable"),Bt=Symbol("makeFs"),lm=Symbol("file"),um=Symbol("directory"),gc=Symbol("link"),fT=Symbol("symlink"),dT=Symbol("hardlink"),pT=Symbol("unsupported"),mT=Symbol("checkPath"),Ri=Symbol("mkdir"),Qe=Symbol("onError"),dc=Symbol("pending"),gT=Symbol("pend"),ks=Symbol("unpend"),nm=Symbol("ended"),sm=Symbol("maybeClose"),cm=Symbol("skip"),la=Symbol("doChown"),ua=Symbol("uid"),ca=Symbol("gid"),ha=Symbol("checkedCwd"),ET=require("crypto"),ST=lT(),S2=process.env.TESTING_TAR_FAKE_PLATFORM||process.platform,fa=S2==="win32",b2=1024,_2=(t,e)=>{if(!fa)return K.unlink(t,e);let r=t+".DELETE."+ET.randomBytes(16).toString("hex");K.rename(t,r,i=>{if(i)return e(i);K.unlink(r,e)})},v2=t=>{if(!fa)return K.unlinkSync(t);let e=t+".DELETE."+ET.randomBytes(16).toString("hex");K.renameSync(t,e),K.unlinkSync(e)},yT=(t,e,r)=>t===t>>>0?t:e===e>>>0?e:r,wT=t=>A2(Ut(E2(t))).toLowerCase(),O2=(t,e)=>{e=wT(e);for(let r of t.keys()){let i=wT(r);(i===e||i.indexOf(e+"/")===0)&&t.delete(r)}},T2=t=>{for(let e of t.keys())t.delete(e)},da=class extends m2{constructor(e){if(e||(e={}),e.ondone=r=>{this[nm]=!0,this[sm]()},super(e),this[ha]=!1,this.reservations=y2(),this.transform=typeof e.transform=="function"?e.transform:null,this.writable=!0,this.readable=!1,this[dc]=0,this[nm]=!1,this.dirCache=e.dirCache||new Map,typeof e.uid=="number"||typeof e.gid=="number"){if(typeof e.uid!="number"||typeof e.gid!="number")throw new TypeError("cannot set owner without number uid and gid");if(e.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=e.uid,this.gid=e.gid,this.setOwner=!0}else this.uid=null,this.gid=null,this.setOwner=!1;e.preserveOwner===void 0&&typeof e.uid!="number"?this.preserveOwner=process.getuid&&process.getuid()===0:this.preserveOwner=!!e.preserveOwner,this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null,this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null,this.maxDepth=typeof e.maxDepth=="number"?e.maxDepth:b2,this.forceChown=e.forceChown===!0,this.win32=!!e.win32||fa,this.newer=!!e.newer,this.keep=!!e.keep,this.noMtime=!!e.noMtime,this.preservePaths=!!e.preservePaths,this.unlink=!!e.unlink,this.cwd=Ut(Wr.resolve(e.cwd||process.cwd())),this.strip=+e.strip||0,this.processUmask=e.noChmod?0:process.umask(),this.umask=typeof e.umask=="number"?e.umask:this.processUmask,this.dmode=e.dmode||511&~this.umask,this.fmode=e.fmode||438&~this.umask,this.on("entry",r=>this[cT](r))}warn(e,r,i={}){return(e==="TAR_BAD_ARCHIVE"||e==="TAR_ABORT")&&(i.recoverable=!1),super.warn(e,r,i)}[sm](){this[nm]&&this[dc]===0&&(this.emit("prefinish"),this.emit("finish"),this.emit("end"))}[mT](e){let r=Ut(e.path),i=r.split("/");if(this.strip){if(i.length<this.strip)return!1;if(e.type==="Link"){let n=Ut(e.linkpath).split("/");if(n.length>=this.strip)e.linkpath=n.slice(this.strip).join("/");else return!1}i.splice(0,this.strip),e.path=i.join("/")}if(isFinite(this.maxDepth)&&i.length>this.maxDepth)return this.warn("TAR_ENTRY_ERROR","path excessively deep",{entry:e,path:r,depth:i.length,maxDepth:this.maxDepth}),!1;if(!this.preservePaths){if(i.includes("..")||fa&&/^[a-z]:\.\.$/i.test(i[0]))return this.warn("TAR_ENTRY_ERROR","path contains '..'",{entry:e,path:r}),!1;let[n,s]=w2(r);n&&(e.path=s,this.warn("TAR_ENTRY_INFO","stripping ".concat(n," from absolute path"),{entry:e,path:r}))}if(Wr.isAbsolute(e.path)?e.absolute=Ut(Wr.resolve(e.path)):e.absolute=Ut(Wr.resolve(this.cwd,e.path)),!this.preservePaths&&e.absolute.indexOf(this.cwd+"/")!==0&&e.absolute!==this.cwd)return this.warn("TAR_ENTRY_ERROR","path escaped extraction target",{entry:e,path:Ut(e.path),resolvedPath:e.absolute,cwd:this.cwd}),!1;if(e.absolute===this.cwd&&e.type!=="Directory"&&e.type!=="GNUDumpDir")return!1;if(this.win32){let{root:n}=Wr.win32.parse(e.absolute);e.absolute=n+uT.encode(e.absolute.slice(n.length));let{root:s}=Wr.win32.parse(e.path);e.path=s+uT.encode(e.path.slice(s.length))}return!0}[cT](e){if(!this[mT](e))return e.resume();switch(p2.equal(typeof e.absolute,"string"),e.type){case"Directory":case"GNUDumpDir":e.mode&&(e.mode=e.mode|448);case"File":case"OldFile":case"ContiguousFile":case"Link":case"SymbolicLink":return this[om](e);case"CharacterDevice":case"BlockDevice":case"FIFO":default:return this[pT](e)}}[Qe](e,r){e.name==="CwdError"?this.emit("error",e):(this.warn("TAR_ENTRY_ERROR",e,{entry:r}),this[ks](),r.resume())}[Ri](e,r,i){AT(Ut(e),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:r,noChmod:this.noChmod},i)}[la](e){return this.forceChown||this.preserveOwner&&(typeof e.uid=="number"&&e.uid!==this.processUid||typeof e.gid=="number"&&e.gid!==this.processGid)||typeof this.uid=="number"&&this.uid!==this.processUid||typeof this.gid=="number"&&this.gid!==this.processGid}[ua](e){return yT(this.uid,e.uid,this.processUid)}[ca](e){return yT(this.gid,e.gid,this.processGid)}[lm](e,r){let i=e.mode&4095||this.fmode,n=new g2.WriteStream(e.absolute,{flags:ST(e.size),mode:i,autoClose:!1});n.on("error",l=>{n.fd&&K.close(n.fd,()=>{}),n.write=()=>!0,this[Qe](l,e),r()});let s=1,o=l=>{if(l){n.fd&&K.close(n.fd,()=>{}),this[Qe](l,e),r();return}--s===0&&K.close(n.fd,c=>{c?this[Qe](c,e):this[ks](),r()})};n.on("finish",l=>{let c=e.absolute,u=n.fd;if(e.mtime&&!this.noMtime){s++;let h=e.atime||new Date,f=e.mtime;K.futimes(u,h,f,d=>d?K.utimes(c,h,f,y=>o(y&&d)):o())}if(this[la](e)){s++;let h=this[ua](e),f=this[ca](e);K.fchown(u,h,f,d=>d?K.chown(c,h,f,y=>o(y&&d)):o())}o()});let a=this.transform&&this.transform(e)||e;a!==e&&(a.on("error",l=>{this[Qe](l,e),r()}),e.pipe(a)),a.pipe(n)}[um](e,r){let i=e.mode&4095||this.dmode;this[Ri](e.absolute,i,n=>{if(n){this[Qe](n,e),r();return}let s=1,o=a=>{--s===0&&(r(),this[ks](),e.resume())};e.mtime&&!this.noMtime&&(s++,K.utimes(e.absolute,e.atime||new Date,e.mtime,o)),this[la](e)&&(s++,K.chown(e.absolute,this[ua](e),this[ca](e),o)),o()})}[pT](e){e.unsupported=!0,this.warn("TAR_ENTRY_UNSUPPORTED","unsupported entry type: ".concat(e.type),{entry:e}),e.resume()}[fT](e,r){this[gc](e,e.linkpath,"symlink",r)}[dT](e,r){let i=Ut(Wr.resolve(this.cwd,e.linkpath));this[gc](e,i,"link",r)}[gT](){this[dc]++}[ks](){this[dc]--,this[sm]()}[cm](e){this[ks](),e.resume()}[am](e,r){return e.type==="File"&&!this.unlink&&r.isFile()&&r.nlink<=1&&!fa}[om](e){this[gT]();let r=[e.path];e.linkpath&&r.push(e.linkpath),this.reservations.reserve(r,i=>this[hT](e,i))}[mc](e){e.type==="SymbolicLink"?T2(this.dirCache):e.type!=="Directory"&&O2(this.dirCache,e.absolute)}[hT](e,r){this[mc](e);let i=a=>{this[mc](e),r(a)},n=()=>{this[Ri](this.cwd,this.dmode,a=>{if(a){this[Qe](a,e),i();return}this[ha]=!0,s()})},s=()=>{if(e.absolute!==this.cwd){let a=Ut(Wr.dirname(e.absolute));if(a!==this.cwd)return this[Ri](a,this.dmode,l=>{if(l){this[Qe](l,e),i();return}o()})}o()},o=()=>{K.lstat(e.absolute,(a,l)=>{if(l&&(this.keep||this.newer&&l.mtime>e.mtime)){this[cm](e),i();return}if(a||this[am](e,l))return this[Bt](null,e,i);if(l.isDirectory()){if(e.type==="Directory"){let c=!this.noChmod&&e.mode&&(l.mode&4095)!==e.mode,u=h=>this[Bt](h,e,i);return c?K.chmod(e.absolute,e.mode,u):u()}if(e.absolute!==this.cwd)return K.rmdir(e.absolute,c=>this[Bt](c,e,i))}if(e.absolute===this.cwd)return this[Bt](null,e,i);_2(e.absolute,c=>this[Bt](c,e,i))})};this[ha]?s():n()}[Bt](e,r,i){if(e){this[Qe](e,r),i();return}switch(r.type){case"File":case"OldFile":case"ContiguousFile":return this[lm](r,i);case"Link":return this[dT](r,i);case"SymbolicLink":return this[fT](r,i);case"Directory":case"GNUDumpDir":return this[um](r,i)}}[gc](e,r,i,n){K[i](r,e.absolute,s=>{s?this[Qe](s,e):(this[ks](),e.resume()),n()})}},pc=t=>{try{return[null,t()]}catch(e){return[e,null]}},hm=class extends da{[Bt](e,r){return super[Bt](e,r,()=>{})}[om](e){if(this[mc](e),!this[ha]){let s=this[Ri](this.cwd,this.dmode);if(s)return this[Qe](s,e);this[ha]=!0}if(e.absolute!==this.cwd){let s=Ut(Wr.dirname(e.absolute));if(s!==this.cwd){let o=this[Ri](s,this.dmode);if(o)return this[Qe](o,e)}}let[r,i]=pc(()=>K.lstatSync(e.absolute));if(i&&(this.keep||this.newer&&i.mtime>e.mtime))return this[cm](e);if(r||this[am](e,i))return this[Bt](null,e);if(i.isDirectory()){if(e.type==="Directory"){let o=!this.noChmod&&e.mode&&(i.mode&4095)!==e.mode,[a]=o?pc(()=>{K.chmodSync(e.absolute,e.mode)}):[];return this[Bt](a,e)}let[s]=pc(()=>K.rmdirSync(e.absolute));this[Bt](s,e)}let[n]=e.absolute===this.cwd?[]:pc(()=>v2(e.absolute));this[Bt](n,e)}[lm](e,r){let i=e.mode&4095||this.fmode,n=a=>{let l;try{K.closeSync(s)}catch(c){l=c}(a||l)&&this[Qe](a||l,e),r()},s;try{s=K.openSync(e.absolute,ST(e.size),i)}catch(a){return n(a)}let o=this.transform&&this.transform(e)||e;o!==e&&(o.on("error",a=>this[Qe](a,e)),e.pipe(o)),o.on("data",a=>{try{K.writeSync(s,a,0,a.length)}catch(l){n(l)}}),o.on("end",a=>{let l=null;if(e.mtime&&!this.noMtime){let c=e.atime||new Date,u=e.mtime;try{K.futimesSync(s,c,u)}catch(h){try{K.utimesSync(e.absolute,c,u)}catch{l=h}}}if(this[la](e)){let c=this[ua](e),u=this[ca](e);try{K.fchownSync(s,c,u)}catch(h){try{K.chownSync(e.absolute,c,u)}catch{l=l||h}}}n(l)})}[um](e,r){let i=e.mode&4095||this.dmode,n=this[Ri](e.absolute,i);if(n){this[Qe](n,e),r();return}if(e.mtime&&!this.noMtime)try{K.utimesSync(e.absolute,e.atime||new Date,e.mtime)}catch{}if(this[la](e))try{K.chownSync(e.absolute,this[ua](e),this[ca](e))}catch{}r(),e.resume()}[Ri](e,r){try{return AT.sync(Ut(e),{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:r})}catch(i){return i}}[gc](e,r,i,n){try{K[i+"Sync"](r,e.absolute),n(),e.resume()}catch(s){return this[Qe](s,e)}}};da.Sync=hm;bT.exports=da});var CT=w((k3,TT)=>{"use strict";var C2=ps(),yc=fm(),vT=require("fs"),OT=Ds(),_T=require("path"),dm=bs();TT.exports=(t,e,r)=>{typeof t=="function"?(r=t,e=null,t={}):Array.isArray(t)&&(e=t,t={}),typeof e=="function"&&(r=e,e=null),e?e=Array.from(e):e=[];let i=C2(t);if(i.sync&&typeof r=="function")throw new TypeError("callback not supported for sync tar functions");if(!i.file&&typeof r=="function")throw new TypeError("callback only supported with file option");return e.length&&R2(i,e),i.file&&i.sync?I2(i):i.file?N2(i,r):i.sync?x2(i):D2(i)};var R2=(t,e)=>{let r=new Map(e.map(s=>[dm(s),!0])),i=t.filter,n=(s,o)=>{let a=o||_T.parse(s).root||".",l=s===a?!1:r.has(s)?r.get(s):n(_T.dirname(s),a);return r.set(s,l),l};t.filter=i?(s,o)=>i(s,o)&&n(dm(s)):s=>n(dm(s))},I2=t=>{let e=new yc.Sync(t),r=t.file,i=vT.statSync(r),n=t.maxReadSize||16*1024*1024;new OT.ReadStreamSync(r,{readSize:n,size:i.size}).pipe(e)},N2=(t,e)=>{let r=new yc(t),i=t.maxReadSize||16*1024*1024,n=t.file,s=new Promise((o,a)=>{r.on("error",a),r.on("close",o),vT.stat(n,(l,c)=>{if(l)a(l);else{let u=new OT.ReadStream(n,{readSize:i,size:c.size});u.on("error",a),u.pipe(r)}})});return e?s.then(e,e):s},x2=t=>new yc.Sync(t),D2=t=>new yc(t)});var RT=w(Ce=>{"use strict";Ce.c=Ce.create=uO();Ce.r=Ce.replace=Yp();Ce.t=Ce.list=sc();Ce.u=Ce.update=wO();Ce.x=Ce.extract=CT();Ce.Pack=Mu();Ce.Unpack=fm();Ce.Parse=nc();Ce.ReadEntry=bu();Ce.WriteEntry=yp();Ce.Header=Ss();Ce.Pax=vu();Ce.types=Zd()});var FT=w((M3,PT)=>{var{spawn:pm}=require("child_process"),{session:IT}=require("electron"),An=require("path"),P2=RT(),wt=require("fs"),F2=require("os"),L2=zt(),$2=Zt(),En=vn(),k2=ga(),de,jt,Ht,Sn,pr,be,Rt,NT,xT,DT;PT.exports=(de=class extends $2{constructor(r){super(r);I(this,be);I(this,jt,null);I(this,Ht,null);I(this,Sn,!1);I(this,pr,{code:de.CODE_OLLAMA_DOWNLOAD,success:!0,progressBar:!1,message:""});_(this,"install",(r=!1)=>p(this,Sn)?(k(this,be,Rt).call(this,p(this,pr).code,p(this,pr).success,p(this,pr).progressBar,p(this,pr).message),!1):(U(this,Sn,!0),p(this,jt)!==null?(k(this,be,Rt).call(this,de.CODE_OLLAMA_FINISH),U(this,Sn,!1),!0):(r&&(k(this,be,Rt).call(this,de.CODE_OLLAMA_DOWNLOAD,!0,!0),wt.existsSync(p(this,Ht))&&wt.rmSync(p(this,Ht),{recursive:!0,force:!0}),wt.mkdirSync(p(this,Ht),{recursive:!0})),(async()=>{let i=["arm","arm64"].includes(F2.arch()),n=An.join(p(this,Ht),"ollama"),s=An.join(p(this,Ht),"models");try{let o=An.join(n,En.MACOS===process.platform?"ollama":En.WINDOWS===process.platform?"ollama.exe":"bin/ollama"),a=wt.existsSync(o),l=[{codeDownload:de.CODE_OLLAMA_DOWNLOAD,codeUnpack:de.CODE_OLLAMA_UNPACK,outputPath:n,archiveName:En.MACOS===process.platform?"ollama-darwin.tgz":En.WINDOWS===process.platform?"ollama-windows-".concat(i?"arm64":"amd64",".zip"):"ollama-linux-".concat(i?"arm64":"amd64",".tgz")},{codeDownload:de.CODE_MODELS_DOWNLOAD,codeUnpack:de.CODE_MODELS_UNPACK,outputPath:s,archiveName:"models.tgz"}];for(let c of l){let u="".concat(de.DOWNLOAD_URL,"/").concat(c.archiveName),h=await k(this,be,NT).call(this,c.codeDownload,u,c.archiveName);await k(this,be,xT).call(this,c.codeUnpack,h,c.outputPath),!a&&wt.existsSync(o)&&de.CODE_OLLAMA_DOWNLOAD===c.codeDownload&&En.WINDOWS!==process.platform&&wt.chmodSync(o,493)}p(this,jt)===null&&(k(this,be,Rt).call(this,de.CODE_OLLAMA_SERVE,!0,!0),U(this,jt,pm(o,["serve"],{env:{...process.env,OLLAMA_HOST:"0.0.0.0:".concat(this._oglama.config.getOllamaPort()),OLLAMA_MODELS:s},detached:!1,stdio:"ignore"})),p(this,jt).unref(),p(this,jt).on("error",c=>{this.stop(),k(this,be,Rt).call(this,de.CODE_OLLAMA_SERVE,!1,!1,"Ollama server offline")})),k(this,be,Rt).call(this,de.CODE_OLLAMA_FINISH)}catch(o){k(this,be,Rt).call(this,p(this,pr).code||de.CODE_OLLAMA_DOWNLOAD,!1,!1,"".concat(o.message??o))}U(this,Sn,!1)})(),!0)));_(this,"getPort",()=>this._oglama.config.getOllamaPort());this._register("llm"),U(this,Ht,An.join(k2.getPathConfig(),"llm")),wt.existsSync(p(this,Ht))||wt.mkdirSync(p(this,Ht),{recursive:!0})}stop(){if(p(this,jt)!==null){try{process.platform==="win32"?pm("taskkill",["/PID",p(this,jt).pid,"/T","/F"],{shell:!0,windowsHide:!0}):p(this,jt).kill("SIGTERM")}catch{}U(this,jt,null)}}},jt=new WeakMap,Ht=new WeakMap,Sn=new WeakMap,pr=new WeakMap,be=new WeakSet,Rt=async function(r,i=!0,n=!1,s=""){if(U(this,pr,{code:r,success:i,progressBar:n,message:s}),typeof this._oglama.main?.view.webContents?.send=="function"){let o=["ipc:llm:install",[p(this,pr)],{type:"req"}];this._oglama.main?.view.webContents?.send(L2.WINDOW_MAIN,o)}},NT=async function(r,i,n){let s=An.join(p(this,Ht),n);return wt.existsSync(s)?s:new Promise((o,a)=>{let l=(c,u)=>{u.setSavePath(s),k(this,be,Rt).call(this,r,!0,0),u.on("updated",(h,f)=>{if(f==="progressing"){let d=Math.floor(u.getReceivedBytes()/u.getTotalBytes()*100);k(this,be,Rt).call(this,r,!0,d)}}),u.once("done",(h,f)=>{if(IT.defaultSession.removeListener("will-download",l),f==="completed"){k(this,be,Rt).call(this,r,!0,100),o(u.getSavePath());return}a(new Error("".concat(r," download failed: ").concat(f)))})};IT.defaultSession.once("will-download",l),this._oglama.main?.view.webContents.downloadURL(i)})},xT=async function(r,i,n){let s=An.join(n,"meta.json");if(wt.existsSync(s))return;k(this,be,Rt).call(this,r,!0,!0),wt.existsSync(n)&&wt.rmSync(n,{recursive:!0,force:!0}),wt.mkdirSync(n,{recursive:!0});let o=Math.floor(new Date().getTime()/1e3);try{An.extname(i)===".zip"?await k(this,be,DT).call(this,i,n):await P2.extract({file:i,cwd:n,strict:!0});let a=Math.floor(new Date().getTime()/1e3);wt.writeFileSync(s,JSON.stringify({t:a,d:a-o})),k(this,be,Rt).call(this,r,!0,100)}catch(a){throw new Error("".concat(r," extraction failed: ").concat(a.message??a))}},DT=async function(r,i){return new Promise((n,s)=>{let o=En.WINDOWS===process.platform?"powershell":"unzip",a=En.WINDOWS===process.platform?["-Command","Expand-Archive -Path '".concat(r,"' -DestinationPath '").concat(i,"' -Force")]:["-o",r,"-d",i];pm(o,a,{shell:!0}).on("close",c=>{if(c===0){n();return}s(new Error("Extraction failed with code ".concat(c)))})})},_(de,"DOWNLOAD_URL","https://dl.oglama.com"),_(de,"CODE_OLLAMA_DOWNLOAD","download:ollama"),_(de,"CODE_OLLAMA_UNPACK","unpack:ollama"),_(de,"CODE_MODELS_DOWNLOAD","download:models"),_(de,"CODE_MODELS_UNPACK","unpack:models"),_(de,"CODE_OLLAMA_SERVE","serve"),_(de,"CODE_OLLAMA_FINISH","finish"),de)});var UT=w((j3,MT)=>{var{app:mm,session:wc,BrowserWindow:LT,powerSaveBlocker:$T}=require("electron"),kT=require("path"),pa=zt(),q2=Om(),M2=Cm(),U2=Im(),B2=xm(),gm=vn(),j2=Hm(),H2=zm(),W2=Gb(),G2=Qb(),z2=t_(),V2=o_(),Y2=g_(),Q2=FT(),ye,qs,ma,Wt,qT;MT.exports=(qT=class{constructor(){I(this,ye,null);I(this,qs,null);I(this,ma,!1);I(this,Wt,null);_(this,"rootPath",mm.getAppPath());_(this,"devMode",!1);_(this,"log",new U2(this));_(this,"webserver",new q2(this));_(this,"activity",new M2(this));_(this,"diskStorage",new j2(this));_(this,"session",new H2(this));_(this,"llm",new Q2(this));_(this,"updater",new W2(this));_(this,"device",new G2(this));_(this,"source",new z2(this));_(this,"target",new V2(this));_(this,"main",new Y2(this));_(this,"config",new B2(this))}mainWindow(){let e=this;if(wc.defaultSession.setPermissionCheckHandler((r,i,n,s)=>!0),wc.defaultSession.setPermissionRequestHandler((r,i,n,s)=>{n(!0)}),p(e,ye)===null){U(e,ye,new LT({icon:kT.join(e.rootPath,"res/icons/icon.png"),minHeight:e.config.getMainMinHeight(),minWidth:e.config.getMainMinWidth(),height:e.config.getMainMinHeight(),width:e.config.getMainMinWidth(),titleBarStyle:"default",backgroundColor:"#000",fullscreenable:!1,useContentSize:!0,resizable:!0,title:"Oglama",show:!1,webPreferences:{session:wc.defaultSession,backgroundThrottling:!1,nodeIntegration:!0,spellcheck:!1}})),p(e,ye).setMenu(null),p(e,ye).on("minimize",i=>{if(i.preventDefault(),!e.updater.isInstalling()){let n=["ipc:oglama:restored",[],{type:"req",fromWin:pa.WINDOW_MAIN_LOGIN}];e.main.view?.webContents.send(pa.WINDOW_MAIN,n)}setTimeout(()=>{p(e,ye).restore(),p(e,ye).webContents.invalidate()},250)}),p(e,ye).setMaxListeners(0),p(e,ye).on("closed",()=>{e.llm.stop(),U(e,ye,null),p(e,qs)!==null&&$T.stop(p(e,qs)),mm.quit()});let r=()=>{let i=p(e,ye).getSize(),n=[gm.WINDOWS,gm.MACOS].includes(process.platform)?Math.abs(p(e,ye).getSize()[1]-p(e,ye).getContentSize()[1]):0,s=[gm.WINDOWS].includes(process.platform)?Math.abs(p(e,ye).getSize()[0]-p(e,ye).getContentSize()[0]):0;e.main.setWindowSize(i[0]-s,i[1]-n),e.target.setWindowSize(i[0]-s,i[1]-n)};p(e,ye).on("resize",()=>r()),p(e,ye).once("ready-to-show",()=>r()),e.main.init(),e.main.view.webContents.on("did-finish-load",()=>{e.getPostAuth()&&p(e,ye).show(),r()}),p(e,ye).setMenu(null),U(e,qs,$T.start("prevent-app-suspension"))}return p(e,ye)}mainLoginWindow(){let e=this;return p(e,Wt)===null&&(U(e,Wt,new LT({width:e.config.getMainLoginWidth(),height:e.config.getMainLoginHeight(),icon:kT.join(e.rootPath,"res/icons/icon.png"),resizable:!1,fullscreenable:!1,transparent:!0,titleBarStyle:"hidden",title:"Oglama",backgroundColor:"#00000000",webPreferences:{backgroundThrottling:!1,spellcheck:!1,nodeIntegration:!0,session:wc.defaultSession}})),p(e,Wt).setMenu(null),p(e,Wt).setMaxListeners(0),p(e,Wt).on("closed",()=>{U(e,Wt,null),mm.quit()}),e.main?.login?.init(),e.main?.login?.view.webContents.on("did-finish-load",()=>{e.getPostAuth()||p(e,Wt).show()}),p(e,Wt).setMenu(null)),p(e,Wt)}getPostAuth(){return p(this,ma)}setPostAuth(e){let r=!1;if(e=!!e,e!==this.getPostAuth()){U(this,ma,e);let i=["ipc:oglama:auth",[e],{type:"req",fromWin:pa.WINDOW_MAIN_LOGIN}];this.main?.login?.view.webContents.send(pa.WINDOW_MAIN_LOGIN,i),setTimeout(()=>{this.main?.view.webContents.send(pa.WINDOW_MAIN,i)},750),e?(this.mainWindow().show(),this.mainLoginWindow().hide()):(this.mainWindow().hide(),this.mainLoginWindow().show()),r=!0}return r}},ye=new WeakMap,qs=new WeakMap,ma=new WeakMap,Wt=new WeakMap,qT)});var{app:nt,BrowserWindow:X2}=require("electron"),K2=UT();nt.userAgentFallback=nt.userAgentFallback.replace(/\s*Electron\/\d+(\.\d+)+\s*/g," ").replace(/\boglama\b/g,"Oglama");nt.commandLine.appendSwitch("allow-insecure-localhost");nt.commandLine.appendSwitch("disable-renderer-backgrounding");nt.commandLine.appendSwitch("disable-background-timer-throttling");nt.commandLine.appendSwitch("disable-backgrounding-occluded-windows");nt.commandLine.appendSwitch("disable-features","UserAgentClientHint");process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";process.on("uncaughtException",t=>{});var Gr=null;do{if(!nt.requestSingleInstanceLock()){nt.quit();break}nt.on("second-instance",()=>{if(Gr!==null){let t=Gr.getPostAuth()?Gr.mainWindow():Gr.mainLoginWindow();t.isMinimized()&&(t.restore(),t.webContents?.invalidate()),t.show()}}),nt.on("ready",async()=>{Gr=new K2,nt.on("activate",()=>{X2.getAllWindows().length===0&&Gr.activity.start()}),await Gr.webserver.start(),await Gr.activity.start(),await Gr.updater.start()}),nt.on("before-quit",()=>{process.exit(0)}),nt.on("window-all-closed",()=>{process.platform!=="darwin"&&nt.quit()})}while(!1);
