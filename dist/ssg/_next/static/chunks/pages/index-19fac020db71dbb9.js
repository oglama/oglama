/*!
 * @architect Mark Jivko <mark@oglama.com>
 * @copyright © 2024-2026 Oglama™ (https://oglama.com)
 * 
 * Licensed under the Oglama™ Source-Available License, Version 1.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     https://github.com/oglama/oglama/blob/main/LICENSE.txt
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{29189:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>rT});var l=n(37876),i=n(75961),r=n.n(i),s=n(14632),a=n(35505),o=n(13383);let d=null,c=function(e){var t,n,l;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};if(!e.isTrusted||e.shiftKey||e.altKey||!(null==e?void 0:e.ctrlKey)||"control"===(null==(t=e.key)?void 0:t.toLowerCase()))return;let c=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),s("loading",!0)},u={"/":()=>{var e,t;if(!(null==(e=window.sdk)?void 0:e.devMode))return;let n=window.localStorage.getItem("jwt-user"),l=window.localStorage.getItem("jwt-founder");if("string"!=typeof n||"string"!=typeof l)return void o.o.error("Local storage jwt-user or jwt-founder missing");let i=window.localStorage.getItem("oglama-auth-jwt");window.localStorage.setItem("oglama-auth-jwt",i===n?l:n),c(),o.o.loading("Switching user..."),null==(t=window.sdk)||t.ipc.source.closeAll(),window.setTimeout(()=>window.location.reload(),1500)},numeric:(e,t)=>{var n;let l=[...new Set(e.map(e=>null==e?void 0:e.id).filter(Boolean))];"string"==typeof l[t]&&(null==(n=document.querySelector('[data-agent="'.concat(l[t],'"][data-agent-selected="false"]')))||n.click())},".":()=>{var e;null==(e=document.querySelector('[data-start-stop="'.concat(r(),'"]')))||e.click()},w:()=>{var e;null==(e=document.querySelector('[data-tab="browser"][data-tab-selected="false"]'))||e.click()},e:()=>{var e;null==(e=document.querySelector('[data-tab="settings"][data-tab-selected="false"]'))||e.click()},r:()=>{var e;null==(e=document.querySelector('[data-tab="results"][data-tab-selected="false"]'))||e.click()},l:()=>{var e;null==(e=document.querySelector("[data-logs-toggle]"))||e.click()},m:()=>{var e;null==(e=document.querySelector("[data-modules-toggle]"))||e.click()},u:async()=>{var e,t;await (null==(t=window)||null==(e=t.sdk)?void 0:e.ipc.source.open(r()))&&await c()},i:e=>{let t=(0,a.fD)(e,r());if(null!==t){var n;null==(n=window.sdk)||n.ipc.target.openDevTools(t.id,t.name)}}},p=(null==(n=e.key)?void 0:n.toLowerCase().match(/^[1-9]$/))?t=>u.numeric(t,parseInt(e.key,10)-1):u[null==(l=e.key)?void 0:l.toLowerCase()];"function"==typeof p&&(e.preventDefault(),null!==d&&window.clearTimeout(d),d=window.setTimeout(()=>{d=null;try{var e;p(i),null==(e=window.sdk)||e.ipc.main.setOnTop()}catch(e){}},50))},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},l=l=>c(l,e,t,n);return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}};var p=n(46094),x=n(18952),h=n(81373),m=n(8628),g=n(7156),f=n(14232);let y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},l=window.setTimeout(()=>{if(!Array.isArray(e)||!e.length)return;window.localStorage.removeItem("ally-supports-cache");let l=[],i=e.map(e=>{var t;return null!=(t=null==e?void 0:e.id)?t:null}).filter(Boolean);for(let e of Object.keys(window.localStorage)){let t=e.match(/^oglama\-(\w{24})\-/);t&&!i.includes(t[1])&&l.push(t[1])}for(let e of i)n(e);if(l.length)for(let e of[...new Set(l)])t(e)},500);return()=>window.clearTimeout(l)};var A=n(89099),j=n(39763),v=n.n(j),w=n(91040),b=n(35268),k=n(66703),S=n(38388),C=n(35003),I=n(84812),T=n(2653),z=n(84782);let D=(0,b.Ay)(S.A)(e=>{let{theme:t,open:n=!1}=e;return{transition:"transform 350ms cubic-bezier(0.48, -0.35, 0.17, 0.95)",transform:n?"rotate(180deg)":"rotate(0deg)",justifyContent:"center",alignItems:"center",position:"relative",display:"flex"}}),P=e=>{let{children:t,open:n=!1,sx:i={}}=e;return("object"!=typeof i||null===i)&&(i={}),(0,l.jsx)(D,{sx:i,open:!!n,children:t})};function R(e){let{log:t}=e;return(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:(0,l.jsx)(C.A,{variant:"caption",noWrap:!0,align:"left",sx:{textTransform:"none",width:"calc(100% - 75px)"},children:t.m})})}function _(e){let{agents:t}=e,{i18n:n}=(0,g.B)(),{getAgentActive:i,onAgentActive:r,getAgentId:s,onAgentId:a,getLogs:o,onLog:d,getLogsEnabled:c,onLogsEnabled:u,getLogsVisible:p,onLogsVisible:x,setLogsVisible:m}=(0,h.P)(),[y,A]=(0,f.useState)(null),[j,v]=(0,f.useState)(!1),[w,b]=(0,f.useState)(null),[k,D]=(0,f.useState)(!1),[_,E]=(0,f.useState)(!1);(0,f.useEffect)(()=>{let e=o(s());A(Array.isArray(e)&&e.length?e[0]:null);let t=d(e=>A(Array.isArray(e)&&e.length?e[0]:null));v(i(s()));let n=r(e=>{let{agentId:t,active:n}=e;t===s()&&v(n)});D(c());let l=u(e=>D(e));E(p());let a=x(e=>E(e));return()=>{t(),n(),l(),a()}},[w]),(0,f.useEffect)(()=>{b(s());let e=a(e=>b(e));return()=>e()},[t]);let M="action";return(j&&"string"==typeof(null==y?void 0:y.s)||"error"===(null==y?void 0:y.s))&&(M=y.s),null!==w&&k?(0,l.jsx)(S.A,{sx:{minWidth:"maxContent",width:"100%",flexShrink:1,display:"flex",height:"100%",overflow:"hidden"},children:(0,l.jsx)(S.A,{sx:{width:"100%",height:"100%"},children:(0,l.jsxs)(I.A,{"data-logs-toggle":!0,onClick:()=>{m(!_),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},sx:{width:"100%",height:"100%",alignItems:"center",borderRadius:0,justifyContent:"start",pl:3},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(T.A,{sx:{mr:2},color:M,fontSize:"small"}),null!==y?(0,l.jsx)(R,{log:y}):(0,l.jsx)(C.A,{variant:"caption",noWrap:!0,align:"left",sx:{textTransform:"none",width:"calc(100% - 75px)"},children:n.t("No messages were recorded for this agent")})]}),(0,l.jsx)(S.A,{sx:{position:"absolute",top:12,right:6},children:(0,l.jsx)(P,{open:_,children:(0,l.jsx)(z.A,{color:"action"})})})]})})}):null}var E=n(58549),M=n(3678),N=n(32933),L=n(15852),O=n(99476);let U=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",height:"50px",paddingLeft:t.spacing(4),paddingRight:t.spacing(4),justifyContent:"space-between",backgroundColor:t.palette.background.paper,borderBottom:"1px solid ".concat(t.palette.divider),flexShrink:0}}),B=(0,b.Ay)(S.A)(()=>({display:"inline-block",maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",userSelect:"none",fontSize:"0.85rem",textAlign:"center"})),F=e=>{let{title:t,icon:n=null,handleClose:i=()=>{},sx:r={}}=e,{i18n:s}=(0,g.B)();return("object"!=typeof r||null===r)&&(r={}),(0,l.jsxs)(U,{sx:{...r},children:[n,(0,l.jsx)(L.A,{title:t,children:(0,l.jsx)(B,{children:t})}),(0,l.jsx)(L.A,{title:s.t("Close"),placement:"left",children:(0,l.jsx)(O.A,{onClick:i,sx:{cursor:"pointer"}})})]})},W=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{padding:t.spacing(4),overflowY:"auto",height:"100%"}}),H=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{width:"1100px",height:"1100px",left:"50%",top:"50%",marginLeft:"-550px",marginTop:"-550px",position:"absolute",background:"url(/img/pages/circles-".concat(t.palette.mode,".svg)"),backgroundPosition:"50% 50%",backgroundSize:"cover",backgroundRepeat:"no-repeat",zIndex:1}});var q=n(71948),Y=n(79219),G=n(62727),K=n(50705),V=n(91247),$=n(43400);let J=(0,b.Ay)(q.A)(e=>{let{theme:t}=e;return{[t.breakpoints.down("md")]:{minWidth:100},[t.breakpoints.down("sm")]:{minWidth:67}}}),Q=(0,b.Ay)("span")(e=>{let{theme:t}=e;return{fontSize:"0.75rem",marginLeft:t.spacing(3.4),[t.breakpoints.down("md")]:{display:"none"}}}),X=e=>{let{tabs:t,hash:n,setHash:i,sx:r={},tabsReady:s=!0,hideSingleTab:a=!0,prefix:o=null,suffix:d=null,bordered:c=!1,sticky:u=!1}=e,{i18n:p}=(0,g.B)(),x=(0,k.A)(),h={};return Object.keys(t).map(e=>{(void 0===t[e].visible||t[e].visible)&&(h[e]=t[e])}),(null===r||"object"!=typeof r)&&(r={}),(0,l.jsxs)(Y.Ay,{value:n,children:[Object.keys(h).length<=1&&a?null:s?(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",...c?{borderBottom:"1px solid ".concat(x.palette.divider)}:{},...d?{justifyContent:"space-between"}:{}},children:[null!==o?(0,l.jsx)(S.A,{sx:{pl:3},children:o}):null,(0,l.jsx)(K.A,{sx:{pl:3*(null!==o)},onChange:(e,t)=>i(t),"aria-label":"Tabs",children:Object.keys(h).map((e,t)=>(0,l.jsx)(J,{value:e,label:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[h[e].icon,(0,l.jsx)(Q,{children:p.t(h[e].label)}),h[e].hasPop?(0,l.jsx)(V.A,{sx:{position:"absolute",top:"0.25rem",right:0},color:"warning"}):null]})},t))}),null!==d?(0,l.jsx)(S.A,{sx:{pr:3},children:d}):null]}):(0,l.jsx)(S.A,{sx:{height:"48px",width:{xs:"100%",md:"50%"}},children:(0,l.jsx)($.A,{count:1,columns:3})}),(0,l.jsx)(S.A,{sx:{...u?{height:"calc(100% - 49px)",overflowY:"auto",position:"relative",zIndex:10}:{},...r},children:Object.keys(h).map((e,t)=>(0,l.jsx)(G.A,{value:e,sx:{p:0},children:n===e?h[e].content:null},t))})]})};var Z=n(35250),ee=n(67290),et=n(95196),en=n(71507),el=n.n(en),ei=n(71015),er=n(92828),es=n(4552);let ea={png:"image/png",apng:"image/apng",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif",bmp:"image/bmp",tif:"image/tiff",tiff:"image/tiff",ico:"image/x-icon",mp3:"audio/mpeg",wav:"audio/wav",ogg:"audio/ogg",m4a:"audio/mp4",mp4:"video/mp4",webm:"video/webm",mov:"video/quicktime",mkv:"video/x-matroska"},eo=["png","apng","jpg","jpeg","gif","svg","webp","avif","bmp","tif","tiff","ico"],ed=["mp3","wav","ogg","m4a"],ec=["mp4","webm","mov","mkv"];function eu(e){var t;let{fileUrl:n,showIcon:i=!1,container:r=null}=e,{i18n:s}=(0,g.B)(),a=(0,k.A)(),o=(0,f.useRef)(null),[d,c]=(0,f.useState)(!1),[u,p]=(0,f.useState)(!1),x=()=>p(!0),h="---";try{let e=new URL(n);"file:"===e.protocol&&e.pathname.match(/^.*?\.\w+$/gi)&&(h=e.pathname.replace(/^.*?\.(\w+$)/gi,"$1").toLowerCase())}catch(e){}let m=eo.includes(h)?"image":ed.includes(h)?"audio":ec.includes(h)?"video":null,y=null!=(t=ea[h])?t:"";return(0,f.useEffect)(()=>{var e;if(null===m)return;let t=new IntersectionObserver(e=>{let[n]=e;n.isIntersecting&&(c(!0),t.disconnect())},{root:null!=(e=null==r?void 0:r.current)?e:null,threshold:.1});return t.observe(o.current),()=>t.disconnect()},[]),null===m?i?(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[(0,l.jsx)(es.A,{sx:{mb:2,fontSize:50,color:a.palette.text.primary}}),(0,l.jsx)(C.A,{variant:"caption",sx:{color:a.palette.text.primary,fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace",textTransform:"uppercase"},children:h})]}):null:(0,l.jsx)(S.A,{ref:o,sx:{position:"relative",zIndex:1,display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",overflow:"hidden"},children:(0,l.jsx)(S.A,{sx:{overflow:"hidden",width:"100%",maxWidth:"800px",display:"inline-flex",justifyContent:"center",alignItems:"center",borderRadius:1,background:"light"===a.palette.mode?a.palette.divider:a.palette.background.default},children:u?(0,l.jsxs)(S.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"10rem"},children:[(0,l.jsx)(er.A,{sx:{mb:2,fontSize:50,color:a.palette.divider}}),(0,l.jsx)(C.A,{variant:"caption",sx:{fontFamily:"Inconsolata,monospace"},children:s.t("No preview")})]}):"image"===m?(0,l.jsx)(S.A,{component:"img",src:d?n:null,onError:x,sx:{height:"100%",width:"100%",objectFit:"contain"}}):"audio"===m?(0,l.jsx)(S.A,{component:"audio",controls:!0,onError:x,sx:{width:"100%"},children:d?(0,l.jsx)("source",{src:n,type:y}):null}):(0,l.jsx)(S.A,{component:"video",controls:!0,onError:x,sx:{maxWidth:"100%",maxHeight:"50vh",borderRadius:1},children:d?(0,l.jsx)("source",{src:n,type:y}):null})})})}let ep=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",n=document.querySelector("".concat(t," > .confetti-container"));if(null!==n)return;(n=document.createElement("div")).classList.add("confetti-container"),null==(e=document.querySelector(t))||e.appendChild(n);let l=["red","orange","yellow","green","blue","violet"],i=()=>"".concat(Math.floor(Math.random()*window.innerWidth),"px"),r=()=>l[Math.floor(Math.random()*l.length)];n.innerHTML="";for(let e=0;e<200;e++)setTimeout(()=>{let e=document.createElement("div"),t=.5>Math.random()?"50%":0;e.classList.add("confetti"),e.style.left=i(),e.style.background=r(),e.style.borderRadius=t,n.appendChild(e),e.animate({top:"".concat(window.innerHeight,"px"),left:"".concat(Math.floor(Math.random()*window.innerWidth),"px")},Math.floor(500*Math.random()+1500))},10*e);window.setTimeout(()=>{var e;null==(e=n.parentNode)||e.removeChild(n)},4e3)},ex=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("string"!=typeof e)return[(0,l.jsx)("span",{children:e},0)];"string"!=typeof t&&(t="");let r=e.toLowerCase().indexOf(t.toLowerCase()),s=0,a=/((?:https?|file):\/\/[^\s]+)/gi;return e.split(a).map(e=>{let o=null,d=null,c=!!e.match(a);do{if(r<0)break;if(r>=s&&r<s+e.length){o=r-s,d=Math.min(e.length-o,t.length);break}if(r+t.length>=s&&r+t.length<s+e.length){o=0,d=t.length+r-s;break}}while(!1);s+=e.length;let u=null!==o?[e.substring(0,o),(0,l.jsx)("u",{children:e.substring(o,o+d)},o),e.substring(o+d)].filter(e=>""!==e).map((e,t)=>(0,l.jsx)("span",{children:e},t)):[(0,l.jsx)("span",{children:e},0)],p=null;return c&&i&&(p=(0,l.jsx)(eu,{fileUrl:e})),c?[(0,l.jsxs)("span",{children:[p,(0,l.jsxs)("span",{className:"anchor",onClick:t=>((e,t)=>{e.preventDefault(),e.stopPropagation();try{var l,i,r;let e=new URL(t);"file:"===e.protocol?null==(l=window.sdk)||l.ipc.device.showFileInFolder(e.pathname):(el()(t),"string"==typeof n&&n.length?null==(i=window.sdk)||i.ipc.target.openInNewWindow(n,t):null==(r=window.sdk)||r.ipc.device.openURL(t))}catch(e){}})(t,e),href:e,children:[(0,l.jsx)(ei.A,{sx:{width:"1rem",height:"1rem",lineHeight:"1rem",display:"inline-block",verticalAlign:"middle",mr:1}}),u]})]},0)]:u})};var eh=n(41316),em=n(13353),eg=n(3362),ef=n(95389),ey=n(60595),eA=n(50694),ej=n(63356),ev=n(23154);let ew=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{borderRadius:"5px",position:"absolute",width:"70px",height:"70px",background:t.palette.success.main,inset:0,clipPath:"polygon(0 0, 0 100%, 100% 0)",left:-6,top:-5}}),eb=e=>{let{scale:t=1,label:n=!1}=e,{i18n:i}=(0,g.B)();return(0,l.jsx)(L.A,{title:n?i.t("Installed"):null,children:(0,l.jsxs)(S.A,{sx:{position:"relative",mt:-1,transform:"scale(".concat(t,")"),transformOrigin:"0 50%"},children:[(0,l.jsx)(ej.A,{variant:n?"contained":"outlined",sx:{position:"relative",zIndex:2,textTransform:"uppercase",userSelect:"none",...n?{"& .MuiChip-label":{px:"6px"}}:{px:2}},icon:(0,l.jsx)(ev.A,{fontSize:n?"medium":"small"}),color:"success",size:"medium",label:n?"":i.t("Installed")}),n?(0,l.jsx)(ew,{}):null]})})},ek=(0,b.Ay)("img")(e=>{let{theme:t}=e;return{marginBottom:t.spacing(4),width:"96px",height:"96px",transition:"transform 100ms linear",position:"relative",zIndex:1}}),eS=(0,b.Ay)(C.A)(e=>{let{theme:t}=e;return{fontWeight:400,overflow:"hidden",fontSize:"0.75rem",lineHeight:"1rem",textOverflow:"ellipsis",textTransform:"none",marginBottom:t.spacing(.75),maxWidth:"96px",maxHeight:"3rem"}}),eC=e=>{var t,n;let{module:i=null,installedModuleId:r=null,flaggedModuleId:s=null,setModuleId:a=()=>{},selected:o=!1}=e,d=(0,k.A)(),c=(0,m.A)();return(0,l.jsx)(eh.Ay,{item:!0,children:(0,l.jsx)(I.A,{className:o||s!==(null==i?void 0:i.id)?null:"pop",color:"inherit",variant:"contained",onClick:()=>{null!==i&&a(i.id)},sx:{borderRadius:1,p:0,background:o?d.palette.background.selected:"transparent","&:hover":{background:o?d.palette.background.selected:"transparent"},height:"100%"},children:(0,l.jsx)(ey.A,{sx:{borderRadius:1,background:"transparent",boxShadow:"none",height:"100%"},children:(0,l.jsxs)(ef.A,{sx:{"&.MuiCardContent-root":{p:3},height:"100%",position:"relative",borderRadius:1,border:"1px solid ".concat(o?d.palette.primary.main:d.palette.divider),display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",width:"100%",position:"absolute",left:0,top:0,mt:1,px:1,zIndex:1e3,justifyContent:"space-between"},children:[(0,l.jsx)(S.A,{children:(null==i?void 0:i.id)===r?(0,l.jsx)(eb,{scale:.8,label:!0}):null}),null!==i&&((null==(t=c.user)?void 0:t.id)===(null==i?void 0:i.authorId)||"founder"===(null==(n=c.user)?void 0:n.userRole))?(0,l.jsx)(eA.A,{scale:.8,module:i}):null]}),(0,l.jsx)(S.A,{sx:{position:"relative","&:before":{content:'""',display:null!==i?"block":"none",width:"96px",height:"96px",position:"absolute",top:0,left:0,zIndex:1,background:d.palette.background.paper,borderRadius:2,opacity:1}},children:null!==i?(0,l.jsx)(ek,{src:null!==i.moduleLogoId?"".concat(eg.A.s3Url,"/modules/").concat(i.id,"/").concat(i.moduleLogoId,".png"):"/img/placeholder/module.png"}):(0,l.jsx)(S.A,{sx:{mb:2},children:(0,l.jsx)($.A,{rounded:!0,sx:{width:"96px",height:"96px"}})})}),null!==i?(0,l.jsx)(L.A,{title:i.moduleName,children:(0,l.jsx)(eS,{component:"span",children:i.moduleName})}):(0,l.jsx)($.A,{spacing:0,sx:{my:2,width:"96px",height:"1rem",display:"inline-block"}})]})})})})};var eI=n(5940),eT=n(84072),ez=n(25596);let eD=e=>{let{modulesLoaded:t,setDialogCreate:n=()=>{}}=e;return(0,l.jsx)(eh.Ay,{item:!0,children:(0,l.jsx)(ey.A,{sx:{boxShadow:"none"},children:(0,l.jsx)(ef.A,{sx:{"&.MuiCardContent-root":{p:3},display:"flex",minHeight:"180px",boxShadow:"none"},children:(0,l.jsx)(S.A,{sx:{width:"98px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(eI.A,{sx:{"&:hover":{transform:"scale(1.1)"}},size:"large",color:"primary",onClick:()=>n(!0),disabled:!t,children:t?(0,l.jsx)(ez.A,{}):(0,l.jsx)(eT.A,{})})})})})})},eP=e=>{let{agent:t,moduleId:n,setModuleId:i=()=>{},modulesLoaded:r,modules:s,setModules:a=()=>{}}=e,{i18n:d}=(0,g.B)(),c=(0,m.A)(),[u,p]=(0,f.useState)(!1),x=async(e,t)=>{if(c.user)try{var n;let l=await w.A.post("modules",{moduleName:e,moduleDescription:t});"string"==typeof(null==(n=l.data)?void 0:n.id)&&(a([...s,l.data]),i(l.data.id)),ep(),o.o.info(d.t("Next, install the module and edit its source code."),{duration:7500})}catch(e){}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.A,{sx:{overflowY:"auto",height:"calc(100vh - 110px)",p:4,mt:"5px"},children:(0,l.jsxs)(eh.Ay,{container:!0,spacing:3,children:[r?s.map(e=>(0,l.jsx)(eC,{installedModuleId:null==t?void 0:t.installedModuleId,selected:n===e.id,module:e,setModuleId:i},e.id)):[1,2,3].map(e=>(0,l.jsx)(eC,{},e)),(0,l.jsx)(eD,{modulesLoaded:r,setDialogCreate:p})]})}),u?(0,l.jsx)(em.A,{isOpen:!0,description:d.t("Create a new module with empty source code."),onCreate:x,onClose:()=>p(!1)}):null]})};var eR=n(39467),e_=n(71733),eE=n(1912),eM=n(52894),eN=n(32966),eL=n(29715);let eO=e=>{var t;let{agent:n,moduleId:i,flaggedModuleId:r,setModuleId:s=()=>{},modulesLoaded:a,modules:o,searchQuery:d,setSearchQuery:c=()=>{}}=e,{i18n:u}=(0,g.B)(),p=(0,m.A)(),x=(0,f.useRef)(null),h=(0,f.useRef)(null),y=(0,f.useCallback)(e=>{null!==x.current&&window.clearTimeout(x.current),x.current=window.setTimeout(()=>{c(e),x.current=null},450)},[]),A="founder"===(null==(t=p.user)?void 0:t.userRole)?"public:true":"";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",alignItems:"center",my:3,px:4},children:[(0,l.jsx)(eL.A,{fontSize:"small",color:"disabled",sx:{ml:1}}),(0,l.jsx)(eE.A,{inputRef:h,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},InputProps:{endAdornment:(0,l.jsx)(eR.A,{position:"end",children:(0,l.jsx)(S.A,{sx:{width:30,height:30},children:d!==A?(0,l.jsx)(L.A,{title:u.t("Clear search term"),placement:"left",children:(0,l.jsx)(e_.A,{sx:{width:30,height:30},onClick:()=>{c(""),null!==h.current&&(h.current.value=A)},children:(0,l.jsx)(eN.A,{fontSize:"small"})})}):null})})},defaultValue:d,placeholder:u.t("Search"),variant:"standard",onChange:e=>y(e.target.value.toLowerCase())})]}),(0,l.jsxs)(S.A,{sx:{overflowY:"auto",height:"calc(100vh - 172px)",px:4,py:2},children:[a&&!o.length?(0,l.jsx)(eM.A,{severity:"info",children:u.t("No modules matched your search criteria")}):null,(0,l.jsx)(eh.Ay,{container:!0,spacing:3,children:a?o.map(e=>(0,l.jsx)(eC,{flaggedModuleId:r,installedModuleId:null==n?void 0:n.installedModuleId,selected:i===e.id,module:e,setModuleId:s},e.id)):[1,2,3,4].map(e=>(0,l.jsx)(eC,{},e))})]})]})};var eU=n(22393),eB=n(67906),eF=n(80553),eW=n(44395),eH=n(38111),eq=n(7579),eY=n(79270),eG=n(42371),eK=n(93554),eV=n(2665),e$=n(23842),eJ=n(2452),eQ=n(39335),eX=n(32237),eZ=n(64879),e0=n(28099),e1=n(34591),e2=n(88992),e5=n(71090),e3=n(39091),e4=n(4728),e6=n(96571),e7=n(56792),e8=n(53608),e9=n(45559);let te=(0,b.Ay)("img")(()=>({width:200,height:200})),tt=e=>{let{uploadPath:t,getSrc:n,onChange:i=async()=>{},crop:r="fit",backgroundColor:s=null,borderColor:a=null,borderWidth:d=null,previewWidth:c=200,previewHeight:u=200,radius:p=5,alt:x="Logo",inputName:h="logo",label:m="Select logo",active:y=!1,width:A=256,height:j=256}=e;"function"!=typeof n&&(n=()=>"/img/logo/192.png");let v=(0,k.A)(),[b,I]=(0,f.useState)(n()),[T,z]=(0,f.useState)(!1),{i18n:D}=(0,g.B)(),P=null!==a&&null!==d?"solid":null,{getRootProps:R,getInputProps:_}=(0,e8.VB)({multiple:!1,accept:{"image/png":[".png"],"image/jpg":[".jpg",".jpeg"],"image/webp":[".webp"]},onDrop:e=>{let n=document.createElement("img");n.onload=function(){z(!0),setTimeout(()=>{let e=n.width,l=n.height,s=0,a=0;e>l?"fill"===r?(l=j,e*=j/n.height,s=parseInt((A-e)/2,10)):(e=A,l*=A/n.width,a=parseInt((j-l)/2,10)):"fill"===r?(e=A,l*=A/n.width,a=parseInt((j-l)/2,10)):(l=j,e*=j/n.height,s=parseInt((A-e)/2,10));let o=document.createElement("canvas");o.width=A,o.height=j,o.getContext("2d").drawImage(n,s,a,e,l),o.toBlob(e=>{let n=new FormData;n.append(h,e),(async()=>{try{let l=await w.A.post(t,n,{headers:{"Content-Type":"multipart/form-data"}});I(URL.createObjectURL(e)),"function"==typeof i&&await i(l.data,URL.createObjectURL(e)),z(!1)}catch(e){z(!1)}})()},"png"),o.remove(),n.remove()},Z.A.delay.request)},n.onerror=()=>{o.o.error(D.t("The selected file is not a valid image"),{duration:5e3,ariaProps:{role:"alert"}})},n.src=URL.createObjectURL(Object.assign(e[0]))},validator:()=>{}});return(0,l.jsx)(S.A,{children:T?(0,l.jsx)(S.A,{sx:{width:c,height:u,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,l.jsx)($.A,{count:1,spacing:0,rounded:!0,sx:{p:5,width:c,height:u}})}):y?(0,l.jsxs)(S.A,{...R({className:"dropzone"}),sx:{position:"relative",alignItems:"center",justifyContent:"center",display:"flex",flexDirection:"column"},children:[(0,l.jsx)("input",{..._()}),(0,l.jsx)(te,{src:b,alt:"logo",sx:{m:0,pointerEvents:"none",borderRadius:p,backgroundColor:s,borderStyle:P,borderWidth:d,borderColor:a,width:c,height:u}}),(0,l.jsxs)(S.A,{sx:{cursor:"pointer",position:"absolute",width:"70%",height:"70%",background:"dark"===v.palette.mode?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.6)",borderRadius:"50%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center","&:hover > p":{display:"none"},"&:hover > svg":{transform:"scale(2)"}},children:[(0,l.jsx)(e9.A,{}),(0,l.jsx)(C.A,{size:"large",color:"inherit",sx:{mt:2,textAlign:"center"},children:m})]})]}):(0,l.jsx)(S.A,{sx:{position:"relative",width:c,height:u,"&:before":{content:'""',display:"block",width:c,height:u,position:"absolute",top:0,left:0,zIndex:1,background:v.palette.background.paper,borderRadius:p}},children:(0,l.jsx)(te,{src:b,sx:{position:"relative",zIndex:1,width:c,height:u,borderRadius:p,backgroundColor:"transparent",borderWidth:d,borderColor:a},alt:x})})})},tn=e=>{let{moduleData:t,isOpen:n=!1,onOpen:i=()=>{},onClose:r=()=>{},propagateModule:s=()=>{}}=e,{i18n:a}=(0,g.B)(),o=(0,k.A)(),d=(0,m.A)(),[c,u]=(0,f.useState)(!1),p=(0,f.useRef)(null),x={name:e3.Yj().required(a.t("Module name is required")).min(3,()=>a.t("Must be at least {{n}} characters long",{n:3})).max(32,()=>a.t("Must be at most {{n}} characters long",{n:32})),h1:e3.Yj().max(48,()=>a.t("Must be at most {{n}} characters long",{n:48})),h2:e3.Yj().max(128,()=>a.t("Must be at most {{n}} characters long",{n:128})),vid:e3.Yj().max(24,()=>a.t("Must be at most {{n}} characters long",{n:24})),description:e3.Yj().max(4096,()=>a.t("Must be at most {{n}} characters long",{n:4096}))},{setValue:h,control:y,handleSubmit:A,formState:{errors:j},reset:v}=(0,e2.mN)({defaultValues:{name:"",h1:"",h2:"",vid:"",description:""},mode:"onChange",resolver:(0,e5.t)(e3.Ik().shape(x))});(0,f.useEffect)(()=>{n&&"function"==typeof i&&i()},[n]),(0,f.useEffect)(()=>{"string"==typeof(null==t?void 0:t.id)&&(h("name",t.moduleName),h("h1",t.moduleH1),h("h2",t.moduleH2),h("vid",t.moduleVid),h("description",t.moduleDescription))},[t]);let b=()=>{n&&"function"==typeof r&&r(),v()},C=async e=>{var n,l,i;let{name:a,h1:o,h2:c,vid:p,description:x}=e;if("string"==typeof(null==t?void 0:t.id)&&((null==(n=d.user)?void 0:n.id)===(null==t?void 0:t.authorId)||"founder"===(null==(l=d.user)?void 0:l.userRole))){u(!0);try{let e=await w.A.put("modules/".concat(t.id),{moduleName:a,moduleH1:o,moduleH2:c,moduleVid:p,moduleDescription:x});t.id===(null==(i=e.data)?void 0:i.id)&&s(e.data,["moduleName","moduleH1","moduleH2","moduleVid","moduleDescription"]),r()}catch(e){}u(!1)}},T=()=>{p.current&&p.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return n&&"string"==typeof(null==t?void 0:t.id)?(0,l.jsxs)(eY.A,{open:!0,fullWidth:!0,onClose:c?()=>{}:b,sx:{"& .MuiPaper-root":{maxWidth:c?"650px":"100%",p:2}},children:[c?null:(0,l.jsx)(eW.A,{children:a.t("Update module")}),(0,l.jsx)(eF.A,{children:c?(0,l.jsx)(S.A,{sx:{mt:3},children:(0,l.jsx)($.A,{})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("form",{onSubmit:A(C),ref:p,style:{width:"100%",flexGrow:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:(0,l.jsxs)(eh.Ay,{container:!0,sx:{mt:3},spacing:2,children:[(0,l.jsx)(eh.Ay,{item:!0,xs:3,children:(0,l.jsx)(S.A,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(tt,{active:!0,crop:"fill",previewWidth:180,previewHeight:180,borderWidth:0,borderColor:o.palette.background.paper,backgroundColor:o.palette.background.paper,inputName:"logo",uploadPath:"modules/".concat(t.id,"/logo"),label:a.t("Select logo"),onChange:e=>{s(e,["moduleLogoId"])},alt:a.t("Module logo"),getSrc:()=>"string"==typeof(null==t?void 0:t.moduleLogoId)?"".concat(eg.A.s3Url,"/modules/").concat(null==t?void 0:t.id,"/").concat(t.moduleLogoId,".png"):"/img/placeholder/module.png"})})}),(0,l.jsxs)(eh.Ay,{item:!0,xs:9,children:[(0,l.jsxs)(e6.A,{fullWidth:!0,sx:{mb:4},error:!!j.name,children:[(0,l.jsx)(e2.xI,{name:"name",control:y,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eE.A,{autoFocus:!0,required:!0,value:t,onChange:n,onKeyDown:e=>"Enter"===e.key&&T(),spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:32,tabIndex:1},InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:-2},children:(0,l.jsx)(M.A,{fontSize:"small"})})},label:a.t("Module name"),error:!!j.name})}}),j.name&&(0,l.jsx)(e4.A,{sx:{color:"error.main"},children:j.name.message})]}),(0,l.jsx)(L.A,{title:a.t("Paste YouTube video URL or video ID. The video ID is automatically extracted from video URL."),placement:"top",children:(0,l.jsxs)(e6.A,{fullWidth:!0,sx:{mb:4},error:!!j.moduleVid,children:[(0,l.jsx)(e2.xI,{name:"vid",control:y,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eE.A,{value:t,onChange:e=>((e,t)=>{var n;let l=e.target.value.match(/(?:youtube\.com\/(?:.*v=|.*\/embed\/|shorts\/)|youtu\.be\/)([\w\-]{11,})/i),i=l?l[1]:"".concat(null!=(n=e.target.value)?n:"").substring(0,24);t({...e,target:{...e.target,value:i}})})(e,n),onKeyDown:e=>"Enter"===e.key&&T(),spellCheck:!1,autoComplete:"off",InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:-2},children:(0,l.jsx)(eX.A,{})})},label:"YouTube video ID",error:!!j.vid})}}),j.vid&&(0,l.jsx)(e4.A,{sx:{color:"error.main"},children:j.vid.message})]})}),[{headingType:"h1",headingMaxLength:48},{headingType:"h2",headingMaxLength:128}].map(e=>{let{headingType:t,headingMaxLength:n}=e,i="h1"===t?eQ.A:e1.A,r="h1"===t?a.t("Pain point"):a.t("Solution"),s="h1"===t?a.t("Get more leads"):a.t("Automate your work so you get leads while you sleep"),o="h1"===t?a.t("Describe the pain point as an action."):a.t("Describe the solution in a sentence.");return(0,l.jsx)(S.A,{children:(0,l.jsx)(L.A,{title:o,placement:"top",children:(0,l.jsxs)(e6.A,{fullWidth:!0,sx:{mb:4},error:!!j[t],children:[(0,l.jsx)(e2.xI,{name:t,control:y,render:e=>{let{field:{value:a,onChange:o}}=e;return(0,l.jsx)(eE.A,{value:a,onChange:o,onKeyDown:e=>"Enter"===e.key&&T(),spellCheck:!1,autoComplete:"off",inputProps:{maxLength:n},InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:-2},children:(0,l.jsx)(i,{})})},placeholder:s,label:r,error:!!j[t]})}}),j[t]&&(0,l.jsx)(e4.A,{sx:{color:"error.main"},children:j[t].message})]})})},t)})]}),(0,l.jsx)(eh.Ay,{item:!0,xs:12,children:(0,l.jsxs)(e6.A,{fullWidth:!0,error:!!j.description,children:[(0,l.jsx)(e2.xI,{name:"description",control:y,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eE.A,{multiline:!0,minRows:5,maxRows:12,value:t,onChange:n,spellCheck:!1,autoComplete:"off",inputProps:{maxLength:4096,tabIndex:2},InputProps:{sx:{p:1,borderRadius:1}},label:a.t("Module description"),error:!!j.description})}}),j.description&&(0,l.jsx)(e4.A,{sx:{color:"error.main"},children:j.description.message})]})})]})})})}),c?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:b,children:a.t("Cancel")}),(0,l.jsx)(I.A,{variant:"contained",onClick:()=>{p.current&&p.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},startIcon:(0,l.jsx)(e7.A,{}),children:a.t("Update module")})]})]}):null},tl=e=>{var t,n,i;let{agent:r,onAgentUpdate:s=()=>{},privateModules:a=[],setPrivateModules:d=()=>{},publicModules:c=[],setPublicModules:u=()=>{},flaggedModuleId:p,moduleId:x,onClose:y=()=>{}}=e,{setSource:A,setSourceModified:j,setInstalled:v,moduleUpdate:b,setAgentTab:T,modulePurge:z,agentPurge:D,getFirstPlay:P}=(0,h.P)(),{i18n:R}=(0,g.B)(),_=(0,k.A)(),E=(0,m.A)(),[M,O]=(0,f.useState)(!1),[U,B]=(0,f.useState)(null),[F,W]=(0,f.useState)(null),[H,q]=(0,f.useState)(!1),[Y,G]=(0,f.useState)(!1),[K,V]=(0,f.useState)(!1),[J,Q]=(0,f.useState)(!1),X=()=>{W(null)},ee=async()=>{var e,t,n,l,i,a;O(!1);try{let i=!1,a=!1,d=await w.A.put("agents/".concat(r.id,"/modules/").concat(x));r.id===(null==(e=d.data)?void 0:e.id)&&s(d.data);let c=await w.A.get("agents/".concat(r.id,"/src"));if(!Array.isArray(null==(t=c.data)?void 0:t.srcStateMachine))throw Error(R.t("Invalid state machine definition"));await D(r.id),A(r.id,c.data,!0),i=Array.isArray(c.data[eU.ModuleSrc.K_SRC_INPUTS])&&c.data[eU.ModuleSrc.K_SRC_INPUTS].length>0,a=(null!=(l=c.data[eU.ModuleSrc.K_SRC_STATE_MACHINE])?l:[]).length>0,j(r.id,!1);let u=await w.A.get("modules/".concat(x));"string"==typeof(null==(n=u.data)?void 0:n.id)&&v(r.id,u.data,d.data.installedModuleSrcId),P(r.id)&&ep(),o.o.success(i?R.t("Let's configure this module!"):a?R.t("Let's run this module!"):R.t("Let's edit this empty module!"),{duration:5e3}),window.setTimeout(()=>{O(!0),y(),T(a&&i?"settings":"")},250)}catch(e){404===(null==(i=e.response)?void 0:i.status)&&z(x),o.o.error("".concat(R.t("Install error"),": ").concat(null!=(a=e.message)?a:e),{duration:5e3,ariaProps:{role:"alert"}})}},et=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(B(e),Array.isArray(t)&&t.length){let n=n=>{if((null==n?void 0:n.id)===x)for(let l of t)n[l]=e[l];return n};u(structuredClone(c).map(n)),d(structuredClone(a).map(n))}b(e)},en=async()=>{var e,t;if((null==(e=E.user)?void 0:e.id)===(null==U?void 0:U.authorId)||"founder"===(null==(t=E.user)?void 0:t.userRole)){O(!1),Q(!0);try{await w.A.delete("modules/".concat(x)),z(x)}catch(e){}u(structuredClone(c).filter(e=>(null==e?void 0:e.id)!==x)),d(structuredClone(a).filter(e=>(null==e?void 0:e.id)!==x)),O(!0),Q(!1),V(!1)}},el=async()=>{var e,t,n;if((null==(e=E.user)?void 0:e.id)===(null==U?void 0:U.authorId)||"founder"===(null==(t=E.user)?void 0:t.userRole)){O(!1),Q(!0);try{let e=await w.A.put("modules/".concat(x),{isPublic:!U.isPublic});x===(null==(n=e.data)?void 0:n.id)&&et(e.data,["isPublic","isPending","isApproved"])}catch(e){}O(!0),Q(!1),q(!1)}};(0,f.useEffect)(()=>{if(G(!1),null!==x){O(!1);let e=window.setTimeout(async()=>{var e,t;try{let t=await w.A.get("modules/".concat(x));B(x===(null==(e=t.data)?void 0:e.id)?t.data:null)}catch(e){B(null),404===(null==(t=e.response)?void 0:t.status)&&z(x)}O(!0)},Z.A.delay.request);return()=>window.clearTimeout(e)}B(null)},[x]);let ei=async e=>{var t;o.o.info(R.t("Navigating to video..."),null,!1),await (null==(t=window.sdk)?void 0:t.ipc.device.openURL("https://youtube.com/watch?v=".concat(e)))};return(0,l.jsxs)(S.A,{sx:{display:"flex",position:"relative",flexDirection:"column",alignItems:"center",width:"100%",height:"calc(100vh - 80px)"},children:[(0,l.jsxs)(S.A,{sx:{position:"absolute",top:0,right:-6,zIndex:11,width:"100%",display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(S.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:M&&null!==U?(null==r?void 0:r.installedModuleId)!==(null==U?void 0:U.id)?(0,l.jsx)(I.A,{"data-install":!0,variant:"contained",sx:{borderRadius:"1rem"},startIcon:(0,l.jsx)(N.A,{}),size:"small",onClick:ee,className:null===(null==r?void 0:r.installedModuleId)||p===U.id?"pop pop-rounded":null,children:R.t("Install module")}):(0,l.jsx)(eb,{}):null}),M&&((null==(t=E.user)?void 0:t.id)===(null==U?void 0:U.authorId)||"founder"===(null==(n=E.user)?void 0:n.userRole))?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.A,{sx:{mr:2,display:"flex",alignItems:"center"},children:[null!==U?(0,l.jsx)(eA.A,{module:U,propagateModule:et}):null,(0,l.jsx)(e_.A,{sx:{width:"40px",height:"40px",ml:2},onClick:e=>{W(e.currentTarget)},children:(0,l.jsx)(e$.A,{fontSize:"small"})})]}),(0,l.jsxs)(eG.A,{anchorOrigin:{vertical:"bottom",horizontal:"left"},anchorEl:F,open:!!F,onClose:X,children:[(0,l.jsx)(eH.A,{onClick:()=>{X(),G(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(S.A,{sx:{display:"flex"},children:[(0,l.jsx)(eV.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:R.t("Edit module")})]})}),(0,l.jsx)(eH.A,{onClick:()=>{X(),q(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(S.A,{sx:{display:"flex"},children:[U.isPublic?(0,l.jsx)(eJ.A,{fontSize:"small"}):(0,l.jsx)(eZ.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:U.isPublic?R.t("Unpublish module"):R.t("Publish module")})]})}),(0,l.jsx)(eq.A,{}),(0,l.jsx)(eH.A,{onClick:()=>{X(),V(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(S.A,{sx:{display:"flex"},children:[(0,l.jsx)(eK.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:R.t("Delete module")})]})})]})]}):null]}),(0,l.jsx)(S.A,{sx:{height:180,mt:10},children:M?(0,l.jsx)(tt,{crop:"fill",previewWidth:180,previewHeight:180,borderWidth:0,borderColor:_.palette.background.paper,backgroundColor:_.palette.background.paper,inputName:"logo",uploadPath:"modules/".concat(x,"/logo"),label:R.t("Select logo"),onChange:e=>{et(e,["moduleLogoId"])},alt:R.t("Module logo"),getSrc:()=>"string"==typeof(null==U?void 0:U.moduleLogoId)?"".concat(eg.A.s3Url,"/modules/").concat(x,"/").concat(U.moduleLogoId,".png"):"/img/placeholder/module.png"},null!=(i=null==U?void 0:U.moduleLogoId)?i:""):(0,l.jsx)($.A,{rounded:!0,sx:{width:"180px",height:"180px"}})}),M?(0,l.jsxs)(S.A,{sx:{my:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsx)(C.A,{variant:"h4",sx:{textAlign:"center"},children:null!==U?U.moduleName:R.t("Module not found")}),(0,l.jsxs)(S.A,{children:[(0,l.jsx)(L.A,{title:Array.isArray(null==U?void 0:U.moduleReleases)&&U.moduleReleases.length?R.t("Latest release"):null,placement:"top",children:(0,l.jsx)(ej.A,{size:"small",variant:Array.isArray(null==U?void 0:U.moduleReleases)&&U.moduleReleases.length?"filled":"outlined",sx:{flexGrow:0,userSelect:"none"},label:Array.isArray(null==U?void 0:U.moduleReleases)&&U.moduleReleases.length?"v".concat(U.moduleReleases[U.moduleReleases.length-1].srcVersion):R.t("No releases")})}),(null==U?void 0:U.moduleVid.length)?(0,l.jsx)(L.A,{title:R.t("Navigate to Youtube video in local web browser"),placement:"top",children:(0,l.jsx)(I.A,{sx:{ml:3},variant:"text",size:"small",onClick:()=>ei(U.moduleVid),startIcon:(0,l.jsx)(eX.A,{}),children:R.t("Watch video")})}):null]})]}):(0,l.jsx)(S.A,{sx:{display:"flex",justifyContent:"center"},children:(0,l.jsx)($.A,{spacing:0,sx:{width:"15rem",my:5,height:"0.75rem",display:"inline-block"}})}),M?(0,l.jsxs)(S.A,{sx:{width:"100%",overflowY:"auto"},children:[null===U||!U.isPublic||U.isPending||U.isApproved?null:(0,l.jsx)(eM.A,{severity:"error",sx:{mb:2},children:(0,l.jsx)(C.A,{variant:"caption",color:"inherit",children:"string"==typeof U.reason&&U.reason.length?"".concat(R.t("Module rejected"),": ").concat(U.reason):R.t("Module rejected")})}),[{headingType:"h1"},{headingType:"h2"}].map(e=>{let{headingType:t}=e,n="h1"===t?eQ.A:e1.A,i="h1"===t?"moduleH1":"moduleH2";return(0,l.jsx)(S.A,{children:(null==U?void 0:U[i].length)?(0,l.jsxs)(S.A,{sx:{whiteSpace:"pre-wrap",fontSize:"0.75rem",display:"flex",alignItems:"center",mb:2},children:[(0,l.jsx)(n,{color:"inherit",sx:{opacity:.5},fontSize:"small"}),(0,l.jsx)(C.A,{variant:"caption",sx:{ml:2},children:U[i]})]}):null},t)}),(null==U?void 0:U.moduleDescription.length)?(0,l.jsx)(C.A,{sx:{whiteSpace:"pre-wrap",fontSize:"0.75rem"},children:(0,l.jsx)(C.A,{variant:"caption",children:U.moduleDescription})}):(0,l.jsx)(eM.A,{severity:"warning",icon:(0,l.jsx)(e0.A,{}),sx:{fontSize:"0.75rem"},children:(0,l.jsx)(C.A,{variant:"caption",color:"inherit",children:R.t("No description provided")})})]}):(0,l.jsx)($.A,{sx:{mt:-2},count:3}),M&&Y?(0,l.jsx)(tn,{isOpen:!0,onClose:()=>G(!1),propagateModule:et,moduleData:U}):null,K?(0,l.jsxs)(eY.A,{open:!0,onClose:J?()=>{}:()=>V(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[J?null:(0,l.jsx)(eW.A,{children:R.t("Delete module")}),(0,l.jsx)(eF.A,{children:J?(0,l.jsx)($.A,{}):(0,l.jsx)(eM.A,{severity:"warning",children:R.t("Are you sure you want to delete this module?")})}),J?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>V(!1),children:R.t("Cancel")}),(0,l.jsx)(I.A,{color:"error",onClick:en,startIcon:(0,l.jsx)(eK.A,{}),children:R.t("Delete module")})]})]}):null,H?(0,l.jsxs)(eY.A,{open:!0,onClose:J?()=>{}:()=>q(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[J?null:(0,l.jsx)(eW.A,{children:(null==U?void 0:U.isPublic)?R.t("Unpublish module"):R.t("Publish module")}),(0,l.jsx)(eF.A,{children:J?(0,l.jsx)($.A,{}):U.isPublic||Array.isArray(null==U?void 0:U.moduleReleases)&&U.moduleReleases.length?(0,l.jsx)(eM.A,{severity:"warning",children:U.isPublic?R.t("Are you sure you want to unpublish this module? It will no longer be available for install in the module repository."):R.t("This action will make your module public. Once approved, it will be available to others in the module repository.")}):(0,l.jsx)(eM.A,{severity:"error",children:R.t("You cannot publish a module before creating a release.")})}),J?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>q(!1),children:Array.isArray(null==U?void 0:U.moduleReleases)&&U.moduleReleases.length?R.t("Cancel"):R.t("OK")}),U.isPublic||Array.isArray(null==U?void 0:U.moduleReleases)&&U.moduleReleases.length?(0,l.jsx)(I.A,{color:U.isPublic?"error":"primary",onClick:el,startIcon:U.isPublic?(0,l.jsx)(eJ.A,{fontSize:"small"}):(0,l.jsx)(eZ.A,{fontSize:"small"}),children:(null==U?void 0:U.isPublic)?R.t("Unpublish module"):R.t("Publish module")}):null]})]}):null]})},ti=e=>{let{agent:t,onClose:n=()=>{},onAgentUpdate:i=()=>{}}=e,{i18n:r}=(0,g.B)(),s=(0,k.A)(),a=(0,m.A)(),d=e=>{var t;return"".concat(null!=e?e:"").replace(/[^\w \-\:]+/gi," ").replace(/ {2,}/g," ").toLowerCase().trim().substring(0,128)||("founder"===(null==(t=a.user)?void 0:t.userRole)?"public:true":"")},[c,u]=(0,f.useState)(!1),[p,x]=(0,f.useState)(!1),[h,y]=(0,f.useState)(d("")),[A,j]=(0,f.useState)(null),[v,b]=(0,f.useState)([]),[C,I]=(0,f.useState)([]),[T,z]=(0,f.useState)(null),[D,P]=(0,f.useState)("");(0,f.useEffect)(()=>{var e;u(!1),z(null!=(e=null==t?void 0:t.installedModuleId)?e:null);let n=window.setTimeout(async()=>{var e,t;if("string"==typeof(null==(e=a.user)?void 0:e.id))try{let e=await w.A.get("modules",{params:{query:"author:".concat(a.user.id)}});Array.isArray(null==(t=e.data)?void 0:t.modules)&&b(e.data.modules)}catch(e){}u(!0)},2*Z.A.delay.request);return()=>{window.clearTimeout(n)}},[]),(0,f.useEffect)(()=>{x(!1);let e=window.setTimeout(async()=>{if(h.length>0&&h.length<3){o.o.error(r.t("Search term must be at least 3 characters long")),x(!0);return}try{var e,t,n;let l="string"==typeof h&&h.length?{query:h}:{},i=await w.A.get("modules",{params:l});Array.isArray(null==(e=i.data)?void 0:e.modules)&&I(i.data.modules),j(null!=(n=null==(t=i.data)?void 0:t.flaggedModuleId)?n:null)}catch(e){}x(!0)},Z.A.delay.request);return()=>{window.clearTimeout(e)}},[h]);let R={"":{label:"Repository",icon:(0,l.jsx)(et.A,{}),content:(0,l.jsx)(eO,{agent:t,moduleId:T,setModuleId:z,flaggedModuleId:A,modulesLoaded:p,modules:C,searchQuery:h,setSearchQuery:e=>y(d(e))})},dev:{label:"My modules",icon:(0,l.jsx)(ee.A,{}),content:(0,l.jsx)(eP,{agent:t,moduleId:T,setModuleId:z,modulesLoaded:c,modules:v,setModules:b})}};return(0,l.jsxs)(S.A,{sx:{display:"flex",height:"100%"},children:[(0,l.jsx)(S.A,{sx:{width:"100%",height:"100%",position:"relative"},children:(0,l.jsx)(X,{tabs:R,hash:D,setHash:P})}),T?(0,l.jsx)(S.A,{sx:{width:"375px",height:"100%",p:2,flexShrink:0,borderLeft:"1px solid ".concat(s.palette.divider)},children:(0,l.jsx)(tl,{agent:t,onClose:n,onAgentUpdate:i,publicModules:C,setPublicModules:I,privateModules:v,setPrivateModules:b,flaggedModuleId:A,moduleId:T})}):null]})},tr=e=>{var t;let{agents:n,onAgentUpdate:i=()=>{},onOpen:r=()=>{}}=e,{getAgentId:s,onAgentId:o,getDialogVisible:d,setDialogVisible:c,onDialogVisible:u,onMachineStatus:p,getMachineStatus:m}=(0,h.P)(),{i18n:y}=(0,g.B)(),[A,j]=(0,f.useState)((0,a.fD)(n,s())),[v,w]=(0,f.useState)("string"==typeof(null==A?void 0:A.installedModuleId)),[b,k]=(0,f.useState)(!1);(0,f.useEffect)(()=>{b&&"function"==typeof r&&r()},[b]);let C=()=>{c("repo",!1)};return(0,f.useEffect)(()=>{if(w("string"==typeof(null==A?void 0:A.installedModuleId)),"string"!=typeof(null==A?void 0:A.id))return;x.A.STATUS_STOPPED!==m(A.id).status&&C();let e=p(e=>{let{agentId:t,status:n}=e;A.id===t&&x.A.STATUS_STOPPED!==n&&C()});return()=>{e()}},[A]),(0,f.useEffect)(()=>{j((0,a.fD)(n,s()));let e=o(e=>j((0,a.fD)(n,e)));k(d("repo"));let t=u(e=>{let{dialog:t,visible:n}=e;return"repo"===t&&k(n)});return()=>{e(),t()}},[n]),(0,l.jsxs)(E.Ay,{open:b,onClose:C,anchor:"right",sx:{"&.MuiDrawer-root":{top:0,bottom:0,left:250},"& .MuiBackdrop-root":{position:"absolute"},"& .MuiDrawer-paper":{width:"100%"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute",boxShadow:"none"}},children:[(0,l.jsx)(F,{sx:{position:"relative",zIndex:1,background:"transparent",px:4},icon:(0,l.jsx)(M.A,{}),title:"".concat(y.t("Agent module")," - ").concat(null!=(t=null==A?void 0:A.name)?t:""),handleClose:C}),null!==(null==A?void 0:A.installedModuleId)||v?null:(0,l.jsxs)(S.A,{sx:{position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"hidden",zIndex:0},children:[(0,l.jsx)(H,{className:"zoom-in"}),(0,l.jsx)(H,{className:"zoom-in",sx:{animationDelay:"2s"}})]}),(0,l.jsx)(W,{sx:{position:"relative",zIndex:1,p:0},children:v?(0,l.jsx)(ti,{agent:A,onAgentUpdate:i,onClose:C}):(0,l.jsxs)(S.A,{sx:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",flexDirection:"column"},children:[(0,l.jsx)(M.A,{sx:{width:"192px",height:"192px",mt:6},className:"rotate"}),(0,l.jsx)(I.A,{sx:{mt:12},size:"large",autoFocus:!0,startIcon:(0,l.jsx)(N.A,{}),onClick:()=>w(!0),variant:"contained",className:"pop",children:y.t("Install module")})]})})]})};var ts=n(51553),ta=n(81289),to=n(21936),td=n(25175);let tc=(e,t)=>!!(null==e?void 0:e.installedModuleId)||Array.isArray(null==t?void 0:t.srcInputs)&&t.srcInputs.length>0||Array.isArray(null==t?void 0:t.srcOutputs)&&t.srcOutputs.length>0||Array.isArray(null==t?void 0:t.srcFunctions)&&t.srcFunctions.length>0||Array.isArray(null==t?void 0:t.srcStateMachine)&&t.srcStateMachine.length>0;function tu(e){let{agents:t,onSelect:n=()=>{},onUpdate:i=()=>{},onDelete:r=()=>{},showLoading:s=async()=>{}}=e,{i18n:o}=(0,g.B)(),{getAgentId:d,onAgentId:c,getLogsEnabled:u,onLogsEnabled:p,setLogsEnabled:m,getSource:y,onSource:A,onDialogVisible:j,getDialogVisible:v,setDialogVisible:w,onModuleUpdate:b,getInstalled:k,onMachineStatus:z,getMachineStatus:D}=(0,h.P)(),[P,R]=(0,f.useState)(x.A.STATUS_STOPPED),[_,E]=(0,f.useState)(!0),[N,O]=(0,f.useState)(null),[U,B]=(0,f.useState)(!1),[F,W]=(0,f.useState)(null),[H,q]=(0,f.useState)(!0),[Y,G]=(0,f.useState)(null),[K,$]=(0,f.useState)(!1);(0,f.useEffect)(()=>{$(u());let e=p(e=>$(e));if(null!==Y){var t;(async()=>{var e;let t=await y(d(),!0);B((null!=(e=null==t?void 0:t.srcStateMachine)?e:[]).length>0),E(tc(Y,t))})();let{module:e,moduleVersion:n}=k(Y.id);O((0,a.rG)(null!=(t=null==e?void 0:e.moduleName)?t:null,n))}let n=A(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==Y?void 0:Y.id)){var l;B((null!=(l=null==n?void 0:n.srcStateMachine)?l:[]).length>0),E(tc(Y,n))}}),l=b(e=>{var t;let{module:n}=e;if("string"!=typeof(null==Y?void 0:Y.installedModuleId)||(null==Y?void 0:Y.installedModuleId)!==(null==n?void 0:n.id))return;let{moduleVersion:l}=k(Y.id);O((0,a.rG)(null!=(t=n.moduleName)?t:null,l))});q(!v());let i=j(()=>{q(!v())});R(D(null==Y?void 0:Y.id).status);let r=z(e=>{let{agentId:t,status:n}=e;Y.id===t&&R(n)});return()=>{i(),l(),e(),n(),r()}},[Y]),(0,f.useEffect)(()=>{G((0,a.fD)(t,d()));let e=c(e=>G((0,a.fD)(t,e)));return()=>{e()}},[t]);let J=()=>{W(null)},Q=async()=>{if(null!==Y){var e;await (null==(e=window.sdk)?void 0:e.ipc.source.open(Y.id))&&await s()}J()},X=async e=>{e.preventDefault(),e.stopPropagation(),m(null==Y?void 0:Y.id,!K),J()};return null!==Y?(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(L.A,{title:o.t("Agent module"),placement:"left",children:(0,l.jsx)(S.A,{sx:{mr:2},children:(0,l.jsx)(I.A,{color:"inherit",size:"small",disabled:x.A.STATUS_STOPPED!==P,startIcon:(0,l.jsx)(M.A,{sx:{width:"24px",height:"24px"}}),sx:{textTransform:"none"},className:H&&!_?"pop pop-inset":null,"data-modules-toggle":!0,onClick:()=>{null!==Y&&(w("repo",!v("repo")),n(Y.id,!0)),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},children:(0,l.jsx)(C.A,{variant:"caption",sx:{color:"inherit",maxWidth:"150px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},children:null===N?_?o.t("No module installed"):o.t("Install module"):N})})})}),(0,l.jsxs)(e_.A,{sx:{width:"40px",height:"40px",mr:2,position:"relative"},onClick:e=>{W(e.currentTarget),null!==Y&&n(Y.id,!0)},children:[(0,l.jsx)(e$.A,{}),null===N||U||F?null:(0,l.jsx)(V.A,{sx:{position:"absolute",top:-1,right:-8},color:"warning"})]}),(0,l.jsxs)(eG.A,{anchorEl:F,open:!!F,onClose:J,children:[(0,l.jsx)(L.A,{title:o.t("Toggle the capturing of agent logs on this device"),placement:"left",children:(0,l.jsxs)(eH.A,{onClick:X,sx:{justifyContent:"space-between"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex"},children:[(0,l.jsx)(T.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:o.t("Agent logs")})]}),(0,l.jsx)(ts.A,{size:"small",sx:{ml:3},checked:K,defaultValue:K})]})}),(0,l.jsx)(L.A,{title:U?null:o.t("Add one state to make this agent playable"),placement:"left",children:(0,l.jsx)(S.A,{children:(0,l.jsxs)(eH.A,{disabled:x.A.STATUS_STOPPED!==P,onClick:Q,className:null===N||U?null:"pop pop-inset",sx:{"&.pop:after":{inset:"5px"}},children:[(0,l.jsx)(ta.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:o.t("Source code")})]})})}),(0,l.jsxs)(eH.A,{onClick:()=>{if(null!==Y){var e;null==(e=window.sdk)||e.ipc.target.openDevTools(Y.id,Y.name)}J()},children:[(0,l.jsx)(td.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:o.t("Developer Tools")})]}),(0,l.jsx)(eq.A,{}),(0,l.jsxs)(eH.A,{onClick:()=>{i(),J()},children:[(0,l.jsx)(to.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:o.t("Rename agent")})]}),(0,l.jsxs)(eH.A,{onClick:()=>{r(),J()},children:[(0,l.jsx)(eK.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:o.t("Delete agent")})]})]})]}):null}var tp=n(71608),tx=n(10217),th=n(26667),tm=n(76109),tg=n(72563),tf=n(80825),ty=n(88639),tA=n(19999);let tj=(0,b.Ay)(S.A)(e=>{var t,n;let{theme:l,color:i="primary",percent:r=0}=e;return{position:"absolute",top:"5px",left:"5px",borderRadius:"5px",width:"5px",height:"40px",background:l.palette.divider,"&:before":{content:'""',display:"block",position:"absolute",borderRadius:"5px",bottom:0,left:0,width:"100%",height:"".concat(r,"%"),minHeight:"5px",transformOrigin:"50% 100%",background:null!=(n=null==(t=l.palette[i])?void 0:t.main)?n:l.palette.primary.main,transition:"transform 200ms linear"}}}),tv=e=>{var t,n,i,r,s,a,o,d,c,u,p;let{type:x="chip"}=e,{onSubscription:y,getSubscription:A}=(0,h.P)(),[j,v]=(0,f.useState)({}),{i18n:w}=(0,g.B)(),b=(0,m.A)();(0,f.useEffect)(()=>{v(A());let e=y(e=>{let{info:t}=e;v(t)});return()=>{e()}},[]);let k=j.active&&"pilot"===j.status&&j.pilotTotal>0&&100*j.pilotLeft/j.pilotTotal<=33;if("chip"===x){let e=(null==(t=b.user)?void 0:t.computerEnabled)?j.active?"pilot"===j.status?k?w.t("Your free trial is almost over"):w.t("Free trial"):w.t("Active subscription"):null:w.t("Computer disabled");return j.ready?(0,l.jsx)(L.A,{title:e,placement:"right",children:(0,l.jsx)(ej.A,{size:"small",color:(null==(n=b.user)?void 0:n.computerEnabled)?j.active?"pilot"===j.status?k?"warning":"success":eg.A.billing.subscriptionStatus.pastDue===j.status?"warning":"default":"warning":"error",label:(null==(i=b.user)?void 0:i.computerEnabled)?j.active?"pilot"===j.status?w.t("Free trial"):null!=(s=null==(r=j.pricePlan)?void 0:r.productName)?s:"Zen":w.t("Locked"):w.t("Disabled"),variant:j.active&&!["pilot",eg.A.billing.subscriptionStatus.pastDue].includes(j.status)?"outlined":"filled",sx:{height:"1.2rem",fontSize:"0.75rem",fontFamily:"Yaldevi",textTransform:"none"}})}):null}if("progress"===x)return(null==(a=b.user)?void 0:a.computerEnabled)&&j.ready&&j.active&&"pilot"===j.status&&Number.isInteger(j.pilotTotal)&&j.pilotTotal>0?(0,l.jsx)(tj,{color:k?"warning":"success",percent:Math.round(100*j.pilotLeft/j.pilotTotal)}):null;if("label"===x){let e={[eg.A.billing.subscriptionStatus.active]:w.t("active"),[eg.A.billing.subscriptionStatus.cancelled]:w.t("cancelled"),[eg.A.billing.subscriptionStatus.onTrial]:w.t("on trial"),[eg.A.billing.subscriptionStatus.pastDue]:w.t("past due"),[eg.A.billing.subscriptionStatus.unpaid]:w.t("unpaid"),[eg.A.billing.subscriptionStatus.paused]:w.t("paused"),[eg.A.billing.subscriptionStatus.expired]:w.t("expired")};return(0,l.jsx)(L.A,{title:(null==(o=b.user)?void 0:o.computerEnabled)?j.active?"pilot"===j.status?w.t("Review pricing plans before your trial expires"):eg.A.billing.subscriptionStatus.pastDue===j.status?w.t("Click to fix billing issue"):null:w.t("Unlock by upgrading to a paid plan"):w.t("Click to enable this computer"),placement:"bottom",children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(null==(d=b.user)?void 0:d.computerEnabled)?j.active?"pilot"===j.status?(0,l.jsx)(tA.A,{fontSize:"small",color:k?"warning":"inherit"}):eg.A.billing.subscriptionStatus.pastDue===j.status?(0,l.jsx)(tf.A,{fontSize:"small",color:"warning"}):(0,l.jsx)(tg.A,{fontSize:"small"}):(0,l.jsx)(tm.A,{fontSize:"small",color:"warning"}):(0,l.jsx)(ty.A,{color:"error"}),(0,l.jsx)(C.A,{color:(null==(c=b.user)?void 0:c.computerEnabled)?j.active?"pilot"===j.status?"inherit":eg.A.billing.subscriptionStatus.pastDue===j.status?"warning.main":"inherit":"warning.main":"error.main",variant:"caption",sx:{ml:3},children:(null==(u=b.user)?void 0:u.computerEnabled)?j.active?"pilot"===j.status?w.t("Expires in: {{time}}",{time:["".concat(Math.floor(j.pilotLeft/3600),"h"),"".concat(Math.floor(j.pilotLeft%3600/60),"m")].join(", ")}):eg.A.billing.subscriptionStatus.pastDue===j.status?w.t("Pay overdue invoice"):"".concat(w.t("Manage billing")," (").concat(null!=(p=e[j.status])?p:j.status,")"):w.t("Purchase to unlock"):w.t("Computer disabled")})]})})}return null};var tw=n(36740),tb=n(50138),tk=n(35283),tS=n(47896),tC=n(72815),tI=n(72471),tT=n(20191),tz=n(27780),tD=n(216),tP=n(54544),tR=n(22653),t_=n(6995);let tE=(0,b.Ay)(S.A)(e=>{let{theme:t,size:n="small"}=e;return{background:t.palette.background.paper,justifyContent:"center",alignItems:"center",display:"flex",boxShadow:t.shadows[3],borderRadius:"small"===n?"0.4rem":"1rem",fontSize:"small"===n?"0.85rem":"3rem",marginRight:"small"===n?"0px":"2px",marginLeft:"small"===n?"1px":"2px",height:"small"===n?"2rem":"5rem",width:"small"===n?"1.1rem":"3rem"}});function tM(e){let{subInfo:t={},sx:n={},small:i=!1}=e,r=(0,k.A)(),s=(0,t_.A)(r.breakpoints.up("sm")),[a,o]=(0,f.useState)(null);("object"!=typeof n||null===n)&&(n={}),(0,f.useEffect)(()=>{let e=null;return Number.isInteger(t.pilotLeft)&&t.pilotLeft>0&&(o(t.pilotLeft),e=setInterval(()=>{o(e=>e-1)},1e3)),()=>null!==e&&clearInterval(e)},[t.pilotLeft]);let d=t.pilotLeft>0&&(t.planComputersCount>0&&t.computersCount>t.planComputersCount||t.planAgentsCount>0&&t.agentsCount>t.planAgentsCount),c=(s||!i?"00:00:00":"00:00").split("");return"number"==typeof a&&a>0&&(c=[Math.floor(a/3600),Math.floor(a%3600/60),...s||!i?[Math.floor(a%60)]:[]].map(e=>"".concat(e).padStart(2,"0")).join(":").split("")),t.active&&"pilot"===t.status||d?(0,l.jsx)(S.A,{sx:{display:"flex",justifyContent:"space-between",...n},children:c.map((e,t)=>(0,l.jsx)(tE,{size:i?"small":"large",children:e},t))}):null}let tN=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{position:"absolute",left:"-2rem",bottom:"-5rem",width:"25rem",height:"25rem",zIndex:1,opacity:.1,"&>svg":{position:"relative",width:"100%",height:"100%"}}}),tL=(0,b.Ay)("pre")(e=>{let{theme:t}=e;return{backgroundColor:t.palette.divider,padding:t.spacing(2),marginTop:0,marginBottom:0,color:t.palette.text.primary,marginRight:t.spacing(2),borderRadius:t.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}});function tO(e){var t,n,i,r,s,a;let{isOpen:d=!1,onClose:c=()=>{}}=e,{onSubscription:u,getSubscription:p}=(0,h.P)(),{i18n:x}=(0,g.B)(),y=(0,tw.A)(),A=(0,m.A)(),[j,w]=(0,f.useState)(null),[b,k]=(0,f.useState)({}),[T,z]=(0,f.useState)(!1);(0,f.useEffect)(()=>{k(p());let e=u(e=>{let{info:t}=e;k(t)});return(async()=>{var e;w(await (null==(e=window.sdk)?void 0:e.ipc.device.getSerialNumber()))})(),z(!0),()=>e()},[]);let D=()=>{d&&"function"==typeof c&&c()},P=async e=>{o.o.info(x.t("Copied computer serial number to clipboard"),null,!1),y.copy(e)},R=async()=>{var e,t,n;D(),o.o.info((null==(e=A.user)?void 0:e.computerEnabled)?x.t("Navigating to billing page..."):x.t("Navigating to my computers..."),null,!1),await (null==(n=window.sdk)?void 0:n.ipc.device.openURL((null==(t=A.user)?void 0:t.computerEnabled)?"".concat(eg.A.siteUrl,"/profile/#/tab:billing"):"".concat(eg.A.siteUrl,"/#/tab:computers")))},_=[{key:"computersCount",labelSingular:x.t("computer"),labelPlural:x.t("computers"),count:b.computersCount,max:v().max.computersCount,boostedCount:b.planComputersCount,boostedTooltip:x.t("You can use this extra computer until the trial ends"),Icon:tP.A},{key:"agentsCount",labelSingular:x.t("agent per computer"),labelPlural:x.t("agents per computer"),count:b.agentsCount,max:v().max.agentsCount,boostedCount:b.planAgentsCount,boostedTooltip:x.t("You can use this extra agent until the trial ends"),Icon:tC.A}],E=Math.max(v().max.computersCount,v().max.agentsCount),M=b.pilotLeft>0&&(b.planComputersCount>0&&b.computersCount>b.planComputersCount||b.planAgentsCount>0&&b.agentsCount>b.planAgentsCount),N=!(null==(t=A.user)?void 0:t.computerEnabled)||!b.active||eg.A.billing.subscriptionStatus.pastDue===b.status;return d&&T?(0,l.jsxs)(eY.A,{open:!0,onClose:D,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(tN,{className:"rotate",children:(null==(n=A.user)?void 0:n.computerEnabled)?b.active?"pilot"===b.status?(0,l.jsx)(tz.A,{color:"info"}):eg.A.billing.subscriptionStatus.pastDue===b.status?(0,l.jsx)(tS.A,{color:"warning"}):M?(0,l.jsx)(tk.A,{color:"success"}):(0,l.jsx)(tb.A,{color:"success"}):(0,l.jsx)(tR.A,{color:"warning"}):(0,l.jsx)(ty.A,{})}),(0,l.jsxs)(eW.A,{children:[(null==(i=A.user)?void 0:i.computerEnabled)?b.active?"pilot"===b.status?x.t("Free trial"):eg.A.billing.subscriptionStatus.pastDue===b.status?x.t("Invoice past due"):x.t("Active subscription"):x.t("Subscription required"):x.t("Computer disabled"),M?" (".concat(x.t("boosted"),")"):null]}),(0,l.jsx)(eF.A,{sx:{my:6,position:"relative",zIndex:2},children:(null==(r=A.user)?void 0:r.computerEnabled)?b.active?(0,l.jsxs)(S.A,{children:["pilot"!==b.status&&eg.A.billing.subscriptionStatus.pastDue===b.status?(0,l.jsx)(eM.A,{severity:"warning",sx:{mb:6},children:x.t("Invoice past due. Please fix this issue to avoid service interruption.")}):null,"pilot"===b.status||M?(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",userSelect:"none",mb:6},children:[(0,l.jsx)(tM,{subInfo:b,sx:{mb:6}}),(0,l.jsx)(C.A,{variant:"body2",children:x.t("Free trial limits expire soon")})]}):null,_.map(e=>(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[(0,l.jsx)(S.A,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",mr:6},children:[...Array(E).keys()].map(t=>{let n=M&&t>=e.boostedCount;return t<e.count?(0,l.jsx)(L.A,{placement:"top",title:n?e.boostedTooltip:null,children:(0,l.jsx)(e.Icon,{className:n?"zoom-in":null,color:n?"success":"inherit"})},t):(0,l.jsx)(tT.A,{sx:{opacity:+(t<e.max)}},t)})}),(0,l.jsx)(S.A,{sx:{minWidth:"10rem",textAlign:"right"},children:(0,l.jsxs)(C.A,{variant:"body2",color:"text.secondary",children:[(0,l.jsx)("b",{children:e.count})," ",1===e.count?e.labelSingular:e.labelPlural]})})]},e.key))]}):(0,l.jsx)(eM.A,{icon:(0,l.jsx)(tI.A,{}),severity:"warning",variant:"filled",children:x.t("To continue using the software, please upgrade to a paid plan.")}):(0,l.jsxs)(eM.A,{severity:"info",icon:(0,l.jsx)(ty.A,{}),sx:{"&>.MuiAlert-message":{width:"100%"}},children:[(0,l.jsx)(C.A,{variant:"body2",sx:{color:"inherit",width:"100%"},children:x.t("Please go to your dashboard and enable computer with serial number:")}),(0,l.jsxs)(S.A,{display:"flex",sx:{width:"100%",justifyContent:"center",alignItems:"center",my:3},children:[(0,l.jsx)(L.A,{title:x.t("The computer serial number is an anonymized unique hash that you can use to identify this computer in your online dashboard."),placement:"top",children:(0,l.jsx)(tL,{children:j})}),(0,l.jsx)(L.A,{title:x.t("Click to copy"),placement:"top",children:(0,l.jsx)(e_.A,{onClick:()=>P(j),children:(0,l.jsx)(tD.A,{fontSize:"small"})})})]})]})}),(0,l.jsxs)(eB.A,{sx:{position:"relative",zIndex:2},children:[(0,l.jsx)(I.A,{startIcon:(null==(s=A.user)?void 0:s.computerEnabled)?(0,l.jsx)(tg.A,{}):(0,l.jsx)(tP.A,{}),onClick:R,color:b.active?"primary":"warning",className:N?"pop":null,variant:"contained",children:(null==(a=A.user)?void 0:a.computerEnabled)?x.t("Go to billing"):x.t("Go to my computers")}),(0,l.jsx)(I.A,{color:"secondary",onClick:D,children:x.t("Close")})]})]}):null}var tU=n(28888),tB=n(38993),tF=n(29814);function tW(){let e=(0,tU._)(["\n0%   { transform: scale(0.2); opacity: 0; }\n100% { transform: scale(1); opacity: 1; }"]);return tW=function(){return e},e}let tH=(0,tB.i7)(tW()),tq=(0,b.Ay)(tF.A)(e=>{let{theme:t}=e;return{position:"absolute",right:"-10rem",bottom:"-10rem",width:"35rem",height:"35rem",zIndex:1,opacity:.1}}),tY=(0,b.Ay)("pre")(e=>{let{theme:t}=e;return{backgroundColor:t.palette.divider,padding:t.spacing(2),marginTop:0,marginBottom:0,marginRight:t.spacing(2),borderRadius:t.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}}),tG=(0,b.Ay)(eh.Ay)(e=>{let{theme:t,index:n=0}=e;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(tH," 750ms ease-in-out forwards"),animationDelay:"".concat(100*n,"ms")}}),tK=e=>{let{isOpen:t=!1,onOpen:n=()=>{},onClose:i=()=>{}}=e,{i18n:r}=(0,g.B)();(0,f.useEffect)(()=>{t&&"function"==typeof n&&n()},[t]);let s=()=>{t&&"function"==typeof i&&i()},a=[{key:"w",name:r.t("Web browser tab")},{key:"[1...9]",name:r.t("Select agent")},{key:"e",name:r.t("Settings tab")},{key:".",name:r.t("Start/Stop current agent")},{key:"r",name:r.t("Results tab")},{key:"u",name:r.t("Source Code")},{key:"i",name:r.t("Developer Tools")},{key:"m",name:r.t("Module panel")},{key:"l",name:r.t("Logs panel")},{key:"Esc",name:r.t("Close dialogs")}];return t?(0,l.jsxs)(eY.A,{open:!0,onClose:s,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(tq,{color:"action",className:"rotate"}),(0,l.jsx)(eW.A,{sx:{position:"relative",zIndex:2},children:r.t("Keyboard shortcuts")}),(0,l.jsx)(eF.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(eh.Ay,{container:!0,children:a.map((e,t)=>(0,l.jsx)(tG,{xs:6,item:!0,index:t,children:(0,l.jsxs)(S.A,{sx:{display:"flex",mb:2,alignItems:"center"},children:[(0,l.jsxs)(tY,{children:["Esc"!==e.key?"Ctrl+":"",1===e.key.length?e.key.toUpperCase():e.key]}),(0,l.jsx)(C.A,{variant:"body2",sx:{mx:2},children:e.name})]})},"".concat(t,"-").concat(e.key)))})}),(0,l.jsx)(eB.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(I.A,{color:"secondary",onClick:s,children:r.t("Close")})})]}):null};var tV=n(81041),t$=n(60999),tJ=n(95807),tQ=n(66766),tX=n(61293),tZ=n(79701),t0=n(95978),t1=n(46320),t2=n(20003),t5=n(75359);function t3(){let e=(0,tU._)(["\n0%   { transform: scale(0.2); opacity: 0; }\n100% { transform: scale(1); opacity: 1; }"]);return t3=function(){return e},e}function t4(){let e=(0,tU._)(["\n0%   { transform: scale(0.1) translateY(10rem); opacity: 0; }\n100% { transform: scale(1) translateY(0); opacity: 1; }"]);return t4=function(){return e},e}let t6=(0,tB.i7)(t3()),t7=(0,tB.i7)(t4()),t8=(0,b.Ay)(t1.A)(e=>{let{theme:t}=e;return{position:"absolute",right:"-10rem",bottom:"-10rem",width:"35rem",height:"35rem",zIndex:1,opacity:.1}}),t9=(0,b.Ay)("pre")(e=>{let{theme:t}=e;return{backgroundColor:t.palette.divider,padding:t.spacing(2),marginTop:0,marginBottom:0,marginRight:t.spacing(2),borderRadius:t.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}}),ne=(0,b.Ay)(I.A)(e=>{let{theme:t,index:n=0}=e;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(t7," 750ms ease-in-out forwards"),animationDelay:"".concat(100*n,"ms")}}),nt=(0,b.Ay)(tV.Ay)(e=>{let{theme:t,index:n=0}=e;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(t6," 750ms ease-in-out forwards"),animationDelay:"".concat(100*n,"ms")}}),nn=e=>{var t,n,i,r,s;let{isOpen:a=!1,onOpen:d=()=>{},onClose:c=()=>{}}=e,{i18n:u}=(0,g.B)(),p=(0,tw.A)(),[x,h]=(0,f.useState)({});(0,f.useEffect)(()=>{a&&"function"==typeof d&&d()},[a]),(0,f.useEffect)(()=>{let e=setTimeout(async()=>{var e,t;let n=eg.A.version,l=await (null==(e=window.sdk)?void 0:e.ipc.main.getProcessVersions()),i=await (null==(t=window.sdk)?void 0:t.ipc.device.getSerialNumber());h({...l,app:n,serialNumber:i})},150);return()=>clearTimeout(e)},[]);let m=()=>{a&&"function"==typeof c&&c()},y=async()=>{var e;o.o.info(u.t("Navigating to licenses..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.device.openURL("https://github.com/oglama/oglama/blob/main/NOTICE.md"))},A=async()=>{var e;o.o.info(u.t("Navigating to status page..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.device.openURL("https://status.oglama.com/"))},j=async()=>{var e;o.o.info(u.t("Navigating to Terms of Service..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.device.openURL("".concat(eg.A.siteUrl,"/terms-of-service/")))},v=async()=>{var e;o.o.info(u.t("Navigating to my computers..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.device.openURL("".concat(eg.A.siteUrl,"/#/tab:computers")))},w=[{icon:(0,l.jsx)(tP.A,{color:"inherit",fontSize:"large"}),key:"serialNumber",name:u.t("Serial Number"),version:null!=(t=x.serialNumber)?t:null,tooltip:u.t("The computer serial number is an anonymized unique hash that you can use to identify this computer in your online dashboard.")},{icon:(0,l.jsx)(tZ.A,{color:"warning",fontSize:"large"}),key:"chrome",name:"Chromium",version:null!=(n=x.chrome)?n:null},{icon:(0,l.jsx)(tQ.A,{color:"primary",fontSize:"large"}),key:"electron",name:"Electron.js",version:null!=(i=x.electron)?i:null},{icon:(0,l.jsx)(t2.A,{color:"success",fontSize:"large"}),key:"node",name:"Node.js",version:null!=(r=x.node)?r:null},{icon:(0,l.jsx)(t5.A,{size:35,animate:!0}),key:"oglama",name:"Oglama",version:null!=(s=x.app)?s:null}];return a?(0,l.jsxs)(eY.A,{open:!0,onClose:m,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(t8,{color:"action",className:"rotate"}),(0,l.jsx)(eW.A,{sx:{position:"relative",zIndex:2},children:u.t("About Oglama")}),(0,l.jsx)(eF.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(t$.A,{children:w.map((e,t)=>{var n;return(0,l.jsxs)(nt,{index:t,children:[e.icon,(0,l.jsx)(C.A,{variant:"body2",sx:{mx:2},children:e.name}),e.version?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L.A,{title:null!=(n=e.tooltip)?n:null,placement:"top",children:(0,l.jsx)(t9,{children:e.version})}),(0,l.jsx)(L.A,{title:u.t("Click to copy"),placement:"top",children:(0,l.jsx)(e_.A,{onClick:()=>((e,t,n)=>{o.o.info("serialNumber"===e?u.t("Copied computer serial number to clipboard"):u.t("Copied {{name}} version to clipboard",{name:t}),null,!1),p.copy("serialNumber"===e?n:"".concat(t," v").concat(n))})(e.key,e.name,e.version),children:(0,l.jsx)(tD.A,{fontSize:"small"})})}),"serialNumber"===e.key?(0,l.jsx)(L.A,{title:u.t("Go to my computers"),placement:"top",children:(0,l.jsx)(e_.A,{onClick:()=>v(),children:(0,l.jsx)(ei.A,{fontSize:"small"})})}):null]}):(0,l.jsx)($.A,{sx:{width:"15rem",mt:2},spacing:0})]},"".concat(t,"-").concat(e.key))})})}),(0,l.jsxs)(eB.A,{sx:{position:"relative",zIndex:2},children:[(0,l.jsx)(ne,{index:5,onClick:y,startIcon:(0,l.jsx)(t0.A,{}),children:u.t("Licenses")}),(0,l.jsx)(ne,{index:6,onClick:A,startIcon:(0,l.jsx)(tJ.A,{}),children:u.t("Contact & Status")}),(0,l.jsx)(ne,{index:7,onClick:j,startIcon:(0,l.jsx)(tX.A,{}),children:u.t("Terms")}),(0,l.jsx)(I.A,{color:"secondary",onClick:m,children:u.t("Close")})]})]}):null},nl=(0,b.Ay)(eG.A)(e=>{let{theme:t}=e;return{"& .MuiMenu-paper":{width:280,overflow:"hidden",marginTop:t.spacing(4),[t.breakpoints.down("sm")]:{width:"100%"}},"& .MuiMenu-list":{padding:0}}}),ni=()=>{let{checkSubscription:e}=(0,h.P)(),{i18n:t}=(0,g.B)(),n=(0,m.A)(),[i,r]=(0,f.useState)(!1),[s,a]=(0,f.useState)(!1),[o,d]=(0,f.useState)(!1),[c,u]=(0,f.useState)(null),[p,x]=(0,f.useState)(0),y=async t=>{var l;null==(l=window.sdk)||l.ipc.main.setOnTop(),u(t.currentTarget);let i=Math.floor(new Date().getTime()/1e3);i-p>=5&&(x(i),e(n,!0))},A=()=>u(null),j=async()=>{A(),r(!0)},v=async()=>{var e;A(),await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),d(!0)},w=async()=>{var e;A(),await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),a(!0)};return n.user?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(I.A,{onClick:y,fullWidth:!0,sx:{userSelect:"none",transition:"none",borderRadius:0,justifyContent:"space-between",alignItems:"center",height:"100%",position:"relative"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 25px)"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[(0,l.jsx)(t5.A,{size:24,sx:{mx:1,transition:"all 200ms linear"}}),(0,l.jsx)(C.A,{variant:"body2",component:"div",sx:{textTransform:"none",mx:2},children:Z.A.appName})]}),(0,l.jsx)(tv,{type:"chip"})]}),(0,l.jsx)(tv,{type:"progress"}),(0,l.jsx)(P,{sx:{flexShrink:0},open:!!c,children:(0,l.jsx)(th.A,{color:"action"})})]}),(0,l.jsxs)(nl,{sx:{mt:-2,width:"250px"},anchorEl:c,"aria-disabled":"true",open:!!c,onClose:()=>A(),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[(0,l.jsx)(eH.A,{onClick:()=>j(),children:(0,l.jsx)(tv,{type:"label"})}),(0,l.jsx)(eH.A,{onClick:()=>w(),children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(0,l.jsx)(tx.A,{fontSize:"small"}),(0,l.jsx)(C.A,{variant:"caption",sx:{ml:3},children:t.t("Keyboard shortcuts")})]})}),(0,l.jsx)(eH.A,{onClick:()=>v(),children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(0,l.jsx)(tp.A,{fontSize:"small"}),(0,l.jsx)(C.A,{variant:"caption",sx:{ml:3},children:t.t("About")})]})})]}),i?(0,l.jsx)(tO,{isOpen:!0,onClose:()=>r(!1)}):null,s?(0,l.jsx)(tK,{isOpen:!0,onClose:()=>a(!1)}):null,o?(0,l.jsx)(nn,{isOpen:!0,onClose:()=>d(!1)}):null]}):null};var nr=n(63684),ns=n(16954),na=n(56090),no=n(95578),nd=n(42304),nc=n(28196),nu=n(43539),np=n(23078);function nx(e){let{agent:t,title:n=null,iconSx:i={},nameSx:r={}}=e,{i18n:s}=(0,g.B)(),a="string"==typeof(null==t?void 0:t.name)?"".concat(s.t("Agent")," ").concat(null==t?void 0:t.name):s.t("Agent");return(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",fontSize:"inherit",fontFamily:"Inter, sans-serif"},children:[(0,l.jsx)(L.A,{title:a,children:(0,l.jsx)(S.A,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",userSelect:"none"},children:(0,l.jsx)(np.A,{sx:{mr:2,...i}})})}),null!=n?n:null]})}let nh=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{month:"long",day:"numeric",year:"numeric"};return e?new Intl.DateTimeFormat(t,n).format(new Date(e)):e},nm=e=>nh(e,"en-GB",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit",second:"numeric",hour12:!1}),ng=e=>{let t=document.createElement("div");t.textContent=e;let n=t.innerHTML;return t.remove(),n},nf=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l="";if(Array.isArray(e)){let r=0;for(let s of e){var i;if(!n&&r>=v().max.logsOnRender)break;let e=s.s;["info","success","warning","error"].includes(e)||(e="info");let a="number"==typeof s.t?nh(1e3*s.t,"en-US",{day:"numeric",month:"short",hour:"numeric",minute:"numeric",second:"numeric"}):"today",o=ng(null!=(i=s.m)?i:"");if("string"==typeof t&&t.length){let e=ng(t),n=o.toLowerCase().indexOf(e);-1!==n&&(o=o.substring(0,n)+"<u>".concat(o.substring(n,n+e.length),"</u>")+o.substring(n+e.length))}l+='<p><i class="'.concat(e,'"></i><span>').concat(o,"</span><b>").concat(a,"</b></p>"),r++}}return l};function ny(e){let{agent:t,filterText:n,filterStatuses:i}=e,{i18n:r}=(0,g.B)(),{onLog:s,getLogs:a}=(0,h.P)(),[o,d]=(0,f.useState)(a(null==t?void 0:t.id)),[c,u]=(0,f.useState)(!1);(0,f.useEffect)(()=>{d(a(null==t?void 0:t.id));let e=s(e=>d(e));return()=>e()},[null==t?void 0:t.id]),(0,f.useEffect)(()=>{u(!1)},[o]);let p=[{slug:"info",label:r.t("Information")},{slug:"success",label:r.t("Success")},{slug:"warning",label:r.t("Warning")},{slug:"error",label:r.t("Error")}],x=Array.isArray(o)&&o.length?o.filter(e=>{let t=!0;return i.length!==p.length&&(t=i.includes(e.s)),t&&n.length&&(t="".concat(e.m).toLowerCase().includes(n)),t}):[],m=x.length<=v().max.logsOnRender||c?x.length:v().max.logsOnRender;return(0,l.jsx)(l.Fragment,{children:x.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.A,{sx:{overflowY:"auto",mr:"1px"},children:(0,l.jsx)(S.A,{className:"log-box",dangerouslySetInnerHTML:{__html:nf(x,n,c)}})}),(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"end",height:"25px",pr:5,alignItems:"center",flexShrink:0},children:[!c&&Array.isArray(o)&&o.length>v().max.logsOnRender?(0,l.jsx)(S.A,{sx:{display:"flex",flexGrow:1,justifyContent:"center"},children:(0,l.jsx)(I.A,{size:"small",onClick:()=>u(!0),sx:{width:"100%",height:"25px",borderRadius:0},children:r.t("Load all")})}):null,(0,l.jsxs)(S.A,{sx:{display:"flex",flexGrow:0,flexShrink:0,ml:2},children:[(0,l.jsxs)(C.A,{variant:"caption",children:[m," ",1===m?r.t("message"):r.t("messages")]}),(0,l.jsx)(C.A,{variant:"caption",sx:{ml:1},children:"(".concat(Array.isArray(o)?o.length:0," ").concat(r.t("total"),")")})]})]})]}):(0,l.jsx)(eM.A,{variant:"standard",severity:"info",sx:{mx:2,mt:1},children:(0,l.jsx)(C.A,{variant:"caption",color:"inherit",children:p.length!==i.length||n.length?r.t("No messages matched your search criteria"):r.t("No messages were recorded for this agent")})})})}function nA(){let e=(0,tU._)(["\n0%   { transform: translateY(100vh); }\n100% { transform: translateY(0); }"]);return nA=function(){return e},e}let nj=(0,tB.i7)(nA()),nv=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{width:"2px",height:"20px",position:"relative",borderLeft:"1px solid ".concat((0,s.A)(t)),marginLeft:t.spacing(2),marginRight:t.spacing(2)}});function nw(e){let{agents:t}=e,{i18n:n}=(0,g.B)(),{getAgentActive:i,onAgentActive:r,getAgentId:o,onAgentId:d,getLogsEnabled:c,onLogsEnabled:u,getNavVisible:p,onNavVisible:x,getLogsVisible:m,onLogsVisible:y,setLogsVisible:A,clearLogs:j}=(0,h.P)(),v=(0,k.A)(),w=(0,f.useRef)(null),b=(0,f.useRef)(null),C=[{slug:"info",label:n.t("Information")},{slug:"success",label:n.t("Success")},{slug:"warning",label:n.t("Warning")},{slug:"error",label:n.t("Error")}],[T,z]=(0,f.useState)(null),[D,P]=(0,f.useState)(!1),[R,_]=(0,f.useState)(!1),[E,M]=(0,f.useState)(!1),[N,U]=(0,f.useState)(!1),[B,F]=(0,f.useState)(!1),[W,H]=(0,f.useState)([]),[q,Y]=(0,f.useState)(""),[G,K]=(0,f.useState)(!1),[V,$]=(0,f.useState)(!1);(0,f.useEffect)(()=>{H(()=>C.map(e=>e.slug)),P(i(o()));let e=r(e=>{let{agentId:t,active:n}=e;t===o()&&P(n)});_(c());let t=u(e=>_(e));M(m());let n=y(e=>M(e));F(p());let l=x(e=>F(e));return()=>{e(),t(),n(),l()}},[T]),(0,f.useEffect)(()=>{z((0,a.fD)(t,o()));let e=d(e=>z((0,a.fD)(t,e)));return()=>e()},[t]);let J="1px solid ".concat((0,s.A)(v));return T&&R&&E?(0,l.jsxs)(S.A,{sx:{boxShadow:D?"0px -1px 0px 0px #38b7d7":null,borderTop:J,zIndex:20,position:"fixed",display:"flex",flexDirection:"column",left:"250px",bottom:"50px",width:"calc(100vw - 250px)",height:G?B?"calc(100vh - 149px)":"calc(100vh - 99px)":"calc(50vh - 49px)",overflow:"hidden",opacity:V?.2:1,"&:hover":{opacity:V?.8:1},background:v.palette.background.default,transition:"opacity 100ms linear",animation:"".concat(nj," 200ms ease-in-out forwards")},children:[(0,l.jsxs)(S.A,{sx:{height:"50px",p:2,alignItems:"center",display:"flex"},children:[(0,l.jsx)(L.A,{title:n.t("Clear agent logs"),placement:"right",children:(0,l.jsx)(e_.A,{onClick:()=>U(!0),sx:{width:"2rem",height:"2rem"},children:(0,l.jsx)(eK.A,{fontSize:"small"})})}),(0,l.jsx)(nv,{}),(0,l.jsx)(nd.A,{fontSize:"small",sx:{mx:2},color:"action"}),(0,l.jsx)(eE.A,{inputRef:w,variant:"standard",placeholder:n.t("Filter"),onChange:e=>{var t;return t=e.target.value.toLowerCase(),void(null!==b.current&&window.clearTimeout(b.current),b.current=window.setTimeout(()=>{Y(t),b.current=null},450))},sx:{width:"100%","& input":{px:"0 !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},InputProps:{endAdornment:q?(0,l.jsx)(eR.A,{position:"end",children:(0,l.jsx)(S.A,{sx:{width:30,height:30},children:(0,l.jsx)(L.A,{title:n.t("Clear filter"),placement:"left",children:(0,l.jsx)(e_.A,{size:"small",sx:{width:30,height:30},onClick:()=>{Y(""),null!==w.current&&(w.current.value="")},children:(0,l.jsx)(eN.A,{fontSize:"small"})})})})}):null}}),(0,l.jsx)(S.A,{sx:{display:"flex",ml:2},children:C.map(e=>(0,l.jsx)(L.A,{title:"".concat(n.t("Toggle log level"),": ").concat(e.label),placement:"left",children:(0,l.jsx)(e_.A,{sx:{width:"2rem",height:"2rem",mr:1},onClick:()=>{var t;let n;return t=e.slug,n=[...W],void(W.includes(t)?n=n.filter(e=>e!==t):n.push(t),H(n))},children:W.includes(e.slug)?(0,l.jsx)(nr.A,{color:e.slug,fontSize:"small"}):(0,l.jsx)(no.A,{color:e.slug,fontSize:"small"})})},e.slug))}),(0,l.jsx)(nv,{}),(0,l.jsx)(L.A,{title:n.t("Toggle translucence"),placement:"left",children:(0,l.jsx)(e_.A,{onClick:()=>$(!V),sx:{width:"2rem",height:"2rem",mr:1},children:V?(0,l.jsx)(nu.A,{fontSize:"small"}):(0,l.jsx)(nc.A,{fontSize:"small"})})}),(0,l.jsx)(L.A,{title:G?n.t("Restore"):n.t("Maximize"),placement:"left",children:(0,l.jsx)(e_.A,{onClick:()=>K(!G),sx:{width:"2rem",height:"2rem",mr:1},children:G?(0,l.jsx)(na.A,{fontSize:"small"}):(0,l.jsx)(ns.A,{fontSize:"small"})})}),(0,l.jsx)(L.A,{title:n.t("Close agent logs"),placement:"left",children:(0,l.jsx)(e_.A,{onClick:()=>{A(!1),Y(""),H(C.map(e=>e.slug))},sx:{width:"2rem",height:"2rem",mr:1},children:(0,l.jsx)(O.A,{fontSize:"small"})})})]}),(0,l.jsx)(ny,{agent:T,filterText:q,filterStatuses:W}),null!==T&&N?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>U(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eW.A,{children:(0,l.jsx)(nx,{agent:T,title:n.t("Clear agent logs")})}),(0,l.jsx)(eF.A,{children:(0,l.jsx)(eM.A,{severity:"warning",children:n.t("Are you sure you want to delete all messages for this agent?")})}),(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>U(!1),children:n.t("Cancel")}),(0,l.jsx)(I.A,{color:"error",onClick:()=>{j(null==T?void 0:T.id),U(!1)},startIcon:(0,l.jsx)(eK.A,{}),children:n.t("Clear agent logs")})]})]}):null]}):null}var nb=n(66911),nk=n(57429);let nS=(0,b.Ay)(q.A)(e=>{let{theme:t}=e;return{[t.breakpoints.down("md")]:{minWidth:100},[t.breakpoints.down("sm")]:{minWidth:67},height:"50px",minHeight:"50px"}}),nC=(0,b.Ay)("span")(e=>{let{theme:t}=e;return{fontSize:"0.8rem",lineHeight:"0.8rem",textTransform:"none",marginLeft:t.spacing(2.4),[t.breakpoints.down("md")]:{display:"none"}}});function nI(e){var t;let{agents:n}=e,{i18n:i}=(0,g.B)(),{getAgentActive:r,onAgentActive:s,getAgentId:o,onAgentId:d,onAgentTab:c,getAgentTab:u,setAgentTab:p,getInputs:x,onInputs:m,getSource:y,onSource:A,onNavVisible:j,getNavVisible:v,setNavVisible:w}=(0,h.P)(),[b,k]=(0,f.useState)({inputs:!1,outputs:!1}),[C,I]=(0,f.useState)(!1),[T,z]=(0,f.useState)(!1),[D,R]=(0,f.useState)(!1),[_,E]=(0,f.useState)([]),[M,N]=(0,f.useState)({}),[L,O]=(0,f.useState)(null),[U,B]=(0,f.useState)(""),F={"":{label:"Browser",icon:(0,l.jsx)(tZ.A,{className:D?"rotate-360":null})},settings:{label:"Settings",icon:(0,l.jsx)(nb.A,{}),visible:T,hasPop:!(0,a.qH)(_,M)},results:{label:"Results",icon:(0,l.jsx)(nk.A,{}),visible:b.outputs}};return(0,f.useEffect)(()=>{null!==L&&(async()=>{var e,t;let n=await y(o(),!0);k((0,a.pv)(n)),E(null!=(e=null==n?void 0:n.srcInputs)?e:[]),N(await x(L.id)),z((null!=(t=null==n?void 0:n.srcStateMachine)?t:[]).length>0)})();let e=A(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==L?void 0:L.id)){var l,i;k((0,a.pv)(n)),E(null!=(l=null==n?void 0:n.srcInputs)?l:[]),z((null!=(i=null==n?void 0:n.srcStateMachine)?i:[]).length>0)}});R(r(o()));let t=s(e=>{let{agentId:t,active:n}=e;t===o()&&R(n)});B(u());let n=c(e=>B(e));I(v());let l=j(e=>I(e)),i=m(e=>{let{agentId:t,inputs:n,inputSessionId:l}=e;(null==L?void 0:L.id)===t&&null===l&&N(n)});return()=>{e(),n(),l(),t(),i()}},[L]),(0,f.useEffect)(()=>{O((0,a.fD)(n,o()));let e=d(e=>O((0,a.fD)(n,e)));return()=>e()},[n]),(0,f.useEffect)(()=>{T&&("results"!==u()||b.outputs)||p("")},[T,b.outputs]),L?(0,l.jsx)(Y.Ay,{value:(null==(t=F[U])?void 0:t.visible)?U:"",children:(0,l.jsx)(K.A,{sx:{"& .MuiTabs-indicator":{borderRadius:"5px",marginBottom:"4px",height:"4px"}},onChange:(e,t)=>p(t),children:Object.keys(F).filter(e=>void 0===F[e].visible||F[e].visible).map((e,t)=>(0,l.jsx)(nS,{"data-tab":""===e?"browser":e,"data-tab-selected":U===e?"true":"false",icon:F[e].icon,iconPosition:"start",onClick:()=>{""===e&&""===u()&&w(!C),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},value:e,sx:{px:4},label:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",pr:2},children:[(0,l.jsx)(nC,{children:i.t(F[e].label)}),""===e?(0,l.jsx)(S.A,{sx:{ml:3,mr:-3},children:(0,l.jsx)(P,{open:C,children:(0,l.jsx)(th.A,{size:"small"})})}):null,F[e].hasPop?(0,l.jsx)(V.A,{sx:{position:"absolute",top:"0.25rem",right:0},color:"warning"}):null]})},t))})}):null}var nT=n(16291),nz=n(39e3);function nD(e){let{agentsCount:t=0,agentsReady:n=!1}=e,{checkSubscription:i,getDialogVisible:r,setDialogVisible:a,onDialogVisible:o}=(0,h.P)(),[d,c]=(0,f.useState)(!1),[u,p]=(0,f.useState)(!1),[x,y]=(0,f.useState)(!1),{i18n:A}=(0,g.B)(),j=(0,k.A)(),v=(0,m.A)();(0,f.useEffect)(()=>{n&&!t&&(0,nT.A)("reveal"),p(r("agentCreate"));let e=o(e=>{let{dialog:t,visible:n}=e;"agentCreate"===t&&p(n)});return()=>{e()}},[n,t]);let w=async()=>{var e;y(!0);let t=await i(v,!0);y(!1),(null==(e=v.user)?void 0:e.computerEnabled)&&t.active?a("agentCreate",!0):c(!0)};return n?0===t?(0,l.jsxs)(S.A,{sx:{position:"absolute",zIndex:100,top:0,left:0,width:"100%",height:"calc(100% - 50px)",overflow:"hidden",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",background:j.palette.background.default,boxShadow:"0px 1px 0px 0px ".concat((0,s.A)(j))},children:[(0,l.jsx)(H,{className:"zoom-in"}),(0,l.jsx)(H,{className:"zoom-in",sx:{animationDelay:"2s"}}),(0,l.jsxs)(S.A,{sx:{mt:14,p:5,position:"relative",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,l.jsx)(t5.A,{size:192,animate:!0,sx:{mb:6},className:"rotate"}),(0,l.jsx)(I.A,{size:"large",variant:"contained",className:u||d?null:"pop",fullWidth:!0,disabled:x,sx:{fontSize:"0.75rem",opacity:0,animation:"fadeIn 1s linear forwards",animationDelay:"1.5s"},startIcon:(0,l.jsx)(nz.A,{color:"inherit",fontSize:"large"}),onClick:w,children:A.t("Let's begin!")})]}),d?(0,l.jsx)(tO,{isOpen:!0,onClose:()=>c(!1)}):null]}):null:(0,l.jsx)(S.A,{sx:{position:"absolute",zIndex:100,top:0,left:0,display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",background:j.palette.background.default},children:(0,l.jsx)(t5.A,{size:192,animate:!0,grey:!0,className:"rotate"})})}var nP=n(90441),nR=n(25668),n_=n(73509),nE=n(80094),nM=n(31262),nN=n(2255),nL=n(27395),nO=n(12785),nU=n(87664),nB=n(86092),nF=n(61823),nW=n(78787),nH=n(85803);function nq(e){let{agents:t}=e,{getAgentId:n,onAgentId:i,onTickCounter:r,getTickCounters:s,getHourglass:a,onHourglass:o}=(0,h.P)(),d=(0,f.useRef)(null),c=(0,k.A)(),[u,p]=(0,f.useState)(null),[x,m]=(0,f.useState)({}),[g,y]=(0,f.useState)(!1),[A,j]=(0,f.useState)(0);(0,f.useEffect)(()=>{p(n());let e=i(e=>p(e));return()=>e()},[t]);let v=e=>{"object"==typeof e&&null!==e&&(y(e.active),j(e.active?e.total+Math.floor(new Date().getTime()/1e3)-e.start:e.total),e.active&&(d.current=window.setTimeout(()=>{v(a(n())),d.current=null},1e3)))};return(0,f.useEffect)(()=>{null!==d.current&&(window.clearTimeout(d.current),d.current=null),m(s(n()));let e=r(e=>m(e));v(a(n()));let t=o(e=>{let{agentId:t,hourglass:l}=e;t===n()&&v(l)});return()=>{e(),t()}},[u]),null!==u&&"object"==typeof x&&null!==x?(0,l.jsxs)(S.A,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"end",px:2,height:"100%"},children:[(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center"},children:Object.keys(x).slice(0,5).map(e=>{let t=!1,n=nU.A;switch(e){case"post":n=nP.A;break;case"view":n=nL.A;break;case"like":n=nO.A;break;case"repost":n=nW.A;break;case"comment":n=nR.A;break;case"upload":n=nF.A;break;case"download":n=N.A;break;case"screenshot":n=nE.A;break;case"collect":n=nH.A;break;case"success":n=ev.A;break;case"warning":n=nB.A;break;case"contact":n=nM.A;break;default:t=!0}return(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",mx:2},children:[(0,l.jsx)(L.A,{title:e,placement:"left",children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(n,{fontSize:"small",color:"action",sx:{mr:2}}),t?(0,l.jsx)(C.A,{color:"inherit",sx:{color:c.palette.text.disabled,mr:2,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:50,lineHeight:"1rem",fontSize:"0.75rem"},children:e}):null]})}),(0,l.jsx)(L.A,{title:x[e],placement:"left",children:(0,l.jsx)(C.A,{color:"disabled",sx:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:40,fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace"},children:x[e]})})]},e)})}),(0,l.jsx)(L.A,{title:"Running time",placement:"left",children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[g?(0,l.jsx)(nN.A,{fontSize:"small",color:"primary"}):(0,l.jsx)(n_.A,{fontSize:"small",color:"action"}),(0,l.jsx)(C.A,{sx:{mx:2,textAlign:"right",fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace",color:g?c.palette.primary.main:c.palette.text.disabled},children:(e=>{let t=Math.floor(e/3600),n=Math.floor(e%3600/60),l=String(t).padStart(2,"0"),i=String(n).padStart(2,"0"),r=String(e%60).padStart(2,"0");return"".concat(l,":").concat(i,":").concat(r)})(A)})]})})]}):null}var nY=n(15591),nG=n(23820),nK=n(81376),nV=n(99594),n$=n(84824),nJ=n(15751),nQ=n(9282),nX=n(20302);let nZ=e=>{let{agent:t,isOpen:n=!1,onOpen:i=()=>{},onClose:r=()=>{},status:s=-1}=e,{i18n:a}=(0,g.B)(),{getAgentBanner:o}=(0,h.P)(),[d,c]=(0,f.useState)(!1);(0,f.useEffect)(()=>{n&&"function"==typeof i&&i()},[n]);let u=()=>{n&&"function"==typeof r&&r()},p=o(null==t?void 0:t.id);return n&&null!==p?(0,l.jsxs)(eY.A,{open:!0,onClose:u,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eW.A,{children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(nx,{agent:t,title:x.A.STATUS_PAUSED===s?a.t("Agent paused"):a.t("Agent stopped")}),(0,l.jsx)(e_.A,{"aria-label":a.t("More information"),sx:{ml:2},color:"default",onClick:()=>c(!d),size:"large",children:d?(0,l.jsx)(nQ.A,{}):(0,l.jsx)(tp.A,{})})]})}),(0,l.jsxs)(eF.A,{children:[d?(0,l.jsx)(eM.A,{icon:(0,l.jsx)(nX.A,{}),sx:{mb:6},children:(0,l.jsxs)(C.A,{color:"inherit",variant:"body2",children:[a.t("Modules are not allowed to intercept or store any of your cookies, passwords, or other sensitive data.")," ",a.t("As a result, you will need to manually log into any websites that require authentication."),(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),a.t("All of your data is securely and exclusively stored on this computer.")]})}):null,(0,l.jsx)(eM.A,{severity:"info",icon:(0,l.jsx)(nJ.A,{}),children:p.message||(p.url?a.t("Please log in before continuing."):a.t("Your attention is required."))})]}),(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:u,children:a.t("OK")}),p.url?(0,l.jsx)(I.A,{className:"pop",onClick:()=>(e=>{var n;null==(n=window.sdk)||n.ipc.target.openInNewWindow(null==t?void 0:t.id,e),u()})(p.url),variant:"contained",children:a.t("Open window")}):null]})]}):null};var n0=n(99833),n1=n(50966);let n2=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{position:"relative",aspectRatio:"16/9",backgroundSize:"cover",backgroundRepeat:"no-repea",backgroundPosition:"50% 50%",backgroundColor:t.palette.background.paper}}),n5="/img/placeholder/agent.webp";function n3(e){let{agent:t,agentHasBanner:n,status:i,index:r,selected:s,refSessionType:a}=e,{i18n:o}=(0,g.B)(),d=(0,k.A)(),[c,u]=(0,f.useState)(n5),[p,h]=(0,f.useState)(!1),m=(0,f.useRef)(null),y=(0,f.useRef)(null),A=(0,f.useRef)(!0),j=(0,f.useRef)(null),v=async e=>{let{imgData:t,imgSize:n}=e;return new Promise(e=>{if(!Number.isInteger(null==n?void 0:n.width)||!Number.isInteger(null==n?void 0:n.height)||(null===m.current&&(m.current=document.createElement("canvas"),m.current.width=n.width,m.current.height=n.height),j.current===t))return void e(null);j.current=t;let l=new ImageData(j.current,n.width,n.height);m.current.getContext("2d").putImageData(l,0,0),m.current.toBlob(t=>{let n=new Image,l=URL.createObjectURL(t);n.onload=()=>{u(e=>("string"==typeof e&&e!==n5&&URL.revokeObjectURL(e),l)),e(l)},n.src=l},"image/png")})};return(0,f.useEffect)(()=>{if("string"!=typeof(null==t?void 0:t.id)||s)return;let e=null,n=async()=>{e=setTimeout(n,p?250:x.A.STATUS_STARTED===i?2e3:4e3);try{var l;await v(await (null==(l=window.sdk)?void 0:l.ipc.target.getPreview(t.id)))}catch(e){u(n5)}},l=A.current?3e3+100*r:Math.floor(1e3-performance.now()%1e3+100*r);return A.current||y.current===d.palette.mode||(y.current=d.palette.mode,l=10*r),e=setTimeout(n,p?100:l),A.current=!1,()=>null!==e&&clearTimeout(e)},[null==t?void 0:t.id,s,p,i,r,d.palette.mode]),(0,l.jsxs)(S.A,{sx:{display:"flex",mx:1,height:"100%",minWidth:"30px",position:"relative",flexShrink:0},children:[(0,l.jsx)(S.A,{sx:{width:s?"30px":"63px",transition:"width 200ms linear",position:"relative",zIndex:0,ml:-2,overflow:"hidden",borderRadius:"3px",boxShadow:s?null:d.shadows["light"===d.palette.mode?3:2]},children:s?null:(0,l.jsx)(L.A,{slotProps:{arrow:{sx:{color:d.palette.divider}},tooltip:{sx:{p:1,background:d.palette.divider,ml:2}}},onOpen:()=>h(!0),onClose:()=>h(!1),title:(0,l.jsx)(n2,{sx:{width:"225px"},style:{backgroundImage:"url(".concat(c,")")}}),children:(0,l.jsx)(n2,{sx:{height:"101%"},style:{backgroundImage:"url(".concat(c,")")}})})}),(0,l.jsx)(S.A,{sx:{position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",right:0,bottom:0,height:"100%",width:"35px",zIndex:s||x.A.STATUS_STOPPED!==i?1:-1,opacity:s||x.A.STATUS_STOPPED!==i?1:0,transformOrigin:x.A.STATUS_STOPPED===i?"100% 50%":"110% 100%",transition:"transform 200ms linear, opacity 200ms linear",transform:s?"scale(1)":"scale(0.5)"},children:x.A.STATUS_STOPPED===i?(0,l.jsx)(np.A,{color:n?"warning":"action"}):null===a.current?(0,l.jsx)(L.A,{title:o.t("Manual run"),placement:"bottom",children:(0,l.jsx)(n0.A,{color:x.A.STATUS_PAUSED===i||n?"warning":"primary"})}):"cron"===a.current?(0,l.jsx)(L.A,{title:o.t("Recurring run"),placement:"bottom",children:(0,l.jsx)(nW.A,{color:x.A.STATUS_PAUSED===i||n?"warning":"primary"})}):(0,l.jsx)(L.A,{title:o.t("Scheduled run"),placement:"bottom",children:(0,l.jsx)(n1.A,{color:x.A.STATUS_PAUSED===i||n?"warning":"primary"})})})]})}function n4(e){let{agent:t,status:n,selected:i}=e,{onAgentBanner:r,getAgentBanner:s}=(0,h.P)(),[a,o]=(0,f.useState)(null!==s(null==t?void 0:t.id)),{i18n:d}=(0,g.B)();return(0,f.useEffect)(()=>{o(null!==s(null==t?void 0:t.id));let e=r(e=>{let{agentId:n,banner:l}=e;(null==t?void 0:t.id)===n&&o(null!==l)});return()=>{e()}},[null==t?void 0:t.id]),(0,l.jsx)(S.A,{sx:{display:"flex",position:"relative",zIndex:2,alignItems:"center",width:i?"calc( 100% - 45px )":"calc( 100% - 70px )",height:"100%",p:0,ml:1},children:(0,l.jsx)(L.A,{title:a?null:null==t?void 0:t.name,enterDelay:500,enterNextDelay:500,componentsProps:{tooltip:{sx:{maxWidth:"200px"}}},children:(0,l.jsx)(C.A,{sx:{mt:1,fontSize:"0.75rem",fontFamily:"Yaldevi",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"calc( 100% - 25px )",color:a||x.A.STATUS_PAUSED===n?"warning.main":"text.main"},variant:"caption",children:a?x.A.STATUS_PAUSED===n?d.t("Unpause when ready"):d.t("Start when ready"):null==t?void 0:t.name})})})}function n6(e){var t,n,i,r,s;let{agent:d,index:c=0,onSelect:u=async()=>{}}=e,{i18n:p}=(0,g.B)(),y=(0,k.A)(),A=(0,m.A)(),{onAgentId:j,getAgentId:v,getAgentBanner:b,onAgentBanner:C,setAgentTab:T,onSource:z,getSource:D,setSource:P,setSourceModified:R,onInputs:_,getInputs:E,getMachine:M,onMachineStatus:N,onMachineBusy:O,onSubscription:U,getSubscription:B,onDialogVisible:F,getDialogVisible:W,onFirstPlay:H,getFirstPlay:q,setFirstPlay:Y,getInstalled:G,setInstalled:K,modulePurge:V,log:$}=(0,h.P)(),[J,Q]=(0,f.useState)(x.A.STATUS_STOPPED),[X,Z]=(0,f.useState)(0),[ee,et]=(0,f.useState)(null),[en,el]=(0,f.useState)(!1),[ei,er]=(0,f.useState)(!1),[es,ea]=(0,f.useState)(!1),[eo,ed]=(0,f.useState)(!1),[ec,eu]=(0,f.useState)(!0),[ep,ex]=(0,f.useState)(!1),[eh,em]=(0,f.useState)([]),[eg,ef]=(0,f.useState)({}),[ey,eA]=(0,f.useState)(!1),[ej,ev]=(0,f.useState)(null),ew=(0,f.useRef)(x.A.STATUS_STOPPED),eb=(0,f.useRef)([]),ek=(0,f.useRef)(null),eS=()=>{ea(!0),setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()},250)},eC=async function(e){var t,n,l;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(i!==(null==d?void 0:d.installedModuleId))return;let s="c"==="".concat(null!=e?e:"")[0]?"cron":"schedule",a=await (null==(t=window.sdk)?void 0:t.ipc.session.read(d.id,e)),c=(null==a?void 0:a.sessionName)||"";if((null==d?void 0:d.id)===v()&&W("repo")){let e="".concat("cron"===s?p.t("Skipped recurring session {{sessionName}}",{sessionName:c}):p.t("Skipped scheduled session {{sessionName}}",{sessionName:c})," (").concat(p.t("module repository is open"),")");o.o.error("".concat(d.name,": ").concat(e),{duration:5e3}),$(d.id,e,"error");return}try{let t=null==(n=await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.runInit(d.id,i,e,r)))?void 0:n.runId;$(d.id,"cron"===s?p.t("Started recurring session {{sessionName}}",{sessionName:c}):p.t("Started scheduled session {{sessionName}}",{sessionName:c}),"success"),M(d).start(i,t)}catch(e){}},eI=async()=>{if(x.A.STATUS_STOPPED!==ew.current)return;let{module:e,moduleSrcId:t}=G(d.id);if((null==e?void 0:e.id)!==d.installedModuleId||t!==d.installedModuleSrcId){let e=null,t=null;if("string"==typeof d.installedModuleId){var n,l,i,r;try{let r=await w.A.get("modules/".concat(d.installedModuleId));if("string"!=typeof(null==(n=r.data)?void 0:n.id))return;e=r.data,t=d.installedModuleSrcId;let s=await w.A.get("agents/".concat(d.id,"/src"));Array.isArray(null==(l=s.data)?void 0:l.srcStateMachine)&&(P(d.id,s.data,!0),R(d.id,!1)),null==(i=window.sdk)||i.ipc.source.close(d.id),K(d.id,e,t);let c=(0,a.DV)(e,t);if("string"==typeof c){let e=p.t("Module updated to version {{version}}",{version:c});o.o.info("".concat(d.name,": ").concat(e),{duration:5e3}),$(d.id,e,"info")}}catch(e){404===(null==(r=e.response)?void 0:r.status)&&V(d.installedModuleId)}}}};(0,f.useEffect)(()=>{et(v());let e=j(e=>{et(e),null!==b(null==d?void 0:d.id)&&(null==d?void 0:d.id)===e&&eS()}),t=C(e=>{let{agentId:t,banner:n}=e;null!==n&&v()===t&&(null==d?void 0:d.id)===t&&eS()});eu(!W("repo"));let n=F(e=>{let{dialog:t,visible:n}=e;"repo"===t&&eu(!n)}),l=setInterval(()=>{let e=Math.floor(new Date().getTime()/1e3);0==e%60&&ev(e)},1e3);return()=>{eb.current=[],n(),clearInterval(l),e(),t()}},[]),(0,f.useEffect)(()=>{var e;if("string"!=typeof(null==d?void 0:d.id))return;(async()=>{var e,t,n,l;await eI();let i=await D(d.id);if(null===i)try{let e=await w.A.get("agents/".concat(d.id,"/src"));Array.isArray(null==(t=e.data)?void 0:t.srcStateMachine)&&(i=e.data,P(d.id,e.data))}catch(e){}em(null!=(n=null==i?void 0:i.srcInputs)?n:[]),ef(await E(d.id)),ex((null!=(l=null==i?void 0:i.srcStateMachine)?l:[]).length>0),await (null==(e=window.sdk)?void 0:e.ipc.target.add(d.id,"about:home",d.id===v()))})();let t=O(e=>{let{agentId:t,busy:n}=e;d.id===t&&eA(n)}),n=N(e=>{let{agentId:t,status:n,sessionType:l}=e;d.id===t&&(ew.current=n,ek.current=x.A.STATUS_STOPPED===n?null:l,Q(n))}),l=z(e=>{let{agentId:t,sourceCode:n}=e;if(d.id===t){var l,i;em(null!=(l=null==n?void 0:n.srcInputs)?l:[]),ex((null!=(i=null==n?void 0:n.srcStateMachine)?i:[]).length>0)}}),i=_(e=>{let{agentId:t,inputs:n,inputSessionId:l}=e;(null==d?void 0:d.id)===t&&null===l&&ef(n)});el(q(d.id));let r=H(e=>{let{agentId:t,firstPlay:n}=e;d.id===t&&el(n)}),s=B();er(!!s.active),Z(null!=(e=s.agentsCount)?e:0);let a=U(e=>{var t;let{info:n}=e;er(!!n.active),Z(null!=(t=n.agentsCount)?t:0)}),o=()=>{$(d.id,p.t("No internet connection"),"warning"),M(d).stop()};return window.addEventListener("offline",o),()=>{var e,s;t(),n(),l(),i(),r(),a(),window.removeEventListener("offline",o,!1),M(d).shutDown(),null==(e=window.sdk)||e.ipc.target.remove(d.id),null==(s=window.sdk)||s.ipc.source.close(d.id)}},[null==d?void 0:d.id]),(0,f.useEffect)(()=>{var e;(null==(e=A.user)?void 0:e.computerEnabled)&&ei&&!(c>X-1)||M(d).stop()},[ei,X,null==(t=A.user)?void 0:t.computerEnabled]),(0,f.useEffect)(()=>{if(x.A.STATUS_STOPPED===J&&eb.current.length){let{sessionId:e,moduleId:t,time:n}=eb.current.shift();eC(e,t,n)}},[J]),(0,f.useEffect)(()=>{window.setTimeout(async()=>{do{var e;if(!Number.isInteger(ej)||"string"!=typeof(null==d?void 0:d.id))break;let t=await (null==(e=window.sdk)?void 0:e.ipc.session.getAt(d.id,ej));if("object"!=typeof t||null===t)break;let{sessionId:n,moduleId:l,sessionType:i}=t;if("string"!=typeof n)break;if("string"!=typeof l&&null!==l&&(l=null),x.A.STATUS_STOPPED===ew.current){await eC(n,l,ej);break}"schedule"===i&&(eb.current.push({moduleId:l,sessionId:n,time:ej}),"schedule"!==ek.current&&M(d).stop())}while(!1)},250*c)},[ej]);let eT=async e=>{e.stopPropagation(),await u(null==d?void 0:d.id),null!==b(null==d?void 0:d.id)&&eS(),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},ez=async e=>{var t,n,l,i;if((e.stopPropagation(),"string"==typeof(null==d?void 0:d.id)&&!eo)&&ei&&!(c>X-1)){en||Y(d.id,!0),"string"!=typeof ee&&await u(d.id);try{ed(!0),setTimeout(()=>ed(!1),2500),x.A.STATUS_STARTED===J?M(d).stop():(ee===(null==d?void 0:d.id)&&(null==(t=window.sdk)||t.ipc.main.setOnTop()),M(d).start(null!=(n=d.installedModuleId)?n:null))}catch(e){await (null==(l=window.sdk)?void 0:l.ipc.main.setOnTop()),o.o.error("".concat(p.t("Agent toggle error"),": ").concat(null!=(i=e.message)?i:e),{duration:5e3,ariaProps:{role:"alert"}})}window.setTimeout(()=>{var e;en||T(""),null==(e=window.sdk)||e.ipc.main.focus()},350)}},eD=null;switch(J){case x.A.STATUS_STOPPED:eD=ey?p.t("Working"):p.t("Start");break;case x.A.STATUS_PAUSED:eD=es?null:p.t("Unpause");break;case x.A.STATUS_STARTED:eD=p.t("Stop")}let eP=(0,a.qH)(eh,eg),eR=!(null==(n=A.user)?void 0:n.computerEnabled)||!ei||c>X-1,eE=null!==b(null==d?void 0:d.id),eM=eR||eo||x.A.STATUS_STOPPED===J&&ey;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.A,{sx:{width:"100%",ml:"-1px",height:"50px",position:"relative"},children:[(0,l.jsxs)(I.A,{"data-agent":"".concat(null!=(r=null==d?void 0:d.id)?r:""),"data-agent-selected":ee===(null==d?void 0:d.id)?"true":"false",variant:"text",sx:{"&.MuiButton-root":{background:ee===(null==d?void 0:d.id)?y.palette.background.selected:null},borderRadius:0,width:"100%",transition:"none",height:"50px",position:"relative",zIndex:2,justifyContent:"start"},onClick:eT,children:[(0,l.jsx)(n3,{index:c,agent:d,status:J,selected:ee===(null==d?void 0:d.id),agentHasBanner:eE,refSessionType:ek}),(0,l.jsx)(n4,{agent:d,status:J,selected:ee===(null==d?void 0:d.id)}),(0,l.jsx)(S.A,{sx:{position:"absolute",top:"5px",left:"3px",borderRadius:"5px",width:"4px",height:"40px",zIndex:3,background:ee===(null==d?void 0:d.id)?x.A.STATUS_PAUSED===J||eE?y.palette.warning.main:y.palette.primary.main:"transparent",transform:"scaleY(".concat(ee===(null==d?void 0:d.id)?"100":"0","%)"),transition:"transform 200ms linear"}})]}),null!==ek.current||eP&&ec&&ep?(0,l.jsx)(L.A,{title:eR?(null==(i=A.user)?void 0:i.computerEnabled)?p.t("Locked by billing"):p.t("Computer disabled"):eM?null:eD,placement:"left",children:(0,l.jsx)(S.A,{sx:{position:"absolute",right:"5px",top:"5px",zIndex:2},children:(0,l.jsx)(e_.A,{className:en||ee!==(null==d?void 0:d.id)?null:"pop pop-rounded pop-inset",disabled:eM,"data-start-stop":"".concat(null!=(s=null==d?void 0:d.id)?s:""),onClick:ez,children:eR?(0,l.jsx)(nY.A,{fontSize:"small",color:"inherit"}):x.A.STATUS_STARTED===J?(0,l.jsx)(nK.A,{color:eM?"disabled":"primary"}):x.A.STATUS_STOPPED===J&&ey?(0,l.jsx)(nG.A,{className:"rotate-360"}):(0,l.jsx)(nV.A,{color:eM?"disabled":x.A.STATUS_PAUSED===J||eE?"warning":"primary"})})})}):null,eE?(0,l.jsx)(n$.A,{color:"warning",variant:"indeterminate",sx:{position:"absolute",bottom:0,left:0,height:"2px",zIndex:3}}):null]}),es?(0,l.jsx)(nZ,{agent:d,isOpen:!0,onClose:()=>ea(!1),status:J}):null]})}var n7=n(72568),n8=n(74787),n9=n(14822),le=n(13536),lt=n(1879),ln=n(49404);let ll=(0,f.forwardRef)((e,t)=>{let{tooltipPlacement:n="bottom",tooltipShown:i=!0}=e,{settings:r,saveSettings:s}=(0,n8.t)(),[a,o]=(0,f.useState)(!1),{i18n:d}=(0,g.B)(),c=(0,k.A)(),u="boolean"!=typeof(null==r?void 0:r.sound)||r.sound;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(L.A,{title:i?u?d.t("Sound on"):d.t("Sound off"):null,placement:n,children:(0,l.jsx)(ts.A,{ref:t,color:"default",inputProps:{"aria-label":"sound",name:"sound"},checked:u,disabled:a,sx:{mx:1,height:"38px","& .MuiSwitch-track":{background:"transparent",opacity:1,border:"1px solid ".concat(c.palette.divider)}},icon:(0,l.jsx)(ln.A,{fontSize:"small",color:"disabled"}),checkedIcon:(0,l.jsx)(lt.A,{fontSize:"small",color:"info",sx:{color:"#ff9b00"}}),onClick:()=>{!a&&(o(!0),setTimeout(()=>o(!1),500),s({sound:!u}),u||(0,nT.A)("toastInfo"))}})})})});var li=n(54441),lr=n(65010),ls=n(74441),la=n(92705);let lo=(0,f.forwardRef)((e,t)=>{var n,i;let{user:r,sx:s,skin:a,color:o}=e,d=(0,k.A)(),c=(()=>{let e=(0,k.A)();return{primaryFilled:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main},primaryLight:{color:e.palette.primary.main,backgroundColor:(0,lr.z)(e.palette.primary.main,.12)},secondaryFilled:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main},secondaryLight:{color:e.palette.secondary.main,backgroundColor:(0,lr.z)(e.palette.secondary.main,.12)},successFilled:{color:e.palette.success.contrastText,backgroundColor:e.palette.success.main},successLight:{color:e.palette.success.main,backgroundColor:(0,lr.z)(e.palette.success.main,.12)},errorFilled:{color:e.palette.error.contrastText,backgroundColor:e.palette.error.main},errorLight:{color:e.palette.error.main,backgroundColor:(0,lr.z)(e.palette.error.main,.12)},warningFilled:{color:e.palette.warning.contrastText,backgroundColor:e.palette.warning.main},warningLight:{color:e.palette.warning.main,backgroundColor:(0,lr.z)(e.palette.warning.main,.12)},infoFilled:{color:e.palette.info.contrastText,backgroundColor:e.palette.info.main},infoLight:{color:e.palette.info.main,backgroundColor:(0,lr.z)(e.palette.info.main,.12)}}})(),u=(0,m.A)(),p=new Date().toJSON().slice(0,10),x="".concat(eg.A.s3Url,"/users/").concat(r.id,"/?cb=").concat(p);(null==(n=u.user)?void 0:n.id)===r.id&&(x="string"==typeof(null==r?void 0:r.userAvatarId)?"".concat(eg.A.s3Url,"/users/").concat(r.id,"/").concat(r.userAvatarId,".png"):"/img/placeholder/user.png");let h=(e,t)=>"light"===e?{...c["".concat(t,"Light")]}:"light-static"===e?{color:c["".concat(t,"Light")].color,backgroundColor:(0,ls.a)(d.palette[t].main,.88)}:{...c["".concat(t,"Filled")]};s.backgroundColor=d.palette.background.default,s.border="2px solid ".concat(null!=(i=d.palette.customColors.userColors.solid[r.userColor])?i:d.palette.divider);let g={primary:h(a,"primary"),secondary:h(a,"secondary"),success:h(a,"success"),error:h(a,"error"),warning:h(a,"warning"),info:h(a,"info")},f={sx:s,skin:a,color:o,src:x,alt:"avatar"};return(0,l.jsx)(la.A,{ref:t,...f,sx:!x&&a&&o?Object.assign(g[o],s):s})});lo.defaultProps={skin:"filled",color:"primary"};let ld=(0,b.Ay)(eG.A)(e=>{let{theme:t}=e;return{"& .MuiMenu-paper":{width:280,overflow:"hidden",marginTop:t.spacing(4),[t.breakpoints.down("sm")]:{width:"100%"}},"& .MuiMenu-list":{padding:0}}}),lc=e=>{let{onProfileOpen:t=()=>{}}=e,{settings:n}=(0,n8.t)(),{i18n:i}=(0,g.B)(),r=(0,k.A)(),s=(0,m.A)(),[a,o]=(0,f.useState)(null),d=(0,f.useRef)(null),c=(0,f.useRef)(null),u=()=>o(null),p=async()=>{var e;u(),await (null==(e=window.sdk)?void 0:e.ipc.main.quit())};return s.user?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(I.A,{onClick:e=>{o(e.currentTarget)},fullWidth:!0,sx:{borderRadius:0,justifyContent:"space-between",alignItems:"center",height:"100%"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 30px)"},children:[(0,l.jsx)(n9.A,{"aria-disabled":"true",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(lo,{user:s.user,sx:{width:24,height:24,ml:1}})}),(0,l.jsx)(C.A,{variant:"body2",sx:{textTransform:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",ml:3},children:s.user.userName})]}),(0,l.jsx)(P,{sx:{flexShrink:0},open:!!a,children:(0,l.jsx)(z.A,{color:"action"})})]}),(0,l.jsxs)(ld,{sx:{mt:-6,width:"250px"},anchorEl:a,"aria-disabled":"true",open:!!a,onClose:()=>u(),anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:[(0,l.jsx)(eH.A,{onClick:()=>{u(),t()},sx:{p:3,py:2,textDecoration:"none"},children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(n9.A,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(lo,{user:s.user,sx:{width:"2rem",height:"2rem",ml:1}})}),(0,l.jsxs)(S.A,{"aria-disabled":"true",sx:{display:"flex",ml:3,alignItems:"flex-start",flexDirection:"column"},children:[(0,l.jsx)(L.A,{title:s.user.userName,placement:"top",children:(0,l.jsx)(C.A,{variant:"body2",sx:{fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"145px"},children:s.user.userName})}),(0,l.jsx)(L.A,{title:s.user.userEmail,placement:"bottom",children:(0,l.jsx)(C.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"145px"},children:s.user.userEmail})})]})]})}),(0,l.jsx)(eq.A,{}),(0,l.jsx)(eH.A,{onClick:e=>{e.stopPropagation(),u(),c.current&&c.current.click()},children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(S.A,{sx:{ml:"-19px",mr:"-3px"},children:(0,l.jsx)(li.A,{ref:c,tooltipShown:!1})}),(0,l.jsx)(C.A,{variant:"body2",children:"dark"===r.palette.mode?i.t("Dark mode"):i.t("Light mode")})]})}),(0,l.jsx)(eH.A,{onClick:e=>{e.stopPropagation(),u(),d.current&&d.current.click()},children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(S.A,{sx:{ml:"-19px",mr:"-3px"},children:(0,l.jsx)(ll,{ref:d,tooltipShown:!1})}),(0,l.jsx)(C.A,{variant:"body2",children:n.sound?i.t("Sound on"):i.t("Sound off")})]})}),(0,l.jsx)(eq.A,{}),(0,l.jsxs)(eH.A,{sx:{py:3,fontWeight:400},"aria-disabled":"true",onClick:p,children:[(0,l.jsx)(le.A,{sx:{ml:1,mr:4},color:"action"}),(0,l.jsx)(C.A,{variant:"body2",children:i.t("Exit")})]})]})]}):null};var lu=n(42993),lp=n(60749);let lx=(0,b.Ay)(S.A)(e=>{let{theme:t,type:n}=e;return{position:"absolute",width:t.spacing(24),height:t.spacing(24),border:"1px solid #fff",..."top-left"===n?{borderBottom:"none",borderRight:"none",top:t.spacing(12),left:t.spacing(12)}:"top-right"===n?{borderBottom:"none",borderLeft:"none",top:t.spacing(12),right:t.spacing(12)}:"bottom-left"===n?{borderTop:"none",borderRight:"none",bottom:t.spacing(12),left:t.spacing(12)}:"bottom-right"===n?{borderTop:"none",borderLeft:"none",bottom:t.spacing(12),right:t.spacing(12)}:{}}});function lh(e){let{agents:t,agentsReady:n=!1}=e,{getAgentActive:i,onAgentActive:r,getAgentId:s,onAgentId:a,onTickArea:o,onVmouseMove:d,onVmouseClick:c,getVmouse:u,onDownloadInfo:p,getDownloadInfo:x,onVideoInfo:m,getVideoInfo:g}=(0,h.P)(),y=(0,k.A)(),A=(0,f.useRef)(null),j=(0,f.useRef)(null),v=(0,f.useRef)(null),w=(0,f.useRef)(null),[b,I]=(0,f.useState)(!1),[T,z]=(0,f.useState)(null),[D,P]=(0,f.useState)(!1),[R,_]=(0,f.useState)(null),[E,M]=(0,f.useState)({}),[N,O]=(0,f.useState)({}),[U,B]=(0,f.useState)(null);return(0,f.useEffect)(()=>{I(i(s()));let e=r(e=>{let{agentId:t,active:n}=e;t===s()&&I(n)});z(null);let t=o(e=>{let{agentId:t,area:n}=e;if(t===s()&&Array.isArray(n)){let e=n.map(e=>parseInt(e,10)).filter(e=>Number.isInteger(e));4===e.length&&(z(null),null!==v.current&&(window.clearTimeout(v.current),v.current=null),v.current=window.setTimeout(()=>{z(e),v.current=null,null!==w.current&&(window.clearTimeout(w.current),w.current=null),w.current=window.setTimeout(()=>{z(null),w.current=null},1e3)},50))}});B(u(s()));let n=d(e=>{let{agentId:t,vmouse:n}=e;t===s()&&B(n)});M(x(s()));let l=p(e=>{let{agentId:t,info:n}=e;t===s()&&M(n)});O(g(s()));let a=m(e=>{let{agentId:t,info:n}=e;t===s()&&O(n)}),h=c(e=>{let{agentId:t,vmouse:n}=e;t===s()&&["click","double-click"].includes(null==n?void 0:n.name)&&(P(!0),window.setTimeout(()=>P(!1),250),_(null),null!==A.current&&(window.clearTimeout(A.current),A.current=null),A.current=window.setTimeout(()=>{_(n),A.current=null,null!==j.current&&(window.clearTimeout(j.current),j.current=null),j.current=window.setTimeout(()=>{_(null),j.current=null},300)},50))});return()=>{t(),l(),a(),n(),e(),h()}},[]),(0,f.useEffect)(()=>{let e=a(e=>{A.current=null,j.current=null,v.current=null,w.current=null,M(x(e)),O(g(e)),I(i(e)),z(null)});return()=>e()},[t]),n?b?(0,l.jsxs)(S.A,{sx:{position:"relative",width:"100%",height:"100%",boxShadow:"none",overflow:"hidden"},children:[(0,l.jsxs)(S.A,{className:"agent-overlay",children:[N.rec?(0,l.jsxs)(S.A,{sx:{width:"100%",height:"100%",left:0,top:0,position:"absolute",display:"flex",flexDirection:"column",justifyContent:"space-between",zIndex:10},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",width:"100%",justifyContent:"space-between"},children:[(0,l.jsx)(S.A,{sx:{position:"relative"},children:(0,l.jsx)(lx,{type:"top-left"})}),(0,l.jsxs)(S.A,{sx:{position:"relative"},children:[(0,l.jsx)(lx,{type:"top-right"}),(0,l.jsxs)(S.A,{sx:{marginTop:16,marginRight:16,display:"flex",alignItems:"center",background:"rgba(0,0,0,0.2)",px:4,py:2,borderRadius:1,userSelect:"none"},children:[(0,l.jsx)(lp.A,{fontSize:"small",color:"error",className:"zoom-in"}),(0,l.jsx)(L.A,{title:N.fileName||null,children:(0,l.jsxs)(C.A,{variant:"body1",sx:{ml:3,color:"#fff",fontFamily:"Inconsolata,monospace"},children:["".concat(Math.floor(N.total/60)).padStart(2,"0"),":","".concat(N.total%60).padStart(2,"0")]})})]})]})]}),(0,l.jsxs)(S.A,{sx:{display:"flex",width:"100%",justifyContent:"space-between"},children:[(0,l.jsx)(S.A,{sx:{position:"relative"},children:(0,l.jsx)(lx,{type:"bottom-left"})}),(0,l.jsx)(S.A,{sx:{position:"relative"},children:(0,l.jsx)(lx,{type:"bottom-right"})})]})]}):null,(0,l.jsx)(S.A,{sx:{width:"350px",height:"100%",right:"0px",position:"absolute",overflowY:"auto",mr:2,display:"flex",flexDirection:"column",justifyContent:"end",zIndex:12},children:Object.keys(E).map(e=>{let t="string"==typeof E[e].error?"error":E[e].done?"success":"primary",n="string"==typeof E[e].error?(0,l.jsx)(nB.A,{}):E[e].done?(0,l.jsx)(ev.A,{}):(0,l.jsx)(nG.A,{className:"rotate-360"}),i="string"==typeof E[e].error?E[e].error:"".concat(E[e].fileName).concat(E[e].totalBytes>0?" (".concat((E[e].totalBytes/1048576).toFixed(3),"MB)"):"");return(0,l.jsx)(lu.A,{sx:{mb:2},children:(0,l.jsxs)(eM.A,{variant:"filled",color:t,sx:{px:2,"& .MuiAlert-message":{width:"100%"},boxShadow:y.shadows[3]},icon:n,children:[(0,l.jsx)(C.A,{variant:"caption",color:"inherit",children:i}),"string"==typeof E[e].error||E[e].done?null:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%",height:"1rem"},children:[(0,l.jsx)(n$.A,{color:"primary",value:parseFloat(E[e].progress),variant:E[e].totalBytes>0?"determinate":"indeterminate"}),E[e].totalBytes>0?(0,l.jsx)(C.A,{variant:"caption",color:"inherit",sx:{ml:3},children:"".concat(E[e].progress,"%")}):null]})]})},e)})})]}),Array.isArray(T)?(0,l.jsx)(S.A,{className:"tick-area",sx:{left:T[0],top:T[1],width:T[2],height:T[3]}}):null,null!==R?(0,l.jsx)(S.A,{className:"mouse-ripple",sx:{left:"".concat(R.x-25,"px"),top:"".concat(R.y-25,"px"),animationIterationCount:"double-click"===R.name?2:1}}):null,null!==U?(0,l.jsx)(S.A,{className:"mouse-pointer","data-tapped":"".concat(D),sx:{transform:"translate(".concat(U.x,"px, ").concat(U.y,"px)"),...Number.isInteger(U.duration)?{transitionDuration:"".concat(U.duration,"ms")}:{}}}):null]}):null:(0,l.jsx)(S.A,{sx:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(t5.A,{size:128,animate:!0,grey:!0,className:"rotate"})})}var lm=n(52782),lg=n(55815),lf=n(71918),ly=n(64266);let lA=e=>{var t;let{field:n,refFirstEmpty:i,firstValue:r=[],actionSet:s=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}=e,{i18n:a}=(0,g.B)();("object"!=typeof n||null===n)&&(n={});let[o,d]=(0,f.useState)(Array.isArray(r)?r:[]);return(0,f.useEffect)(()=>{d(Array.isArray(r)?r:[])},[r]),(0,l.jsx)("form",{"data-scalar":n.key,onSubmit:e=>e.preventDefault(),children:Array.isArray(n.options)&&n.options.length?n.options.length>1&&n.isList?(0,l.jsx)(S.A,{className:i.current===n.id?"pop":"",sx:{width:"100%",borderRadius:"0.25rem",p:1,position:"relative"},children:n.options.map(e=>{let t=o.includes(e)&&o.length<=1&&n.default===e;return(0,l.jsx)(L.A,{title:t?a.t("Enable another option before disabling this one"):null,children:(0,l.jsx)(S.A,{sx:{m:1,display:"inline-block"},children:(0,l.jsx)(lf.A,{label:e,sx:{mr:6,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi"}},control:(0,l.jsx)(ly.A,{inputProps:{name:n.key},value:e,color:t?"default":"primary",checked:o.includes(e),onChange:t=>((e,t)=>{d(l=>{let i=e.target.checked?[...new Set([...l,t])]:l.filter(e=>e!==t);return i.length||(i=[n.default]),JSON.stringify(l)!==JSON.stringify(i)&&s(),i})})(t,e)})})})},e)})}):(0,l.jsx)(lm.A,{fullWidth:!0,displayEmpty:!0,renderValue:e=>e||(0,l.jsx)(C.A,{variant:"caption",children:a.t("Select an option")}),name:n.key,defaultValue:null!=r?r:"",className:i.current===n.id?"pop":"",inputProps:{id:"field-".concat(n.id)},onChange:e=>s(),children:n.options.map(e=>(0,l.jsx)(eH.A,{value:e,children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center"},children:e})},e))}):(0,l.jsx)(L.A,{title:"int"===n.type?[...Number.isInteger(n.min)?[a.t("Minimum: {{n}}",{n:n.min})]:[],...Number.isInteger(n.max)?[a.t("Maximum: {{n}}",{n:n.max})]:[]].join(", "):[...Number.isInteger(n.min)?[1===n.min?a.t("Required"):a.t("Minimum length: {{n}}",{n:n.min})]:[],...Number.isInteger(n.max)?[a.t("Maximum length: {{n}}",{n:n.max})]:[]].join(", "),children:(0,l.jsx)(eE.A,{id:"field-".concat(n.id),className:i.current===n.id?"pop":"",name:n.key,InputLabelProps:{shrink:!0},sx:{width:"100%","& .MuiInputBase-multiline":{py:3},"& textarea":{p:"0 !important"}},defaultValue:r,placeholder:"".concat(null!=(t=n.default)?t:""),onChange:e=>s(450),type:"int"===n.type?"number":"string",inputMode:"int"===n.type?"numeric":"text",multiline:"string"===n.type,maxRows:9,inputProps:{..."int"===n.type?{min:n.min,max:n.max}:{minLength:n.min,maxLength:n.max}}})})})},lj=e=>{let{field:t,firstValue:n,actionSet:i=()=>{}}=e;return("object"!=typeof t||null===t)&&(t={}),(0,l.jsx)("form",{"data-scalar":t.key,onSubmit:e=>e.preventDefault(),children:(0,l.jsx)(ts.A,{id:"field-".concat(t.id),name:t.key,defaultChecked:!!n,onChange:e=>i()})})};var lv=n(37085),lw=n.n(lv),lb=n(27420),lk=n(5754),lS=n(95250),lC=n(80735),lI=n(26271),lT=n(53395),lz=n(47952);let lD=e=>{let{time:t,sessionId:n=null,sx:i={},inline:r=!1}=e,{i18n:s}=(0,g.B)(),{getAgentId:a}=(0,h.P)();("object"!=typeof i||null===i)&&(i={});let[o,d]=(0,f.useState)(null),c=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t&&null!==o)return;if("string"!=typeof n||"default"===n)return void d(s.t("Manual run"));let l=await (null==(e=window.sdk)?void 0:e.ipc.session.read(a(),n));d("string"==typeof(null==l?void 0:l.sessionName)&&l.sessionName.length?l.sessionName:"c"===n[0]?s.t("Recurring run"):s.t("Scheduled run"))};(0,f.useEffect)(()=>{r&&c(!0)},[r,n,t]);let u=(0,l.jsx)(n0.A,{});"string"==typeof n&&"default"!==n&&(u="c"===n[0]?(0,l.jsx)(nW.A,{}):(0,l.jsx)(n1.A,{}));let p=(null!==o?"".concat(o," - "):"")+nh(1e3*t,"en",{day:"numeric",month:"long",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}),x=nm(1e3*t);return r&&(x="".concat(o," - ").concat(x)),Number.isInteger(t)?(0,l.jsx)(L.A,{placement:"left",title:p,children:(0,l.jsx)(ej.A,{size:"small",icon:u,variant:"outlined",onMouseEnter:r?null:()=>c(),label:x,sx:{fontFamily:"Inconsolata,sans-serif",...i}})}):null};var lP=n(98738);let lR=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",justifyContent:"end",padding:t.spacing(2),"& > button":{marginLeft:t.spacing(2)}}}),l_={en:n(85606).c};var lE=n(93614);let lM=e=>e*parseFloat(getComputedStyle(document.documentElement).fontSize),lN=e=>{let t=(()=>{let{settings:e}=(0,n8.t)(),t=(void 0!==l_[null==e?void 0:e.lang]?l_[e.lang]:l_.en).components.MuiDataGrid.defaultProps.localeText;return t.MuiTablePagination.labelDisplayedRows=e=>{let{from:t,to:n,count:l}=e;return"".concat(t," - ").concat(n," / ").concat(l)},t})(),n=(0,k.A)(),[i,r]=(0,f.useState)(lM(3)),[s,a]=(0,f.useState)(lM(3));return(0,f.useEffect)(()=>{let e=document.documentElement,t=new ResizeObserver(()=>{a(lM(3)),r(lM(3))});return t.observe(e),()=>t.disconnect()},[]),(0,l.jsx)(S.A,{sx:{border:"1px solid ".concat(n.palette.divider),borderRadius:"8px"},children:(0,l.jsx)(lE.z,{...e,showColumnRightBorder:!0,hideFooterSelectedRowCount:!0,dataGridLocale:t,rowHeight:s,columnHeaderHeight:i})})};var lL=n(959);let lO=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{border:"1px solid ".concat(t.palette.divider),borderRadius:t.spacing(2),width:"100%",overflowX:"auto",paddingBottom:t.spacing(1)}}),lU=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{height:"35px",width:"100%",display:"flex",alignItems:"center",padding:t.spacing(2),marginBottom:t.spacing(1)}}),lB=(0,b.Ay)(S.A)(e=>{let{theme:t,removed:n=!1,excluded:l=!1}=e;return{border:"1px solid ".concat(t.palette.divider),borderRadius:t.spacing(1),width:"115px",flexShrink:0,flexGrow:0,marginRight:t.spacing(1),height:"35px",padding:t.spacing(2),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"0.75rem",lineHeight:"18px",verticalAlign:"middle",textDecoration:n?"line-through":"none",background:l?t.palette.divider:"transparent",userSelect:n||l?"none":"text"}}),lF=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{"&:before":{position:"absolute",content:'""',display:"block",top:0,left:0,width:"5px",height:"100%",background:t.palette.divider,borderRadius:t.spacing(1)},marginBottom:t.spacing(4),position:"relative",paddingLeft:t.spacing(4),whiteSpaceCollapse:"preserve",wordBreak:"break-word",whiteSpace:"pre-wrap",width:"100%","&>span":{display:"inline-block",width:"100%",marginTop:t.spacing(2),marginBottom:t.spacing(2)}}}),lW=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=[];return new Promise((r,s)=>{let a=new FileReader;a.onload=e=>{let a=e.target.result;lw().parse(a,{header:!1,skipEmptyLines:!0,dynamicTyping:!0,comments:"#",worker:!1,step:async(e,s)=>{if(e.data.filter(e=>null!==e).length){if(i.push(e.data),"function"!=typeof n){i.length>=t&&(r(i),i=[],s.abort());return}i.length>=l&&(s.pause(),await n(i),i=[],s.resume())}},complete:async()=>{if("function"!=typeof n)return void r(i);i.length>0&&await n(i),r(!0)},error:s})},a.onerror=s,a.readAsText(e)})},lH=(0,f.memo)(e=>{let{fieldKey:t,fieldName:n,fieldColumns:i=[],runIds:r=null,pop:s=!1,sessionId:a=null}=e,{getAgentId:d,refetchInputs:c}=(0,h.P)(),{i18n:u}=(0,g.B)(),p=(0,f.useRef)(null),x=(0,f.useRef)(null),m=(0,f.useRef)(null);Array.isArray(i)||(i=[]);let[y,A]=(0,f.useState)(10),[j,w]=(0,f.useState)(1),[b,k]=(0,f.useState)(1),[T,z]=(0,f.useState)(""),[D,P]=(0,f.useState)(!1),[R,_]=(0,f.useState)([]),[M,N]=(0,f.useState)(null),[O,U]=(0,f.useState)(!1),[B,H]=(0,f.useState)(!1),[q,Y]=(0,f.useState)(!1),[G,K]=(0,f.useState)(!1),[V,J]=(0,f.useState)(null),[Q,X]=(0,f.useState)([]),[Z,ee]=(0,f.useState)(!1),[et,en]=(0,f.useState)([]),el=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];P(!1);try{var n,l;let e=Array.isArray(r)?await (null==(n=window.sdk)?void 0:n.ipc.diskStorage.outputTableQuery(d(),r.slice(-v().max.diskStorage.outputRunsCount),t,b,5e3)):await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.inputTableQuery(d(),t,b,5e3,a));"object"==typeof e&&null!==e&&(w(Math.ceil(e.total/5e3)),_(e.rows))}catch(e){}e&&await c(d(),a),P(!0)},ei=()=>O?Math.max(...(Array.isArray(Q)?Q:[]).map(e=>e.length),i.length):0;(0,f.useEffect)(()=>{let e=setTimeout(()=>el(!1),100);return()=>window.clearTimeout(e)},[t,i,b,r]),(0,f.useEffect)(()=>{O&&en([...i,...Array(ei()-i.length).fill("")])},[O,i,Q]);let er=async e=>{var n;if(Array.isArray(r))return;Y(!0);let l=new FormData(e.target),s={};for(let e of i)s[e]=l.get(e);await (null==(n=window.sdk)?void 0:n.ipc.diskStorage.inputTableAdd(d(),t,[s],a)),Y(!1),K(!1),await el()},es=async(e,n)=>{var l;if(Array.isArray(r))return;Y(!0);let s=new FormData(e.target),o={};for(let e of i)o[e]=s.get(e);await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.inputTableUpdate(d(),t,n,o,a)),Y(!1),K(!1),await el()},ea=async e=>{var n;K(!1),Array.isArray(r)||(P(!1),await (null==(n=window.sdk)?void 0:n.ipc.diskStorage.inputTableDelete(d(),t,e,a)),await el())},eo=async()=>{var e;H(!1),Array.isArray(r)||(P(!1),await (null==(e=window.sdk)?void 0:e.ipc.diskStorage.inputTableDelete(d(),t,null,a)),await el())},ed=async()=>{if(!Array.isArray(et)||!et.length||!i.length)return void eu();Y(!0);let e=!1;try{await lW(V,4,async n=>{var l;let i=n.map(e=>{let t={};for(let n=0;n<et.length;n++)et[n].length&&(t[et[n]]=void 0===e[n]?null:e[n]);return t});!e&&Z&&(e=!0,i.shift()),await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.inputTableAdd(d(),t,i,a))},100)}catch(e){var n;o.o.error("".concat(u.t("Error importing CSV"),": ").concat(null!=(n=e.message)?n:e))}eu(),await el()},ec=async e=>{let t=Array.isArray(e)&&e.length?e[0]:null,n=[];if(null!==t)try{n=await lW(t,4)}catch(e){var l;o.o.error("".concat(u.t("Error parsing CSV"),": ").concat(null!=(l=e.message)?l:e))}if(!Array.isArray(n)||!n.length)return void o.o.error(u.t("The CSV file is empty"));J(t),X(n)},eu=async()=>{U(!1),Y(!1),J(null),X([]),ee(!1),en([])},ep=()=>{K(!1)},eh=()=>{x.current&&x.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},em=[...null!==r?[{width:150,hideable:!1,field:"_date_",filterable:!1,headerName:u.t("Run"),renderCell:e=>{let{row:t}=e;return(0,l.jsx)(lD,{time:t._time,sessionId:t._sid})},valueGetter:e=>{let{row:t}=e;return t._time}}]:[],...i.map((e,t)=>({flex:1,minWidth:200,hideable:null!==r||0!==t,field:e,renderCell:t=>{let{row:n}=t;return(0,l.jsx)(L.A,{title:n[e],children:(0,l.jsx)(C.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:ex(n[e],T,d())})})},valueGetter:t=>{let{row:n}=t;return n[e]}})),...null===r?[{width:40,field:"_actions_",hideable:!1,filterable:!1,headerName:u.t("Actions"),renderHeader:()=>"",renderCell:e=>{let{row:t}=e;return(0,l.jsx)(S.A,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsx)(L.A,{title:u.t("Delete row"),placement:"left",children:(0,l.jsx)(e_.A,{size:"small",onClick:e=>{e.preventDefault(),e.stopPropagation(),ea(t._id)},children:(0,l.jsx)(eK.A,{fontSize:"small"})})})})}}]:[]],eg=O&&null!==V?et.length<=4?550:et.length>=9?1150:550+120*(et.length-4):750;return(0,l.jsxs)(S.A,{sx:{width:"100%"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:4,height:"30px"},children:[D&&i.length&&j>1?(0,l.jsx)(S.A,{sx:{display:"flex",width:"280px",justifyContent:"start",flexShrink:0},children:(0,l.jsx)(lk.A,{size:"small",count:j,page:b,onChange:async(e,t)=>k(t)})}):null,(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",justifyContent:"end",alignItems:"center"},children:[D&&R.length?(0,l.jsx)(S.A,{sx:{width:"200px",height:"30px",mt:"2px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,l.jsx)(nd.A,{fontSize:"small",color:"disabled"}),(0,l.jsx)(eE.A,{inputRef:m,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"}},InputProps:{endAdornment:(0,l.jsx)(eR.A,{position:"end",children:(0,l.jsx)(S.A,{sx:{width:30,height:30},children:T.length?(0,l.jsx)(L.A,{title:u.t("Clear filter"),children:(0,l.jsx)(e_.A,{sx:{width:30,height:30},onClick:()=>{z(""),null!==m.current&&(m.current.value="")},children:(0,l.jsx)(eN.A,{fontSize:"small"})})}):null})})},placeholder:u.t("Filter"),variant:"standard",disabled:!D,onChange:e=>{var t;return t=e.target.value.toLowerCase(),void(null!==p.current&&window.clearTimeout(p.current),p.current=window.setTimeout(()=>{z(t),p.current=null},450))}})]})}):null,null===r&&i.length?(0,l.jsxs)(l.Fragment,{children:[D?(0,l.jsx)(S.A,{sx:{ml:3,borderRadius:1,height:"30px",width:"80px",position:"relative"},className:!s||G||O||B||null!=M?null:"pop",children:(0,l.jsxs)(lb.A,{size:"small",disabled:!D,children:[(0,l.jsx)(I.A,{sx:{px:"0 !important",height:"30px"},variant:R.length?"outlined":"contained",onClick:()=>{K(!0),N(null)},children:(0,l.jsx)(ez.A,{})}),(0,l.jsx)(I.A,{sx:{px:"0 !important",height:"30px"},variant:R.length?"outlined":"contained",onClick:e=>N(e.currentTarget),children:(0,l.jsx)(th.A,{})})]})}):(0,l.jsx)($.A,{spacing:0,sx:{width:"90px",height:"20px",mr:3,my:"5px"}}),D?R.length?(0,l.jsx)(L.A,{title:u.t("Clear table"),placement:"left",children:(0,l.jsx)(e_.A,{sx:{width:"30px",height:"30px",mx:3},onClick:()=>H(!0),children:(0,l.jsx)(eK.A,{fontSize:"small"})})}):null:(0,l.jsx)($.A,{spacing:0,rounded:!0,sx:{width:"30px",height:"30px",mr:2}})]}):null]})]}),(0,l.jsx)(lN,{sx:{"& .MuiDataGrid-row":{cursor:"pointer"}},onPageSizeChange:e=>A(e),onRowClick:e=>{let{row:t}=e;return K(t)},rowsPerPageOptions:[10,25,50,100],disableSelectionOnClick:!0,getRowId:e=>e._id,pageSize:y,columns:em,loading:!D,rows:"string"==typeof T&&T.length?R.filter(e=>Object.values(e).some(e=>"string"==typeof e&&e.toLowerCase().includes(T.toLowerCase()))):R,autoHeight:!0}),D&&i.length?(0,l.jsxs)(E.Ay,{open:!!G,anchor:"right",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{top:50,bottom:50,left:250},"& .MuiDrawer-paper":{width:"55%",minWidth:"400px",maxWidth:"1200"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute"}},onClose:()=>ep(),children:[q?null:(0,l.jsx)(F,{icon:null===r&&("object"==typeof G||!0===G)?"object"==typeof G?(0,l.jsx)(lI.A,{}):(0,l.jsx)(lS.A,{}):(0,l.jsx)(lz.A,{}),title:"".concat(n,": ").concat(null===r?"object"==typeof G?u.t("Edit row"):u.t("Add row"):Number.isInteger(null==G?void 0:G._time)?nm((null==G?void 0:G._time)*1e3):"---"),handleClose:()=>ep()}),(0,l.jsx)(W,{children:q?(0,l.jsx)($.A,{}):(0,l.jsx)("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),null===r&&("object"==typeof G?es(e,G._id):er(e))},ref:x,children:i.map((e,t)=>{var n;let i="object"==typeof G&&null!==G?null!=(n=G[e])?n:"":null;return(0,l.jsx)(S.A,{sx:{width:"100%",display:"flex"},children:null===r?(0,l.jsx)(L.A,{title:u.t("Shift+Enter to add a new line"),placement:"left",children:(0,l.jsx)(eE.A,{variant:"outlined",autoFocus:0===t,defaultValue:i,multiline:!0,maxRows:9,minRows:1,InputProps:{startAdornment:(0,l.jsx)(eR.A,{position:"start",children:(0,l.jsx)(eQ.A,{fontSize:"small"})})},label:e,sx:{width:"100%",mb:4,"& .MuiInputBase-multiline":{py:3},"& textarea":{p:"0 !important"}},id:"cell-".concat(e),name:e,onKeyDown:e=>"Enter"===e.key&&!e.shiftKey&&eh()})}):(0,l.jsxs)(lF,{children:[(0,l.jsx)(ej.A,{label:e,size:"small",variant:"outlined"}),(0,l.jsx)(C.A,{variant:"caption",component:"span",children:ex(i,T,d(),!0)})]})},e)})})}),q?null:(0,l.jsxs)(lR,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>K(!1),sx:{mr:2},children:null===r?u.t("Cancel"):u.t("Close")}),null===r?(0,l.jsx)(I.A,{variant:"contained",onClick:eh,children:"object"==typeof G?u.t("Save"):u.t("Add row")}):null]})]}):null,D&&null===r&&i.length&&R.length&&B?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>H(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsxs)(eW.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[n,(0,l.jsx)(lT.A,{}),u.t("Clear table")]}),(0,l.jsx)(eF.A,{children:(0,l.jsx)(eM.A,{severity:"warning",children:u.t("Are you sure you want to delete all data in this table?")})}),(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>H(!1),children:u.t("Cancel")}),(0,l.jsx)(I.A,{color:"error",onClick:eo,startIcon:(0,l.jsx)(eK.A,{}),children:u.t("Clear table")})]})]}):null,D&&null===r&&i.length&&O?(0,l.jsxs)(eY.A,{open:!0,onClose:q?()=>{}:eu,fullWidth:!0,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:eg,p:2}},children:[q?null:(0,l.jsxs)(eW.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[n,(0,l.jsx)(lT.A,{}),u.t("Import csv file")]}),(0,l.jsx)(eF.A,{children:q?(0,l.jsx)($.A,{}):null===V?(0,l.jsx)(lL.A,{handleFiles:ec,extensions:["csv"],maxSize:v().max.sourceCode.ioFieldTableSize}):(0,l.jsxs)(S.A,{children:[(0,l.jsx)(eM.A,{severity:"info",sx:{mb:3},children:u.t("Use this preview to match each column with the correct entries")}),(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",p:2,mb:3},children:[(0,l.jsx)(ts.A,{id:"skip-first-row",value:Z,onChange:e=>ee(e.target.checked)}),(0,l.jsx)(S.A,{sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",wordWrap:"break-word",overflowWrap:"anywhere",ml:2},children:(0,l.jsxs)(lg.A,{htmlFor:"skip-first-row",sx:{cursor:"pointer",userSelect:"none"},children:[(0,l.jsx)(C.A,{variant:"body2",children:u.t("Do not import the first row")}),(0,l.jsx)(C.A,{variant:"caption",children:u.t("Check this if the first row in your csv file is a header row")})]})})]}),(0,l.jsxs)(lO,{children:[(0,l.jsx)(lP.A,{tooltip:!0,tooltipEmpty:u.t("Column not imported"),tooltipPrefix:u.t("Column imported as"),highlight:!0,maxContent:!0,items:et,setItems:en,sx:{width:"115px",minWidth:"115px",mr:1}}),(Array.isArray(Q)?Q:[]).map((e,t)=>Array.isArray(e)?(0,l.jsx)(L.A,{title:Z&&0===t?u.t("Row not imported"):null,placement:"left",children:(0,l.jsx)(lU,{children:[...e,...Array(ei()-e.length).fill("")].map((e,n)=>(0,l.jsx)(lB,{removed:Z&&0===t,excluded:Z&&0===t||!et[n],children:e},n))})},t):null)]})]})}),q?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:eu,children:u.t("Cancel")}),null!==V?(0,l.jsx)(I.A,{variant:"contained",onClick:ed,startIcon:(0,l.jsx)(lC.A,{}),children:u.t("Import csv file")}):null]})]}):null,(0,l.jsx)(eG.A,{anchorEl:M,open:!!M,onClose:()=>N(null),children:(0,l.jsxs)(eH.A,{onClick:()=>{U(!0),N(null)},children:[(0,l.jsx)(lC.A,{fontSize:"small"}),(0,l.jsx)(C.A,{sx:{ml:3},variant:"body2",children:u.t("Import csv")})]})})]})});var lq=n(12067),lY=n(9344);let lG=e=>{let{onDelete:t,filePaths:n=[],sx:i={},children:r=null,maxCount:s=null,tooltip:a=null,multiple:o=!1,pop:d=!1}=e,c=(0,f.useRef)(null),{i18n:u}=(0,g.B)(),p=(0,k.A)();("object"!=typeof i||null===i)&&(i={});let x=async e=>{var t;await (null==(t=window.sdk)?void 0:t.ipc.device.showFileInFolder(e))},h=async(e,n)=>{e.preventDefault(),e.stopPropagation(),"function"==typeof t&&await t(n)};return(0,l.jsxs)(S.A,{ref:c,sx:{border:o?"1px solid rgba(".concat(p.palette.customColors.mainRgb,", 0.22)"):null,borderRadius:1,p:3*!!o,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",...i,overflowY:o&&Array.isArray(n)&&n.length>0?"auto":null},children:[Array.isArray(n)&&n.length?(0,l.jsx)(eh.Ay,{container:!0,spacing:2,sx:{position:"relative",zIndex:1},children:n.map((e,n)=>{let i="string"==typeof e?e:null==e?void 0:e.filePath,r="object"==typeof e?null==e?void 0:e.runTime:null,s="object"==typeof e?null==e?void 0:e.sessionId:null,a=i.replace(/[\\\/]+$/g,"").replace(/[\\\/]+/g,"/").split("/").pop();return o||0===n?(0,l.jsx)(eh.Ay,{item:!0,children:(0,l.jsxs)(I.A,{onClick:e=>{e.preventDefault(),x(i)},sx:{p:0,display:"flex",alignItems:"center",flexDirection:"column",borderRadius:1,transition:"transform 100ms linear"},children:[(0,l.jsxs)(S.A,{sx:{width:200,height:113,display:"flex",position:"relative",justifyContent:"center",zIndex:0,"&>.delete":{opacity:0,transform:"scale(0.1)"},"&:hover>.delete":{opacity:1,transform:"scale(1)"},borderRadius:1},children:["function"==typeof t?(0,l.jsx)(e_.A,{className:"delete",component:"div",color:"error",onClick:e=>h(e,i),sx:{position:"absolute",top:4,right:4,zIndex:10,"&:hover":{color:"#fff",background:p.palette.error.main},transition:"all 100ms linear"},children:(0,l.jsx)(lY.A,{fontSize:"small"})}):null,(0,l.jsx)(eu,{fileUrl:(0,lq.w8)(i),showIcon:!0,container:c})]}),null!==r?(0,l.jsx)(lD,{sx:{mt:3},time:r,sessionId:s}):null,(0,l.jsx)(L.A,{title:i,placement:"left",children:(0,l.jsxs)(C.A,{variant:"caption",sx:{my:3,px:2,cursor:"pointer",color:p.palette.primary.main,userSelect:"none",textDecoration:"none",fontFamily:"Yaldevi, sans-serif",textAlign:"center",whiteSpace:"nowrap",wordBreak:"break-all",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",width:"200px",lineHeight:"1rem",maxHeight:"1rem"},children:[(0,l.jsx)(ei.A,{sx:{width:"1rem",height:"1rem",lineHeight:"1rem",display:"inline-block",verticalAlign:"middle",mr:1}}),a]})})]})},n):null})}):o?(0,l.jsx)(S.A,{sx:{userSelect:"none",display:"flex",ml:3,mt:3,width:"100%",height:25,alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(C.A,{variant:"caption",children:u.t("No files selected")})}):null,r&&(!Number.isInteger(s)||n.length<s)?(0,l.jsx)(S.A,{sx:{mt:3*(s>1)},children:r}):null,o?(0,l.jsx)(S.A,{sx:{mt:3,display:"flex",justifyContent:"end",position:"sticky",bottom:0,right:0,zIndex:0},children:(0,l.jsx)(L.A,{title:a,placement:"left",children:(0,l.jsx)(ej.A,{variant:"outlined",sx:{"&:hover":{background:p.palette.background.paper}},label:(0,l.jsx)(C.A,{variant:"caption",children:Number.isInteger(s)?"".concat(n.length," / ").concat(s," ").concat(u.t("files")):"".concat(n.length," ").concat(1===n.length?u.t("file"):u.t("files"))})})})}):null]})};var lK=n(8949);let lV=e=>{var t;let{field:n}=e,[i,r]=(0,f.useState)({}),s="table"===n.type&&void 0===i[n.key]||i[n.key];return(0,l.jsx)(S.A,{sx:{display:"flex",width:"250px",flex:"0 0 250px",flexDirection:"column",justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"},children:(0,l.jsxs)(S.A,{sx:{position:"sticky",top:"0.25rem",pr:2},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,l.jsx)(S.A,{sx:{width:"30px",height:"30px",mr:2},children:n.desc?(0,l.jsx)(e_.A,{size:"small",onClick:()=>((e,t)=>{r(n=>{let l="table"===t&&void 0===n[e]||n[e];return{...n,[e]:!l}})})(n.key,n.type),children:s?(0,l.jsx)(nQ.A,{fontSize:"small"}):(0,l.jsx)(tp.A,{fontSize:"small"})}):null}),(0,l.jsx)(lg.A,{htmlFor:"field-".concat(n.id),sx:{cursor:["int","string","boolean"].includes(n.type)&&!(Array.isArray(n.options)&&n.options.length)?"pointer":"default"},children:(0,l.jsx)(C.A,{variant:"body2",children:null!=(t=n.name)?t:n.key})})]}),n.desc&&s?(0,l.jsx)(C.A,{variant:"caption",component:"pre",sx:{wordBreak:"break-word",whiteSpace:"preserve",fontFamily:"Yaldevi",mt:2,pl:2},children:n.desc}):null]})})},l$=e=>{let{agents:t,sessionId:n=null,sessionChange:i=()=>{}}=e,{getAgentId:r,onAgentId:s,getSource:o,onSource:d,getInputs:c,onInputs:u,inputsSetScalars:p,inputsAddFiles:x,inputsDeleteFile:m}=(0,h.P)(),{i18n:y}=(0,g.B)(),A=(0,f.useRef)(null),j=(0,f.useRef)(null),w=(0,f.useRef)({}),b=(0,f.useRef)([]),k=(0,f.useRef)(null),[C,I]=(0,f.useState)((0,a.fD)(t,r())),[T,z]=(0,f.useState)(!1),[D,P]=(0,f.useState)([]),[R,_]=(0,f.useState)({});(0,f.useEffect)(()=>{I((0,a.fD)(t,r()));let e=s(e=>{z(!1),I((0,a.fD)(t,e))});return()=>{e()}},[t]),(0,f.useEffect)(()=>{A.current=null,j.current=null,w.current={},b.current=[],k.current=null,z(!1),"string"==typeof(null==C?void 0:C.id)&&(async()=>{var e,t;b.current=null!=(t=null==(e=await o(C.id))?void 0:e.srcInputs)?t:[],P(b.current),_(await c(C.id,!0,n)),window.setTimeout(()=>z(!0),100)})();let e=d(async e=>{let{agentId:t,sourceCode:l}=e;if(t===(null==C?void 0:C.id)){var i,r;w.current={},JSON.stringify(b.current)!==JSON.stringify(null!=(i=null==l?void 0:l.srcInputs)?i:[])&&(z(!1),b.current=null!=(r=null==l?void 0:l.srcInputs)?r:[],P(b.current),_(await c(t,!0,n)),window.setTimeout(()=>z(!0),100))}}),t=u(e=>{let{agentId:t,inputs:l,inputSessionId:i}=e;t===(null==C?void 0:C.id)&&i===n&&_(l)});return()=>{e(),t()}},[C]),(0,f.useEffect)(()=>{T&&window.setTimeout(()=>M(),200)},[T]),(0,f.useEffect)(()=>{if("string"!=typeof(null==C?void 0:C.id))return;let e=setTimeout(async()=>{if("string"==typeof n){var e;let t=!0;Array.isArray(D)&&D.length&&(t=D.reduce((e,t)=>{if(e){let{fieldShown:e,fieldEmpty:n}=(0,a.PZ)(D,t.key,R);return!e||!n||void 0!==t.default}return e},!0)),await (null==(e=window.sdk)?void 0:e.ipc.session.updateReady(C.id,n,t))&&i()}},200);return()=>{clearTimeout(e)}},[D,R]);let E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;null!==A.current&&window.clearTimeout(A.current),A.current=window.setTimeout(()=>{A.current=null,M()},e)},M=async()=>{if("string"!=typeof(null==C?void 0:C.id)||!k.current||!T)return;let e={};for(let t of k.current.querySelectorAll("form[data-scalar]"))e[t.getAttribute("data-scalar")]=new FormData(t);let t={};for(let n of D)if(!["files","table"].includes(n.type)&&e[n.key]instanceof FormData)switch(n.type){case"int":case"string":t[n.key]=n.isList?e[n.key].getAll(n.key):e[n.key].get(n.key);break;case"boolean":t[n.key]="on"===e[n.key].get(n.key)}await p(C.id,t,n)},N=async(e,t)=>{Array.isArray(t)&&t.length&&await x(r(),e,t.map(e=>e.path),n)},L=async(e,t)=>{await m(r(),e,t,n)};return j.current=null,(0,l.jsx)(S.A,{children:T?Array.isArray(D)&&D.length?(0,l.jsx)(S.A,{sx:{p:3,pb:0,flexGrow:1},ref:k,children:D.map(e=>{var t;let i=(e=>{var t;let n="files"===e.type?[]:null!=(t=e.default)?t:"";if(void 0===w.current[e.key]){let t=R[e.key];switch(e.type){case"int":case"string":e.isList?Array.isArray(t)||(t=null!==n?[n]:[]):("int"!==e.type||Number.isInteger(t)||(t=n),"string"===e.type&&"string"!=typeof t&&(t=n));break;case"boolean":"boolean"!=typeof t&&(t=n);break;case"files":Array.isArray(t)||(t=n)}w.current[e.key]=t}return w.current[e.key]})(e),{fieldShown:r,fieldEmpty:s}=(0,a.PZ)(D,e.key,R),o=null==(t=null==e?void 0:e.multiple)||t;return r&&s&&void 0===e.default&&null===j.current&&(j.current=e.id),(0,l.jsxs)(S.A,{sx:{display:r?"flex":"none",mb:3},children:[(0,l.jsx)(lV,{field:e}),(0,l.jsx)(S.A,{sx:{width:"100%"},children:["string","int"].includes(e.type)?(0,l.jsx)(lA,{field:e,firstValue:i,actionSet:E,refFirstEmpty:j}):"boolean"===e.type?(0,l.jsx)(lj,{field:e,firstValue:i,actionSet:E}):"files"===e.type?(0,l.jsx)(lG,{maxCount:o?v().max.sourceCode.ioInputFileCount:1,multiple:o,onDelete:t=>L(e.key,t),filePaths:Array.isArray(R[e.key])?R[e.key]:i,sx:{minHeight:o?"250px":"158px",maxHeight:"390px"},children:!o&&Array.isArray(R[e.key])&&R[e.key].length?null:(0,l.jsx)(lL.A,{multiple:o,pop:j.current===e.id,maxCount:v().max.sourceCode.ioInputFileCount,minSize:null==e?void 0:e.min,maxSize:null==e?void 0:e.max,extensions:Array.isArray(null==e?void 0:e.extensions)?e.extensions:["txt"],withPaths:!0,handleFiles:t=>N(e.key,t)})}):"table"===e.type?(0,l.jsx)(lH,{pop:j.current===e.id,fieldKey:e.key,fieldName:e.name,fieldColumns:e.columns,sessionId:n}):null})]},"".concat(e.id,"-").concat(e.type))})}):null===n?(0,l.jsx)(S.A,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",pt:12},children:(0,l.jsx)(lK.default,{title:y.t("No inputs"),message:y.t("This module has no settings to configure"),sx:{"&.content-center":{minHeight:"100%"}}})}):null:(0,l.jsx)(S.A,{sx:{top:0,left:0,height:"100%",width:"100%",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:(0,l.jsx)(t5.A,{grey:!0,size:128,className:"zoom-in"})})})};var lJ=n(55360);let lQ=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{"& .react-datepicker-popper":{zIndex:5},"& .react-datepicker-wrapper":{width:"100%"},"& .react-datepicker":{padding:t.spacing(2,0),color:t.palette.text.primary,borderRadius:t.shape.borderRadius,fontFamily:t.typography.fontFamily,backgroundColor:t.palette.background.paper,boxShadow:t.shadows[7*("bordered"!==Z.A.skin)],border:"bordered"===Z.A.skin?"1px solid ".concat(t.palette.divider):"none","& .react-datepicker__header":{padding:0,border:"none",fontWeight:400,backgroundColor:t.palette.background.paper,"& .react-datepicker__day-name":{margin:0}},"& .react-datepicker-year-header":{lineHeight:2.1,marginBottom:"0.5rem",color:t.palette.text.primary},"& .react-datepicker__triangle":{display:"none"},"& > .react-datepicker__navigation":{top:t.spacing(3),"&.react-datepicker__navigation--previous":{border:"none",backgroundImage:"".concat("url('data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' style=\\'width:24px;height:24px\\' viewBox=\\'0 0 24 24\\'%3E%3Cpath fill=\\'currentColor\\' d=\\'M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z\\' /%3E%3C/svg%3E')".replace("currentColor",t.palette.text.secondary).replace("#","%23")),height:"24px",width:"24px","& .react-datepicker__navigation-icon":{display:"none"}},"&.react-datepicker__navigation--next":{border:"none",backgroundImage:"".concat("url('data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' style=\\'width:24px;height:24px\\' viewBox=\\'0 0 24 24\\'%3E%3Cpath fill=\\'currentColor\\' d=\\'M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z\\' /%3E%3C/svg%3E')".replace("currentColor",t.palette.text.secondary).replace("#","%23")),height:"24px",width:"24px","& .react-datepicker__navigation-icon":{display:"none"}},"&.react-datepicker__navigation--next--with-time":{right:"122px"},"&:focus, &:active":{outline:0}},"& .react-datepicker__current-month":{lineHeight:2.1,fontSize:"1rem",fontWeight:400,letterSpacing:"0.15px",marginBottom:t.spacing(2),color:t.palette.text.primary},"& .react-datepicker__day-name":{lineHeight:1.5,width:"2.25rem",fontSize:"0.75rem",letterSpacing:"0.4px",color:t.palette.text.secondary},"& .react-datepicker__day":{margin:0,width:"2.25rem",lineHeight:2.75,height:"2.25rem",borderRadius:"50%",color:t.palette.text.primary,"&.react-datepicker__day--selected, &.react-datepicker__day--keyboard-selected":{color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&.react-datepicker__day--in-range, &.react-datepicker__day--in-selecting-range":{borderRadius:0,color:t.palette.primary.main,backgroundColor:"".concat((0,lr.z)(t.palette.primary.main,.06)," !important"),"&:empty":{backgroundColor:"transparent !important"}},"&.react-datepicker__day--selected.react-datepicker__day--in-selecting-range.react-datepicker__day--selecting-range-start, &.react-datepicker__day--selected.react-datepicker__day--range-start.react-datepicker__day--in-range, &.react-datepicker__day--range-start":{borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&.react-datepicker__day--range-end":{borderTopRightRadius:"50%",borderBottomRightRadius:"50%",color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&:focus, &:active":{outline:0},"&.react-datepicker__day--outside-month":{height:"auto"},"&.react-datepicker__day--outside-month, &.react-datepicker__day--disabled:not(.react-datepicker__day--selected)":{color:t.palette.text.disabled,"&:hover":{backgroundColor:"transparent"}},"&.react-datepicker__day--highlighted, &.react-datepicker__day--highlighted:hover":{color:t.palette.success.main,backgroundColor:(0,lr.z)(t.palette.success.main,.12)},"&.react-datepicker__day--today":{fontWeight:400}},"& .react-datepicker__header__dropdown":{"& .react-datepicker__month-dropdown-container:not(:last-child)":{marginRight:t.spacing(8)},"& .react-datepicker__month-dropdown-container, & .react-datepicker__year-dropdown-container":{marginBottom:t.spacing(4)},"& .react-datepicker__month-read-view--selected-month, & .react-datepicker__year-read-view--selected-year":{fontSize:"0.85rem",marginRight:t.spacing(1),color:t.palette.text.primary},"& .react-datepicker__month-read-view:hover .react-datepicker__month-read-view--down-arrow, & .react-datepicker__year-read-view:hover .react-datepicker__year-read-view--down-arrow":{borderTopColor:t.palette.text.secondary,borderRightColor:t.palette.text.secondary},"& .react-datepicker__month-read-view--down-arrow, & .react-datepicker__year-read-view--down-arrow":{top:4,borderTopColor:t.palette.text.disabled,borderRightColor:t.palette.text.disabled},"& .react-datepicker__month-dropdown, & .react-datepicker__year-dropdown":{paddingTop:t.spacing(1.5),paddingBottom:t.spacing(1.5),borderColor:t.palette.divider,borderRadius:t.shape.borderRadius,backgroundColor:t.palette.background.paper,boxShadow:"light"===t.palette.mode?t.shadows[8]:t.shadows[9]},"& .react-datepicker__month-option, & .react-datepicker__year-option":{paddingTop:t.spacing(.5),paddingBottom:t.spacing(.5),"&:hover":{backgroundColor:t.palette.action.hover}},"& .react-datepicker__month-option.react-datepicker__month-option--selected_month":{backgroundColor:(0,lr.z)(t.palette.primary.main,.08),"&:hover":{backgroundColor:(0,lr.z)(t.palette.primary.main,.12)},"& .react-datepicker__month-option--selected":{display:"none"}},"& .react-datepicker__year-option.react-datepicker__year-option--selected_year":{backgroundColor:(0,lr.z)(t.palette.primary.main,.08),"&:hover":{backgroundColor:(0,lr.z)(t.palette.primary.main,.12)},"& .react-datepicker__year-option--selected":{display:"none"}},"& .react-datepicker__year-option":{"& .react-datepicker__navigation--years-upcoming":{width:9,height:9,borderStyle:"solid",borderWidth:"3px 3px 0 0",transform:"rotate(-45deg)",borderTopColor:t.palette.text.disabled,borderRightColor:t.palette.text.disabled,margin:"".concat(t.spacing(2.75)," auto ").concat(t.spacing(0))},"&:hover .react-datepicker__navigation--years-upcoming":{borderTopColor:t.palette.text.secondary,borderRightColor:t.palette.text.secondary},"& .react-datepicker__navigation--years-previous":{width:9,height:9,borderStyle:"solid",borderWidth:"0 0 3px 3px",transform:"rotate(-45deg)",borderLeftColor:t.palette.text.disabled,borderBottomColor:t.palette.text.disabled,margin:"".concat(t.spacing(0)," auto ").concat(t.spacing(2.75))},"&:hover .react-datepicker__navigation--years-previous":{borderLeftColor:t.palette.text.secondary,borderBottomColor:t.palette.text.secondary}}},"& .react-datepicker__month":{marginTop:t.spacing(3)},[t.breakpoints.down("sm")]:{"& .react-datepicker__month":{marginLeft:0,marginRight:0,marginBottom:0}},"& .react-datepicker__month, & .react-datepicker__year":{"& .react-datepicker__month-text, & .react-datepicker__year-text, & .react-datepicker__quarter-text":{height:"2rem",alignItems:"center",display:"inline-flex",justifyContent:"center","&:hover":{borderRadius:t.shape.borderRadius},"&:focus, &:active":{outline:0}},"& .react-datepicker__quarter--selected, & .react-datepicker__year-text--selected, & .react-datepicker__month--selected, & .react-datepicker__quarter-text--keyboard-selected, & .react-datepicker__month-text--keyboard-selected, & .react-datepicker__year-text--keyboard-selected":{color:t.palette.common.white,borderRadius:t.shape.borderRadius,backgroundColor:"".concat(t.palette.primary.main," !important")},"& .react-datepicker__week-number":{fontWeight:600,color:t.palette.text.primary}},"& .react-datepicker__year-wrapper":{maxWidth:205,justifyContent:"center"},"& .react-datepicker__input-time-container":{display:"flex",alignItems:"center",..."rtl"===t.direction?{flexDirection:"row-reverse"}:{}},"& .react-datepicker__today-button":{borderRadius:"1rem",margin:"0 1rem 0.3rem",color:t.palette.common.white,backgroundColor:t.palette.primary.main},"& .react-datepicker__time-container":{borderLeftColor:t.palette.divider},"&.react-datepicker--time-only, & .react-datepicker__time-container":{width:"7rem",padding:t.spacing(1.2,0),"& .react-datepicker-time__header":{marginBottom:t.spacing(3),color:t.palette.text.primary,fontSize:t.typography.body2.fontSize},"& .react-datepicker__time":{background:t.palette.background.paper,"& .react-datepicker__time-box .react-datepicker__time-list-item--disabled":{color:t.palette.text.disabled}},"& .react-datepicker__time-list-item":{lineHeight:1.75,height:"auto !important",marginLeft:t.spacing(3.2),marginRight:t.spacing(1.2),color:t.palette.text.primary,borderRadius:t.shape.borderRadius,"&:focus, &:active":{outline:0},"&:hover":{backgroundColor:"".concat(t.palette.action.hover," !important")},"&.react-datepicker__time-list-item--selected":{color:"".concat(t.palette.common.white," !important"),backgroundColor:"".concat(t.palette.primary.main," !important")}},"& .react-datepicker__time-box":{width:"100%"},"& .react-datepicker__time-list":{"&::-webkit-scrollbar":{width:8},"&::-webkit-scrollbar-track":{background:t.palette.background.paper},"&::-webkit-scrollbar-thumb":{background:"#aaa",borderRadius:"10px"},"&::-webkit-scrollbar-thumb:hover":{background:"#999"}}},"&.react-datepicker--time-only .react-datepicker__time-container":{width:"calc(7rem - 2px)"},"& .react-datepicker__day:hover, & .react-datepicker__month-text:hover, & .react-datepicker__quarter-text:hover, & .react-datepicker__year-text:hover":{backgroundColor:t.palette.action.hover}},"& .react-datepicker__close-icon":{paddingRight:t.spacing(4),..."rtl"===t.direction?{right:0,left:"auto"}:{},"&:after":{width:"unset",height:"unset",fontSize:"1.5rem",color:t.palette.text.primary,backgroundColor:"transparent !important"}}}});var lX=n(39200),lZ=n.n(lX),l0=n(5232),l1=n(20243),l2=n(9778),l5=n(46813),l3=n(50133);let l4=e=>{var t;let{session:n,onChange:i=()=>{}}=e,{i18n:r}=(0,g.B)(),s=(0,k.A)(),a=(0,f.useRef)(null),o=(0,f.useRef)(null),[d,c]=(0,f.useState)(null!=(t=n.sessionInfo)?t:{day:"*",hour:"*",minute:"0"});(0,f.useEffect)(()=>{"object"==typeof n.sessionInfo&&null!==n.sessionInfo&&c(structuredClone(n.sessionInfo))},[n.sessionInfo]);let u=(e,t)=>{null!==a.current&&window.clearTimeout(a.current),c(n=>{let l=structuredClone(n);do{let n=e.match(/^(day|hour|minute)\-type$/);if(n){if("all"===t){l[n[1]]="*";break}if("modulo"===t){l[n[1]]="%2";break}if("list"===t){l[n[1]]="day"===n[1]?"1":"0";break}if("day"===n[1]&&"dayofweek"===t){l[n[1]]="w1";break}}if(["day","hour","minute"].includes(e)){if(Array.isArray(t)){(t=t.map(e=>parseInt(e,10)).filter(e=>Number.isInteger(e)&&e>=0)).length&&(l[e]="w"===l[e][0]?"w".concat(t.join(",")):t.join(","));break}if("%"===l[e][0]){let n="day"===e?31:"hour"===e?23:59;(!Number.isInteger(t=parseInt(t,10))||t<2)&&(t=2),t>n&&(t=n),l[e]="%".concat(t)}}}while(!1);return a.current=window.setTimeout(async()=>{i(l),a.current=null},450),l})},p=e=>{let t=[];for(let n of o.current.querySelectorAll("[name=".concat(e,"][type=checkbox]")))n.checked&&t.push(n.value);u(e,t)},x=[{key:"day",label:r.t("Days"),icon:(0,l.jsx)(l2.A,{})},{key:"hour",label:r.t("Hours"),icon:(0,l.jsx)(l3.A,{})},{key:"minute",label:r.t("Minutes"),icon:(0,l.jsx)(l5.A,{})}],h=[r.t("Monday"),r.t("Tuesday"),r.t("Wednesday"),r.t("Thursday"),r.t("Friday"),r.t("Saturday"),r.t("Sunday")];return(0,l.jsx)(S.A,{ref:o,children:x.map(e=>{let t=null,n=(()=>{var n;let l=null!=(n=d[e.key])?n:"";if("*"===l)return"all";if("%"===l[0]){let e=Math.abs(parseInt(l.substring(1),10));if(Number.isInteger(e)&&e>=2)return t=e,"modulo"}if(l.match(/^\d+(?:,\d+)*?$/)){let e=l.split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e));if(e.length)return t=e,"list"}if("day"===e.key&&l.match(/^w\d+(?:,\d+)*?$/)){let e=l.substring(1).split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e)&&e>=1&&e<=7);if(e.length)return t=e,"dayofweek"}})();return(0,l.jsxs)(S.A,{sx:{mb:4,width:"100%"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",width:"100%"},children:[(0,l.jsxs)(e6.A,{fullWidth:!0,children:[(0,l.jsx)(l1.A,{sx:{px:2,background:s.palette.background.paper,ml:-1},children:e.label}),(0,l.jsxs)(lm.A,{name:"".concat(e.key,"-type"),value:null!=n?n:"",required:!0,startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:-1},children:e.icon}),onChange:t=>u("".concat(e.key,"-type"),t.target.value),fullWidth:!0,children:[(0,l.jsx)(eH.A,{value:"all",children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?r.t("Every day"):"hour"===e.key?r.t("Every hour"):r.t("Every minute")})}),(0,l.jsx)(eH.A,{value:"modulo",children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?r.t("Every n days of the month"):"hour"===e.key?r.t("Every n hours"):r.t("Every n minutes")})}),(0,l.jsx)(eH.A,{value:"list",children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?r.t("Specific days of the month"):"hour"===e.key?r.t("Specific hours"):r.t("Specific minutes")})}),"day"===e.key?(0,l.jsx)(eH.A,{value:"dayofweek",children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:r.t("Specific days of the week")})}):null]})]}),"modulo"===n?(0,l.jsx)(eE.A,{fullWidth:!0,sx:{ml:3},name:e.key,type:"number",inputMode:"numeric",onChange:t=>u(e.key,t.target.value),inputProps:{min:2,max:"day"===e.key?31:"hour"===e.key?23:59},value:t}):null]}),"all"===n?(0,l.jsx)("input",{type:"hidden",name:e.key,value:"*"}):null,"list"===n?(0,l.jsx)(S.A,{sx:{px:4,mb:4},children:[...Array("day"===e.key?31:"hour"===e.key?24:60).keys()].map(n=>{let i="day"===e.key?n+1:n,r="day"===e.key?"".concat(i):"".concat(i).padStart(2,"0");return(0,l.jsx)(lf.A,{label:r,sx:{mr:4,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi"}},control:(0,l.jsx)(ly.A,{inputProps:{name:e.key},value:i,checked:(Array.isArray(t)?t:[]).includes(i),onChange:()=>p(e.key)})},"".concat(e.key,"-").concat(i))})}):null,"dayofweek"===n?(0,l.jsx)(S.A,{sx:{px:4,mb:4},children:[...Array(7).keys()].map(n=>{let i=n+1,r=h[n];return(0,l.jsx)(lf.A,{label:r,sx:{mr:4,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi",userSelect:"none"}},control:(0,l.jsx)(ly.A,{inputProps:{name:e.key},value:i,checked:(Array.isArray(t)?t:[]).includes(i),onChange:()=>p(e.key)})},"".concat(e.key,"-").concat(i))})}):null]},e.key)})})},l6=e=>{let{agentId:t,session:n,fetchAll:i=()=>{}}=e,r=async e=>{var l;"string"==typeof t&&(await (null==(l=window.sdk)?void 0:l.ipc.session.updateInfo(t,n.sessionId,e)),await i())},s=async e=>{await r({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes()})},a=async e=>{await r(e)};return(0,l.jsx)(S.A,{sx:{width:"100%"},children:"schedule"===n.sessionType?(0,l.jsx)(lQ,{children:(0,l.jsx)(lZ(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:new Date(n.sessionInfo.year,n.sessionInfo.month-1,n.sessionInfo.day,n.sessionInfo.hour,n.sessionInfo.minute),minDate:new Date,dateFormat:"MMMM d @ HH:mm",onChange:e=>s(e),customInput:(0,l.jsx)(eE.A,{fullWidth:!0,InputProps:{id:"session-info",startAdornment:(0,l.jsx)(eR.A,{position:"start",children:(0,l.jsx)(l0.A,{sx:{mr:-3}})})}})})}):(0,l.jsx)(l4,{session:n,onChange:e=>a(e)})})},l7=e=>{var t;let{agentId:n,session:i,fetchAll:r=()=>{}}=e,s=(0,f.useRef)(null),a=(0,f.useRef)(null),o=async e=>{null!==s.current&&window.clearTimeout(s.current),s.current=window.setTimeout(async()=>{var t;if("string"!=typeof n||"string"!=typeof(null==i?void 0:i.sessionId))return;let l=await (null==(t=window.sdk)?void 0:t.ipc.session.updateName(n,i.sessionId,e));a.current.value=l,await r(),s.current=null},450)};return(0,l.jsx)(S.A,{sx:{width:"100%"},children:(0,l.jsx)(eE.A,{inputRef:a,id:"session-name",InputLabelProps:{shrink:!0},InputProps:{startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:-1},children:(0,l.jsx)(eQ.A,{})})},onChange:e=>o(e.target.value),type:"string",fullWidth:!0,inputMode:"text",inputProps:{maxLength:32},defaultValue:null!=(t=null==i?void 0:i.sessionName)?t:""})})},l8=e=>{var t;let{field:n}=e,[i,r]=(0,f.useState)({}),s=i[n.key];return(0,l.jsx)(S.A,{sx:{display:"flex",width:"250px",flex:"0 0 250px",flexDirection:"column",justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"},children:(0,l.jsxs)(S.A,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,l.jsx)(S.A,{sx:{width:"30px",height:"30px",mr:2},children:n.desc?(0,l.jsx)(e_.A,{size:"small",onClick:()=>(e=>{r(t=>({...t,[e]:!t[e]}))})(n.key),children:s?(0,l.jsx)(nQ.A,{fontSize:"small"}):(0,l.jsx)(tp.A,{fontSize:"small"})}):null}),(0,l.jsx)(lg.A,{htmlFor:"session-".concat(n.key),sx:{cursor:"name"===(null==n?void 0:n.key)?"pointer":"default"},children:(0,l.jsx)(C.A,{variant:"body2",children:null!=(t=n.name)?t:n.key})})]}),n.desc&&s?(0,l.jsx)(C.A,{variant:"caption",component:"pre",sx:{wordBreak:"break-word",whiteSpace:"preserve",fontFamily:"Yaldevi",mt:2,pl:2},children:n.desc}):null]})})},l9=e=>{let{agents:t,sessionType:n="schedule"}=e,{getAgentId:i,onAgentId:r,onMachineStatus:s,getMachineStatus:o}=(0,h.P)(),{i18n:d}=(0,g.B)(),[c,u]=(0,f.useState)(!1),[p,m]=(0,f.useState)(null),[y,A]=(0,f.useState)(null),[j,v]=(0,f.useState)(null),[w,b]=(0,f.useState)(""),[k,T]=(0,f.useState)(10),[z,D]=(0,f.useState)(!1),[P,R]=(0,f.useState)(null),[_,M]=(0,f.useState)([]),N=(0,f.useRef)(null),O=(0,f.useRef)(null),U=async()=>{var e;if("string"!=typeof(null==P?void 0:P.id))return;let t=await (null==(e=window.sdk)?void 0:e.ipc.session.readAll(P.id,n));M((Array.isArray(t)?t:[]).map(e=>"object"!=typeof e||"object"!=typeof(null==e?void 0:e.sessionInfo)?null:(e.sessionDescription=((e,t,n)=>{if("schedule"===t){if(!Number.isInteger(e.year)||!Number.isInteger(e.month)||!Number.isInteger(e.day)||!Number.isInteger(e.hour)||!Number.isInteger(e.minute))return n.t("Does not run");let t=new Date(e.year,e.month-1,e.day,e.hour,e.minute).getTime(),l=nh(t,"en",{month:"long",day:"numeric"}),i=nh(t,"en",{hour:"2-digit",minute:"2-digit",hour12:!1});return"".concat(l," @ ").concat(i)}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=null;do{if("string"!=typeof e)break;if("*"===e){l=t?n.t("every hour"):n.t("every minute");break}if("%"===e[0]){let i=Math.abs(parseInt(e.substring(1),10));i>=2&&i<=1e3&&(l=t?n.t("every {{numModulo}} hours",{numModulo:i}):n.t("every {{numModulo}} minutes",{numModulo:i}));break}if(e.match(/^\d+(?:,\d+)*?$/)){let i=e.split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e)).map(e=>"".concat(e).padStart(2,"0"));i.length&&(l=t?i.length>1?n.t("hours {{list}}",{list:i.join(", ")}):n.t("hour {{value}}",{value:i[0]}):i.length>1?n.t("minutes {{list}}",{list:i.join(", ")}):n.t("minute {{value}}",{value:i[0]}));break}}while(!1);return l},i=[(e=>{let t=null;do{if("string"!=typeof e)break;if("*"===e){t=n.t("Every day");break}if("%"===e[0]){let l=Math.abs(parseInt(e.substring(1),10));l>=2&&l<=1e3&&(t=n.t("Every {{numModulo}} days of the month",{numModulo:l}));break}if(e.match(/^\d+(?:,\d+)*?$/)){let l=e.split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e));l.length&&(t=1===l.length?n.t("Day {{n}} of every month",{n:l[0]}):n.t("Days {{list}} of every month",{list:l.join(", ")}));break}if(e.match(/^w\d+(?:,\d+)*?$/)){let l=e.substring(1).split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e)&&e>=1&&e<=7),i={1:n.t("Monday"),2:n.t("Tuesday"),3:n.t("Wednesday"),4:n.t("Thursday"),5:n.t("Friday"),6:n.t("Saturday"),7:n.t("Sunday")};l.length&&(t=l.map(e=>i[e]).join(", "));break}}while(!1);return t})(e.day),l(e.hour,!0),l(e.minute)].filter(e=>"string"==typeof e);return 3===i.length?i.join(" @ "):n.t("Does not run")})(e.sessionInfo,n,d),e)).filter(Boolean))};(0,f.useEffect)(()=>{R((0,a.fD)(t,i()));let e=r(e=>{D(!1),u(!1),A(null),v(null),b(""),R((0,a.fD)(t,e))});return()=>{e()}},[t]),(0,f.useEffect)(()=>{N.current=null,O.current=null,D(!1),u(!1),A(null),v(null),b(""),"string"==typeof(null==P?void 0:P.id)&&(async()=>{let{status:e,sessionId:t,sessionType:l}=o(P.id);m(x.A.STATUS_STOPPED!==e&&"string"==typeof t&&l===n?t:null),await U(),window.setTimeout(()=>D(!0),200)})();let e=s(e=>{let{agentId:t,status:l,sessionId:i,sessionType:r}=e;P.id===t&&(m(x.A.STATUS_STOPPED!==l&&"string"==typeof i&&r===n?i:null),window.setTimeout(()=>{U()},750))});return()=>{e()}},[P]);let B=[{field:"sessionReady",width:50,renderHeader:()=>"",headerName:d.t("Status"),renderCell:e=>{let{row:t}=e,n=t.sessionReady?p===t.sessionId?d.t("Running..."):d.t("Ready"):d.t("This session will not run because inputs are missing");return(0,l.jsx)(L.A,{title:n,placement:"top",children:p===t.sessionId?(0,l.jsx)(nG.A,{color:"primary",className:"rotate-360",sx:{ml:-1}}):(0,l.jsx)(lJ.A,{color:t.sessionReady?t.sessionEnabled?"success":"disabled":"warning",sx:{ml:-1},fontSize:"small"})})},valueGetter:e=>{let{row:t}=e;return+!!t.sessionReady}},{field:"sessionEnabled",width:100,headerName:d.t("Enabled"),hideable:!1,renderCell:e=>{let{row:t}=e;return t.sessionReady?(0,l.jsx)(S.A,{sx:{display:"flex",justifyContent:"start",width:"100%"},children:(0,l.jsx)(L.A,{title:t.sessionEnabled?d.t("Disable this session"):d.t("Enable this session"),placement:"top",children:(0,l.jsx)(S.A,{children:(0,l.jsx)(ts.A,{size:"small",disabled:!t.sessionReady,checked:!!t.sessionEnabled,sx:{opacity:t.sessionReady?1:.3},onClick:e=>{e.preventDefault(),e.stopPropagation(),Y(t.sessionId,!t.sessionEnabled)}})})})}):(0,l.jsx)(C.A,{variant:"caption",children:d.t("Not ready")})},valueGetter:e=>{let{row:t}=e;return+!!t.sessionEnabled}},{field:"sessionRuns",minWidth:80,headerName:d.t("Run count"),renderCell:e=>{var t;let{row:n}=e,i=n.sessionRuns?1===n.sessionRuns?d.t("Ran once"):d.t("Ran {{count}} times",{count:n.sessionRuns}):d.t("No runs");return(0,l.jsx)(L.A,{title:i,placement:"top",children:(0,l.jsx)(C.A,{variant:"caption",children:null!=(t=n.sessionRuns)?t:d.t("No runs")})})},valueGetter:e=>{var t;let{row:n}=e;return null!=(t=n.sessionRuns)?t:0}},{field:"sessionName",width:150,headerName:d.t("Session name"),renderCell:e=>{let{row:t}=e;return(0,l.jsx)(L.A,{title:t.sessionName,placement:"top",children:(0,l.jsx)(C.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:ex(t.sessionName,w,i())})})},valueGetter:e=>{let{row:t}=e;return t.sessionName}},{field:"sessionDescription",flex:1,headerName:"schedule"===n?d.t("Session date and time"):d.t("Session cadence"),hideable:!1,renderCell:e=>{let{row:t}=e;return(0,l.jsx)(L.A,{title:t.sessionDescription,placement:"top",children:(0,l.jsx)(C.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:ex(t.sessionDescription,w,i())})})},valueGetter:e=>{let{row:t}=e;return t.sessionDescription}},{width:40,field:"actions",hideable:!1,filterable:!1,headerName:d.t("Actions"),renderHeader:()=>"",renderCell:e=>{let{row:t}=e;return(0,l.jsx)(L.A,{title:d.t("Delete session"),placement:"top",children:(0,l.jsx)(S.A,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsx)(e_.A,{size:"small",onClick:e=>{e.preventDefault(),e.stopPropagation(),v(t.sessionId)},children:(0,l.jsx)(eK.A,{fontSize:"small"})})})})}}],H=async()=>{var e;if("string"!=typeof(null==P?void 0:P.id))return;D(!1);let t=await (null==(e=window.sdk)?void 0:e.ipc.session.create(P.id,P.installedModuleId,n));"string"==typeof t&&(await U(),A(t)),D(!0)},q=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u(!1),v(null),"string"==typeof(null==P?void 0:P.id)&&(D(!1),await (null==(e=window.sdk)?void 0:e.ipc.session.delete(P.id,n,t)),await U(),D(!0))},Y=async(e,t)=>{var n;"string"==typeof(null==P?void 0:P.id)&&await (null==(n=window.sdk)?void 0:n.ipc.session.updateEnabled(P.id,e,t))&&await U()},G="string"==typeof y?_.reduce((e,t)=>t.sessionId===y?t:e,null):null;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.A,{sx:{p:4},children:[(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",justifyContent:"end",alignItems:"center",mb:4},children:[z&&_.length?(0,l.jsx)(S.A,{sx:{width:"200px",height:"30px",mt:"2px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,l.jsx)(nd.A,{fontSize:"small",color:"disabled"}),(0,l.jsx)(eE.A,{inputRef:O,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"}},InputProps:{endAdornment:(0,l.jsx)(eR.A,{position:"end",children:(0,l.jsx)(S.A,{sx:{width:30,height:30},children:w.length?(0,l.jsx)(L.A,{title:d.t("Clear filter"),placement:"top",children:(0,l.jsx)(e_.A,{sx:{width:30,height:30},onClick:()=>{b(""),null!==O.current&&(O.current.value="")},children:(0,l.jsx)(eN.A,{fontSize:"small"})})}):null})})},placeholder:d.t("Filter"),variant:"standard",disabled:!z,onChange:e=>{var t;return t=e.target.value.toLowerCase(),void(null!==N.current&&window.clearTimeout(N.current),N.current=window.setTimeout(()=>{b(t),N.current=null},450))}})]})}):null,(0,l.jsx)(I.A,{size:"small",startIcon:(0,l.jsx)(ez.A,{}),sx:{height:"32px"},variant:!z||_.length?"outlined":"contained",onClick:H,children:d.t("Add")}),z?_.length?(0,l.jsx)(L.A,{title:d.t("Delete all sessions"),placement:"top",children:(0,l.jsx)(e_.A,{disabled:!z||!_.length,sx:{width:"30px",height:"30px",mx:3},onClick:()=>u(!0),children:(0,l.jsx)(eK.A,{fontSize:"small"})})}):null:(0,l.jsx)($.A,{spacing:0,rounded:!0,sx:{width:"30px",height:"30px",mx:3}})]}),(0,l.jsx)(lN,{sx:{"& .MuiDataGrid-row":{cursor:"pointer"}},onPageSizeChange:e=>T(e),onRowClick:e=>{let{row:t}=e;return A(t.sessionId)},rowsPerPageOptions:[10,25,50,100],disableSelectionOnClick:!0,getRowId:e=>e.sessionId,pageSize:k,columns:B,loading:!z,rows:"string"==typeof w&&w.length?_.filter(e=>Object.values(e).some(e=>"string"==typeof e&&e.toLowerCase().includes(w.toLowerCase()))):_,autoHeight:!0})]}),(0,l.jsxs)(E.Ay,{open:!!(z&&y),anchor:"right",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{top:49,bottom:49,left:251},"& .MuiDrawer-paper":{width:"calc(100% - 51px)"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute"}},onClose:()=>A(null),children:[(0,l.jsx)(F,{icon:"schedule"===n?(0,l.jsx)(n1.A,{}):(0,l.jsx)(nW.A,{}),title:"schedule"===n?d.t("Edit scheduled run"):d.t("Edit recurring run"),handleClose:()=>A(null)}),y&&null!==G?(0,l.jsx)(W,{sx:{px:0},children:(0,l.jsxs)(S.A,{sx:{position:"relative",width:"100%"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",my:4,px:3},children:[(0,l.jsx)(l8,{field:{key:"name",name:d.t("Session name"),desc:d.t("A name to identify this session later")}}),(0,l.jsx)(l7,{agentId:null==P?void 0:P.id,session:G,fetchAll:U})]}),(0,l.jsxs)(S.A,{sx:{display:"flex",my:4,px:3},children:[(0,l.jsx)(l8,{field:{key:"info",name:"schedule"===n?d.t("Session date and time"):d.t("Session cadence"),desc:"schedule"===n?d.t("When to start this session"):d.t("How often to start this session")}}),(0,l.jsx)(l6,{agentId:null==P?void 0:P.id,session:G,fetchAll:U})]}),(0,l.jsx)(l$,{agents:t,sessionId:y,sessionChange:U})]})}):null,(0,l.jsx)(lR,{children:(0,l.jsx)(I.A,{color:"secondary",onClick:()=>A(null),children:d.t("Close")})})]}),z&&c?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>u(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eW.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:d.t("Delete all")}),(0,l.jsx)(eF.A,{children:(0,l.jsx)(eM.A,{severity:"warning",children:"schedule"===n?d.t("Are you sure you want to delete all scheduled runs?"):d.t("Are you sure you want to delete all recurring runs?")})}),(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>u(!1),children:d.t("Cancel")}),(0,l.jsx)(I.A,{color:"error",onClick:()=>q(),startIcon:(0,l.jsx)(eK.A,{}),children:d.t("Delete all")})]})]}):null,z&&null!==j?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>v(null),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eW.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:"schedule"===n?d.t("Delete scheduled run"):d.t("Delete recurring run")}),(0,l.jsx)(eF.A,{children:(0,l.jsx)(eM.A,{severity:"warning",children:"schedule"===n?d.t("Are you sure you want to delete this scheduled run?"):d.t("Are you sure you want to delete this recurring run?")})}),(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>v(null),children:d.t("Cancel")}),(0,l.jsx)(I.A,{color:"error",onClick:()=>q(j),startIcon:(0,l.jsx)(eK.A,{}),children:d.t("Delete")})]})]}):null]})},ie=(0,b.Ay)(S.A)(e=>{let{theme:t,bordered:n="false"}=e;return{display:"flex",width:"100%",height:"50px",alignItems:"center",borderBottom:"1px solid ".concat("true"===n?t.palette.divider:"transparent"),position:"relative",zIndex:10}}),it=e=>{let{agents:t}=e,{getAgentId:n,onAgentId:i,getInputs:r,onInputs:s,getSource:o,onSource:d}=(0,h.P)(),[c,u]=(0,f.useState)("manual"),[p,x]=(0,f.useState)([]),[m,g]=(0,f.useState)({}),[y,A]=(0,f.useState)(null);(0,f.useEffect)(()=>{null!==y&&(async()=>{var e;let t=await o(n(),!0);x(null!=(e=null==t?void 0:t.srcInputs)?e:[]),g(await r(y.id))})();let e=d(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==y?void 0:y.id)){var l;x(null!=(l=null==n?void 0:n.srcInputs)?l:[])}}),t=s(e=>{let{agentId:t,inputs:n,inputSessionId:l}=e;(null==y?void 0:y.id)===t&&null===l&&g(n)});return()=>{e(),t()}},[y]),(0,f.useEffect)(()=>{A((0,a.fD)(t,n()));let e=i(e=>A((0,a.fD)(t,e)));return()=>e()},[t]);let j=[{value:"manual",label:"Manual run",Icon:n0.A,incomplete:!(0,a.qH)(p,m)},{value:"cron",label:"Recurring runs",Icon:nW.A},{value:"schedule",label:"Scheduled runs",Icon:n1.A}];return(0,l.jsxs)(S.A,{sx:{width:"100%",height:"100%",position:"relative"},children:[(0,l.jsx)(ie,{bordered:"manual"!==c||p.length?"true":null,children:(0,l.jsx)(S.A,{sx:{display:"flex",width:"100%",justifyContent:"end",mr:3},children:(0,l.jsx)(lm.A,{sx:{height:50,ml:5,mr:1,"&.MuiInput-root:before":{display:"none"}},inputProps:{sx:{pl:2}},variant:"standard",onChange:e=>u(e.target.value),value:c,children:j.map(e=>{let{value:t,label:n,Icon:i}=e;return(0,l.jsx)(eH.A,{value:t,sx:{py:0},children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",p:0,height:40,position:"relative"},children:[void 0!==i?(0,l.jsx)(i,{fontSize:"small"}):null,(0,l.jsx)(C.A,{variant:"caption",color:"inherit",sx:{mx:3},children:n})]})},t)})})})}),(0,l.jsx)(S.A,{sx:{height:"calc(100% - 50px)",width:"100%",display:"flex",flexDirection:"column",overflowX:"hidden",p:3},children:"manual"===c?(0,l.jsx)(l$,{agents:t}):(0,l.jsx)(l9,{agents:t,sessionType:c})})]})};var il=n(56829),ii=n(48305),ir=n(12629);let is=e=>{let{runsAll:t=[],runsFiltered:n=[],runsExcluded:i=[],open:r=!1,loaded:s=!1,onClose:o=()=>{},onDelete:d=async()=>{},status:c=x.A.STATUS_STOPPED}=e,{setFiltersRuns:u,getAgentId:p}=(0,h.P)(),{i18n:m}=(0,g.B)(),f=(0,k.A)(),y=0===i.length?ii.A:n.length>=t.length?il.A:ir.A,A=e=>{i.includes(e)?i=i.filter(t=>t!==e):i.push(e),u(p(),i)},j=async e=>{x.A.STATUS_STOPPED===c&&("function"==typeof d&&await d(e),i=i.filter(t=>t!==e),u(p(),i))};return(0,l.jsx)(E.Ay,{open:r,anchor:"left",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{position:"absolute"}},PaperProps:{sx:{position:"absolute"}},onClose:o,children:(0,l.jsxs)(S.A,{sx:{width:240,flexDirection:"column",position:"relative",zIndex:1,height:"100%",ml:1},children:[(0,l.jsxs)(S.A,{sx:{px:1,width:"100%",height:50,display:"flex",justifyContent:"space-between",alignItems:"center",background:f.palette.background.paper,zIndex:1},children:[(0,l.jsx)(L.A,{title:0===i.length?m.t("Deselect all"):m.t("Select all"),placement:"right",children:(0,l.jsx)(S.A,{children:(0,l.jsx)(e_.A,{disabled:!s,onClick:()=>{if(0===i.length)return void u(p(),t.filter(e=>!n.includes(e)));u(p(),[])},sx:{width:40,height:40},children:(0,l.jsx)(y,{})})})}),(0,l.jsx)(L.A,{title:m.t("Close"),placement:"right",children:(0,l.jsx)(e_.A,{onClick:o,sx:{width:40,height:40},children:(0,l.jsx)(O.A,{})})})]}),(0,l.jsx)(S.A,{sx:{width:"100%",minHeight:50,height:"calc(100% - 50px)",p:1,overflowY:"auto"},children:Array.isArray(t)&&t.length?t.map(e=>{let t=(0,a.u0)(e),r=parseInt("".concat(e).trim().split("-").pop(),10),o=n.includes(e)&&!i.includes(e);return(0,l.jsxs)(S.A,{sx:{my:1,display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center","& .MuiIconButton-root":{opacity:0},"&:hover .MuiIconButton-root":{opacity:1}},children:[(0,l.jsx)(L.A,{title:o?m.t("Run excluded by filters"):null,placement:"left",children:(0,l.jsxs)(S.A,{sx:{userSelect:"none",display:"flex",alignItems:"center"},children:[(0,l.jsx)(ly.A,{disabled:!s||o,checked:!n.includes(e),onClick:()=>A(e)}),s?(0,l.jsx)(C.A,{onClick:()=>s&&!o&&A(e),variant:"caption",sx:{fontFamily:"Inconsolata,monospace",...o?{textDecoration:"line-through"}:{cursor:"pointer"}},children:isNaN(r)?e:(0,l.jsx)(lD,{time:r,sessionId:t})}):(0,l.jsx)(S.A,{sx:{width:200,height:20},children:(0,l.jsx)($.A,{spacing:0})})]})}),(0,l.jsx)(L.A,{title:m.t("Delete run"),placement:"right",children:(0,l.jsx)(e_.A,{onClick:()=>j(e),disabled:!s||x.A.STATUS_STOPPED!==c,sx:{width:40,height:40},children:(0,l.jsx)(eK.A,{fontSize:"small"})})})]},e)}):(0,l.jsx)(eM.A,{variant:"info",children:m.t("No runs found")})})]})})};var ia=n(76090),io=n(11422),id=n(41618),ic=n(9004),iu=n(72928),ip=n(39743),ix=n(67922);let ih=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",width:"240px",flex:"0 0 240px",height:"50px",marginLeft:t.spacing(1)}}),im=(0,b.Ay)(S.A)(()=>({display:"flex",width:"100%"})),ig=(0,b.Ay)(S.A)(e=>{let{theme:t,bordered:n="false"}=e;return{display:"flex",width:"100%",height:"50px",alignItems:"center",borderBottom:"1px solid ".concat("true"===n?t.palette.divider:"transparent")}}),iy=e=>{let{startTime:t=null,endTime:n=null,setStartTime:i=()=>{},setEndTime:r=()=>{},loaded:s=!1,runsToggle:a=()=>{},showFilters:o=!1,runsFiltered:d=0,runsTotal:c=0,runsLoaded:u=0}=e,{getFilters:p,setFiltersFields:x,getAgentId:m}=(0,h.P)(),{i18n:y}=(0,g.B)(),[A,j]=(0,f.useState)("today"),v=p(m()).fields,w=[{value:"today",title:y.t("Today"),Icon:ix.A},{value:"yesterday",title:y.t("Yesterday"),Icon:io.A},{value:"last-7",title:y.t("Last 7 days"),Icon:ip.A},{value:"last-30",title:y.t("Last 30 days"),Icon:iu.A},{value:"custom",title:y.t("Custom"),Icon:ic.A}],b=u-d.length,k="object"==typeof v&&null!=v?Object.keys(v).length:0;return(0,l.jsxs)(ig,{bordered:u>0?"true":"false",children:[(0,l.jsx)(ih,{sx:{justifyContent:"space-between",alignItems:"center"},children:o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",ml:2},children:(0,l.jsx)(L.A,{title:y.t("Manually exclude runs from the current report"),children:(0,l.jsx)(I.A,{onClick:a,size:"small",startIcon:(0,l.jsx)(id.A,{fontSize:"small"}),children:y.t("Runs list")})})}),k>0?(0,l.jsx)(L.A,{title:y.t("Clear all filters"),children:(0,l.jsx)(e_.A,{color:"warning",sx:{width:30,height:30},onClick:()=>x(m(),{}),children:(0,l.jsx)(ia.A,{fontSize:"small"})})}):null]}):null}),(0,l.jsxs)(im,{sx:{justifyContent:"end",alignItems:"center",mr:3},children:[s?(0,l.jsx)(L.A,{title:"".concat(y.t("Runs shown: {{runsShown}} of {{runsLoaded}}",{runsShown:b,runsLoaded:u})).concat(0===k?" "+y.t("(no filters)"):"").concat(c>u?". "+y.t("{{runsTotal}} runs were found for this interval, but only the last {{runsLoaded}} runs are shown.",{runsLoaded:u,runsTotal:c}):""),children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",height:"30px"},children:(0,l.jsxs)(C.A,{sx:{color:c>u?"warning.main":"inherit",userSelect:"none",fontSize:"0.75rem",mr:2},children:["".concat(b," / ").concat(u),c>u?" (".concat(c,")"):""]})})}):null,s&&"custom"===A?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L.A,{title:y.t("Start time"),children:(0,l.jsx)(lQ,{children:(0,l.jsx)(lZ(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:new Date(Number.isInteger(t)?1e3*t:Date.now()-864e5),dateFormat:"yyyy-MM-dd HH:mm",onChange:e=>(e=>{e instanceof Date&&i(Math.floor(e.getTime()/1e3))})(e),customInput:(0,l.jsx)(eE.A,{sx:{width:160,"& .MuiInput-input":{height:50,py:0,px:2,textAlign:"center",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},variant:"standard"})})})}),(0,l.jsx)(C.A,{variant:"caption",children:(0,l.jsx)(lT.A,{fontSize:"small",sx:{mt:2}})}),(0,l.jsx)(L.A,{title:y.t("End time"),children:(0,l.jsx)(lQ,{children:(0,l.jsx)(lZ(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:Number.isInteger(n)?new Date(1e3*n):new Date,dateFormat:"yyyy-MM-dd HH:mm",onChange:e=>(e=>{e instanceof Date&&r(Math.floor(e.getTime()/1e3))})(e),customInput:(0,l.jsx)(eE.A,{sx:{width:160,"& .MuiInput-input":{height:50,py:0,px:2,textAlign:"center",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},variant:"standard"})})})})]}):null,(0,l.jsx)(lm.A,{sx:{height:50,ml:5,mr:1,"&.MuiInput-root:before":{display:"none"}},inputProps:{sx:{pl:2}},variant:"standard",onChange:e=>(e=>{j(e);let t=Math.floor(new Date().setHours(0,0,0,0)/1e3);switch(e){case"today":i(t),r(null);break;case"yesterday":i(t-86400),r(t-1);break;case"last-7":i(t-604800),r(null);break;case"last-30":i(t-2592e3),r(null)}})(e.target.value),value:A,children:w.map(e=>{let{value:t,title:n,Icon:i}=e;return(0,l.jsx)(eH.A,{value:t,sx:{py:0},children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",p:0,height:40},children:[void 0!==i?(0,l.jsx)(i,{fontSize:"small"}):null,(0,l.jsx)(C.A,{variant:"caption",color:"inherit",sx:{mx:2},children:n})]})},t)})})]})]})},iA=e=>{let{field:t,loaded:n=!1}=e,{getFilters:i,setFiltersFields:r,getAgentId:s}=(0,h.P)(),{i18n:a}=(0,g.B)(),o=i(s()).fields,d="object"==typeof o&&null!==o&&"boolean"==typeof o[t.key]?o[t.key]:null,c=e=>{if("object"!=typeof o||null===o)return;let n=structuredClone(o);o[t.key]!==e?n[t.key]=!!e:delete n[t.key],r(s(),n)};return"boolean"===t.type?(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(L.A,{title:a.t("Filter by boolean value"),children:(0,l.jsx)(nd.A,{fontSize:"small",sx:{ml:1,mr:2},color:null!==d?"inherit":"disabled"})}),(0,l.jsxs)(lb.A,{size:"small",children:[(0,l.jsx)(I.A,{disabled:!n,onClick:()=>c(!0),variant:!0===d?"contained":"outlined",children:a.t("true")}),(0,l.jsx)(I.A,{disabled:!n,onClick:()=>c(!1),variant:!1===d?"contained":"outlined",children:a.t("false")})]})]}),null!==d?(0,l.jsx)(L.A,{title:a.t("Clear filter"),children:(0,l.jsx)(e_.A,{color:"warning",sx:{width:30,height:30},onClick:()=>{if("object"!=typeof o||null===o||void 0===o[t.key])return;let e=structuredClone(o);delete e[t.key],r(s(),e)},children:(0,l.jsx)(eN.A,{fontSize:"small"})})}):null]}):null},ij=e=>{let{field:t,loaded:n=!1}=e,{getFilters:i,setFiltersFields:r,onFilters:s,getAgentId:a}=(0,h.P)(),{i18n:o}=(0,g.B)(),d=(0,f.useRef)(null),[c,u]=(0,f.useState)(i(a())),[p,x]=(0,f.useState)("");return(0,f.useEffect)(()=>{let e=s(e=>{let{agentId:t,filters:n}=e;a()===t&&u(n)});return()=>{e()}},[]),(0,f.useEffect)(()=>{x("object"==typeof(null==c?void 0:c.fields)&&null!==c.fields&&"string"==typeof c.fields[t.key]?c.fields[t.key]:"")},[c]),"string"===t.type?(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(L.A,{title:o.t("Filter by text value"),children:(0,l.jsx)(nd.A,{fontSize:"small",sx:{ml:1,mr:2},color:p.length?"inherit":"disabled"})}),(0,l.jsx)(eE.A,{sx:{width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},placeholder:o.t("Filter"),variant:"standard",disabled:!n,value:p,onChange:e=>(e=>{x(e),null!==d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{"object"==typeof c.fields&&null!==c.fields&&(r(a(),{...c.fields,[t.key]:e}),d.current=null)},450)})(e.target.value.toLowerCase()),InputProps:{endAdornment:(0,l.jsx)(eR.A,{position:"end",children:(0,l.jsx)(S.A,{sx:{width:30,height:30},children:p.length?(0,l.jsx)(L.A,{title:o.t("Clear filter"),children:(0,l.jsx)(e_.A,{color:"warning",sx:{width:30,height:30},onClick:()=>{if("object"!=typeof c.fields||null===c.fields||void 0===c.fields[t.key])return;x("");let e=structuredClone(c.fields);delete e[t.key],r(a(),e)},children:(0,l.jsx)(eN.A,{fontSize:"small"})})}):null})})}})]})}):null},iv=e=>{let{field:t,loaded:n=!1}=e,{getFilters:i,setFiltersFields:r,onFilters:s,getAgentId:a}=(0,h.P)(),{i18n:o}=(0,g.B)(),d=(0,f.useRef)(null),c=(0,f.useRef)(null),[u,p]=(0,f.useState)(i(a())),[x,m]=(0,f.useState)(""),[y,A]=(0,f.useState)("");(0,f.useEffect)(()=>{let e=s(e=>{let{agentId:t,filters:n}=e;a()===t&&p(n)});return()=>{e()}},[]),(0,f.useEffect)(()=>{let e="object"==typeof(null==u?void 0:u.fields)&&null!==u.fields&&"object"==typeof u.fields[t.key]&&null!==u.fields[t.key]?u.fields[t.key]:{min:"",max:""};m(Number.isInteger(e.min)?e.min:""),A(Number.isInteger(e.max)?e.max:"")},[u]);let j=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"min";Number.isInteger(e=parseInt(e,10))||(e="");let l="min"===n?d:c;("min"===n?m:A)(e),null!==l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{"object"==typeof u.fields&&null!==u.fields&&(r(a(),{...u.fields,[t.key]:{min:Number.isInteger(x)?x:"",max:Number.isInteger(y)?y:"",[n]:e}}),l.current=null)},250)};return"int"===t.type?(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(L.A,{title:o.t("Filter by minimum and maximum value"),children:(0,l.jsx)(nd.A,{fontSize:"small",sx:{ml:1,mr:2},color:x||y?"inherit":"disabled"})}),["min","max"].map(e=>(0,l.jsx)(eE.A,{type:"number",variant:"standard",disabled:!n,inputMode:"numeric",value:"".concat("min"===e?x:y),placeholder:"min"===e?o.t("Minimum"):o.t("Maximum"),onChange:t=>j(t.target.value.toLowerCase(),e),sx:{width:"100%",ml:2*("min"!==e),"& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}}},e))]}),Number.isInteger(x)||Number.isInteger(y)?(0,l.jsx)(L.A,{title:o.t("Clear filter"),children:(0,l.jsx)(e_.A,{color:"warning",sx:{width:30,height:30},onClick:()=>{if("object"!=typeof u.fields||null===u.fields||void 0===u.fields[t.key])return;m(""),A("");let e=structuredClone(u.fields);delete e[t.key],r(a(),e)},children:(0,l.jsx)(eN.A,{fontSize:"small"})})}):null]}):null};var iw=n(34007),ib=n(52621),ik=n(67362),iS=n(4069),iC=n(25493),iI=n(40570),iT=n(24788),iz=n(88246);let iD=e=>{let{sx:t={}}=e,{i18n:n}=(0,g.B)();return("object"!=typeof t||null===t)&&(t={}),(0,l.jsx)(S.A,{sx:{width:"100%",minHeight:"3rem",display:"flex",alignItems:"start",borderRadius:1,...t},children:(0,l.jsx)(eM.A,{severity:"info",sx:{width:"100%",px:1},children:(0,l.jsx)(C.A,{color:"inherit",variant:"caption",children:n.t("No data")})})})},iP=e=>{let{active:t,payload:n,coordinate:i}=e,{i18n:r}=(0,g.B)();if(!t||!Array.isArray(n)||!n.length)return null;let{value:s,time:a,sessionId:o}=n[0].payload;return void 0===s||void 0===a?null:(0,l.jsx)(S.A,{sx:{position:"absolute",left:i.x,top:i.y-5,pointerEvents:"none"},children:(0,l.jsx)(L.A,{title:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",flexDirection:"column"},children:[null!==a?(0,l.jsx)(lD,{time:a,sessionId:o,inline:!0}):null,(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[null!==s?s?(0,l.jsx)(e7.A,{fontSize:"small"}):(0,l.jsx)(O.A,{fontSize:"small"}):null,(0,l.jsx)(C.A,{variant:"caption",color:"inherit",sx:{ml:2,fontWeight:"bold"},children:null===s?r.t("No data"):s?r.t("true"):r.t("false")})]})]}),arrow:!0,placement:"top",open:!0,children:(0,l.jsx)("div",{style:{width:"1px",height:"1px"}})})})},iR=e=>{let{runs:t=[],loaded:n=!1}=e,i=(0,k.A)(),r=(Array.isArray(t)?t:[]).map(e=>{let t=parseInt(e.runId.replace(/^.*\-(\d+)$/g,"$1"),10);return{time:Number.isInteger(t)?t:null,norm:e.runData?1.6:.6,value:e.runData,run:nm(1e3*t),sessionId:(0,a.u0)(e.runId)}});return n?r.filter(e=>null!==e.value).length?(0,l.jsx)(S.A,{sx:{width:"100%",height:"100px",paddingTop:"10px"},children:(0,l.jsx)(iw.u,{width:"100%",height:100,children:(0,l.jsxs)(ib.E,{data:r,width:"100%",innerRadius:10,barSize:10,margin:{top:5,left:0,right:0,bottom:0},children:[(0,l.jsx)(ik.m,{content:e=>{let{active:t,payload:n,coordinate:i}=e;return(0,l.jsx)(iP,{active:t,payload:n,coordinate:i})}}),(0,l.jsx)(iS.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,l.jsx)(iC.h,{domain:[0,2],tick:{fontSize:11},ticks:[2,1],hide:!0}),(0,l.jsx)(iI.W,{dataKey:"run",tick:{fontSize:11}}),(0,l.jsx)(iT.y,{radius:15,dataKey:"norm",children:r.map((e,t)=>{let n=10*(null!==e.value);return(0,l.jsx)(iz.f,{height:n,width:n,radius:e.value?n:0,fill:null===e.value?i.palette.text.primary:e.value?i.palette.success.main:i.palette.error.main},"cell-".concat(t))})})]})})}):(0,l.jsx)(iD,{sx:{height:"80px"}}):(0,l.jsx)(S.A,{sx:{width:"100%",height:"100px",alignItems:"center",display:"flex",justifyContent:"center"},children:(0,l.jsx)(t5.A,{grey:!0,size:50,className:"zoom-in"})})},i_=e=>{let{field:t,runs:n=[],loaded:i=!1}=e,{getFilters:r,getAgentId:s}=(0,h.P)(),o=r(s()),d="object"==typeof(null==o?void 0:o.fields)&&null!==o.fields&&"string"==typeof o.fields[t.key]?o.fields[t.key]:"",c=(()=>{let e=[];if(Array.isArray(n)){for(let t of n)if("string"==typeof t.runData){let n=parseInt(t.runId.replace(/^.*\-(\d+)$/g,"$1"),10),l=(0,a.u0)(t.runId);e.push({time:Number.isInteger(n)?n:null,string:t.runData,sessionId:l})}}return e})();return i?c.length?(0,l.jsx)(S.A,{sx:{display:"flex",flexDirection:"column",py:2,width:"100%",wordWrap:"break-word",overflowWrap:"anywhere",minHeight:250,maxHeight:360,overflowY:"auto"},children:c.map((e,t)=>{let{time:n,string:i,sessionId:r}=e;return(0,l.jsxs)(S.A,{sx:{display:"flex",mb:2,alignItems:"center"},children:[(0,l.jsx)(eQ.A,{sx:{mr:2},color:"text.primary",fontSize:"small"}),(0,l.jsx)(lD,{time:n,sessionId:r,sx:{mr:2}}),(0,l.jsx)(C.A,{variant:"caption",sx:{whiteSpaceCollapse:"preserve",wordBreak:"break-word",whiteSpace:"pre-wrap"},children:ex(i,d,s(),!0)})]},t)})}):(0,l.jsx)(iD,{}):(0,l.jsx)(S.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(t5.A,{grey:!0,size:50,className:"zoom-in"})})},iE=e=>{let{runs:t=[],loaded:n=!1}=e,{i18n:i}=(0,g.B)(),r=(()=>{let e=[];if(Array.isArray(t))for(let n of t){let t=parseInt(n.runId.replace(/^.*\-(\d+)$/g,"$1"),10),l=(0,a.u0)(n.runId);Array.isArray(n.runData)&&e.push(...n.runData.map(e=>Number.isInteger(t)?{filePath:e,runTime:t,sessionId:l}:e))}return e})();return n?r.length?(0,l.jsx)(lG,{multiple:!0,filePaths:r,sx:{minHeight:"250px",maxHeight:"360px"},tooltip:i.t("Up to {{count}} files are shown per run",{count:v().max.sourceCode.ioOutputFileCount})}):(0,l.jsx)(iD,{}):(0,l.jsx)(S.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(t5.A,{grey:!0,size:50,className:"zoom-in"})})},iM=e=>{var t;let{field:n,runs:i=[],loaded:r=!1}=e,s=(0,f.useMemo)(()=>(Array.isArray(i)?i:[]).map(e=>null==e?void 0:e.runId),[null==i||null==(t=i.map)?void 0:t.call(i,e=>null==e?void 0:e.runId).join(",")]);return r?s.length?(0,l.jsx)(lH,{fieldKey:n.key,fieldName:n.name,fieldColumns:n.columns,runIds:s}):(0,l.jsx)(iD,{}):(0,l.jsx)(S.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(t5.A,{grey:!0,size:50,className:"zoom-in"})})};var iN=n(1676);let iL=e=>{let{active:t,payload:n,coordinate:i}=e;if(!t||!Array.isArray(n)||!n.length)return null;let{value:r,time:s,sessionId:a}=n[0].payload;return void 0===r||void 0===s?null:(0,l.jsx)(S.A,{sx:{position:"absolute",left:i.x,top:i.y-5,pointerEvents:"none"},children:(0,l.jsx)(L.A,{title:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",flexDirection:"column"},children:[null!==s?(0,l.jsx)(lD,{time:s,sessionId:a,inline:!0}):null,(0,l.jsx)(C.A,{variant:"caption",color:"inherit",sx:{fontWeight:"bold"},children:new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)})]}),arrow:!0,placement:"top",open:!0,children:(0,l.jsx)("div",{style:{width:"1px",height:"1px"}})})})},iO=e=>{let{runs:t=[],loaded:n=!1}=e,i=(0,k.A)(),r={min:0,max:0},s=(Array.isArray(t)?t:[]).map(e=>{let t=parseInt(e.runId.replace(/^.*\-(\d+)$/g,"$1"),10);return r.min>e.runData&&(r.min=e.runData),r.max<e.runData&&(r.max=e.runData),{time:Number.isInteger(t)?t:null,value:e.runData,run:nm(1e3*t),sessionId:(0,a.u0)(e.runId)}});return n?s.filter(e=>null!==e.value).length?(0,l.jsx)(iw.u,{width:"100%",height:250,children:(0,l.jsxs)(ib.E,{data:s,width:"100%",innerRadius:10,barSize:5,margin:{top:10,left:0,right:0,bottom:0},children:[(0,l.jsx)(ik.m,{content:e=>{let{active:t,payload:n,coordinate:i}=e;return(0,l.jsx)(iL,{active:t,payload:n,coordinate:i})}}),(0,l.jsx)(iS.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,l.jsx)(iI.W,{dataKey:"run",tick:{fontSize:11}}),(0,l.jsx)(iC.h,{domain:[r.min,r.max],tick:{fontSize:11}}),(0,l.jsx)(iN.e,{y:0,stroke:i.palette.divider}),(0,l.jsx)(iT.y,{radius:10,dataKey:"value",fill:i.palette.text.primary})]})}):(0,l.jsx)(iD,{}):(0,l.jsx)(S.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(t5.A,{grey:!0,size:50,className:"zoom-in"})})},iU=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",width:"240px",flex:"0 0 240px",paddingTop:t.spacing(2),paddingBottom:t.spacing(2),justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"}}),iB=(0,b.Ay)(S.A)(()=>({display:"flex",width:"100%",wordWrap:"break-word",overflowWrap:"anywhere"})),iF=e=>{var t;let{field:n,loaded:i=!1}=e,[r,s]=(0,f.useState)("table"===n.type);return(0,l.jsx)(iU,{children:(0,l.jsxs)(S.A,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"start",alignItems:"center",mb:2},children:[(0,l.jsx)(S.A,{sx:{width:"30px",height:"30px",mr:1},children:n.desc?(0,l.jsx)(e_.A,{size:"small",onClick:()=>(n.key,s(e=>!e)),children:r?(0,l.jsx)(nQ.A,{fontSize:"small"}):(0,l.jsx)(tp.A,{fontSize:"small"})}):null}),(0,l.jsx)(C.A,{variant:"body2",children:null!=(t=n.name)?t:n.key})]}),"int"===n.type?(0,l.jsx)(iv,{field:n,loaded:i}):null,"string"===n.type?(0,l.jsx)(ij,{field:n,loaded:i}):null,"boolean"===n.type?(0,l.jsx)(iA,{field:n,loaded:i}):null,n.desc&&r?(0,l.jsx)(C.A,{variant:"caption",component:"pre",sx:{mt:2,pl:2,wordBreak:"break-word",whiteSpace:"preserve",fontFamily:"Yaldevi"},children:n.desc}):null]})})},iW=e=>{var t;let{field:n,runs:i=[],loaded:r=!1}=e;return"files"!==n.type||null==(t=n.visible)||t?(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",mb:3},children:[(0,l.jsx)(iF,{field:n,loaded:r}),(0,l.jsxs)(iB,{children:["int"===n.type?(0,l.jsx)(iO,{runs:i,loaded:r}):null,"string"===n.type?(0,l.jsx)(i_,{field:n,runs:i,loaded:r}):null,"boolean"===n.type?(0,l.jsx)(iR,{runs:i,loaded:r}):null,"files"===n.type?(0,l.jsx)(iE,{runs:i,loaded:r}):null,"table"===n.type?(0,l.jsx)(iM,{field:n,runs:i,loaded:r}):null]})]}):null},iH=(0,b.Ay)(S.A)(()=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",zIndex:0})),iq=e=>{var t,n,i,r;let{agents:s}=e,{getAgentId:o,onAgentId:d,getSource:c,onSource:u,onMachineStatus:p,onFilters:m,getFilters:y,onOutputs:A,getMachineStatus:j}=(0,h.P)(),{i18n:v}=(0,g.B)(),w=(0,f.useRef)([]),b=(0,f.useRef)({}),k=(0,f.useRef)([]),C=(0,f.useRef)(null),[I,T]=(0,f.useState)((0,a.fD)(s,o())),[z,D]=(0,f.useState)(x.A.STATUS_STOPPED),[P,R]=(0,f.useState)(!1),[_,E]=(0,f.useState)(null),[M,N]=(0,f.useState)([]),[L,O]=(0,f.useState)(null),[U,B]=(0,f.useState)(null),[F,W]=(0,f.useState)(!1),[H,q]=(0,f.useState)({});(0,f.useEffect)(()=>{T((0,a.fD)(s,o()));let e=d(e=>{W(!1),T((0,a.fD)(s,e))});return()=>e()},[s]),(0,f.useEffect)(()=>{w.current=[],b.current={},k.current=[],"string"==typeof(null==I?void 0:I.id)&&(async()=>{var e,t;k.current=null!=(t=null==(e=await c(I.id,!0))?void 0:e.srcOutputs)?t:[],N(k.current)})();let e=u(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==I?void 0:I.id)){var l,i;JSON.stringify(k.current)!==JSON.stringify(null!=(l=null==n?void 0:n.srcOutputs)?l:[])&&(k.current=null!=(i=null==n?void 0:n.srcOutputs)?i:[],N(k.current))}});return()=>{e()}},[I]),(0,f.useEffect)(()=>{let e=m(e=>{let{agentId:t,filters:n}=e;t===(null==I?void 0:I.id)&&G(n)});K(),D(j(null==I?void 0:I.id).status);let t=p(e=>{let{agentId:t,status:n}=e;t===(null==I?void 0:I.id)&&(D(n),1!==n&&(null===U||U>Math.floor(new Date().getTime()/1e3))&&K(!1))}),n=A(e=>{e===o()&&(null===U||U>Math.floor(new Date().getTime()/1e3))&&K(!1)});return()=>{e(),t(),n()}},[I,L,U]);let Y=async e=>{var t;await (null==(t=window.sdk)?void 0:t.ipc.diskStorage.runDelete(o(),e)),await K()},G=async e=>{var t,n,l,i;w.current=[];let r=await c(o(),!0),s=null!=(i=null==r?void 0:r.srcOutputs)?i:[],a="object"==typeof(null==(t=b.current)?void 0:t.fields)&&null!==(null==(n=b.current)?void 0:n.fields)?null==(l=b.current)?void 0:l.fields:{};if("object"==typeof(null==e?void 0:e.fields)&&null!==(null==e?void 0:e.fields))for(let t of s){if(void 0===e.fields[t.key]||!Array.isArray(a[t.key]))continue;let n=e.fields[t.key];a[t.key].map(e=>{let l=!0;do{if(void 0===e.runData)break;if("int"===t.type&&(Number.isInteger(n.min)&&e.runData<n.min||Number.isInteger(n.max)&&e.runData>n.max)||"string"===t.type&&-1==="".concat(e.runData).toLowerCase().indexOf(n)||"boolean"===t.type&&!!e.runData!==n){l=!1;break}}while(!1);l||w.current.push(e.runId)})}if(Array.isArray(null==e?void 0:e.runs))for(let t of e.runs)"string"==typeof t&&w.current.push(t);w.current=[...new Set(w.current)];let d={};for(let e of s)d[e.key]=(Array.isArray(a[e.key])?a[e.key]:[]).filter(e=>!w.current.includes(e.runId));q(d)},K=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];"string"==typeof o()&&(null!==C.current&&window.clearTimeout(C.current),C.current=window.setTimeout(async()=>{var t,n;window.clearTimeout(C.current);let l=await c(o(),!0);(null!=(n=null==l?void 0:l.srcOutputs)?n:[]).length&&(e&&W(!1),b.current=await (null==(t=window.sdk)?void 0:t.ipc.diskStorage.outputsQuery(o(),null==I?void 0:I.installedModuleId,L,U)),await G(y(o())),e?W(!0):E(new Date().getTime()))},350))},V=Array.isArray(null==(t=b.current)?void 0:t.runIds)?null==(n=b.current)?void 0:n.runIds:[],$=null!=(r=null==(i=b.current)?void 0:i.runIdsTotal)?r:0,J=V.length>0,Q=w.current,X=y(o()).runs;return(0,l.jsx)(iH,{children:(0,l.jsx)(S.A,{sx:{height:"100%",width:"100%"},children:Array.isArray(M)&&M.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(iy,{startTime:L,endTime:U,setStartTime:O,setEndTime:B,loaded:F,runsFiltered:Q,runsTotal:$,runsLoaded:V.length,runsToggle:()=>R(e=>!e),showFilters:J}),J?(0,l.jsx)(is,{runsAll:V,runsFiltered:Q,runsExcluded:X,open:P,loaded:F,status:z,onClose:()=>R(!1),onDelete:Y}):null,(0,l.jsx)(S.A,{sx:{height:"calc(100% - 50px)",width:"100%",display:"flex",flexDirection:"column",overflowX:"hidden",p:3},children:J?M.map(e=>(0,l.jsx)(iW,{field:e,loaded:F,runs:Array.isArray(H[e.key])?H[e.key]:[]},"".concat(e.id,"-").concat(e.type))):F?(0,l.jsx)(lK.default,{title:v.t("No data"),message:v.t("No runs were executed in the specified interval"),sx:{"&.content-center":{minHeight:"100%",overflow:"hidden"}}}):(0,l.jsx)(S.A,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,l.jsx)(t5.A,{grey:!0,size:128,className:"zoom-in"})})})]}):F?(0,l.jsx)(lK.default,{title:v.t("No outputs"),message:v.t("This module has no results to capture and analyze"),sx:{"&.content-center":{minHeight:"100%"}}}):null})},_)},iY=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{background:t.palette.background.paper,position:"relative",overflowY:"auto",height:"100%",width:"100%",zIndex:0}});function iG(e){let{agents:t,agentsReady:n}=e,{getAgentTab:i,onAgentTab:r}=(0,h.P)(),[s,a]=(0,f.useState)("");return(0,f.useEffect)(()=>{a(i());let e=r(e=>a(e));return()=>e()},[t]),s.length?n?(0,l.jsxs)(iY,{children:["settings"===s?(0,l.jsx)(it,{agents:t}):null,"results"===s?(0,l.jsx)(iq,{agents:t}):null]}):null:(0,l.jsx)(lh,{agents:t,agentsReady:n})}var iK=n(97578);let iV=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{width:"100%",height:"40px",position:"relative",display:"flex",alignItems:"center",justifyContent:"start",paddingLeft:t.spacing(2),paddingRight:t.spacing(2),borderRadius:0,textTransform:"none",textAlign:"left"}}),i$=(0,b.Ay)(C.A)(e=>{let{theme:t}=e;return{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"}}),iJ=()=>{var e;let{onUpdaterInfo:t,getUpdaterInfo:n,onUpdaterStatus:i,getUpdaterStatus:r}=(0,h.P)(),{i18n:s}=(0,g.B)(),[a,d]=(0,f.useState)(null),[c,u]=(0,f.useState)(null),[p,x]=(0,f.useState)(!1),[m,y]=(0,f.useState)(!1);(0,f.useEffect)(()=>{u(n());let e=t(e=>{let{info:t}=e;return u(t)});d(r());let l=i(e=>{let{status:t}=e;return d(t)});return(async()=>{var e;return y("linux"===await (null==(e=window.sdk)?void 0:e.ipc.device.getOS()))})(),()=>{e(),l()}},[]),(0,f.useEffect)(()=>{var e;null==(e=window.sdk)||e.ipc.updater.check()},[]),(0,f.useEffect)(()=>{!(null==a?void 0:a.working)&&(null==a?void 0:a.error)&&o.o.error("".concat(s.t("Update cancelled.")," ").concat(a.error),{duration:5e3})},[a]);let A=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),x(!0)},j=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.updater.install()),x(!1)};return(0,l.jsxs)(l.Fragment,{children:[(null==c?void 0:c.version)?(0,l.jsxs)(iV,{children:[!(null==c?void 0:c.filePath)||(null==a?void 0:a.working)?(0,l.jsx)(S.A,{sx:{mr:4},children:(null==a?void 0:a.working)?(0,l.jsx)(nG.A,{className:"rotate-360"}):(0,l.jsx)(tR.A,{color:"primary"})}):null,(0,l.jsx)(S.A,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"start"},children:!(null==c?void 0:c.filePath)||(null==a?void 0:a.working)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i$,{variant:"caption",color:"inherit",children:(null==a?void 0:a.working)?s.t("Updating to v.{{version}}...",{version:c.version}):s.t("Downloading v.{{version}}...",{version:c.version})}),(0,l.jsx)(n$.A,{color:"primary",sx:{mt:1},variant:(null==a?void 0:a.working)?"indeterminate":"determinate",value:(null==a?void 0:a.working)?null:null!=(e=null==c?void 0:c.progress)?e:0})]}):(0,l.jsx)(L.A,{title:s.t("Update to version {{version}}",{version:c.version}),placement:"top",children:(0,l.jsx)(I.A,{fullWidth:!0,size:"small",variant:"outlined",startIcon:(0,l.jsx)(tR.A,{}),onClick:()=>A(),children:s.t("Update")})})})]}):null,(null==c?void 0:c.version)&&p?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>!(null==a?void 0:a.working)&&x(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:1}},children:[(0,l.jsx)(eW.A,{children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(C.A,{variant:"h3",sx:{ml:4},children:(null==a?void 0:a.working)?s.t("Updating to v.{{version}}...",{version:c.version}):s.t("Install update")})})}),(0,l.jsx)(eF.A,{children:(null==a?void 0:a.working)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eM.A,{severity:"warning",sx:{mb:4},children:s.t("Please do not close this window until the update is complete.")}),(0,l.jsx)($.A,{sx:{mb:-4}})]}):(0,l.jsx)(eM.A,{severity:"info",icon:(0,l.jsx)(iK.A,{}),children:m?s.t("Updating to version {{version}} requires root privileges. Please enter your root password in the next dialog.",{version:c.version}):s.t("Update to version {{version}} and restart the application.",{version:c.version})})}),(null==a?void 0:a.working)?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",variant:"text",onClick:()=>x(!1),children:s.t("Cancel")}),(0,l.jsx)(I.A,{size:"small",className:"pop",startIcon:(0,l.jsx)(tR.A,{}),color:"primary",onClick:()=>j(),variant:"contained",children:s.t("Update and restart")})]})]}):null]})};var iQ=n(54989);let iX=e=>{let{isOpen:t=!1,isFirst:n=!1,onOpen:i=()=>{},onClose:r=()=>{},onAgentCreate:s=()=>{}}=e,{i18n:a}=(0,g.B)(),o=(0,f.useRef)(null),[d,c]=(0,f.useState)(!1),[u,p]=(0,f.useState)(n),[x,h]=(0,f.useState)(!1),m={name:e3.Yj().required(a.t("Agent name is required")).min(3,()=>a.t("Must be at least {{n}} characters long",{n:3})).max(64,()=>a.t("Must be at most {{n}} characters long",{n:64}))},{reset:y,control:A,handleSubmit:j,formState:{errors:v}}=(0,e2.mN)({defaultValues:{name:""},mode:"onChange",resolver:(0,e5.t)(e3.Ik().shape(m))}),w=async e=>{let{name:t}=e;h(!0),await s(t),h(!1),r()};(0,f.useEffect)(()=>{t&&"function"==typeof i&&i()},[t]);let b=()=>{t&&"function"==typeof r&&r(),y()},k=()=>{o.current&&o.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return t?(0,l.jsxs)(eY.A,{open:!0,onClose:x?()=>{}:b,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[x?null:(0,l.jsxs)(eW.A,{children:[n?a.t("Add your first agent"):a.t("Add agent"),(0,l.jsx)(e_.A,{"aria-label":a.t("More information"),sx:{ml:2},color:"default",onClick:()=>p(!u),size:"large",children:u?(0,l.jsx)(nQ.A,{}):(0,l.jsx)(tp.A,{})})]}),(0,l.jsxs)(eF.A,{children:[!x&&u?(0,l.jsx)(eM.A,{severity:"success",sx:{mb:6},icon:(0,l.jsx)(iQ.A,{className:"zoom-in"}),children:(0,l.jsx)(C.A,{color:"inherit",variant:"body2",children:a.t("Agents are browser instances that use a bit of AI magic to automate repetitive web tasks that are just too boring for humans.")})}):null,(0,l.jsx)("form",{onSubmit:j(w),ref:o,children:x?(0,l.jsx)(S.A,{sx:{mt:6},children:(0,l.jsx)($.A,{})}):(0,l.jsxs)(e6.A,{fullWidth:!0,sx:{my:3},error:!!v.name,children:[(0,l.jsx)(e2.xI,{name:"name",control:A,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eE.A,{disabled:x,autoFocus:!0,required:!0,value:t,onChange:e=>{c(e.target.value.length>=3),n(e)},onKeyDown:e=>"Enter"===e.key&&k(),spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:0},children:(0,l.jsx)(np.A,{})})},label:a.t("Agent name"),placeholder:a.t("Agent name"),error:!!v.name})}}),v.name&&(0,l.jsx)(e4.A,{sx:{color:"error.main"},children:v.name.message})]})})]}),x?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:b,children:a.t("Cancel")}),d?(0,l.jsx)(I.A,{variant:"contained",className:"pop",onClick:k,endIcon:(0,l.jsx)(lT.A,{}),children:a.t("Next")}):null]})]}):null},iZ=e=>{var t;let{agents:n,isOpen:i=!1,onOpen:r=()=>{},onClose:s=()=>{},onAgentUpdate:o=()=>{}}=e,{i18n:d}=(0,g.B)(),{getAgentId:c,onAgentId:u}=(0,h.P)(),p=(0,f.useRef)(null),[x,m]=(0,f.useState)(!1),[y,A]=(0,f.useState)(!1),[j,v]=(0,f.useState)(!1),[b,k]=(0,f.useState)(!1),[T,z]=(0,f.useState)((0,a.fD)(n,c())),D={name:e3.Yj().required(d.t("Agent name is required")).min(3,()=>d.t("Must be at least {{n}} characters long",{n:3})).max(64,()=>d.t("Must be at most {{n}} characters long",{n:64}))},P={name:null!=(t=null==T?void 0:T.name)?t:""},{reset:R,control:_,handleSubmit:E,formState:{errors:M}}=(0,e2.mN)({defaultValues:P,mode:"onChange",resolver:(0,e5.t)(e3.Ik().shape(D))}),N=async e=>{let{name:t}=e;k(!0);try{var n;await (null==(n=window.sdk)?void 0:n.ipc.main.setOnTop());let e=await w.A.put("agents/".concat(T.id),{name:t});await o(e.data)}catch(e){}k(!1),s()};(0,f.useEffect)(()=>{z((0,a.fD)(n,c()));let e=u(e=>z((0,a.fD)(n,e)));return()=>e()},[n]),(0,f.useEffect)(()=>{i&&"function"==typeof r&&r()},[i]);let L=()=>{i&&"function"==typeof s&&s(),R()},O=()=>{p.current&&p.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return i?(0,l.jsxs)(eY.A,{open:!0,onClose:b?()=>{}:L,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[b?null:(0,l.jsx)(eW.A,{children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(nx,{agent:T,title:d.t("Rename agent")}),(0,l.jsx)(e_.A,{"aria-label":d.t("More information"),sx:{ml:2},color:"default",onClick:()=>A(!y),size:"large",children:y?(0,l.jsx)(nQ.A,{}):(0,l.jsx)(tp.A,{})})]})}),(0,l.jsxs)(eF.A,{children:[!b&&y?(0,l.jsx)(eM.A,{severity:"success",sx:{mb:6},icon:(0,l.jsx)(eQ.A,{}),children:(0,l.jsx)(C.A,{color:"inherit",variant:"body2",children:d.t("Keep agent names short and meaningful.")})}):null,(0,l.jsx)("form",{onSubmit:E(N),ref:p,children:b?(0,l.jsx)(S.A,{sx:{mt:6},children:(0,l.jsx)($.A,{})}):(0,l.jsxs)(e6.A,{fullWidth:!0,sx:{my:3},error:!!M.name,children:[(0,l.jsx)(e2.xI,{name:"name",control:_,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eE.A,{disabled:b,autoFocus:!0,required:!0,value:t,onChange:e=>{m(e.target.value.length>=3),v(e.target.value!==T.name),n(e)},onKeyDown:e=>"Enter"===e.key&&O(),spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:0},children:(0,l.jsx)(np.A,{})})},label:d.t("Agent name"),placeholder:d.t("Agent name"),error:!!M.name})}}),M.name&&(0,l.jsx)(e4.A,{sx:{color:"error.main"},children:M.name.message})]})})]}),b?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:L,children:d.t("Cancel")}),x&&j?(0,l.jsx)(I.A,{variant:"contained",onClick:O,startIcon:(0,l.jsx)(e7.A,{}),children:d.t("Save")}):null]})]}):null},i0=e=>{let{agents:t,isOpen:n=!1,onOpen:i=()=>{},onClose:r=()=>{},onAgentDelete:s=()=>{}}=e,{i18n:o}=(0,g.B)(),{getAgentId:d,onAgentId:c}=(0,h.P)(),[u,p]=(0,f.useState)(!1),[x,m]=(0,f.useState)(!1),[y,A]=(0,f.useState)((0,a.fD)(t,d()));(0,f.useEffect)(()=>{n&&"function"==typeof i&&i()},[n]);let j=()=>{n&&"function"==typeof r&&r()};(0,f.useEffect)(()=>{A((0,a.fD)(t,d()));let e=c(e=>A((0,a.fD)(t,e)));return()=>e()},[t]);let v=e=>{p((null==y?void 0:y.name)===e.target.value)},w=async()=>{if(u){m(!0),p(!1);try{await s(null==y?void 0:y.id)}catch(e){}m(!1),await j()}};return n?(0,l.jsxs)(eY.A,{open:!0,onClose:x?()=>{}:j,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eW.A,{children:(0,l.jsx)(nx,{agent:y,title:o.t("Delete agent")})}),(0,l.jsx)(eF.A,{children:x?(0,l.jsx)($.A,{}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(eM.A,{severity:"warning",sx:{mb:6},children:[o.t("Are you sure you want to delete this agent?")," ",o.t("This action is irreversible!"),(0,l.jsx)("br",{}),o.t('To confirm deleting your agent, please type "{{name}}" below:',{name:null==y?void 0:y.name})]}),(0,l.jsx)(eE.A,{autoFocus:!0,fullWidth:!0,spellCheck:!1,autoComplete:"off",required:!0,inputProps:{tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{mr:0},children:(0,l.jsx)(np.A,{})})},type:"text",color:u?"primary":"error",label:o.t("Agent name"),placeholder:o.t("Agent name"),onChange:v,onKeyUp:v,onKeyDown:e=>"Enter"===e.key&&w()})]})}),x?null:(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:j,children:o.t("Cancel")}),(0,l.jsx)(I.A,{color:"error",onClick:w,disabled:!u,startIcon:(0,l.jsx)(eK.A,{}),children:o.t("Delete agent")})]})]}):null};var i1=n(16084),i2=n(77648),i5=n(32136),i3=n(7827),i4=n(51018);function i6(){let e=(0,tU._)(["0% { opacity: 0 } 100% { opacity: 1 }"]);return i6=function(){return e},e}function i7(){let e=(0,tU._)(["0% { opacity: 0; transform: scale(1.5); } 100% { opacity: 1; transform: scale(1); }"]);return i7=function(){return e},e}let i8=(0,tB.i7)(i6()),i9=(0,tB.i7)(i7()),re=(0,b.Ay)(S.A)(e=>{let{theme:t,color:n}=e;return{display:"flex",position:"absolute",justifyContent:"flex-end",alignItems:"end",top:0,left:0,width:"100%",height:200,zIndex:0,"&:before":{content:'""',display:"block",position:"absolute",background:n,width:"100%",height:"100%",opacity:0,animation:null!==n?"".concat(i8," 1250ms forwards linear"):"none"},"&:after":{content:'""',display:"block",position:"absolute",width:"100%",height:"100%",opacity:0,transform:"scale(1.5)",animation:null!==n?"".concat(i9," 250ms forwards linear"):"none",background:"url(/img/pages/circles-profile-".concat(t.palette.mode,".svg)"),backgroundSize:"auto",backgroundRepeat:"no-repeat",[t.breakpoints.up("xs")]:{backgroundPosition:"50% -600px",transformOrigin:"50% 100%"},[t.breakpoints.up("md")]:{backgroundPosition:"-680px -600px",transformOrigin:"100px 100%"}}}}),rt=e=>{var t,n;let{isOpen:i=!1,onOpen:r=()=>{},onClose:s=()=>{}}=e,{settings:a}=(0,n8.t)(),{i18n:o}=(0,g.B)(),d=(0,m.A)(),c=(0,i1.G)(),u=(0,k.A)(),p=c.getUserData(),[x,h]=(0,f.useState)(null),[y,A]=(0,f.useState)(!0),[j,v]=(0,f.useState)(!1),[b,T]=(0,f.useState)(null),[z,D]=(0,f.useState)(!1);(0,f.useEffect)(()=>{i&&"function"==typeof r&&r()},[i]);let P=()=>{i&&"function"==typeof s&&s()},{control:R,setValue:_,handleSubmit:E,formState:{errors:M}}=(0,e2.mN)({defaultValues:{userName:null!=(t=null==p?void 0:p.userName)?t:o.t("User name")},mode:"onChange",resolver:(0,e5.t)(e3.Ik().shape({userName:e3.Yj().min(3,()=>o.t("Must be at least {{n}} characters long",{n:3})).max(64,()=>o.t("Must be at most {{n}} characters long",{n:64})).required()}))});(0,f.useEffect)(()=>{_("userName",null==p?void 0:p.userName),T(null);let e=setTimeout(async()=>{"string"==typeof u.palette.customColors.userColors.gradient[null==p?void 0:p.userColor]&&T(u.palette.customColors.userColors.gradient[null==p?void 0:p.userColor])},150);return()=>clearTimeout(e)},[a.mode,null==p?void 0:p.userColor,null==p?void 0:p.userName]);let N=e=>{"string"==typeof(null==e?void 0:e.userName)&&(_("userName",e.userName),d.setUser({...d.user,userName:e.userName,userColor:e.userColor,userAvatarId:e.userAvatarId}))},O=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),D(!0)},U=async()=>{P(),d.logout()},B=async e=>{if(y){A(!1);try{var t;let n=await w.A.post("account",e);N(null!=(t=null==n?void 0:n.data)?t:{})}catch(e){}A(!0),v(!1)}},F=async e=>{if(y){A(!1);try{var t;let n=await w.A.post("account",{userColor:e});N(null!=(t=null==n?void 0:n.data)?t:{})}catch(e){}A(!0)}};return i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eY.A,{open:!0,onClose:P,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:750,p:0}},children:(0,l.jsx)(eh.Ay,{container:!0,spacing:6,children:(0,l.jsx)(eh.Ay,{item:!0,xs:12,children:(0,l.jsxs)(ey.A,{sx:{position:"relative"},children:[(0,l.jsx)(re,{color:b}),(0,l.jsx)(i2.A,{sx:{zIndex:10,position:"relative"},action:(0,l.jsxs)(S.A,{sx:{display:"flex"},children:[j&&y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(L.A,{title:o.t("Profile color"),children:(0,l.jsx)(e_.A,{sx:{zIndex:10,background:"light"===u.palette.mode?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)","&:hover":{background:u.palette.background.paper}},onClick:e=>h(e.currentTarget),children:(0,l.jsx)(i3.A,{color:"info"})})}),(0,l.jsx)(eG.A,{keepMounted:!0,anchorEl:x,open:!!x,onClose:()=>h(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{ml:"2px",mt:2},PaperProps:{style:{minWidth:20}},children:Object.keys(u.palette.customColors.userColors.solid).map(e=>(0,l.jsx)(eH.A,{selected:(null==p?void 0:p.userColor)==e,onClick:()=>{h(null),F(e)},children:(0,l.jsx)(S.A,{sx:{width:15,height:15,borderRadius:"50%",background:u.palette.customColors.userColors.solid[e]}})},"user-color-".concat(e)))})]}):null,(0,l.jsx)(L.A,{title:j?o.t("Exit edit mode"):o.t("Edit profile"),children:(0,l.jsx)(e_.A,{sx:{ml:2,background:"light"===u.palette.mode?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)","&:hover":{background:u.palette.background.paper}},variant:"contained",color:"inherit",onClick:()=>{if(!j)return void v(!0);_("userName",p.userName),v(!1)},children:j?(0,l.jsx)(i5.A,{}):(0,l.jsx)(eV.A,{})})})]})}),(0,l.jsxs)(ef.A,{sx:{zIndex:10},children:[(0,l.jsx)("form",{onSubmit:E(B),autoComplete:"off",children:(0,l.jsx)(eh.Ay,{container:!0,spacing:7,sx:{justifyContent:"left"},children:(0,l.jsx)(eh.Ay,{item:!0,xs:12,sx:{my:4,display:"flex"},children:(0,l.jsxs)(S.A,{sx:{display:"flex",width:"100%",alignItems:{xs:"center",md:"flex-end"},flexDirection:{xs:"column",md:"row"}},children:[(0,l.jsx)(tt,{crop:"fill",borderColor:u.palette.background.paper,backgroundColor:u.palette.background.paper,inputName:"avatar",uploadPath:"account/avatar",active:j,label:o.t("Select avatar"),radius:"50%",onChange:async()=>{var e;let t=await w.A.get("account");"string"==typeof(null==(e=t.data)?void 0:e.id)&&d.setUser(t.data)},alt:null!=(n=null==p?void 0:p.userName)?n:o.t("User name"),getSrc:()=>{var e;let t=new Date().toJSON().slice(0,10),n="".concat(eg.A.s3Url,"/users/").concat(null==p?void 0:p.id,"/?cb=").concat(t);return(null==(e=d.user)?void 0:e.id)===(null==p?void 0:p.id)&&(n="string"==typeof(null==p?void 0:p.userAvatarId)?"".concat(eg.A.s3Url,"/users/").concat(p.id,"/").concat(p.userAvatarId,".png"):"/img/placeholder/user.png"),n}}),(0,l.jsx)(S.A,{sx:{ml:{xs:0,md:6},width:"100%",position:"relative"},children:j?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex"},children:[(0,l.jsx)(e2.xI,{name:"userName",control:R,fullWidth:!0,rules:{required:!0},render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eE.A,{sx:{textAlign:"center"},fullWidth:!0,required:!0,spellCheck:!1,autoComplete:"off",autoFocus:!0,disabled:!y,value:t,label:o.t("User name"),onChange:n,placeholder:"John Doe"})}}),(0,l.jsx)(I.A,{variant:"contained",startIcon:(0,l.jsx)(e7.A,{}),sx:{ml:3},type:"submit",disabled:!y,children:o.t("Save")})]}),M.userName&&(0,l.jsx)(e4.A,{sx:{color:"error.main",position:"absolute",bottom:-25},children:M.userName.message})]}):(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(L.A,{title:(null==p?void 0:p.createdAt)?"".concat(o.t("Member since")," ").concat(nh(p.createdAt,a.lang,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})):null,children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"start",flexDirection:"column"},children:[(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(C.A,{variant:"h6",children:p.userName})}),(0,l.jsx)(C.A,{variant:"caption",children:null==p?void 0:p.userEmail})]})})})})]})})})}),(0,l.jsxs)(S.A,{sx:{display:"flex",justifyContent:"end",width:"100%",mt:2},children:[(0,l.jsx)(I.A,{startIcon:(0,l.jsx)(i4.A,{}),onClick:O,color:"error",sx:{mr:2},children:o.t("Log out")}),(0,l.jsx)(I.A,{color:"secondary",onClick:P,children:o.t("Close")})]})]})]})})})}),z?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>D(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eW.A,{children:o.t("Log out")}),(0,l.jsx)(eF.A,{children:(0,l.jsxs)(eM.A,{severity:"warning",children:[o.t("Are you sure you want to log out of this computer?"),(0,l.jsx)("br",{}),o.t("You can reconnect this computer to your account at any time.")]})}),(0,l.jsxs)(eB.A,{children:[(0,l.jsx)(I.A,{color:"secondary",onClick:()=>D(!1),children:o.t("Cancel")}),(0,l.jsx)(I.A,{variant:"text",color:"error",onClick:()=>U(),startIcon:(0,l.jsx)(i4.A,{}),children:o.t("Log out")})]})]}):null]}):null};var rn=n(37277);let rl=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{position:"absolute",right:"-8.75rem",bottom:"-9.75rem",width:"25rem",height:"25rem",zIndex:1,opacity:.1,"&>svg":{position:"relative",width:"100%",height:"100%"}}}),ri=e=>{let{isOpen:t=!1,onOpen:n=()=>{},onClose:i=()=>{}}=e,{i18n:r}=(0,g.B)();(0,f.useEffect)(()=>{t&&"function"==typeof n&&n()},[t]);let s=()=>{t&&"function"==typeof i&&i()};return t?(0,l.jsxs)(eY.A,{open:!0,onClose:s,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:750,p:2,overflow:"hidden"}},children:[(0,l.jsx)(rl,{className:"rotate",children:(0,l.jsx)(rn.A,{})}),(0,l.jsx)(eW.A,{children:r.t("Window restored")}),(0,l.jsx)(eF.A,{children:(0,l.jsxs)(eM.A,{children:[r.t("This window must remain open and visible for the application to function correctly. "),(0,l.jsx)("br",{}),r.t("You can run other applications on top of it, but it cannot be minimized.")]})}),(0,l.jsx)(eB.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(I.A,{color:"secondary",onClick:s,children:r.t("OK")})})]}):null},rr=e=>{let{isOpen:t=!1,onOpen:n=()=>{}}=e;return(0,f.useEffect)(()=>{t&&"function"==typeof n&&n()},[t]),t?(0,l.jsx)(eY.A,{open:!0,sx:{"& .MuiPaper-root":{background:"transparent",boxShadow:"none"}},children:(0,l.jsx)(eF.A,{children:(0,l.jsx)(S.A,{sx:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",opacity:.9},children:(0,l.jsx)(t5.A,{size:192,animate:!0,grey:!0,dark:!1,className:"rotate"})})})}):null},rs=e=>{let{agents:t,onAgentCreate:n,onAgentUpdate:i,onAgentDelete:r}=e,{getAgentId:s,setPageTitle:o,setPageSubtitle:d,getDialogVisible:c,setDialogVisible:u,onDialogVisible:p}=(0,h.P)(),{i18n:x}=(0,g.B)(),[m,y]=(0,f.useState)(!1),[A,j]=(0,f.useState)(!1),[w,b]=(0,f.useState)(!1),[k,S]=(0,f.useState)(!1),[C,I]=(0,f.useState)(!1),[T,z]=(0,f.useState)(!1);return(0,f.useEffect)(()=>{y(c("agentCreate")),j(c("agentUpdate")),b(c("agentDelete")),S(c("restored")),I(c("loading")),z(c("profile"));let e=p(e=>{let{dialog:t,visible:n}=e;switch(t){case"agentCreate":y(n);break;case"agentUpdate":j(n);break;case"agentDelete":b(n);break;case"restored":S(n);break;case"loading":I(n);break;case"profile":z(n);break;case"repo":d(n?x.t("Agent module"):null)}});return()=>{e()}},[]),(0,f.useEffect)(()=>{let e=null;return C&&(e=window.setTimeout(()=>u("loading",!1),7500)),()=>null!==e&&window.clearTimeout(e)},[C]),(0,f.useEffect)(()=>{var e;let n=(0,a.fD)(t,s());o(T?x.t("User Profile"):(null==n?void 0:n.name)?"".concat(null!=(e=null==n?void 0:n.name)?e:""):null)},[T]),(0,l.jsxs)(l.Fragment,{children:[C?(0,l.jsx)(rr,{isOpen:!0}):null,m&&t.length<v().max.agentsCount?(0,l.jsx)(iX,{isOpen:!0,isFirst:0===t.length,onAgentCreate:n,onClose:()=>u("agentCreate",!1)}):null,A?(0,l.jsx)(iZ,{isOpen:!0,agents:t,onAgentUpdate:i,onClose:()=>u("agentUpdate",!1)}):null,w?(0,l.jsx)(i0,{isOpen:!0,agents:t,onAgentDelete:r,onClose:()=>u("agentDelete",!1)}):null,T?(0,l.jsx)(rt,{isOpen:!0,onClose:()=>u("profile",!1)}):null,k?(0,l.jsx)(ri,{isOpen:!0,onClose:()=>u("restored",!1),onOpen:(0,nT.A)("notification")}):null]})};rs.guestGuard=!0;var ra=n(23229),ro=n(85143),rd=n(13082),rc=n(65122),ru=n(15483),rp=n(26423),rx=n(1477);let rh=()=>{let{getLlmStatus:e,onLlmStatus:t,isLlmReady:n,onLlmInfo:i,showLlmInfo:r}=(0,h.P)(),{i18n:s}=(0,g.B)(),a=(0,k.A)(),d=(0,f.useRef)(!1),[c,u]=(0,f.useState)(!1),[p,x]=(0,f.useState)(!1),[m,y]=(0,f.useState)({});(0,f.useEffect)(()=>{y(e());let n=t(e=>{let{status:t}=e;y(t),!d.current&&"".concat(null==t?void 0:t.code).match(/^(?:download|unpack)/gi)&&(d.current=!0),d.current&&"finish"===(null==t?void 0:t.code)&&r(!0)}),l=i(e=>{let{show:t}=e;if(u(t),t){var n;null==(n=window.sdk)||n.ipc.main.setOnTop()}});return()=>{n(),l()}},[]),(0,f.useEffect)(()=>{let e=null;return n()&&(e=window.setTimeout(async()=>{c&&(ep(".MuiDialog-root"),o.o.success(s.t("Large language model installed successfully!"),{duration:5e3})),e=null},250)),()=>{null!==e&&(window.clearTimeout(e),e=null)}},[m,c]);let A=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null==(e=window.sdk)||e.ipc.llm.init(t)},j=[{code:"download:ollama",Icon:rp.A,title:s.t("Downloading Ollama")},{code:"unpack:ollama",Icon:rp.A,title:s.t("Unpacking Ollama")},{code:"download:models",Icon:rx.A,title:s.t("Downloading large language model")},{code:"unpack:models",Icon:rx.A,title:s.t("Unpacking large language model")},{code:"serve",Icon:tk.A,title:s.t("Launching server")},{code:"finish",Icon:ro.A,title:m.success?s.t("LLM server running"):s.t("LLM server failed to start")}],v=j.reduce((e,t)=>t.code===m.code?t:e,null),w=j.findIndex(e=>e.code===m.code);return(0,l.jsxs)(l.Fragment,{children:[null===v||n()?null:(0,l.jsx)(L.A,{title:m.success?v.title:s.t("Error installing LLM"),placement:"top",children:(0,l.jsx)(I.A,{onClick:()=>r(!0),startIcon:(0,l.jsx)(v.Icon,{sx:{ml:2,mr:1},fontSize:"small",color:m.success?"primary":"warning"}),sx:{width:"100%",height:"40px",position:"relative",display:"flex",alignItems:"center",justifyContent:"start",px:4,borderRadius:0,textTransform:"none",textAlign:"left"},children:(0,l.jsxs)(S.A,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"start"},children:[(0,l.jsx)(C.A,{variant:"caption",sx:{color:m.success?"inherit":a.palette.warning.main,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"},children:m.success?v.title:s.t("Error installing LLM")}),Number.isInteger(m.progressBar)||m.progressBar?(0,l.jsx)(n$.A,{color:m.success?"primary":"warning",sx:{mt:1},variant:Number.isInteger(m.progressBar)?"determinate":"indeterminate",value:Number.isInteger(m.progressBar)?m.progressBar:null}):null]})})}),c?(0,l.jsxs)(eY.A,{open:!0,onClose:()=>u(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:1}},children:[(0,l.jsx)(eW.A,{children:(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(C.A,{variant:"h3",sx:{ml:4},children:s.t("Large language model setup")}),(0,l.jsx)(e_.A,{"aria-label":s.t("More information"),sx:{ml:2},color:"default",onClick:()=>x(!p),size:"large",children:p?(0,l.jsx)(nQ.A,{}):(0,l.jsx)(tp.A,{})})]})}),(0,l.jsxs)(eF.A,{children:[p?(0,l.jsx)(eM.A,{severity:"info",sx:{mb:2},children:(0,l.jsxs)(C.A,{color:"inherit",variant:"body2",children:[s.t("To ensure complete privacy of your data, this application uses a large language model that runs locally on your machine."),(0,l.jsx)("br",{}),s.t("Downloading and extracting the LLM typically takes less than 10 minutes, depending on your internet connection speed and system performance.")]})}):null,j.map((e,t)=>(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",my:2,opacity:t<=w?1:.4,userSelect:t<=w?"auto":"none"},children:[(0,l.jsx)(S.A,{sx:{height:"100%",display:"flex",alignItems:"center"},children:w>=0&&t<=w?t===w?m.success?n()?(0,l.jsx)(ra.A,{color:"primary"}):(0,l.jsx)(rd.A,{color:"primary",className:"rotate-360"}):(0,l.jsx)(rc.A,{color:"warning"}):(0,l.jsx)(nr.A,{}):(0,l.jsx)(no.A,{})}),(0,l.jsxs)(S.A,{sx:{width:"100%",height:40,display:"flex",alignItems:"start",justifyContent:"center",flexDirection:"column"},children:[(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(e.Icon,{sx:{mx:3},color:t===w?m.success?"primary":"warning":"inherit"}),(0,l.jsx)(C.A,{color:t===w?m.success?"primary":"warning":"inherit",variant:"body2",children:e.title})]}),t===w&&(Number.isInteger(m.progressBar)||m.progressBar)?(0,l.jsx)(n$.A,{color:m.success?"primary":"warning",sx:{mt:2,mx:3},variant:Number.isInteger(m.progressBar)?"determinate":"indeterminate",value:Number.isInteger(m.progressBar)?m.progressBar:null}):null]})]},t)),m.success?null:(0,l.jsxs)(eM.A,{severity:"warning",children:[m.message.length?m.message:s.t("An error occured during the installation of the large language model."),(0,l.jsx)("br",{}),"serve"!==m.code?s.t("Press the reinstall button below to begin a fresh install."):s.t("Press the restart button below to reload the large language model.")]})]}),(0,l.jsxs)(eB.A,{children:[m.success?null:(0,l.jsxs)(S.A,{sx:{width:"100%",display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(I.A,{startIcon:(0,l.jsx)(N.A,{}),color:"warning",onClick:()=>A(!0),children:s.t("Reinstall")}),(0,l.jsx)(I.A,{startIcon:(0,l.jsx)(ru.A,{}),color:"primary",onClick:()=>A(!1),variant:"outlined",children:s.t("Restart")})]}),(0,l.jsx)(I.A,{color:m.success&&n()?"primary":"secondary",variant:m.success&&n()?"contained":"text",className:m.success&&n()?"pop":null,onClick:()=>u(!1),children:m.success&&n()?s.t("Let's go!"):s.t("OK")})]})]}):null]})};var rm=n(40577),rg=n(61548),rf=n(10957);function ry(){let e=(0,tU._)(["\n0%   { transform: translateY(-50px); }\n100% { transform: translateY(0px); }"]);return ry=function(){return e},e}let rA=(0,tB.i7)(ry()),rj=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{width:"2px",height:"20px",position:"relative",borderRight:"1px solid ".concat((0,s.A)(t)),marginLeft:t.spacing(2)}});function rv(e){var t;let{agents:n}=e,{getAgentActive:i,onAgentActive:r,getAgentId:o,onAgentId:d,getNavVisible:c,onNavVisible:u,setNavVisible:p,getNavUrl:x,onNavUrl:m,getNavInfo:y,onNavInfo:A,log:j}=(0,h.P)(),v=(0,k.A)(),w=(0,f.useRef)(null),{i18n:b}=(0,g.B)(),I=(0,f.useRef)(null),[T,z]=(0,f.useState)(null),[D,P]=(0,f.useState)(!1),[R,_]=(0,f.useState)(!1),[E,M]=(0,f.useState)(!1),[N,U]=(0,f.useState)({status:-1,domError:null});(0,f.useEffect)(()=>{P(i(o()));let e=r(e=>{let{agentId:t,active:n}=e;t===o()&&P(n)});M(c());let t=u(e=>{M(e)});null!==w.current&&(w.current.value=x(o()));let n=m(e=>{let{agentId:t,url:n}=e;t===o()&&null!==w.current&&(w.current.value=n)});U(y(o()));let l=A(e=>{let{agentId:t,info:n}=e;t===o()&&U(n)});return()=>{e(),t(),n(),l()}},[T]),(0,f.useEffect)(()=>{z((0,a.fD)(n,o()));let e=d(e=>z((0,a.fD)(n,e)));return()=>e()},[n]),(0,f.useEffect)(()=>{E&&null!==w.current&&(w.current.value=x(o()))},[E]);let B=async e=>{var t,n;if(!D){U({...N,status:-1}),null==(t=window.sdk)||t.ipc.main.setOnTop();try{await (null==(n=window.sdk)?void 0:n.ipc.target.loadUrl(o(),e))}catch(e){j(o(),"Navigation error: ".concat(e.message),"error")}}},F=async()=>{var e,t;if(!D){U({...N,status:-1}),null==(e=window.sdk)||e.ipc.main.setOnTop();try{await (null==(t=window.sdk)?void 0:t.ipc.target.reload(o(),!0))}catch(e){j(o(),"Navigation error: ".concat(e.message),"error")}}},W=async()=>{if(!D)try{var e;await (null==(e=window.sdk)?void 0:e.ipc.target.goBack(o()))}catch(e){j(o(),"Navigation error: ".concat(e.message),"error")}},H=async()=>{if(!D)try{var e;await (null==(e=window.sdk)?void 0:e.ipc.target.goForward(o()))}catch(e){j(o(),"Navigation error: ".concat(e.message),"error")}},q=async()=>{p(!1)},Y="1px solid ".concat(D?v.palette.primary.main:(0,s.A)(v));return T&&E?(0,l.jsx)(S.A,{sx:{borderBottom:Y,zIndex:20,position:"fixed",display:"flex",flexDirection:"column",left:"250px",top:"50px",width:"calc(100vw - 250px)",overflow:"hidden",background:v.palette.background.default,animation:"".concat(rA," 100ms ease-in-out forwards"),transition:"opacity 100ms linear",opacity:R?.2:1,"&:hover":{opacity:R?.8:1}},children:(0,l.jsxs)(S.A,{sx:{height:"49px",alignItems:"center",display:"flex"},children:[D?(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",mx:2,flex:"0 0 auto",userSelect:"none"},children:(0,l.jsx)(C.A,{variant:"caption",color:v.palette.action.active,children:b.t("Controlled by agent")})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",mx:2},children:(0,l.jsx)(e_.A,{onClick:W,disabled:-1===N.status||!N.canGoBack,children:(0,l.jsx)(rg.A,{fontSize:"small"})})}),(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",mr:2},children:(0,l.jsx)(e_.A,{onClick:H,disabled:-1===N.status||!N.canGoForward,children:(0,l.jsx)(rm.A,{fontSize:"small"})})}),(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(e_.A,{onClick:F,disabled:-1===N.status,children:(0,l.jsx)(rf.A,{fontSize:"small"})})})]}),(0,l.jsx)(rj,{sx:{mr:2}}),(0,l.jsx)(eE.A,{inputRef:w,variant:"standard",fullWidth:!0,disabled:D||-1===N.status,sx:{"& .MuiInput-root:before":{display:"none"}},onKeyDown:e=>{var t;return"Enter"===e.key&&(t=e.target.value,void(null!==I.current&&window.clearTimeout(I.current),I.current=window.setTimeout(async()=>{I.current=null;try{w.current.value=new URL(t).href,await B(w.current.value)}catch(e){w.current.value=x(o())}},250)))},inputProps:{sx:{fontSize:"0.75rem",px:"0 !important"}},placeholder:b.t("Type URL and press Enter"),InputProps:{startAdornment:(0,l.jsx)(eR.A,{position:"start",sx:{userSelect:"none"},children:(0,l.jsx)(S.A,{sx:{display:"flex",alignItems:"center",mx:2},children:(0,l.jsx)(S.A,{sx:{height:"20px"},children:-1===N.status?(0,l.jsx)(nG.A,{fontSize:"small",className:"rotate-360"}):0===N.status?(0,l.jsx)(L.A,{title:null!=(t=N.domError)?t:b.t("Failed to load"),placement:"left",children:(0,l.jsx)(tS.A,{fontSize:"small",color:"warning"})}):D?(0,l.jsx)(tC.A,{fontSize:"small",color:"action"}):(0,l.jsx)(ev.A,{fontSize:"small"})})})})}}),(0,l.jsxs)(S.A,{sx:{display:"flex",alignItems:"center",mx:2},children:[(0,l.jsx)(rj,{sx:{mr:2}}),(0,l.jsx)(L.A,{title:b.t("Toggle translucence"),placement:"left",children:(0,l.jsx)(e_.A,{onClick:()=>_(!R),sx:{width:"2rem",height:"2rem",mr:1},children:R?(0,l.jsx)(nu.A,{fontSize:"small"}):(0,l.jsx)(nc.A,{fontSize:"small"})})}),(0,l.jsx)(L.A,{title:b.t("Close navigation bar"),placement:"left",children:(0,l.jsx)(e_.A,{onClick:q,sx:{mr:"2px"},children:(0,l.jsx)(O.A,{fontSize:"small"})})})]})]})}):null}function rw(e){var t,n;let{count:i=0,onAgentAdd:r=()=>{}}=e,{getSubscription:s,onSubscription:a}=(0,h.P)(),{i18n:o}=(0,g.B)(),d=(0,m.A)(),[c,u]=(0,f.useState)(0),[p,x]=(0,f.useState)(0);return(0,f.useEffect)(()=>{var e;let t=s();x(!!t.active),u(null!=(e=t.agentsCount)?e:0);let n=a(e=>{var t;let{info:n}=e;x(!!n.active),u(null!=(t=n.agentsCount)?t:0)});return()=>{n()}},[null==(t=d.user)?void 0:t.computerEnabled]),p&&(null==(n=d.user)?void 0:n.computerEnabled)&&i<c?(0,l.jsx)(S.A,{sx:{px:2,my:2},children:(0,l.jsx)(I.A,{fullWidth:!0,sx:{fontSize:"0.75rem"},startIcon:(0,l.jsx)(ez.A,{color:"inherit"}),onClick:r,children:o.t("Add agent")})}):null}let rb=(0,b.Ay)(S.A)(()=>({display:"flex",width:"100%",height:"calc(100vh - 100px)",position:"relative",zIndex:2})),rk=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",width:"250px",height:"100%",boxShadow:"-1px 0px 0px 0px ".concat((0,s.A)(t)," inset")}}),rS=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",width:"calc(100vw - 250px)",boxShadow:"0px -1px 0px 0px ".concat((0,s.A)(t)," inset"),height:"100%"}}),rC=(0,b.Ay)(S.A)(e=>{let{theme:t}=e;return{display:"flex",width:"100%",height:"50px",background:t.palette.background.default,position:"relative",zIndex:21}}),rI=()=>{var e;let{onAgentId:t,getAgentId:n,setAgentId:i,getAgentActive:o,onAgentActive:d,getAgentTab:c,onAgentTab:j,setHourglass:b,setPageTitle:C,log:I,getLogs:T,getLogsInit:z,setLogsInit:D,setLogsEnabled:P,onLogsVisible:R,getLogsVisible:E,setLogsVisible:M,onNavVisible:N,getNavVisible:L,setNavVisible:O,onMachineStatus:U,getDialogVisible:B,setDialogVisible:F,getSource:W,modulePurge:H,onModuleUpdate:q,onModulePurge:Y,agentPurge:G,setInstalled:K}=(0,h.P)(),{i18n:V}=(0,g.B)(),$=(0,A.useRouter)(),J=(0,k.A)(),Q=(0,m.A)(),[X,Z]=(0,f.useState)(!1),[ee,et]=(0,f.useState)([]);(0,f.useEffect)(()=>{Q.user&&(x.A.setI18n(V),(async()=>{var e,t,n;try{let e=await (0,p.f)("agents",()=>w.A.get("agents"));Array.isArray(e.data)&&et(e.data),e.data.length&&window.setTimeout(async()=>{await en(e.data[0].id)},250)}catch(e){}null==(e=window.sdk)||e.irc.handle("irc-source:agent:data",e=>{"object"==typeof e&&"string"==typeof(null==e?void 0:e.id)&&et(t=>structuredClone(t).map(t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)?e:t))}),null==(t=window.sdk)||t.irc.handle("irc-source:module:installed",(e,t,n)=>{"string"==typeof e&&(("object"!=typeof t||"string"!=typeof(null==t?void 0:t.id))&&(t=null),(null===t||"string"!=typeof n)&&(n=null),K(e,t,n,!1))}),null==(n=window.sdk)||n.irc.handle("irc-source:module:purge",e=>{"string"==typeof e&&H(e)}),Z(!0)})())},[null==(e=Q.user)?void 0:e.id]),(0,f.useEffect)(()=>{let e=e=>{var t;return C((null==e?void 0:e.name)?"".concat(null!=(t=null==e?void 0:e.name)?t:""):null)};e((0,a.fD)(ee,n()));let l=t(t=>{e((0,a.fD)(ee,t))}),i=U(e=>{let{status:t}=e;x.A.STATUS_STARTED===t&&F("repo",!1)}),r=u(ee,n,F),s=y(ee,G,e=>{!z(e)&&(P(e,!0,!1),D(e,!0),T(e).length||(I(e,V.t("Errors happen, but at least they're detailed and nicely colored"),"error"),I(e,V.t("Messages are temporary - they get cleared when you close the application"),"warning"),I(e,V.t("Only the last {{logsPerAgent}} messages are kept in this console",{logsPerAgent:v().max.logsPerAgent})),I(e,V.t("This is where agents display their messages"),"success")))}),o=q(e=>{let{module:t,sendToSce:n}=e;n&&"string"==typeof(null==t?void 0:t.id)&&t.id.length&&(async()=>{for(let n of structuredClone(ee))if("string"==typeof(null==n?void 0:n.id)&&(null==n?void 0:n.installedModuleId)===t.id){var e;let l=await W(n.id,!0),i={agentData:n,moduleData:t,sourceCode:l};null==(e=window.sdk)||e.irc.source.send(n.id,"irc-main:module-repo:data",[i])}})()}),d=Y(e=>{"string"==typeof e&&e.length&&(async()=>{for(let n of structuredClone(ee))if("string"==typeof(null==n?void 0:n.id)&&(null==n?void 0:n.installedModuleId)===e){var t;n.installedModuleId=null,n.installedModuleSrcId=null,n.installedModuleAuthorId=null;let e={agentData:structuredClone(n),moduleData:null};null==(t=window.sdk)||t.irc.source.send(n.id,"irc-main:module-repo:data",[e]),ei(n)}})()});return()=>{o(),d(),r(),l(),i(),s()}},[ee]),(0,f.useEffect)(()=>{var e,t;if("object"!=typeof window.sdk)return void $.replace("/home/");window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},750),null==(e=window.sdk)||e.irc.handle("irc-source:open",()=>F("loading",!1)),null==(t=window.sdk)||t.irc.handle("ipc:oglama:restored",async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),F("restored",!0)});let l=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop())};window.addEventListener("beforeunload",l),$.events.on("routeChangeStart",l);let i=d(e=>{let{agentId:t,active:n}=e;return b(t,n)}),r=R(e=>!e&&eo()),s=N(e=>!e&&eo()),a=j(()=>null!==n()&&en(n()));return()=>{window.removeEventListener("beforeunload",l),$.events.off("routeChangeStart",l),i(),r(),s(),a()}},[]);let en=async function(e){var t,n;let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"!=typeof e)return;i(e);let r=l||""!==c()||B()||E()||L()||o(e);await (null==(t=window.sdk)?void 0:t.ipc.main.setOnTop(r)),""===c()&&await (null==(n=window.sdk)?void 0:n.ipc.target.select(e))},el=async e=>{var t,n,l;if("string"==typeof(null==(t=Q.user)?void 0:t.computerId)){try{let t=await w.A.post("agents",{name:e,computerId:Q.user.computerId});"string"==typeof(null==(l=t.data)?void 0:l.id)&&(et(e=>[...structuredClone(e),t.data]),i(t.data.id),P(t.data.id,!0,!1),F("repo",!0))}catch(e){}await (null==(n=window.sdk)?void 0:n.ipc.main.setOnTop())}},ei=e=>{if("object"==typeof e&&null!==e&&"string"==typeof e.id){var t,n;et(t=>structuredClone(t).map(t=>t.id===e.id?e:t)),null==(t=window.sdk)||t.irc.source.send(e.id,"irc-main:agent:data",[e]),null==(n=window.sdk)||n.ipc.target.setDevToolsTitle(e.id,e.name)}},er=async e=>{try{await w.A.delete("agents/".concat(e)),et(t=>{let l=[...structuredClone(t).filter(t=>t.id!==e)];return n()===e&&i(l.length?l[0].id:null),l}),G(e)}catch(e){}},es=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),F("agentCreate",!0)},ea=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),F("profile",!0)},eo=async()=>{""===c()&&await en(n())},ed=async()=>{M(!1),O(!1),await eo()},ec=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),F("loading",!0)};return null===Q.user?(0,l.jsx)(n7.A,{}):(0,l.jsxs)(S.A,{sx:{display:"flex",width:"100vw",height:"100vh",flexDirection:"column"},children:[(0,l.jsx)(r(),{id:"a832ee7090d48c19",children:"body{background:transparent}"}),(0,l.jsx)(nD,{agentsCount:ee.length,agentsReady:X}),(0,l.jsx)(rC,{children:X&&ee.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(rk,{sx:{justifyContent:"space-between",alignItems:"center"},children:(0,l.jsx)(ni,{})}),(0,l.jsxs)(rS,{sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)(nI,{agents:ee,onSelect:en}),(0,l.jsx)(tu,{agents:ee,onSelect:en,onUpdate:()=>F("agentUpdate",!0),onDelete:()=>F("agentDelete",!0),showLoading:ec})]})]}):null}),(0,l.jsx)(rb,{children:X&&ee.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(rk,{sx:{background:J.palette.background.default,flexDirection:"column",position:"relative",zIndex:10},children:(0,l.jsxs)(S.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},children:[(0,l.jsxs)(S.A,{children:[ee.map((e,t)=>(0,l.jsx)(n6,{agent:e,index:t,onSelect:en},e.id)),(0,l.jsx)(rw,{count:ee.length,onAgentAdd:es})]}),(0,l.jsxs)(S.A,{children:[(0,l.jsx)(iJ,{}),(0,l.jsx)(rh,{})]})]})}),(0,l.jsx)(rS,{sx:{boxShadow:"none"},onMouseOver:eo,onMouseDown:ed,children:(0,l.jsx)(iG,{agents:ee,agentsReady:X})}),(0,l.jsx)(rv,{agents:ee}),(0,l.jsx)(nw,{agents:ee})]}):null}),(0,l.jsxs)(rC,{children:[(0,l.jsx)(rk,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:(0,l.jsx)(lc,{onProfileOpen:ea})}),X&&ee.length?(0,l.jsxs)(rS,{sx:{alignItems:"center",boxShadow:"0px 1px 0px 0px ".concat((0,s.A)(J)," inset"),justifyContent:"space-between"},children:[(0,l.jsx)(_,{agents:ee}),(0,l.jsx)(nq,{agents:ee})]}):null]}),(0,l.jsx)(tr,{agents:ee,onAgentUpdate:ei}),(0,l.jsx)(rs,{agents:ee,onAgentCreate:el,onAgentUpdate:ei,onAgentDelete:er})]})};rI.guestGuard=!0;let rT=rI},42936:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(29189)}])},54441:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var l=n(37876),i=n(74787),r=n(7156),s=n(14232),a=n(66703),o=n(15852),d=n(51553),c=n(54610),u=n(72066);let p=(0,s.forwardRef)((e,t)=>{let{tooltipPlacement:n="bottom",tooltipShown:p=!0}=e,{settings:x,saveSettings:h}=(0,i.t)(),[m,g]=(0,s.useState)(!1),{i18n:f}=(0,r.B)(),y=(0,a.A)();return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(o.A,{title:p?"dark"===x.mode?f.t("Dark mode"):f.t("Light mode"):null,placement:n,children:(0,l.jsx)(d.A,{ref:t,color:"default",disabled:m,inputProps:{"aria-label":"dark-mode",name:"dark-mode"},checked:"dark"===x.mode,sx:{mx:1,height:"38px","& .MuiSwitch-track":{background:"transparent",opacity:1,border:"1px solid ".concat(y.palette.divider)}},icon:(0,l.jsx)(c.A,{fontSize:"small",sx:{color:"#ff9b00"}}),checkedIcon:(0,l.jsx)(u.A,{fontSize:"small",color:"primary"}),onClick:()=>{m||(g(!0),setTimeout(()=>g(!1),500),h({mode:"light"===x.mode?"dark":"light"}))}})})})})}},e=>{e.O(0,[284,957,797,470,316,876,338,636,593,792],()=>e(e.s=42936)),_N_E=e.O()}]);