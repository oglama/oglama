/*!
 * @architect Mark Jivko <mark@oglama.com>
 * @copyright Â© 2024-2025 Oglama (https://oglama.com)
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{14629:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var l=n(35268),i=n(38388);let r=(0,l.Ay)(i.A)(e=>{let{theme:t}=e;return{width:"1100px",height:"1100px",left:"50%",top:"50%",marginLeft:"-550px",marginTop:"-550px",position:"absolute",background:"url(/img/pages/circles-".concat(t.palette.mode,".svg)"),backgroundPosition:"50% 50%",backgroundSize:"cover",backgroundRepeat:"no-repeat",zIndex:1}})},35342:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>rO});var l=n(37876),i=n(75961),r=n.n(i),s=n(14632),a=n(35505),o=n(13383);let d=null,c=function(e){var t,n,l;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:()=>{};if(!e.isTrusted||e.shiftKey||e.altKey||!(null==e?void 0:e.ctrlKey)||"control"===(null==(t=e.key)?void 0:t.toLowerCase()))return;let c=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),s("loading",!0)},u={"/":()=>{var e,t;if(!(null==(e=window.sdk)?void 0:e.devMode))return;let n=window.localStorage.getItem("jwt-user"),l=window.localStorage.getItem("jwt-founder");if("string"!=typeof n||"string"!=typeof l)return void o.o.error("Local storage jwt-user or jwt-founder missing");let i=window.localStorage.getItem("oglama-auth-jwt");window.localStorage.setItem("oglama-auth-jwt",i===n?l:n),c(),o.o.loading("Switching user..."),null==(t=window.sdk)||t.ipc.source.closeAll(),window.setTimeout(()=>window.location.reload(),1500)},numeric:(e,t)=>{var n;let l=[...new Set(e.map(e=>null==e?void 0:e.id).filter(Boolean))];"string"==typeof l[t]&&(null==(n=document.querySelector('[data-agent="'.concat(l[t],'"][data-agent-selected="false"]')))||n.click())},".":()=>{var e;null==(e=document.querySelector('[data-start-stop="'.concat(r(),'"]')))||e.click()},w:()=>{var e;null==(e=document.querySelector('[data-tab="browser"][data-tab-selected="false"]'))||e.click()},e:()=>{var e;null==(e=document.querySelector('[data-tab="settings"][data-tab-selected="false"]'))||e.click()},r:()=>{var e;null==(e=document.querySelector('[data-tab="results"][data-tab-selected="false"]'))||e.click()},l:()=>{var e;null==(e=document.querySelector("[data-logs-toggle]"))||e.click()},m:()=>{var e;null==(e=document.querySelector("[data-modules-toggle]"))||e.click()},u:async()=>{var e,t;await (null==(t=window)||null==(e=t.sdk)?void 0:e.ipc.source.open(r()))&&await c()},i:e=>{let t=(0,a.fD)(e,r());if(null!==t){var n;null==(n=window.sdk)||n.ipc.target.openDevTools(t.id,t.name)}}},p=(null==(n=e.key)?void 0:n.toLowerCase().match(/^[1-9]$/))?t=>u.numeric(t,parseInt(e.key,10)-1):u[null==(l=e.key)?void 0:l.toLowerCase()];"function"==typeof p&&(e.preventDefault(),null!==d&&window.clearTimeout(d),d=window.setTimeout(()=>{d=null;try{var e;p(i),null==(e=window.sdk)||e.ipc.main.setOnTop()}catch(e){}},50))},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},l=l=>c(l,e,t,n);return window.addEventListener("keydown",l),()=>{window.removeEventListener("keydown",l)}};var p=n(18952),x=n(81373),h=n(8628),m=n(7156),g=n(14232);let f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},l=window.setTimeout(()=>{if(!Array.isArray(e)||!e.length)return;window.localStorage.removeItem("ally-supports-cache");let l=[],i=e.map(e=>{var t;return null!=(t=null==e?void 0:e.id)?t:null}).filter(Boolean);for(let e of Object.keys(window.localStorage)){let t=e.match(/^oglama\-(\w{24})\-/);t&&!i.includes(t[1])&&l.push(t[1])}for(let e of i)n(e);if(l.length)for(let e of[...new Set(l)])t(e)},500);return()=>window.clearTimeout(l)};var y=n(89099),A=n(39763),j=n.n(A),v=n(91040),w=n(35268),b=n(66703),k=n(38388),S=n(35003),C=n(84812),I=n(2653),T=n(84782);let z=(0,w.Ay)(k.A)(e=>{let{theme:t,open:n=!1}=e;return{transition:"transform 350ms cubic-bezier(0.48, -0.35, 0.17, 0.95)",transform:n?"rotate(180deg)":"rotate(0deg)",justifyContent:"center",alignItems:"center",position:"relative",display:"flex"}}),D=e=>{let{children:t,open:n=!1,sx:i={}}=e;return("object"!=typeof i||null===i)&&(i={}),(0,l.jsx)(z,{sx:i,open:!!n,children:t})};function E(e){let{log:t}=e;return(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:(0,l.jsx)(S.A,{variant:"caption",noWrap:!0,align:"left",sx:{textTransform:"none",width:"calc(100% - 75px)"},children:t.m})})}function _(e){let{agents:t}=e,{i18n:n}=(0,m.B)(),{getAgentActive:i,onAgentActive:r,getAgentId:s,onAgentId:a,getLogs:o,onLog:d,getLogsEnabled:c,onLogsEnabled:u,getLogsVisible:p,onLogsVisible:h,setLogsVisible:f}=(0,x.P)(),[y,A]=(0,g.useState)(null),[j,v]=(0,g.useState)(!1),[w,b]=(0,g.useState)(null),[z,_]=(0,g.useState)(!1),[M,P]=(0,g.useState)(!1);(0,g.useEffect)(()=>{let e=o(s());A(Array.isArray(e)&&e.length?e[0]:null);let t=d(e=>A(Array.isArray(e)&&e.length?e[0]:null));v(i(s()));let n=r(e=>{let{agentId:t,active:n}=e;t===s()&&v(n)});_(c());let l=u(e=>_(e));P(p());let a=h(e=>P(e));return()=>{t(),n(),l(),a()}},[w]),(0,g.useEffect)(()=>{b(s());let e=a(e=>b(e));return()=>e()},[t]);let N="action";return(j&&"string"==typeof(null==y?void 0:y.s)||"error"===(null==y?void 0:y.s))&&(N=y.s),null!==w&&z?(0,l.jsx)(k.A,{sx:{minWidth:"maxContent",width:"100%",flexShrink:1,display:"flex",height:"100%",overflow:"hidden"},children:(0,l.jsx)(k.A,{sx:{width:"100%",height:"100%"},children:(0,l.jsxs)(C.A,{"data-logs-toggle":!0,onClick:()=>{f(!M),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},sx:{width:"100%",height:"100%",alignItems:"center",borderRadius:0,justifyContent:"start",pl:3},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(I.A,{sx:{mr:2},color:N,fontSize:"small"}),null!==y?(0,l.jsx)(E,{log:y}):(0,l.jsx)(S.A,{variant:"caption",noWrap:!0,align:"left",sx:{textTransform:"none",width:"calc(100% - 75px)"},children:n.t("No messages were recorded for this agent")})]}),(0,l.jsx)(k.A,{sx:{position:"absolute",top:12,right:6},children:(0,l.jsx)(D,{open:M,children:(0,l.jsx)(T.A,{color:"action"})})})]})})}):null}var M=n(58549),P=n(3678),N=n(32933),R=n(15852),L=n(99476);let O=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",height:"50px",paddingLeft:t.spacing(4),paddingRight:t.spacing(4),justifyContent:"space-between",backgroundColor:t.palette.background.paper,borderBottom:"1px solid ".concat(t.palette.divider),flexShrink:0}}),F=(0,w.Ay)(k.A)(()=>({display:"inline-block",maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",userSelect:"none",fontSize:"0.85rem",textAlign:"center"})),B=e=>{let{title:t,icon:n=null,handleClose:i=()=>{},sx:r={}}=e,{i18n:s}=(0,m.B)();return("object"!=typeof r||null===r)&&(r={}),(0,l.jsxs)(O,{sx:{...r},children:[n,(0,l.jsx)(R.A,{title:t,children:(0,l.jsx)(F,{children:t})}),(0,l.jsx)(R.A,{title:s.t("Close"),placement:"left",children:(0,l.jsx)(L.A,{onClick:i,sx:{cursor:"pointer"}})})]})},W=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{padding:t.spacing(4),overflowY:"auto",height:"100%"}});var U=n(14629),H=n(71948),q=n(79219),Y=n(62727),K=n(50705),G=n(91247),V=n(43400);let $=(0,w.Ay)(H.A)(e=>{let{theme:t}=e;return{[t.breakpoints.down("md")]:{minWidth:100},[t.breakpoints.down("sm")]:{minWidth:67}}}),J=(0,w.Ay)("span")(e=>{let{theme:t}=e;return{fontSize:"0.75rem",marginLeft:t.spacing(3.4),[t.breakpoints.down("md")]:{display:"none"}}}),X=e=>{let{tabs:t,hash:n,setHash:i,sx:r={},tabsReady:s=!0,hideSingleTab:a=!0,prefix:o=null,suffix:d=null,bordered:c=!1,sticky:u=!1}=e,{i18n:p}=(0,m.B)(),x=(0,b.A)(),h={};return Object.keys(t).map(e=>{(void 0===t[e].visible||t[e].visible)&&(h[e]=t[e])}),(null===r||"object"!=typeof r)&&(r={}),(0,l.jsxs)(q.Ay,{value:n,children:[Object.keys(h).length<=1&&a?null:s?(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",...c?{borderBottom:"1px solid ".concat(x.palette.divider)}:{},...d?{justifyContent:"space-between"}:{}},children:[null!==o?(0,l.jsx)(k.A,{sx:{pl:3},children:o}):null,(0,l.jsx)(K.A,{sx:{pl:3*(null!==o)},onChange:(e,t)=>i(t),"aria-label":"Tabs",children:Object.keys(h).map((e,t)=>(0,l.jsx)($,{value:e,label:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[h[e].icon,(0,l.jsx)(J,{children:p.t(h[e].label)}),h[e].hasPop?(0,l.jsx)(G.A,{sx:{position:"absolute",top:"0.25rem",right:0},color:"warning"}):null]})},t))}),null!==d?(0,l.jsx)(k.A,{sx:{pr:3},children:d}):null]}):(0,l.jsx)(k.A,{sx:{height:"48px",width:{xs:"100%",md:"50%"}},children:(0,l.jsx)(V.A,{count:1,columns:3})}),(0,l.jsx)(k.A,{sx:{...u?{height:"calc(100% - 49px)",overflowY:"auto",position:"relative",zIndex:10}:{},...r},children:Object.keys(h).map((e,t)=>(0,l.jsx)(Y.A,{value:e,sx:{p:0},children:n===e?h[e].content:null},t))})]})};var Z=n(35250),Q=n(67290),ee=n(95196),et=n(71507),en=n.n(et),el=n(71015);let ei=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",n=document.querySelector("".concat(t," > .confetti-container"));if(null!==n)return;(n=document.createElement("div")).classList.add("confetti-container"),null==(e=document.querySelector(t))||e.appendChild(n);let l=["red","orange","yellow","green","blue","violet"],i=()=>"".concat(Math.floor(Math.random()*window.innerWidth),"px"),r=()=>l[Math.floor(Math.random()*l.length)];n.innerHTML="";for(let e=0;e<200;e++)setTimeout(()=>{let e=document.createElement("div"),t=.5>Math.random()?"50%":0;e.classList.add("confetti"),e.style.left=i(),e.style.background=r(),e.style.borderRadius=t,n.appendChild(e),e.animate({top:"".concat(window.innerHeight,"px"),left:"".concat(Math.floor(Math.random()*window.innerWidth),"px")},Math.floor(500*Math.random()+1500))},10*e);window.setTimeout(()=>{var e;null==(e=n.parentNode)||e.removeChild(n)},4e3)},er=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"!=typeof e)return[(0,l.jsx)("span",{children:e},0)];"string"!=typeof t&&(t="");let i=e.toLowerCase().indexOf(t.toLowerCase()),r=0,s=/(https?:\/\/[^\s]+)/gi;return e.split(s).map(e=>{let a=null,o=null,d=!!e.match(s);do{if(i<0)break;if(i>=r&&i<r+e.length){a=i-r,o=Math.min(e.length-a,t.length);break}if(i+t.length>=r&&i+t.length<r+e.length){a=0,o=t.length+i-r;break}}while(!1);r+=e.length;let c=null!==a?[e.substring(0,a),(0,l.jsx)("u",{children:e.substring(a,a+o)},a),e.substring(a+o)].filter(e=>""!==e).map((e,t)=>(0,l.jsx)("span",{children:e},t)):[(0,l.jsx)("span",{children:e},0)];return d?[(0,l.jsxs)("span",{className:"anchor",onClick:t=>{var l,i;t.preventDefault(),t.stopPropagation(),en()(e),"string"==typeof n&&n.length?null==(l=window.sdk)||l.ipc.target.openInNewWindow(n,e):null==(i=window.sdk)||i.ipc.main.openExternal(e)},href:e,children:[(0,l.jsx)(el.A,{sx:{width:"1rem",height:"1rem",lineHeight:"1rem",display:"inline-block",verticalAlign:"middle",mr:1}}),c]},0)]:c})};var es=n(41316),ea=n(13353),eo=n(3362),ed=n(95389),ec=n(60595),eu=n(50694),ep=n(63356),ex=n(23154);let eh=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{borderRadius:"5px",position:"absolute",width:"70px",height:"70px",background:t.palette.success.main,inset:0,clipPath:"polygon(0 0, 0 100%, 100% 0)",left:-6,top:-5}}),em=e=>{let{scale:t=1,label:n=!1}=e,{i18n:i}=(0,m.B)();return(0,l.jsx)(R.A,{title:n?i.t("Installed"):null,children:(0,l.jsxs)(k.A,{sx:{position:"relative",mt:-1,transform:"scale(".concat(t,")"),transformOrigin:"0 50%"},children:[(0,l.jsx)(ep.A,{variant:n?"contained":"outlined",sx:{position:"relative",zIndex:2,textTransform:"uppercase",userSelect:"none",...n?{"& .MuiChip-label":{px:"6px"}}:{px:2}},icon:(0,l.jsx)(ex.A,{fontSize:n?"medium":"small"}),color:"success",size:"medium",label:n?"":i.t("Installed")}),n?(0,l.jsx)(eh,{}):null]})})},eg=(0,w.Ay)("img")(e=>{let{theme:t}=e;return{marginBottom:t.spacing(4),width:"96px",height:"96px",transition:"transform 100ms linear",position:"relative",zIndex:1}}),ef=(0,w.Ay)(S.A)(e=>{let{theme:t}=e;return{fontWeight:400,overflow:"hidden",fontSize:"0.75rem",lineHeight:"1rem",textOverflow:"ellipsis",textTransform:"none",marginBottom:t.spacing(.75),maxWidth:"96px",maxHeight:"3rem"}}),ey=e=>{var t;let{module:n=null,installedModuleId:i=null,flaggedModuleId:r=null,setModuleId:s=()=>{},selected:a=!1}=e,o=(0,b.A)(),d=(0,h.A)();return(0,l.jsx)(es.Ay,{item:!0,children:(0,l.jsx)(C.A,{className:a||r!==(null==n?void 0:n.id)?null:"pop",color:"inherit",variant:"contained",onClick:()=>{null!==n&&s(n.id)},sx:{borderRadius:1,p:0,background:a?o.palette.background.selected:"transparent","&:hover":{background:a?o.palette.background.selected:"transparent"},height:"100%"},children:(0,l.jsx)(ec.A,{sx:{borderRadius:1,background:"transparent",boxShadow:"none",height:"100%"},children:(0,l.jsxs)(ed.A,{sx:{"&.MuiCardContent-root":{p:3},height:"100%",position:"relative",borderRadius:1,border:"1px solid ".concat(a?o.palette.primary.main:o.palette.divider),display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",width:"100%",position:"absolute",left:0,top:0,mt:1,px:1,zIndex:1e3,justifyContent:"space-between"},children:[(0,l.jsx)(k.A,{children:(null==n?void 0:n.id)===i?(0,l.jsx)(em,{scale:.8,label:!0}):null}),null!==n&&(d.user.id===(null==n?void 0:n.authorId)||"founder"===(null==(t=d.user)?void 0:t.userRole))?(0,l.jsx)(eu.A,{scale:.8,module:n}):null]}),(0,l.jsx)(k.A,{sx:{position:"relative","&:before":{content:'""',display:null!==n?"block":"none",width:"96px",height:"96px",position:"absolute",top:0,left:0,zIndex:1,background:o.palette.background.paper,borderRadius:2,opacity:1}},children:null!==n?(0,l.jsx)(eg,{src:null!==n.moduleLogoId?"".concat(eo.A.s3Url,"/modules/").concat(n.id,"/").concat(n.moduleLogoId,".png"):"/img/placeholder/module.png"}):(0,l.jsx)(k.A,{sx:{mb:2},children:(0,l.jsx)(V.A,{rounded:!0,sx:{width:"96px",height:"96px"}})})}),null!==n?(0,l.jsx)(R.A,{title:n.moduleName,children:(0,l.jsx)(ef,{component:"span",children:n.moduleName})}):(0,l.jsx)(V.A,{spacing:0,sx:{my:2,width:"96px",height:"1rem",display:"inline-block"}})]})})})})};var eA=n(5940),ej=n(84072),ev=n(25596);let ew=e=>{let{modulesLoaded:t,setDialogCreate:n=()=>{}}=e;return(0,l.jsx)(es.Ay,{item:!0,children:(0,l.jsx)(ec.A,{sx:{boxShadow:"none"},children:(0,l.jsx)(ed.A,{sx:{"&.MuiCardContent-root":{p:3},display:"flex",minHeight:"180px",boxShadow:"none"},children:(0,l.jsx)(k.A,{sx:{width:"98px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(eA.A,{sx:{"&:hover":{transform:"scale(1.1)"}},size:"large",color:"primary",onClick:()=>n(!0),disabled:!t,children:t?(0,l.jsx)(ev.A,{}):(0,l.jsx)(ej.A,{})})})})})})},eb=e=>{let{agent:t,moduleId:n,setModuleId:i=()=>{},modulesLoaded:r,modules:s,setModules:a=()=>{}}=e,{i18n:d}=(0,m.B)(),c=(0,h.A)(),[u,p]=(0,g.useState)(!1),x=async(e,t)=>{if(c.user)try{var n;let l=await v.A.post("modules",{moduleName:e,moduleDescription:t});"string"==typeof(null==(n=l.data)?void 0:n.id)&&(a([...s,l.data]),i(l.data.id)),ei(),o.o.info(d.t("Next, install the module and edit its source code."),{duration:7500})}catch(e){}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{sx:{overflowY:"auto",height:"calc(100vh - 110px)",p:4,mt:"5px"},children:(0,l.jsxs)(es.Ay,{container:!0,spacing:3,children:[r?s.map(e=>(0,l.jsx)(ey,{installedModuleId:null==t?void 0:t.installedModuleId,selected:n===e.id,module:e,setModuleId:i},e.id)):[1,2,3].map(e=>(0,l.jsx)(ey,{},e)),(0,l.jsx)(ew,{modulesLoaded:r,setDialogCreate:p})]})}),u?(0,l.jsx)(ea.A,{isOpen:!0,description:d.t("Create a new module with empty source code."),onCreate:x,onClose:()=>p(!1)}):null]})};var ek=n(39467),eS=n(1912),eC=n(52894),eI=n(29715),eT=n(71733),ez=n(32966);let eD=e=>{let{agent:t,moduleId:n,flaggedModuleId:i,setModuleId:r=()=>{},modulesLoaded:s,modules:a,searchModuleName:o,setSearchModuleName:d=()=>{}}=e,{i18n:c}=(0,m.B)(),u=(0,g.useRef)(null),p=(0,g.useRef)(null),x=(0,g.useCallback)(e=>{null!==u.current&&window.clearTimeout(u.current),e="".concat(e).replace(/[^\w \-\:]+/gi," ").replace(/ {2,}/g," ").toLowerCase().trim().substring(0,128),u.current=window.setTimeout(()=>{d(e),u.current=null},450)},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",alignItems:"center",my:3,px:4},children:[(0,l.jsx)(eI.A,{fontSize:"small",color:"disabled",sx:{ml:1}}),(0,l.jsx)(eS.A,{inputRef:p,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},InputProps:{endAdornment:(0,l.jsx)(ek.A,{position:"end",children:(0,l.jsx)(k.A,{sx:{width:30,height:30},children:o.length?(0,l.jsx)(R.A,{title:c.t("Clear search term"),placement:"left",children:(0,l.jsx)(eT.A,{sx:{width:30,height:30},onClick:()=>{d(""),null!==p.current&&(p.current.value="")},children:(0,l.jsx)(ez.A,{fontSize:"small"})})}):null})})},placeholder:c.t("Search"),variant:"standard",onChange:e=>x(e.target.value.toLowerCase())})]}),(0,l.jsxs)(k.A,{sx:{overflowY:"auto",height:"calc(100vh - 172px)",px:4,py:2},children:[s&&!a.length?(0,l.jsx)(eC.A,{severity:"info",children:c.t("No modules matched your search criteria")}):null,(0,l.jsx)(es.Ay,{container:!0,spacing:3,children:s?a.map(e=>(0,l.jsx)(ey,{flaggedModuleId:i,installedModuleId:null==t?void 0:t.installedModuleId,selected:n===e.id,module:e,setModuleId:r},e.id)):[1,2,3,4].map(e=>(0,l.jsx)(ey,{},e))})]})]})};var eE=n(22393),e_=n(67906),eM=n(80553),eP=n(44395),eN=n(38111),eR=n(7579),eL=n(79270),eO=n(42371),eF=n(93554),eB=n(2665),eW=n(23842),eU=n(2452),eH=n(39335),eq=n(32237),eY=n(64879),eK=n(28099),eG=n(34591),eV=n(88992),e$=n(71090),eJ=n(39091),eX=n(4728),eZ=n(96571),eQ=n(56792),e0=n(53608),e1=n(45559);let e2=(0,w.Ay)("img")(()=>({width:200,height:200})),e5=e=>{let{uploadPath:t,getSrc:n,onChange:i=async()=>{},crop:r="fit",backgroundColor:s=null,borderColor:a=null,borderWidth:d=null,previewWidth:c=200,previewHeight:u=200,radius:p=5,alt:x="Logo",inputName:h="logo",label:f="Select logo",active:y=!1,width:A=256,height:j=256}=e;"function"!=typeof n&&(n=()=>"/img/logo/192.png");let w=(0,b.A)(),[C,I]=(0,g.useState)(n()),[T,z]=(0,g.useState)(!1),{i18n:D}=(0,m.B)(),E=null!==a&&null!==d?"solid":null,{getRootProps:_,getInputProps:M}=(0,e0.VB)({multiple:!1,accept:{"image/png":[".png"],"image/jpg":[".jpg",".jpeg"],"image/webp":[".webp"]},onDrop:e=>{let n=document.createElement("img");n.onload=function(){z(!0),setTimeout(()=>{let e=n.width,l=n.height,s=0,a=0;e>l?"fill"===r?(l=j,e*=j/n.height,s=parseInt((A-e)/2,10)):(e=A,l*=A/n.width,a=parseInt((j-l)/2,10)):"fill"===r?(e=A,l*=A/n.width,a=parseInt((j-l)/2,10)):(l=j,e*=j/n.height,s=parseInt((A-e)/2,10));let o=document.createElement("canvas");o.width=A,o.height=j,o.getContext("2d").drawImage(n,s,a,e,l),o.toBlob(e=>{let n=new FormData;n.append(h,e),(async()=>{try{let l=await v.A.post(t,n,{headers:{"Content-Type":"multipart/form-data"}});I(URL.createObjectURL(e)),"function"==typeof i&&await i(l.data,URL.createObjectURL(e)),z(!1)}catch(e){z(!1)}})()},"png"),o.remove(),n.remove()},Z.A.delay.request)},n.onerror=()=>{o.o.error(D.t("The selected file is not a valid image"),{duration:5e3,ariaProps:{role:"alert"}})},n.src=URL.createObjectURL(Object.assign(e[0]))},validator:()=>{}});return(0,l.jsx)(k.A,{children:T?(0,l.jsx)(k.A,{sx:{width:c,height:u,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,l.jsx)(V.A,{count:1,spacing:0,rounded:!0,sx:{p:5,width:c,height:u}})}):y?(0,l.jsxs)(k.A,{..._({className:"dropzone"}),sx:{position:"relative",alignItems:"center",justifyContent:"center",display:"flex",flexDirection:"column"},children:[(0,l.jsx)("input",{...M()}),(0,l.jsx)(e2,{src:C,alt:"logo",sx:{m:0,pointerEvents:"none",borderRadius:p,backgroundColor:s,borderStyle:E,borderWidth:d,borderColor:a,width:c,height:u}}),(0,l.jsxs)(k.A,{sx:{cursor:"pointer",position:"absolute",width:"70%",height:"70%",background:"dark"===w.palette.mode?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.6)",borderRadius:"50%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center","&:hover > p":{display:"none"},"&:hover > svg":{transform:"scale(2)"}},children:[(0,l.jsx)(e1.A,{}),(0,l.jsx)(S.A,{size:"large",color:"inherit",sx:{mt:2,textAlign:"center"},children:f})]})]}):(0,l.jsx)(k.A,{sx:{position:"relative",width:c,height:u,"&:before":{content:'""',display:"block",width:c,height:u,position:"absolute",top:0,left:0,zIndex:1,background:w.palette.background.paper,borderRadius:p}},children:(0,l.jsx)(e2,{src:C,sx:{position:"relative",zIndex:1,width:c,height:u,borderRadius:p,backgroundColor:"transparent",borderWidth:d,borderColor:a},alt:x})})})},e3=e=>{let{moduleData:t,isOpen:n=!1,onOpen:i=()=>{},onClose:r=()=>{},propagateModule:s=()=>{}}=e,{i18n:a}=(0,m.B)(),o=(0,b.A)(),d=(0,h.A)(),[c,u]=(0,g.useState)(!1),p=(0,g.useRef)(null),x={name:eJ.Yj().required(a.t("Module name is required")).min(3,()=>a.t("Must be at least {{n}} characters long",{n:3})).max(32,()=>a.t("Must be at most {{n}} characters long",{n:32})),h1:eJ.Yj().max(32,()=>a.t("Must be at most {{n}} characters long",{n:32})),h2:eJ.Yj().max(128,()=>a.t("Must be at most {{n}} characters long",{n:128})),vid:eJ.Yj().max(24,()=>a.t("Must be at most {{n}} characters long",{n:24})),description:eJ.Yj().max(4096,()=>a.t("Must be at most {{n}} characters long",{n:4096}))},{setValue:f,control:y,handleSubmit:A,formState:{errors:j},reset:w}=(0,eV.mN)({defaultValues:{name:"",h1:"",h2:"",vid:"",description:""},mode:"onChange",resolver:(0,e$.t)(eJ.Ik().shape(x))});(0,g.useEffect)(()=>{n&&"function"==typeof i&&i()},[n]),(0,g.useEffect)(()=>{"string"==typeof(null==t?void 0:t.id)&&(f("name",t.moduleName),f("h1",t.moduleH1),f("h2",t.moduleH2),f("vid",t.moduleVid),f("description",t.moduleDescription))},[t]);let S=()=>{n&&"function"==typeof r&&r(),w()},I=async e=>{var n,l;let{name:i,h1:a,h2:o,vid:c,description:p}=e;if("string"==typeof(null==t?void 0:t.id)&&(d.user.id===(null==t?void 0:t.authorId)||"founder"===(null==(n=d.user)?void 0:n.userRole))){u(!0);try{let e=await v.A.put("modules/".concat(t.id),{moduleName:i,moduleH1:a,moduleH2:o,moduleVid:c,moduleDescription:p});t.id===(null==(l=e.data)?void 0:l.id)&&s(e.data,["moduleName","moduleH1","moduleH2","moduleVid","moduleDescription"]),r()}catch(e){}u(!1)}},T=()=>{p.current&&p.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return n&&"string"==typeof(null==t?void 0:t.id)?(0,l.jsxs)(eL.A,{open:!0,fullWidth:!0,onClose:c?()=>{}:S,sx:{"& .MuiPaper-root":{maxWidth:c?"650px":"100%",p:2}},children:[c?null:(0,l.jsx)(eP.A,{children:a.t("Update module")}),(0,l.jsx)(eM.A,{children:c?(0,l.jsx)(k.A,{sx:{mt:3},children:(0,l.jsx)(V.A,{})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("form",{onSubmit:A(I),ref:p,style:{width:"100%",flexGrow:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:(0,l.jsxs)(es.Ay,{container:!0,sx:{mt:3},spacing:2,children:[(0,l.jsx)(es.Ay,{item:!0,xs:3,children:(0,l.jsx)(k.A,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(e5,{active:!0,crop:"fill",previewWidth:180,previewHeight:180,borderWidth:0,borderColor:o.palette.background.paper,backgroundColor:o.palette.background.paper,inputName:"logo",uploadPath:"modules/".concat(t.id,"/logo"),label:a.t("Select logo"),onChange:e=>{s(e,["moduleLogoId"])},alt:a.t("Module logo"),getSrc:()=>"string"==typeof(null==t?void 0:t.moduleLogoId)?"".concat(eo.A.s3Url,"/modules/").concat(null==t?void 0:t.id,"/").concat(t.moduleLogoId,".png"):"/img/placeholder/module.png"})})}),(0,l.jsxs)(es.Ay,{item:!0,xs:9,children:[(0,l.jsxs)(eZ.A,{fullWidth:!0,sx:{mb:4},error:!!j.name,children:[(0,l.jsx)(eV.xI,{name:"name",control:y,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eS.A,{autoFocus:!0,required:!0,value:t,onChange:n,onKeyDown:e=>"Enter"===e.key&&T(),spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:32,tabIndex:1},InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:-2},children:(0,l.jsx)(P.A,{fontSize:"small"})})},label:a.t("Module name"),error:!!j.name})}}),j.name&&(0,l.jsx)(eX.A,{sx:{color:"error.main"},children:j.name.message})]}),(0,l.jsx)(R.A,{title:a.t("Paste YouTube video URL or video ID. The video ID is automatically extracted from video URL."),placement:"top",children:(0,l.jsxs)(eZ.A,{fullWidth:!0,sx:{mb:4},error:!!j.moduleVid,children:[(0,l.jsx)(eV.xI,{name:"vid",control:y,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eS.A,{value:t,onChange:e=>((e,t)=>{var n;let l=e.target.value.match(/(?:youtube\.com\/(?:.*v=|.*\/embed\/|shorts\/)|youtu\.be\/)([\w\-]{11,})/i),i=l?l[1]:"".concat(null!=(n=e.target.value)?n:"").substring(0,24);t({...e,target:{...e.target,value:i}})})(e,n),onKeyDown:e=>"Enter"===e.key&&T(),spellCheck:!1,autoComplete:"off",InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:-2},children:(0,l.jsx)(eq.A,{})})},label:"YouTube video ID",error:!!j.vid})}}),j.vid&&(0,l.jsx)(eX.A,{sx:{color:"error.main"},children:j.vid.message})]})}),[{headingType:"h1",headingMaxLength:32},{headingType:"h2",headingMaxLength:128}].map(e=>{let{headingType:t,headingMaxLength:n}=e,i="h1"===t?eH.A:eG.A,r="h1"===t?a.t("Pain point"):a.t("Solution"),s="h1"===t?a.t("Get more leads"):a.t("Automate your work so you get leads while you sleep"),o=("h1"===t?a.t("Describe the pain point as an action."):a.t("Describe the solution in a sentence."))+" "+a.t("Example: '{{example}}'",{example:s});return(0,l.jsx)(k.A,{children:(0,l.jsx)(R.A,{title:o,placement:"top",children:(0,l.jsxs)(eZ.A,{fullWidth:!0,sx:{mb:4},error:!!j[t],children:[(0,l.jsx)(eV.xI,{name:t,control:y,render:e=>{let{field:{value:a,onChange:o}}=e;return(0,l.jsx)(eS.A,{value:a,onChange:o,onKeyDown:e=>"Enter"===e.key&&T(),spellCheck:!1,autoComplete:"off",inputProps:{maxLength:n},InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:-2},children:(0,l.jsx)(i,{})})},placeholder:s,label:r,error:!!j[t]})}}),j[t]&&(0,l.jsx)(eX.A,{sx:{color:"error.main"},children:j[t].message})]})})},t)})]}),(0,l.jsx)(es.Ay,{item:!0,xs:12,children:(0,l.jsxs)(eZ.A,{fullWidth:!0,error:!!j.description,children:[(0,l.jsx)(eV.xI,{name:"description",control:y,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eS.A,{multiline:!0,minRows:5,maxRows:12,value:t,onChange:n,spellCheck:!1,autoComplete:"off",onKeyDown:e=>"Enter"===e.key&&e.ctrlKey&&T(),inputProps:{maxLength:4096,tabIndex:2},InputProps:{sx:{p:1,borderRadius:1}},label:a.t("Module description"),error:!!j.description})}}),j.description&&(0,l.jsx)(eX.A,{sx:{color:"error.main"},children:j.description.message})]})})]})})})}),c?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:S,children:a.t("Cancel")}),(0,l.jsx)(C.A,{variant:"contained",onClick:()=>{p.current&&p.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},startIcon:(0,l.jsx)(eQ.A,{}),children:a.t("Update module")})]})]}):null},e4=e=>{var t,n;let{agent:i,onAgentUpdate:r=()=>{},privateModules:s=[],setPrivateModules:a=()=>{},publicModules:d=[],setPublicModules:c=()=>{},flaggedModuleId:u,moduleId:p,onClose:f=()=>{}}=e,{setSource:y,setSourceModified:A,setInstalled:j,moduleUpdate:w,setAgentTab:I,modulePurge:T,agentPurge:z,getFirstPlay:D}=(0,x.P)(),{i18n:E}=(0,m.B)(),_=(0,b.A)(),M=(0,h.A)(),[P,L]=(0,g.useState)(!1),[O,F]=(0,g.useState)(null),[B,W]=(0,g.useState)(null),[U,H]=(0,g.useState)(!1),[q,Y]=(0,g.useState)(!1),[K,G]=(0,g.useState)(!1),[$,J]=(0,g.useState)(!1),X=()=>{W(null)},Q=async()=>{var e,t,n,l,s,a;L(!1);try{let s=!1,a=!1,d=await v.A.put("agents/".concat(i.id,"/modules/").concat(p));i.id===(null==(e=d.data)?void 0:e.id)&&r(d.data);let c=await v.A.get("agents/".concat(i.id,"/src"));if(!Array.isArray(null==(t=c.data)?void 0:t.srcStateMachine))throw Error(E.t("Invalid state machine definition"));await z(i.id),y(i.id,c.data,!0),s=Array.isArray(c.data[eE.ModuleSrc.K_SRC_INPUTS])&&c.data[eE.ModuleSrc.K_SRC_INPUTS].length>0,a=(null!=(l=c.data[eE.ModuleSrc.K_SRC_STATE_MACHINE])?l:[]).length>0,A(i.id,!1);let u=await v.A.get("modules/".concat(p));"string"==typeof(null==(n=u.data)?void 0:n.id)&&j(i.id,u.data,d.data.installedModuleSrcId),D(i.id)&&ei(),o.o.success(s?E.t("Let's configure this module!"):a?E.t("Let's run this module!"):E.t("Let's edit this empty module!"),{duration:5e3}),window.setTimeout(()=>{L(!0),f(),I(a&&s?"settings":"")},250)}catch(e){404===(null==(s=e.response)?void 0:s.status)&&T(p),o.o.error("".concat(E.t("Install error"),": ").concat(null!=(a=e.message)?a:e),{duration:5e3,ariaProps:{role:"alert"}})}},ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(F(e),Array.isArray(t)&&t.length){let n=n=>{if((null==n?void 0:n.id)===p)for(let l of t)n[l]=e[l];return n};c(structuredClone(d).map(n)),a(structuredClone(s).map(n))}w(e)},et=async()=>{if(!M.user.id!==(null==O?void 0:O.authorId)){L(!1),J(!0);try{await v.A.delete("modules/".concat(p)),T(p)}catch(e){}c(structuredClone(d).filter(e=>(null==e?void 0:e.id)!==p)),a(structuredClone(s).filter(e=>(null==e?void 0:e.id)!==p)),L(!0),J(!1),G(!1)}},en=async()=>{if(!M.user.id!==(null==O?void 0:O.authorId)){L(!1),J(!0);try{var e;let t=await v.A.put("modules/".concat(p),{isPublic:!O.isPublic});p===(null==(e=t.data)?void 0:e.id)&&ee(t.data,["isPublic","isPending","isApproved"])}catch(e){}L(!0),J(!1),H(!1)}};(0,g.useEffect)(()=>{if(Y(!1),null!==p){L(!1);let e=window.setTimeout(async()=>{var e,t;try{let t=await v.A.get("modules/".concat(p));F(p===(null==(e=t.data)?void 0:e.id)?t.data:null)}catch(e){F(null),404===(null==(t=e.response)?void 0:t.status)&&T(p)}L(!0)},Z.A.delay.request);return()=>window.clearTimeout(e)}F(null)},[p]);let el=async e=>{var t;o.o.info(E.t("Navigating to video..."),null,!1),await (null==(t=window.sdk)?void 0:t.ipc.main.openExternal("https://www.youtube.com/watch?v=".concat(e)))};return(0,l.jsxs)(k.A,{sx:{display:"flex",position:"relative",flexDirection:"column",alignItems:"center",width:"100%",height:"calc(100vh - 80px)"},children:[(0,l.jsxs)(k.A,{sx:{position:"absolute",top:0,right:-6,zIndex:11,width:"100%",display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(k.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:P&&null!==O?(null==i?void 0:i.installedModuleId)!==(null==O?void 0:O.id)?(0,l.jsx)(C.A,{"data-install":!0,variant:"contained",sx:{borderRadius:"1rem"},startIcon:(0,l.jsx)(N.A,{}),size:"small",onClick:Q,className:null===(null==i?void 0:i.installedModuleId)||u===O.id?"pop pop-rounded":null,children:E.t("Install module")}):(0,l.jsx)(em,{}):null}),P&&(M.user.id===(null==O?void 0:O.authorId)||"founder"===(null==(t=M.user)?void 0:t.userRole))?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.A,{sx:{mr:2,display:"flex",alignItems:"center"},children:[null!==O?(0,l.jsx)(eu.A,{module:O,propagateModule:ee}):null,(0,l.jsx)(eT.A,{sx:{width:"40px",height:"40px",ml:2},onClick:e=>{W(e.currentTarget)},children:(0,l.jsx)(eW.A,{fontSize:"small"})})]}),(0,l.jsxs)(eO.A,{anchorOrigin:{vertical:"bottom",horizontal:"left"},anchorEl:B,open:!!B,onClose:X,children:[(0,l.jsx)(eN.A,{onClick:()=>{X(),Y(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(k.A,{sx:{display:"flex"},children:[(0,l.jsx)(eB.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:E.t("Edit module")})]})}),(0,l.jsx)(eN.A,{onClick:()=>{X(),H(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(k.A,{sx:{display:"flex"},children:[O.isPublic?(0,l.jsx)(eU.A,{fontSize:"small"}):(0,l.jsx)(eY.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:O.isPublic?E.t("Unpublish module"):E.t("Publish module")})]})}),(0,l.jsx)(eR.A,{}),(0,l.jsx)(eN.A,{onClick:()=>{X(),G(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(k.A,{sx:{display:"flex"},children:[(0,l.jsx)(eF.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:E.t("Delete module")})]})})]})]}):null]}),(0,l.jsx)(k.A,{sx:{height:180,mt:10},children:P?(0,l.jsx)(e5,{crop:"fill",previewWidth:180,previewHeight:180,borderWidth:0,borderColor:_.palette.background.paper,backgroundColor:_.palette.background.paper,inputName:"logo",uploadPath:"modules/".concat(p,"/logo"),label:E.t("Select logo"),onChange:e=>{ee(e,["moduleLogoId"])},alt:E.t("Module logo"),getSrc:()=>"string"==typeof(null==O?void 0:O.moduleLogoId)?"".concat(eo.A.s3Url,"/modules/").concat(p,"/").concat(O.moduleLogoId,".png"):"/img/placeholder/module.png"},null!=(n=null==O?void 0:O.moduleLogoId)?n:""):(0,l.jsx)(V.A,{rounded:!0,sx:{width:"180px",height:"180px"}})}),P?(0,l.jsxs)(k.A,{sx:{my:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsx)(S.A,{variant:"h4",sx:{textAlign:"center"},children:null!==O?O.moduleName:E.t("Module not found")}),(0,l.jsxs)(k.A,{children:[(0,l.jsx)(R.A,{title:Array.isArray(null==O?void 0:O.moduleReleases)&&O.moduleReleases.length?E.t("Latest release"):null,placement:"top",children:(0,l.jsx)(ep.A,{size:"small",variant:Array.isArray(null==O?void 0:O.moduleReleases)&&O.moduleReleases.length?"filled":"outlined",sx:{flexGrow:0,userSelect:"none"},label:Array.isArray(null==O?void 0:O.moduleReleases)&&O.moduleReleases.length?"v".concat(O.moduleReleases[O.moduleReleases.length-1].srcVersion):E.t("No releases")})}),(null==O?void 0:O.moduleVid.length)?(0,l.jsx)(R.A,{title:E.t("Navigate to Youtube video in local web browser"),placement:"top",children:(0,l.jsx)(C.A,{sx:{ml:3},variant:"text",size:"small",onClick:()=>el(O.moduleVid),startIcon:(0,l.jsx)(eq.A,{}),children:E.t("Watch video")})}):null]})]}):(0,l.jsx)(k.A,{sx:{display:"flex",justifyContent:"center"},children:(0,l.jsx)(V.A,{spacing:0,sx:{width:"15rem",my:5,height:"0.75rem",display:"inline-block"}})}),P?(0,l.jsxs)(k.A,{sx:{width:"100%",overflowY:"auto"},children:[null===O||!O.isPublic||O.isPending||O.isApproved?null:(0,l.jsx)(eC.A,{severity:"error",sx:{mb:2},children:(0,l.jsx)(S.A,{variant:"caption",color:"inherit",children:"string"==typeof O.reason&&O.reason.length?"".concat(E.t("Module rejected"),": ").concat(O.reason):E.t("Module rejected")})}),[{headingType:"h1"},{headingType:"h2"}].map(e=>{let{headingType:t}=e,n="h1"===t?eH.A:eG.A,i="h1"===t?"moduleH1":"moduleH2";return(0,l.jsx)(k.A,{children:(null==O?void 0:O[i].length)?(0,l.jsxs)(k.A,{sx:{whiteSpace:"pre-wrap",fontSize:"0.75rem",display:"flex",alignItems:"center",mb:2},children:[(0,l.jsx)(n,{color:"inherit",sx:{opacity:.5},fontSize:"small"}),(0,l.jsx)(S.A,{variant:"caption",sx:{ml:2},children:O[i]})]}):null},t)}),(null==O?void 0:O.moduleDescription.length)?(0,l.jsx)(S.A,{sx:{whiteSpace:"pre-wrap",fontSize:"0.75rem"},children:(0,l.jsx)(S.A,{variant:"caption",children:O.moduleDescription})}):(0,l.jsx)(eC.A,{severity:"warning",icon:(0,l.jsx)(eK.A,{}),sx:{fontSize:"0.75rem"},children:(0,l.jsx)(S.A,{variant:"caption",color:"inherit",children:E.t("No description provided")})})]}):(0,l.jsx)(V.A,{sx:{mt:-2},count:3}),P&&q?(0,l.jsx)(e3,{isOpen:!0,onClose:()=>Y(!1),propagateModule:ee,moduleData:O}):null,K?(0,l.jsxs)(eL.A,{open:!0,onClose:$?()=>{}:()=>G(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[$?null:(0,l.jsx)(eP.A,{children:E.t("Delete module")}),(0,l.jsx)(eM.A,{children:$?(0,l.jsx)(V.A,{}):(0,l.jsx)(eC.A,{severity:"warning",children:E.t("Are you sure you want to delete this module?")})}),$?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>G(!1),children:E.t("Cancel")}),(0,l.jsx)(C.A,{color:"error",onClick:et,startIcon:(0,l.jsx)(eF.A,{}),children:E.t("Delete module")})]})]}):null,U?(0,l.jsxs)(eL.A,{open:!0,onClose:$?()=>{}:()=>H(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[$?null:(0,l.jsx)(eP.A,{children:(null==O?void 0:O.isPublic)?E.t("Unpublish module"):E.t("Publish module")}),(0,l.jsx)(eM.A,{children:$?(0,l.jsx)(V.A,{}):O.isPublic||Array.isArray(null==O?void 0:O.moduleReleases)&&O.moduleReleases.length?(0,l.jsx)(eC.A,{severity:"warning",children:O.isPublic?E.t("Are you sure you want to unpublish this module? It will no longer be available for install in the module repository."):E.t("This action will make your module public. Once approved, it will be available to others in the module repository.")}):(0,l.jsx)(eC.A,{severity:"error",children:E.t("You cannot publish a module before creating a release.")})}),$?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>H(!1),children:Array.isArray(null==O?void 0:O.moduleReleases)&&O.moduleReleases.length?E.t("Cancel"):E.t("OK")}),O.isPublic||Array.isArray(null==O?void 0:O.moduleReleases)&&O.moduleReleases.length?(0,l.jsx)(C.A,{color:O.isPublic?"error":"primary",onClick:en,startIcon:O.isPublic?(0,l.jsx)(eU.A,{fontSize:"small"}):(0,l.jsx)(eY.A,{fontSize:"small"}),children:(null==O?void 0:O.isPublic)?E.t("Unpublish module"):E.t("Publish module")}):null]})]}):null]})},e6=e=>{let{agent:t,onClose:n=()=>{},onAgentUpdate:i=()=>{}}=e,{i18n:r}=(0,m.B)(),s=(0,b.A)(),[a,d]=(0,g.useState)(!1),[c,u]=(0,g.useState)(!1),[p,x]=(0,g.useState)(""),[h,f]=(0,g.useState)(null),[y,A]=(0,g.useState)([]),[j,w]=(0,g.useState)([]),[S,C]=(0,g.useState)(null),[I,T]=(0,g.useState)("");(0,g.useEffect)(()=>{var e;d(!1),C(null!=(e=null==t?void 0:t.installedModuleId)?e:null);let n=window.setTimeout(async()=>{try{let e=await v.A.get("modules");Array.isArray(e.data)&&A(e.data),d(!0)}catch(e){}},2*Z.A.delay.request);return()=>{window.clearTimeout(n)}},[]),(0,g.useEffect)(()=>{u(!1);let e=window.setTimeout(async()=>{if(p.length>0&&p.length<3){o.o.error(r.t("Search term must be at least 3 characters long")),u(!0);return}try{var e,t,n;let l="string"==typeof p&&p.length?{query:p}:{},i=await v.A.get("repository",{params:l});Array.isArray(null==(e=i.data)?void 0:e.modules)&&w(i.data.modules),f(null!=(n=null==(t=i.data)?void 0:t.flaggedModuleId)?n:null)}catch(e){}u(!0)},Z.A.delay.request);return()=>{window.clearTimeout(e)}},[p]);let z={"":{label:"Repository",icon:(0,l.jsx)(ee.A,{}),content:(0,l.jsx)(eD,{agent:t,moduleId:S,setModuleId:C,flaggedModuleId:h,modulesLoaded:c,modules:j,searchModuleName:p,setSearchModuleName:x})},dev:{label:"My modules",icon:(0,l.jsx)(Q.A,{}),content:(0,l.jsx)(eb,{agent:t,moduleId:S,setModuleId:C,modulesLoaded:a,modules:y,setModules:A})}};return(0,l.jsxs)(k.A,{sx:{display:"flex",height:"100%"},children:[(0,l.jsx)(k.A,{sx:{width:"100%",height:"100%",position:"relative"},children:(0,l.jsx)(X,{tabs:z,hash:I,setHash:T})}),S?(0,l.jsx)(k.A,{sx:{width:"375px",height:"100%",p:2,flexShrink:0,borderLeft:"1px solid ".concat(s.palette.divider)},children:(0,l.jsx)(e4,{agent:t,onClose:n,onAgentUpdate:i,publicModules:j,setPublicModules:w,privateModules:y,setPrivateModules:A,flaggedModuleId:h,moduleId:S})}):null]})},e9=e=>{var t;let{agents:n,onAgentUpdate:i=()=>{},onOpen:r=()=>{}}=e,{getAgentId:s,onAgentId:o,getDialogVisible:d,setDialogVisible:c,onDialogVisible:u,onMachineStatus:h,getMachineStatus:f}=(0,x.P)(),{i18n:y}=(0,m.B)(),[A,j]=(0,g.useState)((0,a.fD)(n,s())),[v,w]=(0,g.useState)("string"==typeof(null==A?void 0:A.installedModuleId)),[b,S]=(0,g.useState)(!1);(0,g.useEffect)(()=>{b&&"function"==typeof r&&r()},[b]);let I=()=>{c("repo",!1)};return(0,g.useEffect)(()=>{if(w("string"==typeof(null==A?void 0:A.installedModuleId)),"string"!=typeof(null==A?void 0:A.id))return;p.A.STATUS_STOPPED!==f(A.id).status&&I();let e=h(e=>{let{agentId:t,status:n}=e;A.id===t&&p.A.STATUS_STOPPED!==n&&I()});return()=>{e()}},[A]),(0,g.useEffect)(()=>{j((0,a.fD)(n,s()));let e=o(e=>j((0,a.fD)(n,e)));S(d("repo"));let t=u(e=>{let{dialog:t,visible:n}=e;return"repo"===t&&S(n)});return()=>{e(),t()}},[n]),(0,l.jsxs)(M.Ay,{open:b,onClose:I,anchor:"right",sx:{"&.MuiDrawer-root":{top:0,bottom:0,left:250},"& .MuiBackdrop-root":{position:"absolute"},"& .MuiDrawer-paper":{width:"100%"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute",boxShadow:"none"}},children:[(0,l.jsx)(B,{sx:{position:"relative",zIndex:1,background:"transparent",px:4},icon:(0,l.jsx)(P.A,{}),title:"".concat(y.t("Agent module")," - ").concat(null!=(t=null==A?void 0:A.name)?t:""),handleClose:I}),null!==(null==A?void 0:A.installedModuleId)||v?null:(0,l.jsxs)(k.A,{sx:{position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"hidden",zIndex:0},children:[(0,l.jsx)(U.A,{className:"zoom-in"}),(0,l.jsx)(U.A,{className:"zoom-in",sx:{animationDelay:"2s"}})]}),(0,l.jsx)(W,{sx:{position:"relative",zIndex:1,p:0},children:v?(0,l.jsx)(e6,{agent:A,onAgentUpdate:i,onClose:I}):(0,l.jsxs)(k.A,{sx:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",flexDirection:"column"},children:[(0,l.jsx)(P.A,{sx:{width:"192px",height:"192px",mt:6},className:"rotate"}),(0,l.jsx)(C.A,{sx:{mt:12},size:"large",autoFocus:!0,startIcon:(0,l.jsx)(N.A,{}),onClick:()=>w(!0),variant:"contained",className:"pop",children:y.t("Install module")})]})})]})};var e7=n(51553),e8=n(81289),te=n(21936),tt=n(25175);let tn=(e,t)=>!!(null==e?void 0:e.installedModuleId)||Array.isArray(null==t?void 0:t.srcInputs)&&t.srcInputs.length>0||Array.isArray(null==t?void 0:t.srcOutputs)&&t.srcOutputs.length>0||Array.isArray(null==t?void 0:t.srcFunctions)&&t.srcFunctions.length>0||Array.isArray(null==t?void 0:t.srcStateMachine)&&t.srcStateMachine.length>0;function tl(e){let{agents:t,onSelect:n=()=>{},onUpdate:i=()=>{},onDelete:r=()=>{},showLoading:s=async()=>{}}=e,{i18n:o}=(0,m.B)(),{getAgentId:d,onAgentId:c,getLogsEnabled:u,onLogsEnabled:h,setLogsEnabled:f,getSource:y,onSource:A,onDialogVisible:j,getDialogVisible:v,setDialogVisible:w,onModuleUpdate:b,getInstalled:T,onMachineStatus:z,getMachineStatus:D}=(0,x.P)(),[E,_]=(0,g.useState)(p.A.STATUS_STOPPED),[M,N]=(0,g.useState)(!0),[L,O]=(0,g.useState)(null),[F,B]=(0,g.useState)(!1),[W,U]=(0,g.useState)(null),[H,q]=(0,g.useState)(!0),[Y,K]=(0,g.useState)(null),[V,$]=(0,g.useState)(!1);(0,g.useEffect)(()=>{$(u());let e=h(e=>$(e));if(null!==Y){var t;(async()=>{var e;let t=await y(d(),!0);B((null!=(e=null==t?void 0:t.srcStateMachine)?e:[]).length>0),N(tn(Y,t))})();let{module:e,moduleVersion:n}=T(Y.id);O((0,a.rG)(null!=(t=null==e?void 0:e.moduleName)?t:null,n))}let n=A(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==Y?void 0:Y.id)){var l;B((null!=(l=null==n?void 0:n.srcStateMachine)?l:[]).length>0),N(tn(Y,n))}}),l=b(e=>{var t;let{module:n}=e;if("string"!=typeof(null==Y?void 0:Y.installedModuleId)||(null==Y?void 0:Y.installedModuleId)!==(null==n?void 0:n.id))return;let{moduleVersion:l}=T(Y.id);O((0,a.rG)(null!=(t=n.moduleName)?t:null,l))});q(!v());let i=j(()=>{q(!v())});_(D(null==Y?void 0:Y.id).status);let r=z(e=>{let{agentId:t,status:n}=e;Y.id===t&&_(n)});return()=>{i(),l(),e(),n(),r()}},[Y]),(0,g.useEffect)(()=>{K((0,a.fD)(t,d()));let e=c(e=>K((0,a.fD)(t,e)));return()=>{e()}},[t]);let J=()=>{U(null)},X=async()=>{if(null!==Y){var e;await (null==(e=window.sdk)?void 0:e.ipc.source.open(Y.id))&&await s()}J()},Z=async e=>{e.preventDefault(),e.stopPropagation(),f(null==Y?void 0:Y.id,!V),J()};return null!==Y?(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(R.A,{title:o.t("Agent module"),placement:"left",children:(0,l.jsx)(k.A,{sx:{mr:2},children:(0,l.jsx)(C.A,{color:"inherit",size:"small",disabled:p.A.STATUS_STOPPED!==E,startIcon:(0,l.jsx)(P.A,{sx:{width:"24px",height:"24px"}}),sx:{textTransform:"none"},className:H&&!M?"pop pop-inset":null,"data-modules-toggle":!0,onClick:()=>{null!==Y&&(w("repo",!v("repo")),n(Y.id,!0)),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},children:(0,l.jsx)(S.A,{variant:"caption",sx:{color:"inherit",maxWidth:"150px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"0.75rem",fontFamily:"Yaldevi,sans-serif"},children:null===L?M?o.t("No module installed"):o.t("Install module"):L})})})}),(0,l.jsxs)(eT.A,{sx:{width:"40px",height:"40px",mr:2,position:"relative"},onClick:e=>{U(e.currentTarget),null!==Y&&n(Y.id,!0)},children:[(0,l.jsx)(eW.A,{}),null===L||F||W?null:(0,l.jsx)(G.A,{sx:{position:"absolute",top:-1,right:-8},color:"warning"})]}),(0,l.jsxs)(eO.A,{anchorEl:W,open:!!W,onClose:J,children:[(0,l.jsx)(R.A,{title:o.t("Toggle the capturing of agent logs on this device"),placement:"left",children:(0,l.jsxs)(eN.A,{onClick:Z,sx:{justifyContent:"space-between"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex"},children:[(0,l.jsx)(I.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:o.t("Agent logs")})]}),(0,l.jsx)(e7.A,{size:"small",sx:{ml:3},checked:V,defaultValue:V})]})}),(0,l.jsx)(R.A,{title:F?null:o.t("Add one state to make this agent playable"),placement:"left",children:(0,l.jsx)(k.A,{children:(0,l.jsxs)(eN.A,{disabled:p.A.STATUS_STOPPED!==E,onClick:X,className:null===L||F?null:"pop pop-inset",sx:{"&.pop:after":{inset:"5px"}},children:[(0,l.jsx)(e8.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:o.t("Source code")})]})})}),(0,l.jsxs)(eN.A,{onClick:()=>{if(null!==Y){var e;null==(e=window.sdk)||e.ipc.target.openDevTools(Y.id,Y.name)}J()},children:[(0,l.jsx)(tt.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:o.t("Developer tools")})]}),(0,l.jsx)(eR.A,{}),(0,l.jsxs)(eN.A,{onClick:()=>{i(),J()},children:[(0,l.jsx)(te.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:o.t("Rename agent")})]}),(0,l.jsxs)(eN.A,{onClick:()=>{r(),J()},children:[(0,l.jsx)(eF.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:o.t("Delete agent")})]})]})]}):null}var ti=n(71608),tr=n(10217),ts=n(26667),ta=n(76109),to=n(72563),td=n(80825),tc=n(88639),tu=n(19999);let tp=(0,w.Ay)(k.A)(e=>{var t,n;let{theme:l,color:i="primary",percent:r=0}=e;return{position:"absolute",top:"5px",left:"5px",borderRadius:"5px",width:"5px",height:"40px",background:l.palette.divider,"&:before":{content:'""',display:"block",position:"absolute",borderRadius:"5px",bottom:0,left:0,width:"100%",height:"".concat(r,"%"),minHeight:"5px",transformOrigin:"50% 100%",background:null!=(n=null==(t=l.palette[i])?void 0:t.main)?n:l.palette.primary.main,transition:"transform 200ms linear"}}}),tx=e=>{var t,n,i,r,s,a,o,d,c,u,p;let{type:f="chip"}=e,{onSubscription:y,getSubscription:A}=(0,x.P)(),[j,v]=(0,g.useState)({}),{i18n:w}=(0,m.B)(),b=(0,h.A)();(0,g.useEffect)(()=>{v(A());let e=y(e=>{let{info:t}=e;v(t)});return()=>{e()}},[]);let C=j.active&&"pilot"===j.status&&j.pilotTotal>0&&100*j.pilotLeft/j.pilotTotal<=33;if("chip"===f){let e=(null==(t=b.user)?void 0:t.computerEnabled)?j.active?"pilot"===j.status?C?w.t("Your free trial is almost over"):w.t("Free trial"):w.t("Active subscription"):null:w.t("Computer disabled");return j.ready?(0,l.jsx)(R.A,{title:e,placement:"right",children:(0,l.jsx)(ep.A,{size:"small",color:(null==(n=b.user)?void 0:n.computerEnabled)?j.active?"pilot"===j.status?C?"warning":"success":eo.A.billing.subscriptionStatus.pastDue===j.status?"warning":"default":"warning":"error",label:(null==(i=b.user)?void 0:i.computerEnabled)?j.active?"pilot"===j.status?w.t("Free trial"):null!=(s=null==(r=j.pricePlan)?void 0:r.productName)?s:"Zen":w.t("Locked"):w.t("Disabled"),variant:j.active&&!["pilot",eo.A.billing.subscriptionStatus.pastDue].includes(j.status)?"outlined":"filled",sx:{height:"1.2rem",fontSize:"0.75rem",fontFamily:"Yaldevi,sans-serif",textTransform:"none"}})}):null}if("progress"===f)return(null==(a=b.user)?void 0:a.computerEnabled)&&j.ready&&j.active&&"pilot"===j.status&&Number.isInteger(j.pilotTotal)&&j.pilotTotal>0?(0,l.jsx)(tp,{color:C?"warning":"success",percent:Math.round(100*j.pilotLeft/j.pilotTotal)}):null;if("label"===f){let e={[eo.A.billing.subscriptionStatus.active]:w.t("active"),[eo.A.billing.subscriptionStatus.cancelled]:w.t("cancelled"),[eo.A.billing.subscriptionStatus.onTrial]:w.t("on trial"),[eo.A.billing.subscriptionStatus.pastDue]:w.t("past due"),[eo.A.billing.subscriptionStatus.unpaid]:w.t("unpaid"),[eo.A.billing.subscriptionStatus.paused]:w.t("paused"),[eo.A.billing.subscriptionStatus.expired]:w.t("expired")};return(0,l.jsx)(R.A,{title:(null==(o=b.user)?void 0:o.computerEnabled)?j.active?"pilot"===j.status?w.t("Review pricing plans before your trial expires"):eo.A.billing.subscriptionStatus.pastDue===j.status?w.t("Click to fix billing issue"):null:w.t("Unlock by upgrading to a paid plan"):w.t("Click to enable this computer"),placement:"bottom",children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(null==(d=b.user)?void 0:d.computerEnabled)?j.active?"pilot"===j.status?(0,l.jsx)(tu.A,{fontSize:"small",color:C?"warning":"inherit"}):eo.A.billing.subscriptionStatus.pastDue===j.status?(0,l.jsx)(td.A,{fontSize:"small",color:"warning"}):(0,l.jsx)(to.A,{fontSize:"small"}):(0,l.jsx)(ta.A,{fontSize:"small",color:"warning"}):(0,l.jsx)(tc.A,{color:"error"}),(0,l.jsx)(S.A,{color:(null==(c=b.user)?void 0:c.computerEnabled)?j.active?"pilot"===j.status?"inherit":eo.A.billing.subscriptionStatus.pastDue===j.status?"warning.main":"inherit":"warning.main":"error.main",variant:"caption",sx:{ml:3},children:(null==(u=b.user)?void 0:u.computerEnabled)?j.active?"pilot"===j.status?w.t("Expires in: {{time}}",{time:["".concat(Math.floor(j.pilotLeft/3600),"h"),"".concat(Math.floor(j.pilotLeft%3600/60),"m")].join(", ")}):eo.A.billing.subscriptionStatus.pastDue===j.status?w.t("Pay overdue invoice"):"".concat(w.t("Manage billing")," (").concat(null!=(p=e[j.status])?p:j.status,")"):w.t("Purchase to unlock"):w.t("Computer disabled")})]})})}return null},th=e=>e&&("TEXTAREA"===e.nodeName||"INPUT"===e.nodeName),tm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,g.useRef)(null),n=()=>{e.onSuccess&&e.onSuccess(),e.selectOnCopy&&th(t.current)&&t.current.select()},l=()=>{e.onError&&e.onError(),!1!==e.selectOnError&&th(t.current)&&t.current.select()},i=e=>{en()(e).then(n).catch(l)};return{copy:(0,g.useCallback)(e=>{"string"==typeof e?i(e):t.current&&i(t.current.value)},[]),target:t}};var tg=n(50138),tf=n(35283),ty=n(47896),tA=n(72815),tj=n(72471),tv=n(20191),tw=n(27780),tb=n(216),tk=n(54544),tS=n(22653),tC=n(6995);let tI=(0,w.Ay)(k.A)(e=>{let{theme:t,size:n="small"}=e;return{background:t.palette.background.paper,justifyContent:"center",alignItems:"center",display:"flex",boxShadow:t.shadows[3],borderRadius:"small"===n?"0.4rem":"1rem",fontSize:"small"===n?"0.85rem":"3rem",marginRight:"small"===n?"0px":"2px",marginLeft:"small"===n?"1px":"2px",height:"small"===n?"2rem":"5rem",width:"small"===n?"1.1rem":"3rem"}});function tT(e){let{subInfo:t={},sx:n={},small:i=!1}=e,r=(0,b.A)(),s=(0,tC.A)(r.breakpoints.up("sm")),[a,o]=(0,g.useState)(null);("object"!=typeof n||null===n)&&(n={}),(0,g.useEffect)(()=>{let e=null;return Number.isInteger(t.pilotLeft)&&t.pilotLeft>0&&(o(t.pilotLeft),e=setInterval(()=>{o(e=>e-1)},1e3)),()=>null!==e&&clearInterval(e)},[t.pilotLeft]);let d=t.pilotLeft>0&&(t.planComputersCount>0&&t.computersCount>t.planComputersCount||t.planAgentsCount>0&&t.agentsCount>t.planAgentsCount),c=(s||!i?"00:00:00":"00:00").split("");return"number"==typeof a&&a>0&&(c=[Math.floor(a/3600),Math.floor(a%3600/60),...s||!i?[Math.floor(a%60)]:[]].map(e=>"".concat(e).padStart(2,"0")).join(":").split("")),t.active&&"pilot"===t.status||d?(0,l.jsx)(k.A,{sx:{display:"flex",justifyContent:"space-between",...n},children:c.map((e,t)=>(0,l.jsx)(tI,{size:i?"small":"large",children:e},t))}):null}let tz=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{position:"absolute",left:"-2rem",bottom:"-5rem",width:"25rem",height:"25rem",zIndex:1,opacity:.1,"&>svg":{position:"relative",width:"100%",height:"100%"}}}),tD=(0,w.Ay)("pre")(e=>{let{theme:t}=e;return{backgroundColor:t.palette.divider,padding:t.spacing(2),marginTop:0,marginBottom:0,color:t.palette.text.primary,marginRight:t.spacing(2),borderRadius:t.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}});function tE(e){var t,n,i,r,s,a;let{isOpen:d=!1,onClose:c=()=>{}}=e,{onSubscription:u,getSubscription:p}=(0,x.P)(),{i18n:f}=(0,m.B)(),y=tm(),A=(0,h.A)(),[v,w]=(0,g.useState)(null),[b,I]=(0,g.useState)({}),[T,z]=(0,g.useState)(!1);(0,g.useEffect)(()=>{I(p());let e=u(e=>{let{info:t}=e;I(t)});return(async()=>{var e;w(await (null==(e=window.sdk)?void 0:e.ipc.device.getSerialNumber()))})(),z(!0),()=>e()},[]);let D=()=>{d&&"function"==typeof c&&c()},E=async e=>{o.o.info(f.t("Copied computer serial number to clipboard"),null,!1),y.copy(e)},_=async()=>{var e,t,n;D(),o.o.info((null==(e=A.user)?void 0:e.computerEnabled)?f.t("Navigating to billing page..."):f.t("Navigating to my computers..."),null,!1),await (null==(n=window.sdk)?void 0:n.ipc.main.openExternal((null==(t=A.user)?void 0:t.computerEnabled)?"".concat(eo.A.siteUrl,"/profile/#/tab:billing"):"".concat(eo.A.siteUrl,"/#/tab:computers")))},M=[{key:"computersCount",labelSingular:f.t("computer"),labelPlural:f.t("computers"),count:b.computersCount,max:j().max.computersCount,boostedCount:b.planComputersCount,boostedTooltip:f.t("You can use this extra computer until the trial ends"),Icon:tk.A},{key:"agentsCount",labelSingular:f.t("agent per computer"),labelPlural:f.t("agents per computer"),count:b.agentsCount,max:j().max.agentsCount,boostedCount:b.planAgentsCount,boostedTooltip:f.t("You can use this extra agent until the trial ends"),Icon:tA.A}],P=Math.max(j().max.computersCount,j().max.agentsCount),N=b.pilotLeft>0&&(b.planComputersCount>0&&b.computersCount>b.planComputersCount||b.planAgentsCount>0&&b.agentsCount>b.planAgentsCount),L=!(null==(t=A.user)?void 0:t.computerEnabled)||!b.active||eo.A.billing.subscriptionStatus.pastDue===b.status;return d&&T?(0,l.jsxs)(eL.A,{open:!0,onClose:D,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(tz,{className:"rotate",children:(null==(n=A.user)?void 0:n.computerEnabled)?b.active?"pilot"===b.status?(0,l.jsx)(tw.A,{color:"info"}):eo.A.billing.subscriptionStatus.pastDue===b.status?(0,l.jsx)(ty.A,{color:"warning"}):N?(0,l.jsx)(tf.A,{color:"success"}):(0,l.jsx)(tg.A,{color:"success"}):(0,l.jsx)(tS.A,{color:"warning"}):(0,l.jsx)(tc.A,{})}),(0,l.jsxs)(eP.A,{children:[(null==(i=A.user)?void 0:i.computerEnabled)?b.active?"pilot"===b.status?f.t("Free trial"):eo.A.billing.subscriptionStatus.pastDue===b.status?f.t("Invoice past due"):f.t("Active subscription"):f.t("Subscription required"):f.t("Computer disabled"),N?" (".concat(f.t("boosted"),")"):null]}),(0,l.jsx)(eM.A,{sx:{my:6,position:"relative",zIndex:2},children:(null==(r=A.user)?void 0:r.computerEnabled)?b.active?(0,l.jsxs)(k.A,{children:["pilot"!==b.status&&eo.A.billing.subscriptionStatus.pastDue===b.status?(0,l.jsx)(eC.A,{severity:"warning",sx:{mb:6},children:f.t("Invoice past due. Please fix this issue to avoid service interruption.")}):null,"pilot"===b.status||N?(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",userSelect:"none",mb:6},children:[(0,l.jsx)(tT,{subInfo:b,sx:{mb:6}}),(0,l.jsx)(S.A,{variant:"body2",children:f.t("Free trial limits expire soon")})]}):null,M.map(e=>(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[(0,l.jsx)(k.A,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",mr:6},children:[...Array(P).keys()].map(t=>{let n=N&&t>=e.boostedCount;return t<e.count?(0,l.jsx)(R.A,{placement:"top",title:n?e.boostedTooltip:null,children:(0,l.jsx)(e.Icon,{className:n?"zoom-in":null,color:n?"success":"inherit"})},t):(0,l.jsx)(tv.A,{sx:{opacity:+(t<e.max)}},t)})}),(0,l.jsx)(k.A,{sx:{minWidth:"10rem",textAlign:"right"},children:(0,l.jsxs)(S.A,{variant:"body2",color:"text.secondary",children:[(0,l.jsx)("b",{children:e.count})," ",1===e.count?e.labelSingular:e.labelPlural]})})]},e.key))]}):(0,l.jsx)(eC.A,{icon:(0,l.jsx)(tj.A,{}),severity:"warning",variant:"filled",children:f.t("To continue using the software, please upgrade to a paid plan.")}):(0,l.jsxs)(eC.A,{severity:"info",icon:(0,l.jsx)(tc.A,{}),sx:{"&>.MuiAlert-message":{width:"100%"}},children:[(0,l.jsx)(S.A,{variant:"body2",sx:{color:"inherit",width:"100%"},children:f.t("Please go to your dashboard and enable computer with serial number:")}),(0,l.jsxs)(k.A,{display:"flex",sx:{width:"100%",justifyContent:"center",alignItems:"center",my:3},children:[(0,l.jsx)(R.A,{title:f.t("The computer serial number is an anonymized unique hash that you can use to identify this computer in your online dashboard."),placement:"top",children:(0,l.jsx)(tD,{children:v})}),(0,l.jsx)(R.A,{title:f.t("Click to copy"),placement:"top",children:(0,l.jsx)(eT.A,{onClick:()=>E(v),children:(0,l.jsx)(tb.A,{fontSize:"small"})})})]})]})}),(0,l.jsxs)(e_.A,{sx:{position:"relative",zIndex:2},children:[(0,l.jsx)(C.A,{startIcon:(null==(s=A.user)?void 0:s.computerEnabled)?(0,l.jsx)(to.A,{}):(0,l.jsx)(tk.A,{}),onClick:_,color:b.active?"primary":"warning",className:L?"pop":null,variant:"contained",children:(null==(a=A.user)?void 0:a.computerEnabled)?f.t("Go to billing"):f.t("Go to my computers")}),(0,l.jsx)(C.A,{color:"secondary",onClick:D,children:f.t("Close")})]})]}):null}var t_=n(28888),tM=n(38993),tP=n(29814);function tN(){let e=(0,t_._)(["\n0%   { transform: scale(0.2); opacity: 0; }\n100% { transform: scale(1); opacity: 1; }"]);return tN=function(){return e},e}let tR=(0,tM.i7)(tN()),tL=(0,w.Ay)(tP.A)(e=>{let{theme:t}=e;return{position:"absolute",right:"-10rem",bottom:"-10rem",width:"35rem",height:"35rem",zIndex:1,opacity:.1}}),tO=(0,w.Ay)("pre")(e=>{let{theme:t}=e;return{backgroundColor:t.palette.divider,padding:t.spacing(2),marginTop:0,marginBottom:0,marginRight:t.spacing(2),borderRadius:t.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}}),tF=(0,w.Ay)(es.Ay)(e=>{let{theme:t,index:n=0}=e;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(tR," 750ms ease-in-out forwards"),animationDelay:"".concat(100*n,"ms")}}),tB=e=>{let{isOpen:t=!1,onOpen:n=()=>{},onClose:i=()=>{}}=e,{i18n:r}=(0,m.B)();(0,g.useEffect)(()=>{t&&"function"==typeof n&&n()},[t]);let s=()=>{t&&"function"==typeof i&&i()},a=[{key:"w",name:r.t("Web browser tab")},{key:"[1...9]",name:r.t("Select agent")},{key:"e",name:r.t("Settings tab")},{key:".",name:r.t("Start/Stop current agent")},{key:"r",name:r.t("Results tab")},{key:"u",name:r.t("Source code")},{key:"i",name:r.t("Developer tools")},{key:"m",name:r.t("Module panel")},{key:"l",name:r.t("Logs panel")},{key:"Esc",name:r.t("Close dialogs")}];return t?(0,l.jsxs)(eL.A,{open:!0,onClose:s,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(tL,{color:"action",className:"rotate"}),(0,l.jsx)(eP.A,{sx:{position:"relative",zIndex:2},children:r.t("Keyboard shortcuts")}),(0,l.jsx)(eM.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(es.Ay,{container:!0,children:a.map((e,t)=>(0,l.jsx)(tF,{xs:6,item:!0,index:t,children:(0,l.jsxs)(k.A,{sx:{display:"flex",mb:2,alignItems:"center"},children:[(0,l.jsxs)(tO,{children:["Esc"!==e.key?"Ctrl+":"",1===e.key.length?e.key.toUpperCase():e.key]}),(0,l.jsx)(S.A,{variant:"body2",sx:{mx:2},children:e.name})]})},"".concat(t,"-").concat(e.key)))})}),(0,l.jsx)(e_.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(C.A,{color:"secondary",onClick:s,children:r.t("Close")})})]}):null};var tW=n(81041),tU=n(60999),tH=n(95807),tq=n(66766),tY=n(61293),tK=n(79701),tG=n(95978),tV=n(46320),t$=n(20003),tJ=n(75359);function tX(){let e=(0,t_._)(["\n0%   { transform: scale(0.2); opacity: 0; }\n100% { transform: scale(1); opacity: 1; }"]);return tX=function(){return e},e}function tZ(){let e=(0,t_._)(["\n0%   { transform: scale(0.1) translateY(10rem); opacity: 0; }\n100% { transform: scale(1) translateY(0); opacity: 1; }"]);return tZ=function(){return e},e}let tQ=(0,tM.i7)(tX()),t0=(0,tM.i7)(tZ()),t1=(0,w.Ay)(tV.A)(e=>{let{theme:t}=e;return{position:"absolute",right:"-10rem",bottom:"-10rem",width:"35rem",height:"35rem",zIndex:1,opacity:.1}}),t2=(0,w.Ay)("pre")(e=>{let{theme:t}=e;return{backgroundColor:t.palette.divider,padding:t.spacing(2),marginTop:0,marginBottom:0,marginRight:t.spacing(2),borderRadius:t.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}}),t5=(0,w.Ay)(C.A)(e=>{let{theme:t,index:n=0}=e;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(t0," 750ms ease-in-out forwards"),animationDelay:"".concat(100*n,"ms")}}),t3=(0,w.Ay)(tW.Ay)(e=>{let{theme:t,index:n=0}=e;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(tQ," 750ms ease-in-out forwards"),animationDelay:"".concat(100*n,"ms")}}),t4=e=>{var t,n,i,r,s;let{isOpen:a=!1,onOpen:d=()=>{},onClose:c=()=>{}}=e,{i18n:u}=(0,m.B)(),p=tm(),[x,h]=(0,g.useState)({});(0,g.useEffect)(()=>{a&&"function"==typeof d&&d()},[a]),(0,g.useEffect)(()=>{let e=setTimeout(async()=>{var e,t;let n=eo.A.version,l=await (null==(e=window.sdk)?void 0:e.ipc.main.getProcessVersions()),i=await (null==(t=window.sdk)?void 0:t.ipc.device.getSerialNumber());h({...l,app:n,serialNumber:i})},150);return()=>clearTimeout(e)},[]);let f=()=>{a&&"function"==typeof c&&c()},y=async()=>{var e;o.o.info(u.t("Navigating to licenses..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.main.openExternal("https://github.com/oglama/oglama/blob/main/NOTICE.md"))},A=async()=>{var e;o.o.info(u.t("Navigating to status page..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.main.openExternal("https://status.oglama.com/"))},j=async()=>{var e;o.o.info(u.t("Navigating to Terms of Service..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.main.openExternal("".concat(eo.A.siteUrl,"/terms-of-service/")))},v=async()=>{var e;o.o.info(u.t("Navigating to my computers..."),null,!1),await (null==(e=window.sdk)?void 0:e.ipc.main.openExternal("".concat(eo.A.siteUrl,"/#/tab:computers")))},w=[{icon:(0,l.jsx)(tk.A,{color:"inherit",fontSize:"large"}),key:"serialNumber",name:u.t("Serial Number"),version:null!=(t=x.serialNumber)?t:null,tooltip:u.t("The computer serial number is an anonymized unique hash that you can use to identify this computer in your online dashboard.")},{icon:(0,l.jsx)(tK.A,{color:"warning",fontSize:"large"}),key:"chrome",name:"Chromium",version:null!=(n=x.chrome)?n:null},{icon:(0,l.jsx)(tq.A,{color:"primary",fontSize:"large"}),key:"electron",name:"Electron.js",version:null!=(i=x.electron)?i:null},{icon:(0,l.jsx)(t$.A,{color:"success",fontSize:"large"}),key:"node",name:"Node.js",version:null!=(r=x.node)?r:null},{icon:(0,l.jsx)(tJ.A,{size:35,animate:!0}),key:"oglama",name:"Oglama",version:null!=(s=x.app)?s:null}];return a?(0,l.jsxs)(eL.A,{open:!0,onClose:f,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(t1,{color:"action",className:"rotate"}),(0,l.jsx)(eP.A,{sx:{position:"relative",zIndex:2},children:u.t("About Oglama")}),(0,l.jsx)(eM.A,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(tU.A,{children:w.map((e,t)=>{var n;return(0,l.jsxs)(t3,{index:t,children:[e.icon,(0,l.jsx)(S.A,{variant:"body2",sx:{mx:2},children:e.name}),e.version?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R.A,{title:null!=(n=e.tooltip)?n:null,placement:"top",children:(0,l.jsx)(t2,{children:e.version})}),(0,l.jsx)(R.A,{title:u.t("Click to copy"),placement:"top",children:(0,l.jsx)(eT.A,{onClick:()=>((e,t,n)=>{o.o.info("serialNumber"===e?u.t("Copied computer serial number to clipboard"):u.t("Copied {{name}} version to clipboard",{name:t}),null,!1),p.copy("serialNumber"===e?n:"".concat(t," v").concat(n))})(e.key,e.name,e.version),children:(0,l.jsx)(tb.A,{fontSize:"small"})})}),"serialNumber"===e.key?(0,l.jsx)(R.A,{title:u.t("Go to my computers"),placement:"top",children:(0,l.jsx)(eT.A,{onClick:()=>v(),children:(0,l.jsx)(el.A,{fontSize:"small"})})}):null]}):(0,l.jsx)(V.A,{sx:{width:"15rem",mt:2},spacing:0})]},"".concat(t,"-").concat(e.key))})})}),(0,l.jsxs)(e_.A,{sx:{position:"relative",zIndex:2},children:[(0,l.jsx)(t5,{index:5,onClick:y,startIcon:(0,l.jsx)(tG.A,{}),children:u.t("Licenses")}),(0,l.jsx)(t5,{index:6,onClick:A,startIcon:(0,l.jsx)(tH.A,{}),children:u.t("Contact & Status")}),(0,l.jsx)(t5,{index:7,onClick:j,startIcon:(0,l.jsx)(tY.A,{}),children:u.t("Terms")}),(0,l.jsx)(C.A,{color:"secondary",onClick:f,children:u.t("Close")})]})]}):null},t6=(0,w.Ay)(eO.A)(e=>{let{theme:t}=e;return{"& .MuiMenu-paper":{width:280,overflow:"hidden",marginTop:t.spacing(4),[t.breakpoints.down("sm")]:{width:"100%"}},"& .MuiMenu-list":{padding:0}}}),t9=()=>{let{checkSubscription:e}=(0,x.P)(),{i18n:t}=(0,m.B)(),n=(0,h.A)(),[i,r]=(0,g.useState)(!1),[s,a]=(0,g.useState)(!1),[o,d]=(0,g.useState)(!1),[c,u]=(0,g.useState)(null),[p,f]=(0,g.useState)(0),y=async t=>{var l;null==(l=window.sdk)||l.ipc.main.setOnTop(),u(t.currentTarget);let i=Math.floor(new Date().getTime()/1e3);i-p>=5&&(f(i),e(n,!0))},A=()=>u(null),j=async()=>{A(),r(!0)},v=async()=>{var e;A(),await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),d(!0)},w=async()=>{var e;A(),await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),a(!0)};return n.user?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(C.A,{onClick:y,fullWidth:!0,sx:{userSelect:"none",transition:"none",borderRadius:0,justifyContent:"space-between",alignItems:"center",height:"100%",position:"relative"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 25px)"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[(0,l.jsx)(tJ.A,{size:24,sx:{mx:1,transition:"all 200ms linear"}}),(0,l.jsx)(S.A,{variant:"body2",sx:{textTransform:"none",mx:2},children:Z.A.moduleName})]}),(0,l.jsx)(tx,{type:"chip"})]}),(0,l.jsx)(tx,{type:"progress"}),(0,l.jsx)(D,{sx:{flexShrink:0},open:!!c,children:(0,l.jsx)(ts.A,{color:"action"})})]}),(0,l.jsxs)(t6,{sx:{mt:-2,width:"250px"},anchorEl:c,"aria-disabled":"true",open:!!c,onClose:()=>A(),anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[(0,l.jsx)(eN.A,{onClick:()=>j(),children:(0,l.jsx)(tx,{type:"label"})}),(0,l.jsx)(eN.A,{onClick:()=>w(),children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(0,l.jsx)(tr.A,{fontSize:"small"}),(0,l.jsx)(S.A,{variant:"caption",sx:{ml:3},children:t.t("Keyboard shortcuts")})]})}),(0,l.jsx)(eN.A,{onClick:()=>v(),children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(0,l.jsx)(ti.A,{fontSize:"small"}),(0,l.jsx)(S.A,{variant:"caption",sx:{ml:3},children:t.t("About")})]})})]}),i?(0,l.jsx)(tE,{isOpen:!0,onClose:()=>r(!1)}):null,s?(0,l.jsx)(tB,{isOpen:!0,onClose:()=>a(!1)}):null,o?(0,l.jsx)(t4,{isOpen:!0,onClose:()=>d(!1)}):null]}):null};var t7=n(63684),t8=n(16954),ne=n(56090),nt=n(95578),nn=n(42304),nl=n(28196),ni=n(43539),nr=n(23078),ns=n(53395);function na(e){let{agent:t,title:n=null,iconSx:i={},nameSx:r={}}=e,{i18n:s}=(0,m.B)(),a="string"==typeof(null==t?void 0:t.name)?"".concat(s.t("Agent")," ").concat(null==t?void 0:t.name):s.t("Agent");return(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",fontSize:"inherit",fontFamily:"Inter, sans-serif"},children:[(0,l.jsx)(R.A,{title:a,children:(0,l.jsxs)(k.A,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",userSelect:"none"},children:[(0,l.jsx)(nr.A,{sx:{mr:2,...i}}),(0,l.jsx)(k.A,{sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px",...r},children:"string"==typeof(null==t?void 0:t.name)?t.name:null}),n?(0,l.jsx)(ns.A,{}):null]})}),null!=n?n:null]})}let no=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{month:"long",day:"numeric",year:"numeric"};return e?new Intl.DateTimeFormat(t,n).format(new Date(e)):e},nd=e=>no(e,"en-GB",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}),nc=e=>{let t=document.createElement("div");t.textContent=e;let n=t.innerHTML;return t.remove(),n},nu=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l="";if(Array.isArray(e)){let r=0;for(let s of e){var i;if(!n&&r>=j().max.logsOnRender)break;let e=s.s;["info","success","warning","error"].includes(e)||(e="info");let a="number"==typeof s.t?no(1e3*s.t,"en-US",{day:"numeric",month:"short",hour:"numeric",minute:"numeric",second:"numeric"}):"today",o=nc(null!=(i=s.m)?i:"");if("string"==typeof t&&t.length){let e=nc(t),n=o.toLowerCase().indexOf(e);-1!==n&&(o=o.substring(0,n)+"<u>".concat(o.substring(n,n+e.length),"</u>")+o.substring(n+e.length))}l+='<p><i class="'.concat(e,'"></i><span>').concat(o,"</span><b>").concat(a,"</b></p>"),r++}}return l};function np(e){let{agent:t,filterText:n,filterStatuses:i}=e,{i18n:r}=(0,m.B)(),{onLog:s,getLogs:a}=(0,x.P)(),[o,d]=(0,g.useState)(a(null==t?void 0:t.id)),[c,u]=(0,g.useState)(!1);(0,g.useEffect)(()=>{d(a(null==t?void 0:t.id));let e=s(e=>d(e));return()=>e()},[null==t?void 0:t.id]),(0,g.useEffect)(()=>{u(!1)},[o]);let p=[{slug:"info",label:r.t("Information")},{slug:"success",label:r.t("Success")},{slug:"warning",label:r.t("Warning")},{slug:"error",label:r.t("Error")}],h=Array.isArray(o)&&o.length?o.filter(e=>{let t=!0;return i.length!==p.length&&(t=i.includes(e.s)),t&&n.length&&(t="".concat(e.m).toLowerCase().includes(n)),t}):[],f=h.length<=j().max.logsOnRender||c?h.length:j().max.logsOnRender;return(0,l.jsx)(l.Fragment,{children:h.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{sx:{overflowY:"auto",mr:"1px"},children:(0,l.jsx)(k.A,{className:"log-box",dangerouslySetInnerHTML:{__html:nu(h,n,c)}})}),(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"end",height:"25px",pr:5,alignItems:"center",flexShrink:0},children:[!c&&Array.isArray(o)&&o.length>j().max.logsOnRender?(0,l.jsx)(k.A,{sx:{display:"flex",flexGrow:1,justifyContent:"center"},children:(0,l.jsx)(C.A,{size:"small",onClick:()=>u(!0),sx:{width:"100%",height:"25px",borderRadius:0},children:r.t("Load all")})}):null,(0,l.jsxs)(k.A,{sx:{display:"flex",flexGrow:0,flexShrink:0,ml:2},children:[(0,l.jsxs)(S.A,{variant:"caption",children:[f," ",1===f?r.t("message"):r.t("messages")]}),(0,l.jsx)(S.A,{variant:"caption",sx:{ml:1},children:"(".concat(Array.isArray(o)?o.length:0," ").concat(r.t("total"),")")})]})]})]}):(0,l.jsx)(eC.A,{variant:"standard",severity:"info",sx:{mx:2,mt:1},children:(0,l.jsx)(S.A,{variant:"caption",color:"inherit",children:p.length!==i.length||n.length?r.t("No messages matched your search criteria"):r.t("No messages were recorded for this agent")})})})}function nx(){let e=(0,t_._)(["\n0%   { transform: translateY(100vh); }\n100% { transform: translateY(0); }"]);return nx=function(){return e},e}let nh=(0,tM.i7)(nx()),nm=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{width:"2px",height:"20px",position:"relative",borderLeft:"1px solid ".concat((0,s.A)(t)),marginLeft:t.spacing(2),marginRight:t.spacing(2)}});function ng(e){let{agents:t}=e,{i18n:n}=(0,m.B)(),{getAgentActive:i,onAgentActive:r,getAgentId:o,onAgentId:d,getLogsEnabled:c,onLogsEnabled:u,getNavVisible:p,onNavVisible:h,getLogsVisible:f,onLogsVisible:y,setLogsVisible:A,clearLogs:j}=(0,x.P)(),v=(0,b.A)(),w=(0,g.useRef)(null),S=(0,g.useRef)(null),I=[{slug:"info",label:n.t("Information")},{slug:"success",label:n.t("Success")},{slug:"warning",label:n.t("Warning")},{slug:"error",label:n.t("Error")}],[T,z]=(0,g.useState)(null),[D,E]=(0,g.useState)(!1),[_,M]=(0,g.useState)(!1),[P,N]=(0,g.useState)(!1),[O,F]=(0,g.useState)(!1),[B,W]=(0,g.useState)(!1),[U,H]=(0,g.useState)([]),[q,Y]=(0,g.useState)(""),[K,G]=(0,g.useState)(!1),[V,$]=(0,g.useState)(!1);(0,g.useEffect)(()=>{H(()=>I.map(e=>e.slug)),E(i(o()));let e=r(e=>{let{agentId:t,active:n}=e;t===o()&&E(n)});M(c());let t=u(e=>M(e));N(f());let n=y(e=>N(e));W(p());let l=h(e=>W(e));return()=>{e(),t(),n(),l()}},[T]),(0,g.useEffect)(()=>{z((0,a.fD)(t,o()));let e=d(e=>z((0,a.fD)(t,e)));return()=>e()},[t]);let J="1px solid ".concat((0,s.A)(v));return T&&_&&P?(0,l.jsxs)(k.A,{sx:{boxShadow:D?"0px -1px 0px 0px #38b7d7":null,borderTop:J,zIndex:20,position:"fixed",display:"flex",flexDirection:"column",left:"250px",bottom:"50px",width:"calc(100vw - 250px)",height:K?B?"calc(100vh - 149px)":"calc(100vh - 99px)":"calc(50vh - 49px)",overflow:"hidden",opacity:V?.2:1,"&:hover":{opacity:V?.8:1},background:v.palette.background.default,transition:"opacity 100ms linear",animation:"".concat(nh," 200ms ease-in-out forwards")},children:[(0,l.jsxs)(k.A,{sx:{height:"50px",p:2,px:4,alignItems:"center",display:"flex"},children:[(0,l.jsx)(R.A,{title:n.t("Clear agent logs"),placement:"bottom-end",children:(0,l.jsx)(eT.A,{onClick:()=>F(!0),sx:{width:"2rem",height:"2rem"},children:(0,l.jsx)(eF.A,{fontSize:"small"})})}),(0,l.jsx)(nm,{}),(0,l.jsx)(nn.A,{fontSize:"small",sx:{mx:2},color:"action"}),(0,l.jsx)(eS.A,{inputRef:w,variant:"standard",placeholder:n.t("Filter"),onChange:e=>{var t;return t=e.target.value.toLowerCase(),void(null!==S.current&&window.clearTimeout(S.current),S.current=window.setTimeout(()=>{Y(t),S.current=null},450))},sx:{width:"100%","& input":{px:"0 !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},InputProps:{endAdornment:q?(0,l.jsx)(ek.A,{position:"end",children:(0,l.jsx)(k.A,{sx:{width:30,height:30},children:(0,l.jsx)(R.A,{title:n.t("Clear filter"),children:(0,l.jsx)(eT.A,{size:"small",sx:{width:30,height:30},onClick:()=>{Y(""),null!==w.current&&(w.current.value="")},children:(0,l.jsx)(ez.A,{fontSize:"small"})})})})}):null}}),(0,l.jsx)(k.A,{sx:{display:"flex",ml:2},children:I.map(e=>(0,l.jsx)(R.A,{title:"".concat(n.t("Toggle log level"),": ").concat(e.label),children:(0,l.jsx)(eT.A,{sx:{width:"2rem",height:"2rem",mr:1},onClick:()=>{var t;let n;return t=e.slug,n=[...U],void(U.includes(t)?n=n.filter(e=>e!==t):n.push(t),H(n))},children:U.includes(e.slug)?(0,l.jsx)(t7.A,{color:e.slug,fontSize:"small"}):(0,l.jsx)(nt.A,{color:e.slug,fontSize:"small"})})},e.slug))}),(0,l.jsx)(nm,{}),(0,l.jsx)(R.A,{title:n.t("Toggle translucence"),children:(0,l.jsx)(eT.A,{onClick:()=>$(!V),sx:{width:"2rem",height:"2rem",mr:1},children:V?(0,l.jsx)(ni.A,{fontSize:"small"}):(0,l.jsx)(nl.A,{fontSize:"small"})})}),(0,l.jsx)(R.A,{title:K?n.t("Restore"):n.t("Maximize"),children:(0,l.jsx)(eT.A,{onClick:()=>G(!K),sx:{width:"2rem",height:"2rem",mr:1},children:K?(0,l.jsx)(ne.A,{fontSize:"small"}):(0,l.jsx)(t8.A,{fontSize:"small"})})}),(0,l.jsx)(R.A,{title:n.t("Close"),children:(0,l.jsx)(eT.A,{onClick:()=>{A(!1),Y(""),H(I.map(e=>e.slug))},sx:{width:"2rem",height:"2rem",mr:1},children:(0,l.jsx)(L.A,{fontSize:"small"})})})]}),(0,l.jsx)(np,{agent:T,filterText:q,filterStatuses:U}),null!==T&&O?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>F(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{children:(0,l.jsx)(na,{agent:T,title:n.t("Clear agent logs")})}),(0,l.jsx)(eM.A,{children:(0,l.jsx)(eC.A,{severity:"warning",children:n.t("Are you sure you want to delete all messages for this agent?")})}),(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>F(!1),children:n.t("Cancel")}),(0,l.jsx)(C.A,{color:"error",onClick:()=>{j(null==T?void 0:T.id),F(!1)},startIcon:(0,l.jsx)(eF.A,{}),children:n.t("Clear agent logs")})]})]}):null]}):null}var nf=n(66911),ny=n(57429);let nA=(0,w.Ay)(H.A)(e=>{let{theme:t}=e;return{[t.breakpoints.down("md")]:{minWidth:100},[t.breakpoints.down("sm")]:{minWidth:67},height:"50px",minHeight:"50px"}}),nj=(0,w.Ay)("span")(e=>{let{theme:t}=e;return{fontSize:"0.8rem",lineHeight:"0.8rem",textTransform:"none",marginLeft:t.spacing(2.4),[t.breakpoints.down("md")]:{display:"none"}}});function nv(e){var t;let{agents:n}=e,{i18n:i}=(0,m.B)(),{getAgentActive:r,onAgentActive:s,getAgentId:o,onAgentId:d,onAgentTab:c,getAgentTab:u,setAgentTab:p,getInputs:h,onInputs:f,getSource:y,onSource:A,onNavVisible:j,getNavVisible:v,setNavVisible:w}=(0,x.P)(),[b,S]=(0,g.useState)({inputs:!1,outputs:!1}),[C,I]=(0,g.useState)(!1),[T,z]=(0,g.useState)(!1),[E,_]=(0,g.useState)(!1),[M,P]=(0,g.useState)([]),[N,R]=(0,g.useState)({}),[L,O]=(0,g.useState)(null),[F,B]=(0,g.useState)(""),W={"":{label:"Browser",icon:(0,l.jsx)(tK.A,{className:E?"rotate-360":null})},settings:{label:"Settings",icon:(0,l.jsx)(nf.A,{}),visible:T,hasPop:!(0,a.qH)(M,N)},results:{label:"Results",icon:(0,l.jsx)(ny.A,{}),visible:b.outputs}};return(0,g.useEffect)(()=>{null!==L&&(async()=>{var e,t;let n=await y(o(),!0);S((0,a.pv)(n)),P(null!=(e=null==n?void 0:n.srcInputs)?e:[]),R(await h(L.id)),z((null!=(t=null==n?void 0:n.srcStateMachine)?t:[]).length>0)})();let e=A(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==L?void 0:L.id)){var l,i;S((0,a.pv)(n)),P(null!=(l=null==n?void 0:n.srcInputs)?l:[]),z((null!=(i=null==n?void 0:n.srcStateMachine)?i:[]).length>0)}});_(r(o()));let t=s(e=>{let{agentId:t,active:n}=e;t===o()&&_(n)});B(u());let n=c(e=>B(e));I(v());let l=j(e=>I(e)),i=f(e=>{let{agentId:t,inputs:n,inputSessionId:l}=e;(null==L?void 0:L.id)===t&&null===l&&R(n)});return()=>{e(),n(),l(),t(),i()}},[L]),(0,g.useEffect)(()=>{O((0,a.fD)(n,o()));let e=d(e=>O((0,a.fD)(n,e)));return()=>e()},[n]),(0,g.useEffect)(()=>{T&&("results"!==u()||b.outputs)||p("")},[T,b.outputs]),L?(0,l.jsx)(q.Ay,{value:(null==(t=W[F])?void 0:t.visible)?F:"",children:(0,l.jsx)(K.A,{sx:{"& .MuiTabs-indicator":{borderRadius:"5px",marginBottom:"4px",height:"4px"}},onChange:(e,t)=>p(t),children:Object.keys(W).filter(e=>void 0===W[e].visible||W[e].visible).map((e,t)=>(0,l.jsx)(nA,{"data-tab":""===e?"browser":e,"data-tab-selected":F===e?"true":"false",icon:W[e].icon,iconPosition:"start",onClick:()=>{""===e&&""===u()&&w(!C),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},value:e,sx:{px:4},label:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",pr:2},children:[(0,l.jsx)(nj,{children:i.t(W[e].label)}),""===e?(0,l.jsx)(k.A,{sx:{ml:3,mr:-3},children:(0,l.jsx)(D,{open:C,children:(0,l.jsx)(ts.A,{size:"small"})})}):null,W[e].hasPop?(0,l.jsx)(G.A,{sx:{position:"absolute",top:"0.25rem",right:0},color:"warning"}):null]})},t))})}):null}var nw=n(16291),nb=n(39e3);function nk(e){let{agentsCount:t=0,agentsReady:n=!1}=e,{checkSubscription:i,getDialogVisible:r,setDialogVisible:a,onDialogVisible:o}=(0,x.P)(),[d,c]=(0,g.useState)(!1),[u,p]=(0,g.useState)(!1),[f,y]=(0,g.useState)(!1),{i18n:A}=(0,m.B)(),j=(0,b.A)(),v=(0,h.A)();(0,g.useEffect)(()=>{n&&!t&&(0,nw.A)("reveal"),p(r("agentCreate"));let e=o(e=>{let{dialog:t,visible:n}=e;"agentCreate"===t&&p(n)});return()=>{e()}},[n,t]);let w=async()=>{var e;y(!0);let t=await i(v,!0);y(!1),(null==(e=v.user)?void 0:e.computerEnabled)&&t.active?a("agentCreate",!0):c(!0)};return n?0===t?(0,l.jsxs)(k.A,{sx:{position:"absolute",zIndex:100,top:0,left:0,width:"100%",height:"calc(100% - 50px)",overflow:"hidden",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",background:j.palette.background.default,boxShadow:"0px 1px 0px 0px ".concat((0,s.A)(j))},children:[(0,l.jsx)(U.A,{className:"zoom-in"}),(0,l.jsx)(U.A,{className:"zoom-in",sx:{animationDelay:"2s"}}),(0,l.jsxs)(k.A,{sx:{mt:14,p:5,position:"relative",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,l.jsx)(tJ.A,{size:192,animate:!0,sx:{mb:6},className:"rotate"}),(0,l.jsx)(C.A,{size:"large",variant:"contained",className:u||d?null:"pop",fullWidth:!0,disabled:f,sx:{fontSize:"0.75rem",opacity:0,animation:"fadeIn 1s linear forwards",animationDelay:"1.5s"},startIcon:(0,l.jsx)(nb.A,{color:"inherit",fontSize:"large"}),onClick:w,children:A.t("Let's begin!")})]}),d?(0,l.jsx)(tE,{isOpen:!0,onClose:()=>c(!1)}):null]}):null:(0,l.jsx)(k.A,{sx:{position:"absolute",zIndex:100,top:0,left:0,display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",background:j.palette.background.default},children:(0,l.jsx)(tJ.A,{size:192,animate:!0,grey:!0,className:"rotate"})})}var nS=n(90441),nC=n(25668),nI=n(73509),nT=n(80094),nz=n(31262),nD=n(2255),nE=n(27395),n_=n(12785),nM=n(87664),nP=n(86092),nN=n(61823),nR=n(78787),nL=n(85803);function nO(e){let{agents:t}=e,{getAgentId:n,onAgentId:i,onTickCounter:r,getTickCounters:s,getHourglass:a,onHourglass:o}=(0,x.P)(),d=(0,g.useRef)(null),c=(0,b.A)(),[u,p]=(0,g.useState)(null),[h,m]=(0,g.useState)({}),[f,y]=(0,g.useState)(!1),[A,j]=(0,g.useState)(0);(0,g.useEffect)(()=>{p(n());let e=i(e=>p(e));return()=>e()},[t]);let v=e=>{"object"==typeof e&&null!==e&&(y(e.active),j(e.active?e.total+Math.floor(new Date().getTime()/1e3)-e.start:e.total),e.active&&(d.current=window.setTimeout(()=>{v(a(n())),d.current=null},1e3)))};return(0,g.useEffect)(()=>{null!==d.current&&(window.clearTimeout(d.current),d.current=null),m(s(n()));let e=r(e=>m(e));v(a(n()));let t=o(e=>{let{agentId:t,hourglass:l}=e;t===n()&&v(l)});return()=>{e(),t()}},[u]),null!==u&&"object"==typeof h&&null!==h?(0,l.jsxs)(k.A,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"end",px:2,height:"100%"},children:[(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center"},children:Object.keys(h).slice(0,5).map(e=>{let t=!1,n=nM.A;switch(e){case"post":n=nS.A;break;case"view":n=nE.A;break;case"like":n=n_.A;break;case"repost":n=nR.A;break;case"comment":n=nC.A;break;case"upload":n=nN.A;break;case"download":n=N.A;break;case"screenshot":n=nT.A;break;case"collect":n=nL.A;break;case"success":n=ex.A;break;case"warning":n=nP.A;break;case"contact":n=nz.A;break;default:t=!0}return(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",mx:2},children:[(0,l.jsx)(R.A,{title:e,placement:"left",children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(n,{fontSize:"small",color:"action",sx:{mr:2}}),t?(0,l.jsx)(S.A,{color:"inherit",sx:{color:c.palette.text.disabled,mr:2,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:50,lineHeight:"1rem",fontSize:"0.75rem"},children:e}):null]})}),(0,l.jsx)(R.A,{title:h[e],placement:"left",children:(0,l.jsx)(S.A,{color:"disabled",sx:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:40,fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace"},children:h[e]})})]},e)})}),(0,l.jsx)(R.A,{title:"Running time",placement:"left",children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[f?(0,l.jsx)(nD.A,{fontSize:"small",color:"primary"}):(0,l.jsx)(nI.A,{fontSize:"small",color:"action"}),(0,l.jsx)(S.A,{sx:{mx:2,textAlign:"right",fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace",color:f?c.palette.primary.main:c.palette.text.disabled},children:(e=>{let t=Math.floor(e/3600),n=Math.floor(e%3600/60),l=String(t).padStart(2,"0"),i=String(n).padStart(2,"0"),r=String(e%60).padStart(2,"0");return"".concat(l,":").concat(i,":").concat(r)})(A)})]})})]}):null}var nF=n(99833),nB=n(50966),nW=n(15591),nU=n(23820),nH=n(81376),nq=n(99594),nY=n(84824),nK=n(15751),nG=n(9282),nV=n(20302);let n$=e=>{let{agent:t,isOpen:n=!1,onOpen:i=()=>{},onClose:r=()=>{},status:s=-1}=e,{i18n:a}=(0,m.B)(),{getAgentBanner:o}=(0,x.P)(),[d,c]=(0,g.useState)(!1);(0,g.useEffect)(()=>{n&&"function"==typeof i&&i()},[n]);let u=()=>{n&&"function"==typeof r&&r()},h=o(null==t?void 0:t.id);return n&&null!==h?(0,l.jsxs)(eL.A,{open:!0,onClose:u,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(na,{agent:t,title:p.A.STATUS_PAUSED===s?a.t("Agent paused"):a.t("Agent stopped")}),(0,l.jsx)(eT.A,{"aria-label":a.t("More information"),sx:{ml:2},color:"default",onClick:()=>c(!d),size:"large",children:d?(0,l.jsx)(nG.A,{}):(0,l.jsx)(ti.A,{})})]})}),(0,l.jsxs)(eM.A,{children:[d?(0,l.jsx)(eC.A,{icon:(0,l.jsx)(nV.A,{}),sx:{mb:6},children:(0,l.jsxs)(S.A,{color:"inherit",variant:"body2",children:[a.t("Modules are not allowed to intercept or store any of your cookies, passwords, or other sensitive data.")," ",a.t("As a result, you will need to manually log into any websites that require authentication."),(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),a.t("All of your data is securely and exclusively stored on this computer.")]})}):null,(0,l.jsx)(eC.A,{severity:"info",icon:(0,l.jsx)(nK.A,{}),children:h.message||(h.url?a.t("Please log in before continuing."):a.t("Your attention is required."))})]}),(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:u,children:a.t("OK")}),h.url?(0,l.jsx)(C.A,{className:"pop",onClick:()=>(e=>{var n;null==(n=window.sdk)||n.ipc.target.openInNewWindow(null==t?void 0:t.id,e),u()})(h.url),variant:"contained",children:a.t("Open window")}):null]})]}):null};function nJ(e){let{agent:t,status:n}=e,{onAgentBanner:i,getAgentBanner:r}=(0,x.P)(),[s,a]=(0,g.useState)(null!==r(null==t?void 0:t.id)),{i18n:o}=(0,m.B)();return(0,g.useEffect)(()=>{a(null!==r(null==t?void 0:t.id));let e=i(e=>{let{agentId:n,banner:l}=e;(null==t?void 0:t.id)===n&&a(null!==l)});return()=>{e()}},[null==t?void 0:t.id]),(0,l.jsx)(k.A,{sx:{display:"flex",position:"relative",zIndex:2,alignItems:"center",width:"calc( 100% - 45px )",height:"100%",p:0,ml:1},children:(0,l.jsx)(R.A,{title:s?null:null==t?void 0:t.name,enterDelay:500,enterNextDelay:500,componentsProps:{tooltip:{sx:{maxWidth:"248px"}}},children:(0,l.jsx)(S.A,{sx:{mt:1,fontSize:"0.8rem",fontFamily:"Yaldevy,sans-serif",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"calc( 100% - 20px )",color:s||p.A.STATUS_PAUSED===n?"warning.main":"text.main"},variant:"caption",children:s?p.A.STATUS_PAUSED===n?o.t("Unpause when ready"):o.t("Start when ready"):null==t?void 0:t.name})})})}function nX(e){var t,n,i,r,s;let{agent:d,index:c=0,onSelect:u=async()=>{}}=e,{i18n:f}=(0,m.B)(),y=(0,b.A)(),A=(0,h.A)(),{onAgentId:j,getAgentId:w,getAgentBanner:S,onAgentBanner:I,setAgentTab:T,onSource:z,getSource:D,setSource:E,setSourceModified:_,onInputs:M,getInputs:P,getMachine:N,onMachineStatus:L,onMachineBusy:O,onSubscription:F,getSubscription:B,onDialogVisible:W,getDialogVisible:U,onFirstPlay:H,getFirstPlay:q,setFirstPlay:Y,getInstalled:K,setInstalled:G,modulePurge:V,log:$}=(0,x.P)(),[J,X]=(0,g.useState)(p.A.STATUS_STOPPED),[Z,Q]=(0,g.useState)(0),[ee,et]=(0,g.useState)(null),[en,el]=(0,g.useState)(!1),[ei,er]=(0,g.useState)(!1),[es,ea]=(0,g.useState)(!1),[eo,ed]=(0,g.useState)(!1),[ec,eu]=(0,g.useState)(!0),[ep,ex]=(0,g.useState)(!1),[eh,em]=(0,g.useState)([]),[eg,ef]=(0,g.useState)({}),[ey,eA]=(0,g.useState)(!1),[ej,ev]=(0,g.useState)(null),ew=(0,g.useRef)(p.A.STATUS_STOPPED),eb=(0,g.useRef)([]),ek=(0,g.useRef)(null),eS=()=>{ea(!0),setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()},250)},eC=async function(e){var t,n,l;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(i!==(null==d?void 0:d.installedModuleId))return;let s="c"==="".concat(null!=e?e:"")[0]?"cron":"schedule",a=await (null==(t=window.sdk)?void 0:t.ipc.session.read(d.id,e)),c=(null==a?void 0:a.sessionName)||"";if((null==d?void 0:d.id)===w()&&U("repo")){let e="".concat("cron"===s?f.t("Skipped recurring session {{sessionName}}",{sessionName:c}):f.t("Skipped scheduled session {{sessionName}}",{sessionName:c})," (").concat(f.t("module repository is open"),")");o.o.error("".concat(d.name,": ").concat(e),{duration:5e3}),$(d.id,e,"error");return}try{let t=null==(n=await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.runInit(d.id,i,e,r)))?void 0:n.runId;$(d.id,"cron"===s?f.t("Started recurring session {{sessionName}}",{sessionName:c}):f.t("Started scheduled session {{sessionName}}",{sessionName:c}),"success"),N(d).start(i,t)}catch(e){}},eI=async()=>{if(p.A.STATUS_STOPPED!==ew.current)return;let{module:e,moduleSrcId:t}=K(d.id);if((null==e?void 0:e.id)!==d.installedModuleId||t!==d.installedModuleSrcId){let e=null,t=null;if("string"==typeof d.installedModuleId){var n,l,i,r;try{let r=await v.A.get("modules/".concat(d.installedModuleId));if("string"!=typeof(null==(n=r.data)?void 0:n.id))return;e=r.data,t=d.installedModuleSrcId;let s=await v.A.get("agents/".concat(d.id,"/src"));Array.isArray(null==(l=s.data)?void 0:l.srcStateMachine)&&(E(d.id,s.data,!0),_(d.id,!1)),null==(i=window.sdk)||i.ipc.source.close(d.id);let c=(0,a.DV)(e,t),u=f.t("Module updated to version {{version}}",{version:c});o.o.info("".concat(d.name,": ").concat(u),{duration:5e3}),$(d.id,u,"info"),G(d.id,e,t)}catch(e){404===(null==(r=e.response)?void 0:r.status)&&V(d.installedModuleId)}}}};(0,g.useEffect)(()=>{et(w());let e=j(e=>{et(e),null!==S(null==d?void 0:d.id)&&(null==d?void 0:d.id)===e&&eS()}),t=I(e=>{let{agentId:t,banner:n}=e;null!==n&&w()===t&&(null==d?void 0:d.id)===t&&eS()});eu(!U("repo"));let n=W(e=>{let{dialog:t,visible:n}=e;"repo"===t&&eu(!n)}),l=setInterval(()=>{let e=Math.floor(new Date().getTime()/1e3);0==e%60&&ev(e)},1e3);return()=>{eb.current=[],n(),clearInterval(l),e(),t()}},[]),(0,g.useEffect)(()=>{var e;if("string"!=typeof(null==d?void 0:d.id))return;(async()=>{var e,t,n,l;await eI();let i=await D(d.id);if(null===i)try{let e=await v.A.get("agents/".concat(d.id,"/src"));Array.isArray(null==(t=e.data)?void 0:t.srcStateMachine)&&(i=e.data,E(d.id,e.data))}catch(e){}em(null!=(n=null==i?void 0:i.srcInputs)?n:[]),ef(await P(d.id)),ex((null!=(l=null==i?void 0:i.srcStateMachine)?l:[]).length>0),await (null==(e=window.sdk)?void 0:e.ipc.target.add(d.id,"about:home",d.id===w()))})();let t=O(e=>{let{agentId:t,busy:n}=e;d.id===t&&eA(n)}),n=L(e=>{let{agentId:t,status:n,sessionType:l}=e;d.id===t&&(ew.current=n,ek.current=p.A.STATUS_STOPPED===n?null:l,X(n))}),l=z(e=>{let{agentId:t,sourceCode:n}=e;if(d.id===t){var l,i;em(null!=(l=null==n?void 0:n.srcInputs)?l:[]),ex((null!=(i=null==n?void 0:n.srcStateMachine)?i:[]).length>0)}}),i=M(e=>{let{agentId:t,inputs:n,inputSessionId:l}=e;(null==d?void 0:d.id)===t&&null===l&&ef(n)});el(q(d.id));let r=H(e=>{let{agentId:t,firstPlay:n}=e;d.id===t&&el(n)}),s=B();er(!!s.active),Q(null!=(e=s.agentsCount)?e:0);let a=F(e=>{var t;let{info:n}=e;er(!!n.active),Q(null!=(t=n.agentsCount)?t:0)}),o=()=>N(d).stop();return window.addEventListener("offline",o),()=>{var e,s;t(),n(),l(),i(),r(),a(),window.removeEventListener("offline",o,!1),N(d).shutDown(),null==(e=window.sdk)||e.ipc.target.remove(d.id),null==(s=window.sdk)||s.ipc.source.close(d.id)}},[null==d?void 0:d.id]),(0,g.useEffect)(()=>{var e;(null==(e=A.user)?void 0:e.computerEnabled)&&ei&&!(c>Z-1)||N(d).stop()},[ei,Z,null==(t=A.user)?void 0:t.computerEnabled]),(0,g.useEffect)(()=>{if(p.A.STATUS_STOPPED===J&&eb.current.length){let{sessionId:e,moduleId:t,time:n}=eb.current.shift();eC(e,t,n)}},[J]),(0,g.useEffect)(()=>{window.setTimeout(async()=>{do{var e;if(!Number.isInteger(ej)||"string"!=typeof(null==d?void 0:d.id))break;let t=await (null==(e=window.sdk)?void 0:e.ipc.session.getAt(d.id,ej));if("object"!=typeof t||null===t)break;let{sessionId:n,moduleId:l,sessionType:i}=t;if("string"!=typeof n)break;if("string"!=typeof l&&null!==l&&(l=null),p.A.STATUS_STOPPED===ew.current){await eC(n,l,ej);break}"schedule"===i&&(eb.current.push({moduleId:l,sessionId:n,time:ej}),"schedule"!==ek.current&&N(d).stop())}while(!1)},250*c)},[ej]);let ez=async e=>{e.stopPropagation(),await u(null==d?void 0:d.id),null!==S(null==d?void 0:d.id)&&eS(),window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},250)},eD=async e=>{var t,n,l,i;if((e.stopPropagation(),"string"==typeof(null==d?void 0:d.id)&&!eo)&&ei&&!(c>Z-1)){en||Y(d.id,!0),"string"!=typeof ee&&await u(d.id);try{ed(!0),setTimeout(()=>ed(!1),2500),p.A.STATUS_STARTED===J?N(d).stop():(ee===(null==d?void 0:d.id)&&(null==(t=window.sdk)||t.ipc.main.setOnTop()),N(d).start(null!=(n=d.installedModuleId)?n:null))}catch(e){await (null==(l=window.sdk)?void 0:l.ipc.main.setOnTop()),o.o.error("".concat(f.t("Agent toggle error"),": ").concat(null!=(i=e.message)?i:e),{duration:5e3,ariaProps:{role:"alert"}})}window.setTimeout(()=>{var e;T(""),null==(e=window.sdk)||e.ipc.main.focus()},350)}},eE=null;switch(J){case p.A.STATUS_STOPPED:eE=ey?f.t("Working"):f.t("Start");break;case p.A.STATUS_PAUSED:eE=es?null:f.t("Unpause");break;case p.A.STATUS_STARTED:eE=f.t("Stop")}let e_=(0,a.qH)(eh,eg),eM=!(null==(n=A.user)?void 0:n.computerEnabled)||!ei||c>Z-1,eP=null!==S(null==d?void 0:d.id),eN=eM||eo||p.A.STATUS_STOPPED===J&&ey;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.A,{sx:{width:"100%",ml:"-1px",height:"50px",position:"relative"},children:[(0,l.jsxs)(C.A,{startIcon:(0,l.jsx)(k.A,{sx:{ml:2,display:"flex"},children:p.A.STATUS_STOPPED===J?(0,l.jsx)(nr.A,{color:eP?"warning":"action"}):null===ek.current?(0,l.jsx)(R.A,{title:f.t("Manual run"),placement:"right",children:(0,l.jsx)(nF.A,{color:p.A.STATUS_PAUSED===J||eP?"warning":"primary"})}):"cron"===ek.current?(0,l.jsx)(R.A,{title:f.t("Recurring run"),placement:"right",children:(0,l.jsx)(nR.A,{color:p.A.STATUS_PAUSED===J||eP?"warning":"primary"})}):(0,l.jsx)(R.A,{title:f.t("Scheduled run"),placement:"right",children:(0,l.jsx)(nB.A,{color:p.A.STATUS_PAUSED===J||eP?"warning":"primary"})})}),"data-agent":"".concat(null!=(r=null==d?void 0:d.id)?r:""),"data-agent-selected":ee===(null==d?void 0:d.id)?"true":"false",variant:"text",sx:{"&.MuiButton-root":{background:ee===(null==d?void 0:d.id)?y.palette.background.selected:null},borderRadius:0,width:"100%",transition:"none",height:"50px",position:"relative",zIndex:2},onClick:ez,children:[(0,l.jsx)(nJ,{agent:d,status:J}),(0,l.jsx)(k.A,{sx:{position:"absolute",top:"5px",left:"5px",borderRadius:"5px",width:"5px",height:"40px",background:ee===(null==d?void 0:d.id)?p.A.STATUS_PAUSED===J||eP?y.palette.warning.main:y.palette.primary.main:"transparent",transform:"scaleY(".concat(ee===(null==d?void 0:d.id)?"100":"0","%)"),transition:"transform 200ms linear"}})]}),null!==ek.current||e_&&ec&&ep?(0,l.jsx)(R.A,{title:eM?(null==(i=A.user)?void 0:i.computerEnabled)?f.t("Locked by billing"):f.t("Computer disabled"):eN?null:eE,placement:"left",children:(0,l.jsx)(k.A,{sx:{position:"absolute",right:"5px",top:"5px",zIndex:2},children:(0,l.jsx)(eT.A,{className:en||ee!==(null==d?void 0:d.id)?null:"pop pop-rounded pop-inset",disabled:eN,"data-start-stop":"".concat(null!=(s=null==d?void 0:d.id)?s:""),onClick:eD,children:eM?(0,l.jsx)(nW.A,{fontSize:"small",color:"inherit"}):p.A.STATUS_STARTED===J?(0,l.jsx)(nH.A,{color:eN?"disabled":"primary"}):p.A.STATUS_STOPPED===J&&ey?(0,l.jsx)(nU.A,{className:"rotate-360"}):(0,l.jsx)(nq.A,{color:eN?"disabled":p.A.STATUS_PAUSED===J||eP?"warning":"primary"})})})}):null,eP?(0,l.jsx)(nY.A,{color:"warning",variant:"indeterminate",sx:{position:"absolute",bottom:0,left:0,height:"2px",zIndex:3}}):null]}),es?(0,l.jsx)(n$,{agent:d,isOpen:!0,onClose:()=>ea(!1),status:J}):null]})}var nZ=n(72568),nQ=n(74787),n0=n(14822),n1=n(13536),n2=n(1879),n5=n(49404);let n3=(0,g.forwardRef)((e,t)=>{let{tooltipPlacement:n="bottom",tooltipShown:i=!0}=e,{settings:r,saveSettings:s}=(0,nQ.t)(),[a,o]=(0,g.useState)(!1),{i18n:d}=(0,m.B)(),c=(0,b.A)(),u="boolean"!=typeof(null==r?void 0:r.sound)||r.sound;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(R.A,{title:i?u?d.t("Sound on"):d.t("Sound off"):null,placement:n,children:(0,l.jsx)(e7.A,{ref:t,color:"default",inputProps:{"aria-label":"sound",name:"sound"},checked:u,disabled:a,sx:{mx:1,height:"38px","& .MuiSwitch-track":{background:"transparent",opacity:1,border:"1px solid ".concat(c.palette.divider)}},icon:(0,l.jsx)(n5.A,{fontSize:"small",color:"disabled"}),checkedIcon:(0,l.jsx)(n2.A,{fontSize:"small",color:"info",sx:{color:"#ff9b00"}}),onClick:()=>{!a&&(o(!0),setTimeout(()=>o(!1),500),s({sound:!u}),u||(0,nw.A)("toastInfo"))}})})})});var n4=n(54441),n6=n(65010),n9=n(74441),n7=n(92705);let n8=(0,g.forwardRef)((e,t)=>{var n,i;let{user:r,sx:s,skin:a,color:o}=e,d=(0,b.A)(),c=(()=>{let e=(0,b.A)();return{primaryFilled:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main},primaryLight:{color:e.palette.primary.main,backgroundColor:(0,n6.z)(e.palette.primary.main,.12)},secondaryFilled:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main},secondaryLight:{color:e.palette.secondary.main,backgroundColor:(0,n6.z)(e.palette.secondary.main,.12)},successFilled:{color:e.palette.success.contrastText,backgroundColor:e.palette.success.main},successLight:{color:e.palette.success.main,backgroundColor:(0,n6.z)(e.palette.success.main,.12)},errorFilled:{color:e.palette.error.contrastText,backgroundColor:e.palette.error.main},errorLight:{color:e.palette.error.main,backgroundColor:(0,n6.z)(e.palette.error.main,.12)},warningFilled:{color:e.palette.warning.contrastText,backgroundColor:e.palette.warning.main},warningLight:{color:e.palette.warning.main,backgroundColor:(0,n6.z)(e.palette.warning.main,.12)},infoFilled:{color:e.palette.info.contrastText,backgroundColor:e.palette.info.main},infoLight:{color:e.palette.info.main,backgroundColor:(0,n6.z)(e.palette.info.main,.12)}}})(),u=(0,h.A)(),p=new Date().toJSON().slice(0,10),x="".concat(eo.A.s3Url,"/users/").concat(r.id,"/?cb=").concat(p);(null==(n=u.user)?void 0:n.id)==r.id&&(x="string"==typeof(null==r?void 0:r.userAvatarId)?"".concat(eo.A.s3Url,"/users/").concat(r.id,"/").concat(r.userAvatarId,".png"):"/img/placeholder/user.png");let m=(e,t)=>"light"===e?{...c["".concat(t,"Light")]}:"light-static"===e?{color:c["".concat(t,"Light")].color,backgroundColor:(0,n9.a)(d.palette[t].main,.88)}:{...c["".concat(t,"Filled")]};s.backgroundColor=d.palette.background.default,s.border="2px solid ".concat(null!=(i=d.palette.customColors.userColors.solid[r.userColor])?i:d.palette.divider);let g={primary:m(a,"primary"),secondary:m(a,"secondary"),success:m(a,"success"),error:m(a,"error"),warning:m(a,"warning"),info:m(a,"info")},f={sx:s,skin:a,color:o,src:x,alt:"avatar"};return(0,l.jsx)(n7.A,{ref:t,...f,sx:!x&&a&&o?Object.assign(g[o],s):s})});n8.defaultProps={skin:"filled",color:"primary"};let le=(0,w.Ay)(eO.A)(e=>{let{theme:t}=e;return{"& .MuiMenu-paper":{width:280,overflow:"hidden",marginTop:t.spacing(4),[t.breakpoints.down("sm")]:{width:"100%"}},"& .MuiMenu-list":{padding:0}}}),lt=e=>{let{onProfileOpen:t=()=>{}}=e,{settings:n}=(0,nQ.t)(),{i18n:i}=(0,m.B)(),r=(0,b.A)(),s=(0,h.A)(),[a,o]=(0,g.useState)(null),d=(0,g.useRef)(null),c=(0,g.useRef)(null),u=()=>o(null),p=async()=>{var e;u(),await (null==(e=window.sdk)?void 0:e.ipc.main.quit())};return s.user?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(C.A,{onClick:e=>{o(e.currentTarget)},fullWidth:!0,sx:{borderRadius:0,justifyContent:"space-between",alignItems:"center",height:"100%"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 30px)"},children:[(0,l.jsx)(n0.A,{"aria-disabled":"true",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(n8,{user:s.user,sx:{width:24,height:24,ml:1}})}),(0,l.jsx)(S.A,{variant:"caption",sx:{textTransform:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",ml:3},children:s.user.userName})]}),(0,l.jsx)(D,{sx:{flexShrink:0},open:!!a,children:(0,l.jsx)(T.A,{color:"action"})})]}),(0,l.jsxs)(le,{sx:{mt:-6,width:"250px"},anchorEl:a,"aria-disabled":"true",open:!!a,onClose:()=>u(),anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:[(0,l.jsx)(eN.A,{onClick:()=>{u(),t()},sx:{p:3,py:2,textDecoration:"none"},children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(n0.A,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(n8,{user:s.user,sx:{width:"2rem",height:"2rem",ml:1}})}),(0,l.jsxs)(k.A,{"aria-disabled":"true",sx:{display:"flex",ml:3,alignItems:"flex-start",flexDirection:"column"},children:[(0,l.jsx)(R.A,{title:s.user.userName,placement:"top",children:(0,l.jsx)(S.A,{sx:{fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"145px"},children:s.user.userName})}),(0,l.jsx)(R.A,{title:s.user.userEmail,placement:"bottom",children:(0,l.jsx)(S.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"145px"},children:s.user.userEmail})})]})]})}),(0,l.jsx)(eR.A,{}),(0,l.jsx)(eN.A,{onClick:e=>{e.stopPropagation(),u(),c.current&&c.current.click()},children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(k.A,{sx:{ml:"-19px",mr:"-3px"},children:(0,l.jsx)(n4.A,{ref:c,tooltipShown:!1})}),(0,l.jsx)(S.A,{variant:"body2",children:"dark"===r.palette.mode?i.t("Dark mode"):i.t("Light mode")})]})}),(0,l.jsx)(eN.A,{onClick:e=>{e.stopPropagation(),u(),d.current&&d.current.click()},children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(k.A,{sx:{ml:"-19px",mr:"-3px"},children:(0,l.jsx)(n3,{ref:d,tooltipShown:!1})}),(0,l.jsx)(S.A,{variant:"body2",children:n.sound?i.t("Sound on"):i.t("Sound off")})]})}),(0,l.jsx)(eR.A,{}),(0,l.jsxs)(eN.A,{sx:{py:3,fontWeight:400},"aria-disabled":"true",onClick:p,children:[(0,l.jsx)(n1.A,{sx:{ml:1,mr:4},color:"action"}),(0,l.jsx)(S.A,{variant:"body2",children:i.t("Exit")})]})]})]}):null};var ln=n(42993);function ll(e){let{agents:t,agentsReady:n=!1}=e,{getAgentActive:i,onAgentActive:r,getAgentId:s,onAgentId:a,onTickArea:o,onVmouseMove:d,onVmouseClick:c,getVmouse:u,onDownloadInfo:p,getDownloadInfo:h}=(0,x.P)(),m=(0,b.A)(),f=(0,g.useRef)(null),y=(0,g.useRef)(null),A=(0,g.useRef)(null),j=(0,g.useRef)(null),[v,w]=(0,g.useState)(!1),[C,I]=(0,g.useState)(null),[T,z]=(0,g.useState)(!1),[D,E]=(0,g.useState)(null),[_,M]=(0,g.useState)({}),[P,N]=(0,g.useState)(null);return(0,g.useEffect)(()=>{w(i(s()));let e=r(e=>{let{agentId:t,active:n}=e;t===s()&&w(n)});I(null);let t=o(e=>{let{agentId:t,area:n}=e;if(t===s()&&Array.isArray(n)){let e=n.map(e=>parseInt(e,10)).filter(e=>Number.isInteger(e));4===e.length&&(I(null),null!==A.current&&(window.clearTimeout(A.current),A.current=null),A.current=window.setTimeout(()=>{I(e),A.current=null,null!==j.current&&(window.clearTimeout(j.current),j.current=null),j.current=window.setTimeout(()=>{I(null),j.current=null},1e3)},50))}});N(u(s()));let n=d(e=>{let{agentId:t,vmouse:n}=e;t===s()&&N(n)});M(h(s()));let l=p(e=>{let{agentId:t,info:n}=e;t===s()&&M(n)}),a=c(e=>{let{agentId:t,vmouse:n}=e;t===s()&&["click","double-click"].includes(null==n?void 0:n.name)&&(z(!0),window.setTimeout(()=>z(!1),250),E(null),null!==f.current&&(window.clearTimeout(f.current),f.current=null),f.current=window.setTimeout(()=>{E(n),f.current=null,null!==y.current&&(window.clearTimeout(y.current),y.current=null),y.current=window.setTimeout(()=>{E(null),y.current=null},300)},50))});return()=>{t(),l(),n(),e(),a()}},[]),(0,g.useEffect)(()=>{let e=a(e=>{f.current=null,y.current=null,A.current=null,j.current=null,M(h(e)),w(i(e)),I(null)});return()=>e()},[t]),n?v?(0,l.jsxs)(k.A,{sx:{position:"relative",width:"100%",height:"100%",boxShadow:"none",overflow:"hidden"},children:[(0,l.jsx)(k.A,{className:"agent-overlay",children:(0,l.jsx)(k.A,{sx:{width:"350px",height:"100%",right:"0px",position:"absolute",overflowY:"auto",mr:2,display:"flex",flexDirection:"column",justifyContent:"end",zIndex:12},children:Object.keys(_).map(e=>{let t="string"==typeof _[e].error?"error":_[e].done?"success":"primary",n="string"==typeof _[e].error?(0,l.jsx)(nP.A,{}):_[e].done?(0,l.jsx)(ex.A,{}):(0,l.jsx)(nU.A,{className:"rotate-360"}),i="string"==typeof _[e].error?_[e].error:"".concat(_[e].fileName).concat(_[e].totalBytes>0?" (".concat((_[e].totalBytes/1048576).toFixed(3),"MB)"):"");return(0,l.jsx)(ln.A,{sx:{mb:2},children:(0,l.jsxs)(eC.A,{variant:"filled",color:t,sx:{px:2,"& .MuiAlert-message":{width:"100%"},boxShadow:m.shadows[3]},icon:n,children:[(0,l.jsx)(S.A,{variant:"caption",color:"inherit",children:i}),"string"==typeof _[e].error||_[e].done?null:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%",height:"1rem"},children:[(0,l.jsx)(nY.A,{color:"primary",value:parseFloat(_[e].progress),variant:_[e].totalBytes>0?"determinate":"indeterminate"}),_[e].totalBytes>0?(0,l.jsx)(S.A,{variant:"caption",color:"inherit",sx:{ml:3},children:"".concat(_[e].progress,"%")}):null]})]})},e)})})}),Array.isArray(C)?(0,l.jsx)(k.A,{className:"tick-area",sx:{left:C[0],top:C[1],width:C[2],height:C[3]}}):null,null!==D?(0,l.jsx)(k.A,{className:"mouse-ripple",sx:{left:"".concat(D.x-25,"px"),top:"".concat(D.y-25,"px"),animationIterationCount:"double-click"===D.name?2:1}}):null,null!==P?(0,l.jsx)(k.A,{className:"mouse-pointer","data-tapped":"".concat(T),sx:{transform:"translate(".concat(P.x,"px, ").concat(P.y,"px)"),...Number.isInteger(P.duration)?{transitionDuration:"".concat(P.duration,"ms")}:{}}}):null]}):null:(0,l.jsx)(k.A,{sx:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(tJ.A,{size:128,animate:!0,grey:!0,className:"rotate"})})}var li=n(55815),lr=n(71918),ls=n(64266),la=n(52782);let lo=e=>{var t;let{field:n,refFirstEmpty:i,firstValue:r=[],actionSet:s=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}=e,{i18n:a}=(0,m.B)();("object"!=typeof n||null===n)&&(n={});let[o,d]=(0,g.useState)(Array.isArray(r)?r:[]);return(0,g.useEffect)(()=>{d(Array.isArray(r)?r:[])},[r]),(0,l.jsx)("form",{"data-scalar":n.key,onSubmit:e=>e.preventDefault(),children:Array.isArray(n.options)&&n.options.length?n.options.length>1&&n.isList?(0,l.jsx)(k.A,{className:i.current===n.id?"pop":"",sx:{width:"100%",borderRadius:"0.25rem",p:1,position:"relative"},children:n.options.map(e=>{let t=o.includes(e)&&o.length<=1&&n.default===e;return(0,l.jsx)(R.A,{title:t?a.t("Enable another option before disabling this one"):null,children:(0,l.jsx)(k.A,{sx:{m:1,display:"inline-block"},children:(0,l.jsx)(lr.A,{label:e,sx:{mr:6,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi,sans-serif"}},control:(0,l.jsx)(ls.A,{inputProps:{name:n.key},value:e,color:t?"default":"primary",checked:o.includes(e),onChange:t=>((e,t)=>{d(l=>{let i=e.target.checked?[...new Set([...l,t])]:l.filter(e=>e!==t);return i.length||(i=[n.default]),JSON.stringify(l)!==JSON.stringify(i)&&s(),i})})(t,e)})})})},e)})}):(0,l.jsx)(la.A,{fullWidth:!0,displayEmpty:!0,renderValue:e=>e||(0,l.jsx)(S.A,{variant:"caption",children:a.t("Select an option")}),name:n.key,defaultValue:null!=r?r:"",className:i.current===n.id?"pop":"",inputProps:{id:"field-".concat(n.id)},onChange:e=>s(),children:n.options.map(e=>(0,l.jsx)(eN.A,{value:e,children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center"},children:e})},e))}):(0,l.jsx)(R.A,{title:"int"===n.type?[...Number.isInteger(n.min)?[a.t("Minimum: {{n}}",{n:n.min})]:[],...Number.isInteger(n.max)?[a.t("Maximum: {{n}}",{n:n.max})]:[]].join(", "):[...Number.isInteger(n.min)?[1===n.min?a.t("Required"):a.t("Minimum length: {{n}}",{n:n.min})]:[],...Number.isInteger(n.max)?[a.t("Maximum length: {{n}}",{n:n.max})]:[]].join(", "),children:(0,l.jsx)(eS.A,{id:"field-".concat(n.id),className:i.current===n.id?"pop":"",name:n.key,InputLabelProps:{shrink:!0},sx:{width:"100%","& .MuiInputBase-multiline":{py:3},"& textarea":{p:"0 !important"}},defaultValue:r,placeholder:"".concat(null!=(t=n.default)?t:""),onChange:e=>s(450),type:"int"===n.type?"number":"string",inputMode:"int"===n.type?"numeric":"text",multiline:"string"===n.type,maxRows:9,inputProps:{..."int"===n.type?{min:n.min,max:n.max}:{minLength:n.min,maxLength:n.max}}})})})},ld=e=>{let{field:t,firstValue:n,actionSet:i=()=>{}}=e;return("object"!=typeof t||null===t)&&(t={}),(0,l.jsx)("form",{"data-scalar":t.key,onSubmit:e=>e.preventDefault(),children:(0,l.jsx)(e7.A,{id:"field-".concat(t.id),name:t.key,defaultChecked:!!n,onChange:e=>i()})})};var lc=n(37085),lu=n.n(lc),lp=n(27420),lx=n(5754),lh=n(95250),lm=n(80735),lg=n(26271),lf=n(47952);let ly=e=>{let{time:t,sessionId:n=null,sx:i={},inline:r=!1}=e,{i18n:s}=(0,m.B)(),{getAgentId:a}=(0,x.P)();("object"!=typeof i||null===i)&&(i={});let[o,d]=(0,g.useState)(null),c=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t&&null!==o)return;if("string"!=typeof n||"default"===n)return void d(s.t("Manual run"));let l=await (null==(e=window.sdk)?void 0:e.ipc.session.read(a(),n));d("string"==typeof(null==l?void 0:l.sessionName)&&l.sessionName.length?l.sessionName:"c"===n[0]?s.t("Recurring run"):s.t("Scheduled run"))};(0,g.useEffect)(()=>{r&&c(!0)},[r,n,t]);let u=(0,l.jsx)(nF.A,{});"string"==typeof n&&"default"!==n&&(u="c"===n[0]?(0,l.jsx)(nR.A,{}):(0,l.jsx)(nB.A,{}));let p=(null!==o?"".concat(o," - "):"")+no(1e3*t,"en",{day:"numeric",month:"long",hour:"numeric",minute:"numeric",hour12:!1}),h=nd(1e3*t);return r&&(h="".concat(o," - ").concat(h)),Number.isInteger(t)?(0,l.jsx)(R.A,{placement:"left",title:p,children:(0,l.jsx)(ep.A,{size:"small",icon:u,variant:"outlined",onMouseEnter:r?null:()=>c(),label:h,sx:{fontFamily:"Inconsolata,sans-serif",...i}})}):null};var lA=n(98738);let lj=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",justifyContent:"end",padding:t.spacing(2),"& > button":{marginLeft:t.spacing(2)}}});var lv=n(47738),lw=n(31662),lb=n(76637),lk=n(24573),lS=n(63317),lC=n(42337),lI=n(7557),lT=n(99709),lz=n(85545),lD=n(75389),lE=n(93361),l_=n(10553),lM=n(85613),lP=n(23916),lN=n(36541),lR=n(41691),lL=n(19917),lO=n(3050),lF=n(14275),lB=n(15590),lW=n(90802),lU=n(92547),lH=n(95688);let lq={en:lv.c,cs:lw.o,nl:lb.x,fr:lk.n,de:lS.z,el:lC.r,hu:lI.x,it:lT.N,pt:lz.F,pl:lD.$,ro:lE.H,ru:l_.F,es:lM.F,sv:lP.q,tr:lN.h,uk:lR.h,ar:lL.N,zh:lO.g,he:lF.r,ja:lB.q,ko:lW.U,fa:lU.$,vi:lH.w};var lY=n(93614);let lK=e=>e*parseFloat(getComputedStyle(document.documentElement).fontSize),lG=e=>{let t=(()=>{let{settings:e}=(0,nQ.t)(),t=(void 0!==lq[null==e?void 0:e.lang]?lq[e.lang]:lq.en).components.MuiDataGrid.defaultProps.localeText;return t.MuiTablePagination.labelDisplayedRows=e=>{let{from:t,to:n,count:l}=e;return"".concat(t," - ").concat(n," / ").concat(l)},t})(),n=(0,b.A)(),[i,r]=(0,g.useState)(lK(3)),[s,a]=(0,g.useState)(lK(3));return(0,g.useEffect)(()=>{let e=document.documentElement,t=new ResizeObserver(()=>{a(lK(3)),r(lK(3))});return t.observe(e),()=>t.disconnect()},[]),(0,l.jsx)(k.A,{sx:{border:"1px solid ".concat(n.palette.divider),borderRadius:"8px"},children:(0,l.jsx)(lY.z,{...e,showColumnRightBorder:!0,hideFooterSelectedRowCount:!0,dataGridLocale:t,rowHeight:s,columnHeaderHeight:i})})};var lV=n(959);let l$=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{border:"1px solid ".concat(t.palette.divider),borderRadius:t.spacing(2),width:"100%",overflowX:"auto",paddingBottom:t.spacing(1)}}),lJ=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{height:"35px",width:"100%",display:"flex",alignItems:"center",padding:t.spacing(2),marginBottom:t.spacing(1)}}),lX=(0,w.Ay)(k.A)(e=>{let{theme:t,removed:n=!1,excluded:l=!1}=e;return{border:"1px solid ".concat(t.palette.divider),borderRadius:t.spacing(1),width:"115px",flexShrink:0,flexGrow:0,marginRight:t.spacing(1),height:"35px",padding:t.spacing(2),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"0.75rem",lineHeight:"18px",verticalAlign:"middle",textDecoration:n?"line-through":"none",background:l?t.palette.divider:"transparent",userSelect:n||l?"none":"text"}}),lZ=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{"&:before":{position:"absolute",content:'""',display:"block",top:0,left:0,width:"5px",height:"100%",background:t.palette.divider,borderRadius:t.spacing(1)},marginBottom:t.spacing(4),position:"relative",paddingLeft:t.spacing(4),whiteSpaceCollapse:"preserve",wordBreak:"break-word",whiteSpace:"pre-wrap",width:"100%","&>span":{display:"inline-block",width:"100%",marginTop:t.spacing(2),marginBottom:t.spacing(2)}}}),lQ=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=[];return new Promise((r,s)=>{let a=new FileReader;a.onload=e=>{let a=e.target.result;lu().parse(a,{header:!1,skipEmptyLines:!0,dynamicTyping:!0,comments:"#",worker:!1,step:async(e,s)=>{if(e.data.filter(e=>null!==e).length){if(i.push(e.data),"function"!=typeof n){i.length>=t&&(r(i),i=[],s.abort());return}i.length>=l&&(s.pause(),await n(i),i=[],s.resume())}},complete:async()=>{if("function"!=typeof n)return void r(i);i.length>0&&await n(i),r(!0)},error:s})},a.onerror=s,a.readAsText(e)})},l0=(0,g.memo)(e=>{let{fieldKey:t,fieldName:n,fieldColumns:i=[],runIds:r=null,pop:s=!1,sessionId:a=null}=e,{getAgentId:d,refetchInputs:c}=(0,x.P)(),{i18n:u}=(0,m.B)(),p=(0,g.useRef)(null),h=(0,g.useRef)(null),f=(0,g.useRef)(null);Array.isArray(i)||(i=[]);let[y,A]=(0,g.useState)(10),[v,w]=(0,g.useState)(1),[b,I]=(0,g.useState)(1),[T,z]=(0,g.useState)(""),[D,E]=(0,g.useState)(!1),[_,P]=(0,g.useState)([]),[N,L]=(0,g.useState)(null),[O,F]=(0,g.useState)(!1),[U,H]=(0,g.useState)(!1),[q,Y]=(0,g.useState)(!1),[K,G]=(0,g.useState)(!1),[$,J]=(0,g.useState)(null),[X,Z]=(0,g.useState)([]),[Q,ee]=(0,g.useState)(!1),[et,en]=(0,g.useState)([]),el=async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];E(!1);try{var n,l;let e=Array.isArray(r)?await (null==(n=window.sdk)?void 0:n.ipc.diskStorage.outputTableQuery(d(),r.slice(-j().max.diskStorage.outputRunsCount),t,b,5e3)):await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.inputTableQuery(d(),t,b,5e3,a));"object"==typeof e&&null!==e&&(w(Math.ceil(e.total/5e3)),P(e.rows))}catch(e){}e&&await c(d(),a),E(!0)},ei=()=>O?Math.max(...(Array.isArray(X)?X:[]).map(e=>e.length),i.length):0;(0,g.useEffect)(()=>{let e=setTimeout(()=>el(!1),100);return()=>window.clearTimeout(e)},[t,i,b,r]),(0,g.useEffect)(()=>{O&&en([...i,...Array(ei()-i.length).fill("")])},[O,i,X]);let es=async e=>{var n;if(Array.isArray(r))return;Y(!0);let l=new FormData(e.target),s={};for(let e of i)s[e]=l.get(e);await (null==(n=window.sdk)?void 0:n.ipc.diskStorage.inputTableAdd(d(),t,[s],a)),Y(!1),G(!1),await el()},ea=async(e,n)=>{var l;if(Array.isArray(r))return;Y(!0);let s=new FormData(e.target),o={};for(let e of i)o[e]=s.get(e);await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.inputTableUpdate(d(),t,n,o,a)),Y(!1),G(!1),await el()},eo=async e=>{var n;G(!1),Array.isArray(r)||(E(!1),await (null==(n=window.sdk)?void 0:n.ipc.diskStorage.inputTableDelete(d(),t,e,a)),await el())},ed=async()=>{var e;H(!1),Array.isArray(r)||(E(!1),await (null==(e=window.sdk)?void 0:e.ipc.diskStorage.inputTableDelete(d(),t,null,a)),await el())},ec=async()=>{if(!Array.isArray(et)||!et.length||!i.length)return void ex();Y(!0);let e=!1;try{await lQ($,4,async n=>{var l;let i=n.map(e=>{let t={};for(let n=0;n<et.length;n++)et[n].length&&(t[et[n]]=void 0===e[n]?null:e[n]);return t});!e&&Q&&(e=!0,i.shift()),await (null==(l=window.sdk)?void 0:l.ipc.diskStorage.inputTableAdd(d(),t,i,a))},100)}catch(e){var n;o.o.error("".concat(u.t("Error importing CSV"),": ").concat(null!=(n=e.message)?n:e))}ex(),await el()},eu=async e=>{let t=Array.isArray(e)&&e.length?e[0]:null,n=[];if(null!==t)try{n=await lQ(t,4)}catch(e){var l;o.o.error("".concat(u.t("Error parsing CSV"),": ").concat(null!=(l=e.message)?l:e))}if(!Array.isArray(n)||!n.length)return void o.o.error(u.t("The CSV file is empty"));J(t),Z(n)},ex=async()=>{F(!1),Y(!1),J(null),Z([]),ee(!1),en([])},eh=()=>{G(!1)},em=()=>{h.current&&h.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},eg=[...null!==r?[{width:160,hideable:!1,field:"_date_",filterable:!1,headerName:u.t("Run"),renderCell:e=>{let{row:t}=e;return(0,l.jsx)(ly,{time:t._time,sessionId:t._sid})},valueGetter:e=>{let{row:t}=e;return t._time}}]:[],...i.map((e,t)=>({flex:1,hideable:null!==r||0!==t,field:e,renderCell:t=>{let{row:n}=t;return(0,l.jsx)(R.A,{title:n[e],children:(0,l.jsx)(S.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:er(n[e],T,d())})})},valueGetter:t=>{let{row:n}=t;return n[e]}})),...null===r?[{width:40,field:"_actions_",hideable:!1,filterable:!1,headerName:u.t("Actions"),renderHeader:()=>"",renderCell:e=>{let{row:t}=e;return(0,l.jsx)(k.A,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsx)(R.A,{title:u.t("Delete row"),placement:"left",children:(0,l.jsx)(eT.A,{size:"small",onClick:e=>{e.preventDefault(),e.stopPropagation(),eo(t._id)},children:(0,l.jsx)(eF.A,{fontSize:"small"})})})})}}]:[]],ef=O&&null!==$?et.length<=4?550:et.length>=9?1150:550+120*(et.length-4):750;return(0,l.jsxs)(k.A,{sx:{width:"100%"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:4,height:"30px"},children:[D&&i.length&&v>1?(0,l.jsx)(k.A,{sx:{display:"flex",width:"280px",justifyContent:"start",flexShrink:0},children:(0,l.jsx)(lx.A,{size:"small",count:v,page:b,onChange:async(e,t)=>I(t)})}):null,(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",justifyContent:"end",alignItems:"center"},children:[D&&_.length?(0,l.jsx)(k.A,{sx:{width:"200px",height:"30px",mt:"2px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,l.jsx)(nn.A,{fontSize:"small",color:"disabled"}),(0,l.jsx)(eS.A,{inputRef:f,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"}},InputProps:{endAdornment:(0,l.jsx)(ek.A,{position:"end",children:(0,l.jsx)(k.A,{sx:{width:30,height:30},children:T.length?(0,l.jsx)(R.A,{title:u.t("Clear filter"),children:(0,l.jsx)(eT.A,{sx:{width:30,height:30},onClick:()=>{z(""),null!==f.current&&(f.current.value="")},children:(0,l.jsx)(ez.A,{fontSize:"small"})})}):null})})},placeholder:u.t("Filter"),variant:"standard",disabled:!D,onChange:e=>{var t;return t=e.target.value.toLowerCase(),void(null!==p.current&&window.clearTimeout(p.current),p.current=window.setTimeout(()=>{z(t),p.current=null},450))}})]})}):null,null===r&&i.length?(0,l.jsxs)(l.Fragment,{children:[D?(0,l.jsx)(k.A,{sx:{ml:3,borderRadius:1,height:"30px",width:"80px",position:"relative"},className:!s||K||O||U||null!=N?null:"pop",children:(0,l.jsxs)(lp.A,{size:"small",disabled:!D,children:[(0,l.jsx)(C.A,{sx:{px:"0 !important",height:"30px"},variant:_.length?"outlined":"contained",onClick:()=>{G(!0),L(null)},children:(0,l.jsx)(ev.A,{})}),(0,l.jsx)(C.A,{sx:{px:"0 !important",height:"30px"},variant:_.length?"outlined":"contained",onClick:e=>L(e.currentTarget),children:(0,l.jsx)(ts.A,{})})]})}):(0,l.jsx)(V.A,{spacing:0,sx:{width:"90px",height:"20px",mr:3,my:"5px"}}),D?_.length?(0,l.jsx)(R.A,{title:u.t("Clear table"),placement:"left",children:(0,l.jsx)(eT.A,{sx:{width:"30px",height:"30px",mx:3},onClick:()=>H(!0),children:(0,l.jsx)(eF.A,{fontSize:"small"})})}):null:(0,l.jsx)(V.A,{spacing:0,rounded:!0,sx:{width:"30px",height:"30px",mr:2}})]}):null]})]}),(0,l.jsx)(lG,{sx:{"& .MuiDataGrid-row":{cursor:"pointer"}},onPageSizeChange:e=>A(e),onRowClick:e=>{let{row:t}=e;return G(t)},rowsPerPageOptions:[10,25,50,100],disableSelectionOnClick:!0,getRowId:e=>e._id,pageSize:y,columns:eg,loading:!D,rows:"string"==typeof T&&T.length?_.filter(e=>Object.values(e).some(e=>"string"==typeof e&&e.toLowerCase().includes(T.toLowerCase()))):_,autoHeight:!0}),D&&i.length?(0,l.jsxs)(M.Ay,{open:!!K,anchor:"right",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{top:50,bottom:50,left:250},"& .MuiDrawer-paper":{width:"45%",minWidth:"400px",maxWidth:"1200"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute"}},onClose:()=>eh(),children:[q?null:(0,l.jsx)(B,{icon:null===r&&("object"==typeof K||!0===K)?"object"==typeof K?(0,l.jsx)(lg.A,{}):(0,l.jsx)(lh.A,{}):(0,l.jsx)(lf.A,{}),title:"".concat(n,": ").concat(null===r?"object"==typeof K?u.t("Edit row"):u.t("Add row"):Number.isInteger(null==K?void 0:K._time)?nd((null==K?void 0:K._time)*1e3):"---"),handleClose:()=>eh()}),(0,l.jsx)(W,{children:q?(0,l.jsx)(V.A,{}):(0,l.jsx)("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),null===r&&("object"==typeof K?ea(e,K._id):es(e))},ref:h,children:i.map((e,t)=>{var n;let i="object"==typeof K&&null!==K?null!=(n=K[e])?n:"":null;return(0,l.jsx)(k.A,{sx:{width:"100%",display:"flex"},children:null===r?(0,l.jsx)(eS.A,{variant:"outlined",autoFocus:0===t,defaultValue:i,multiline:!0,maxRows:9,minRows:1,InputProps:{startAdornment:(0,l.jsx)(ek.A,{position:"start",children:(0,l.jsx)(eH.A,{fontSize:"small"})})},label:e,sx:{width:"100%",mb:4,"& .MuiInputBase-multiline":{py:3},"& textarea":{p:"0 !important"}},id:"cell-".concat(e),name:e,onKeyDown:e=>"Enter"===e.key&&e.ctrlKey&&em()}):(0,l.jsxs)(lZ,{children:[(0,l.jsx)(ep.A,{label:e,size:"small",variant:"outlined"}),(0,l.jsx)(S.A,{variant:"caption",component:"span",children:er(i,T,d())})]})},e)})})}),q?null:(0,l.jsxs)(lj,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>G(!1),sx:{mr:2},children:null===r?u.t("Cancel"):u.t("Close")}),null===r?(0,l.jsx)(C.A,{variant:"contained",onClick:em,children:"object"==typeof K?u.t("Save"):u.t("Add row")}):null]})]}):null,D&&null===r&&i.length&&_.length&&U?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>H(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsxs)(eP.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[n,(0,l.jsx)(ns.A,{}),u.t("Clear table")]}),(0,l.jsx)(eM.A,{children:(0,l.jsx)(eC.A,{severity:"warning",children:u.t("Are you sure you want to delete all data in this table?")})}),(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>H(!1),children:u.t("Cancel")}),(0,l.jsx)(C.A,{color:"error",onClick:ed,startIcon:(0,l.jsx)(eF.A,{}),children:u.t("Clear table")})]})]}):null,D&&null===r&&i.length&&O?(0,l.jsxs)(eL.A,{open:!0,onClose:q?()=>{}:ex,fullWidth:!0,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:ef,p:2}},children:[q?null:(0,l.jsxs)(eP.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[n,(0,l.jsx)(ns.A,{}),u.t("Import csv file")]}),(0,l.jsx)(eM.A,{children:q?(0,l.jsx)(V.A,{}):null===$?(0,l.jsx)(lV.A,{handleFiles:eu,extensions:["csv"],maxSize:j().max.sourceCode.ioFieldTableSize}):(0,l.jsxs)(k.A,{children:[(0,l.jsx)(eC.A,{severity:"info",sx:{mb:3},children:u.t("Use this preview to match each column with the correct entries")}),(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",p:2,mb:3},children:[(0,l.jsx)(e7.A,{id:"skip-first-row",value:Q,onChange:e=>ee(e.target.checked)}),(0,l.jsx)(k.A,{sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",wordWrap:"break-word",overflowWrap:"anywhere",ml:2},children:(0,l.jsxs)(li.A,{htmlFor:"skip-first-row",sx:{cursor:"pointer",userSelect:"none"},children:[(0,l.jsx)(S.A,{variant:"body2",children:u.t("Do not import the first row")}),(0,l.jsx)(S.A,{variant:"caption",children:u.t("Check this if the first row in your csv file is a header row")})]})})]}),(0,l.jsxs)(l$,{children:[(0,l.jsx)(lA.A,{tooltip:!0,tooltipEmpty:u.t("Column not imported"),tooltipPrefix:u.t("Column imported as"),highlight:!0,maxContent:!0,items:et,setItems:en,sx:{width:"115px",minWidth:"115px",mr:1}}),(Array.isArray(X)?X:[]).map((e,t)=>Array.isArray(e)?(0,l.jsx)(R.A,{title:Q&&0===t?u.t("Row not imported"):null,placement:"left",children:(0,l.jsx)(lJ,{children:[...e,...Array(ei()-e.length).fill("")].map((e,n)=>(0,l.jsx)(lX,{removed:Q&&0===t,excluded:Q&&0===t||!et[n],children:e},n))})},t):null)]})]})}),q?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:ex,children:u.t("Cancel")}),null!==$?(0,l.jsx)(C.A,{variant:"contained",onClick:ec,startIcon:(0,l.jsx)(lm.A,{}),children:u.t("Import csv file")}):null]})]}):null,(0,l.jsx)(eO.A,{anchorEl:N,open:!!N,onClose:()=>L(null),children:(0,l.jsxs)(eN.A,{onClick:()=>{F(!0),L(null)},children:[(0,l.jsx)(lm.A,{fontSize:"small"}),(0,l.jsx)(S.A,{sx:{ml:3},variant:"body2",children:u.t("Import csv")})]})})]})});var l1=n(12067),l2=n(4552);let l5=e=>{let{sx:t,container:n=null}=e,i=(0,g.useRef)(null),[r,s]=(0,g.useState)(!1);("object"!=typeof t||null===t)&&(t={}),(0,g.useEffect)(()=>{var e;let t=new IntersectionObserver(e=>{let[n]=e;n.isIntersecting&&(s(!0),t.disconnect())},{root:null!=(e=null==n?void 0:n.current)?e:null,threshold:.1});return t.observe(i.current),()=>t.disconnect()},[]);let a=r&&"string"==typeof t.backgroundImage?t.backgroundImage:"none";return(0,l.jsx)(k.A,{ref:i,sx:{...t,backgroundImage:a}})},l3=["png","apng","jpg","jpeg","gif","svg","webp","avif","bmp","tif","tiff","ico"],l4=e=>{let{onDelete:t,filePaths:n=[],sx:i={},children:r=null,maxCount:s=null,tooltip:a=null}=e,o=(0,g.useRef)(null),{i18n:d}=(0,m.B)(),c=(0,b.A)();("object"!=typeof i||null===i)&&(i={});let u=async e=>{var t;await (null==(t=window.sdk)?void 0:t.ipc.device.showFileInFolder(e))},p=async(e,n)=>{e.preventDefault(),e.stopPropagation(),"function"==typeof t&&await t(n)};return(0,l.jsxs)(k.A,{sx:{border:"1px solid ".concat(c.palette.divider),borderRadius:1,p:3,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",...i},children:[Array.isArray(n)&&n.length?(0,l.jsx)(es.Ay,{container:!0,spacing:4,ref:o,sx:{position:"relative",zIndex:1},children:n.map((e,n)=>{let i="string"==typeof e?e:null==e?void 0:e.filePath,r="object"==typeof e?null==e?void 0:e.runTime:null,s="object"==typeof e?null==e?void 0:e.sessionId:null,a=i.replace(/[\\\/]+$/g,"").replace(/[\\\/]+/g,"/").split("/").pop(),d=a.replace(/^.*\./g,"").toLowerCase();return(0,l.jsx)(es.Ay,{item:!0,children:(0,l.jsxs)(k.A,{sx:{width:120,display:"flex",alignItems:"center",flexDirection:"column"},children:[(0,l.jsx)(R.A,{title:i,enterDelay:250,enterNextDelay:250,placement:"left",children:(0,l.jsxs)(C.A,{onClick:()=>u(i),sx:{width:"100%",height:120,overflow:"hidden",position:"relative",zIndex:0,"&>.delete":{opacity:0,transform:"scale(0.1)"},"&:hover>.delete":{opacity:1,transform:"scale(1)"}},children:["function"==typeof t?(0,l.jsx)(eT.A,{className:"delete",component:"div",onClick:e=>p(e,i),sx:{position:"absolute",top:2,right:2,"&:hover":{color:c.palette.error.main},transition:"all 100ms linear"},children:(0,l.jsx)(eF.A,{fontSize:"small"})}):null,l3.includes(d)?(0,l.jsx)(l5,{sx:{width:"100%",height:"100%",backgroundImage:"url('".concat((0,l1.w8)(i),"')"),backgroundSize:"contain",backgroundPosition:"50%",backgroundRepeat:"no-repeat"},container:o}):(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[(0,l.jsx)(l2.A,{fontSize:"large",sx:{mb:2}}),(0,l.jsx)(S.A,{variant:"caption",color:"primary",sx:{fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace"},children:d})]})]})}),(0,l.jsxs)(S.A,{variant:"caption",sx:{mt:1,userSelect:"none",fontFamily:"Yaldevi, sans-serif",textAlign:"center",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",whiteSpace:"normal",wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%",lineHeight:"1rem",maxHeight:"3rem"},children:[null!==r?(0,l.jsx)(ly,{time:r,sessionId:s}):null,a]})]})},n)})}):(0,l.jsx)(k.A,{sx:{userSelect:"none",display:"flex",ml:3,mt:3,width:"100%",height:25,alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(S.A,{variant:"caption",children:d.t("No files selected")})}),r&&(!Number.isInteger(s)||n.length<s)?(0,l.jsx)(k.A,{sx:{mt:3},children:r}):null,(0,l.jsx)(k.A,{sx:{mt:3,display:"flex",justifyContent:"end",position:"sticky",bottom:"8px",right:0,zIndex:0},children:(0,l.jsx)(R.A,{title:a,placement:"left",children:(0,l.jsx)(ep.A,{variant:"outlined",sx:{"&:hover":{background:c.palette.background.paper}},label:(0,l.jsx)(S.A,{variant:"caption",children:Number.isInteger(s)?"".concat(n.length," / ").concat(s," ").concat(d.t("files")):"".concat(n.length," ").concat(1===n.length?d.t("file"):d.t("files"))})})})})]})};var l6=n(8949);let l9=e=>{var t;let{field:n}=e,[i,r]=(0,g.useState)({}),s="table"===n.type&&void 0===i[n.key]||i[n.key];return(0,l.jsx)(k.A,{sx:{display:"flex",width:"250px",flex:"0 0 250px",flexDirection:"column",justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"},children:(0,l.jsxs)(k.A,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,l.jsx)(k.A,{sx:{width:"30px",height:"30px",mr:2},children:n.desc?(0,l.jsx)(eT.A,{size:"small",onClick:()=>((e,t)=>{r(n=>{let l="table"===t&&void 0===n[e]||n[e];return{...n,[e]:!l}})})(n.key,n.type),children:s?(0,l.jsx)(nG.A,{fontSize:"small"}):(0,l.jsx)(ti.A,{fontSize:"small"})}):null}),(0,l.jsx)(li.A,{htmlFor:"field-".concat(n.id),sx:{cursor:["int","string","boolean"].includes(n.type)&&!(Array.isArray(n.options)&&n.options.length)?"pointer":"default"},children:(0,l.jsx)(S.A,{variant:"body2",children:null!=(t=n.name)?t:n.key})})]}),n.desc&&s?(0,l.jsx)(S.A,{variant:"caption",component:"pre",sx:{wordBreak:"break-word",whiteSpace:"preserve",fontFamily:"Yaldevi,sans-serif",mt:2,pl:2},children:n.desc}):null]})})},l7=e=>{let{agents:t,sessionId:n=null,sessionChange:i=()=>{}}=e,{getAgentId:r,onAgentId:s,getSource:o,onSource:d,getInputs:c,onInputs:u,inputsSetScalars:p,inputsAddFiles:h,inputsDeleteFile:f}=(0,x.P)(),{i18n:y}=(0,m.B)(),A=(0,g.useRef)(null),v=(0,g.useRef)(null),w=(0,g.useRef)({}),b=(0,g.useRef)([]),S=(0,g.useRef)(null),[C,I]=(0,g.useState)((0,a.fD)(t,r())),[T,z]=(0,g.useState)(!1),[D,E]=(0,g.useState)([]),[_,M]=(0,g.useState)({});(0,g.useEffect)(()=>{I((0,a.fD)(t,r()));let e=s(e=>{z(!1),I((0,a.fD)(t,e))});return()=>{e()}},[t]),(0,g.useEffect)(()=>{A.current=null,v.current=null,w.current={},b.current=[],S.current=null,z(!1),"string"==typeof(null==C?void 0:C.id)&&(async()=>{var e,t;b.current=null!=(t=null==(e=await o(C.id))?void 0:e.srcInputs)?t:[],E(b.current),M(await c(C.id,!0,n)),window.setTimeout(()=>z(!0),100)})();let e=d(async e=>{let{agentId:t,sourceCode:l}=e;if(t===(null==C?void 0:C.id)){var i,r;w.current={},JSON.stringify(b.current)!==JSON.stringify(null!=(i=null==l?void 0:l.srcInputs)?i:[])&&(z(!1),b.current=null!=(r=null==l?void 0:l.srcInputs)?r:[],E(b.current),M(await c(t,!0,n)),window.setTimeout(()=>z(!0),100))}}),t=u(e=>{let{agentId:t,inputs:l,inputSessionId:i}=e;t===(null==C?void 0:C.id)&&i===n&&M(l)});return()=>{e(),t()}},[C]),(0,g.useEffect)(()=>{T&&window.setTimeout(()=>N(),200)},[T]),(0,g.useEffect)(()=>{if("string"!=typeof(null==C?void 0:C.id))return;let e=setTimeout(async()=>{if("string"==typeof n){var e;let t=!0;Array.isArray(D)&&D.length&&(t=D.reduce((e,t)=>{if(e){let{fieldShown:e,fieldEmpty:n}=(0,a.PZ)(D,t.key,_);return!e||!n||void 0!==t.default}return e},!0)),await (null==(e=window.sdk)?void 0:e.ipc.session.updateReady(C.id,n,t))&&i()}},200);return()=>{clearTimeout(e)}},[D,_]);let P=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;null!==A.current&&window.clearTimeout(A.current),A.current=window.setTimeout(()=>{A.current=null,N()},e)},N=async()=>{if("string"!=typeof(null==C?void 0:C.id)||!S.current||!T)return;let e={};for(let t of S.current.querySelectorAll("form[data-scalar]"))e[t.getAttribute("data-scalar")]=new FormData(t);let t={};for(let n of D)if(!["files","table"].includes(n.type)&&e[n.key]instanceof FormData)switch(n.type){case"int":case"string":t[n.key]=n.isList?e[n.key].getAll(n.key):e[n.key].get(n.key);break;case"boolean":t[n.key]="on"===e[n.key].get(n.key)}await p(C.id,t,n)},R=async(e,t)=>{Array.isArray(t)&&t.length&&await h(r(),e,t.map(e=>e.path),n)},L=async(e,t)=>{await f(r(),e,t,n)};return v.current=null,(0,l.jsx)(k.A,{children:T?Array.isArray(D)&&D.length?(0,l.jsx)(k.A,{sx:{p:3,pb:0,flexGrow:1},ref:S,children:D.map(e=>{let t=(e=>{var t;let n="files"===e.type?[]:null!=(t=e.default)?t:"";if(void 0===w.current[e.key]){let t=_[e.key];switch(e.type){case"int":case"string":e.isList?Array.isArray(t)||(t=null!==n?[n]:[]):("int"!==e.type||Number.isInteger(t)||(t=n),"string"===e.type&&"string"!=typeof t&&(t=n));break;case"boolean":"boolean"!=typeof t&&(t=n);break;case"files":Array.isArray(t)||(t=n)}w.current[e.key]=t}return w.current[e.key]})(e),{fieldShown:i,fieldEmpty:r}=(0,a.PZ)(D,e.key,_);return i&&r&&void 0===e.default&&null===v.current&&(v.current=e.id),(0,l.jsxs)(k.A,{sx:{display:i?"flex":"none",mb:3},children:[(0,l.jsx)(l9,{field:e}),(0,l.jsx)(k.A,{sx:{width:"100%"},children:["string","int"].includes(e.type)?(0,l.jsx)(lo,{field:e,firstValue:t,actionSet:P,refFirstEmpty:v}):"boolean"===e.type?(0,l.jsx)(ld,{field:e,firstValue:t,actionSet:P}):"files"===e.type?(0,l.jsx)(l4,{maxCount:j().max.sourceCode.ioInputFileCount,onDelete:t=>L(e.key,t),filePaths:Array.isArray(_[e.key])?_[e.key]:t,sx:{mb:3},children:(0,l.jsx)(lV.A,{multiple:!0,pop:v.current===e.id,maxCount:j().max.sourceCode.ioInputFileCount,minSize:null==e?void 0:e.min,maxSize:null==e?void 0:e.max,extensions:Array.isArray(null==e?void 0:e.extensions)?e.extensions:["txt"],withPaths:!0,handleFiles:t=>R(e.key,t)})}):"table"===e.type?(0,l.jsx)(l0,{pop:v.current===e.id,fieldKey:e.key,fieldName:e.name,fieldColumns:e.columns,sessionId:n}):null})]},"".concat(e.id,"-").concat(e.type))})}):null===n?(0,l.jsx)(k.A,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",pt:12},children:(0,l.jsx)(l6.default,{title:y.t("No inputs"),message:y.t("This module has no settings to configure"),sx:{"&.content-center":{minHeight:"100%"}}})}):null:(0,l.jsx)(k.A,{sx:{height:"100%",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,l.jsx)(tJ.A,{grey:!0,size:128,className:"zoom-in"})})})};var l8=n(55360);let ie=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{"& .react-datepicker-popper":{zIndex:5},"& .react-datepicker-wrapper":{width:"100%"},"& .react-datepicker":{padding:t.spacing(2,0),color:t.palette.text.primary,borderRadius:t.shape.borderRadius,fontFamily:t.typography.fontFamily,backgroundColor:t.palette.background.paper,boxShadow:t.shadows[7*("bordered"!==Z.A.skin)],border:"bordered"===Z.A.skin?"1px solid ".concat(t.palette.divider):"none","& .react-datepicker__header":{padding:0,border:"none",fontWeight:400,backgroundColor:t.palette.background.paper,"& .react-datepicker__day-name":{margin:0}},"& .react-datepicker-year-header":{lineHeight:2.1,marginBottom:"0.5rem",color:t.palette.text.primary},"& .react-datepicker__triangle":{display:"none"},"& > .react-datepicker__navigation":{top:t.spacing(3),"&.react-datepicker__navigation--previous":{border:"none",backgroundImage:"".concat("url('data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' style=\\'width:24px;height:24px\\' viewBox=\\'0 0 24 24\\'%3E%3Cpath fill=\\'currentColor\\' d=\\'M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z\\' /%3E%3C/svg%3E')".replace("currentColor",t.palette.text.secondary).replace("#","%23")),height:"24px",width:"24px","& .react-datepicker__navigation-icon":{display:"none"}},"&.react-datepicker__navigation--next":{border:"none",backgroundImage:"".concat("url('data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' style=\\'width:24px;height:24px\\' viewBox=\\'0 0 24 24\\'%3E%3Cpath fill=\\'currentColor\\' d=\\'M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z\\' /%3E%3C/svg%3E')".replace("currentColor",t.palette.text.secondary).replace("#","%23")),height:"24px",width:"24px","& .react-datepicker__navigation-icon":{display:"none"}},"&.react-datepicker__navigation--next--with-time":{right:"122px"},"&:focus, &:active":{outline:0}},"& .react-datepicker__current-month":{lineHeight:2.1,fontSize:"1rem",fontWeight:400,letterSpacing:"0.15px",marginBottom:t.spacing(2),color:t.palette.text.primary},"& .react-datepicker__day-name":{lineHeight:1.5,width:"2.25rem",fontSize:"0.75rem",letterSpacing:"0.4px",color:t.palette.text.secondary},"& .react-datepicker__day":{margin:0,width:"2.25rem",lineHeight:2.75,height:"2.25rem",borderRadius:"50%",color:t.palette.text.primary,"&.react-datepicker__day--selected, &.react-datepicker__day--keyboard-selected":{color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&.react-datepicker__day--in-range, &.react-datepicker__day--in-selecting-range":{borderRadius:0,color:t.palette.primary.main,backgroundColor:"".concat((0,n6.z)(t.palette.primary.main,.06)," !important"),"&:empty":{backgroundColor:"transparent !important"}},"&.react-datepicker__day--selected.react-datepicker__day--in-selecting-range.react-datepicker__day--selecting-range-start, &.react-datepicker__day--selected.react-datepicker__day--range-start.react-datepicker__day--in-range, &.react-datepicker__day--range-start":{borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&.react-datepicker__day--range-end":{borderTopRightRadius:"50%",borderBottomRightRadius:"50%",color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&:focus, &:active":{outline:0},"&.react-datepicker__day--outside-month":{height:"auto"},"&.react-datepicker__day--outside-month, &.react-datepicker__day--disabled:not(.react-datepicker__day--selected)":{color:t.palette.text.disabled,"&:hover":{backgroundColor:"transparent"}},"&.react-datepicker__day--highlighted, &.react-datepicker__day--highlighted:hover":{color:t.palette.success.main,backgroundColor:(0,n6.z)(t.palette.success.main,.12)},"&.react-datepicker__day--today":{fontWeight:400}},"& .react-datepicker__header__dropdown":{"& .react-datepicker__month-dropdown-container:not(:last-child)":{marginRight:t.spacing(8)},"& .react-datepicker__month-dropdown-container, & .react-datepicker__year-dropdown-container":{marginBottom:t.spacing(4)},"& .react-datepicker__month-read-view--selected-month, & .react-datepicker__year-read-view--selected-year":{fontSize:"0.875rem",marginRight:t.spacing(1),color:t.palette.text.primary},"& .react-datepicker__month-read-view:hover .react-datepicker__month-read-view--down-arrow, & .react-datepicker__year-read-view:hover .react-datepicker__year-read-view--down-arrow":{borderTopColor:t.palette.text.secondary,borderRightColor:t.palette.text.secondary},"& .react-datepicker__month-read-view--down-arrow, & .react-datepicker__year-read-view--down-arrow":{top:4,borderTopColor:t.palette.text.disabled,borderRightColor:t.palette.text.disabled},"& .react-datepicker__month-dropdown, & .react-datepicker__year-dropdown":{paddingTop:t.spacing(1.5),paddingBottom:t.spacing(1.5),borderColor:t.palette.divider,borderRadius:t.shape.borderRadius,backgroundColor:t.palette.background.paper,boxShadow:"light"===t.palette.mode?t.shadows[8]:t.shadows[9]},"& .react-datepicker__month-option, & .react-datepicker__year-option":{paddingTop:t.spacing(.5),paddingBottom:t.spacing(.5),"&:hover":{backgroundColor:t.palette.action.hover}},"& .react-datepicker__month-option.react-datepicker__month-option--selected_month":{backgroundColor:(0,n6.z)(t.palette.primary.main,.08),"&:hover":{backgroundColor:(0,n6.z)(t.palette.primary.main,.12)},"& .react-datepicker__month-option--selected":{display:"none"}},"& .react-datepicker__year-option.react-datepicker__year-option--selected_year":{backgroundColor:(0,n6.z)(t.palette.primary.main,.08),"&:hover":{backgroundColor:(0,n6.z)(t.palette.primary.main,.12)},"& .react-datepicker__year-option--selected":{display:"none"}},"& .react-datepicker__year-option":{"& .react-datepicker__navigation--years-upcoming":{width:9,height:9,borderStyle:"solid",borderWidth:"3px 3px 0 0",transform:"rotate(-45deg)",borderTopColor:t.palette.text.disabled,borderRightColor:t.palette.text.disabled,margin:"".concat(t.spacing(2.75)," auto ").concat(t.spacing(0))},"&:hover .react-datepicker__navigation--years-upcoming":{borderTopColor:t.palette.text.secondary,borderRightColor:t.palette.text.secondary},"& .react-datepicker__navigation--years-previous":{width:9,height:9,borderStyle:"solid",borderWidth:"0 0 3px 3px",transform:"rotate(-45deg)",borderLeftColor:t.palette.text.disabled,borderBottomColor:t.palette.text.disabled,margin:"".concat(t.spacing(0)," auto ").concat(t.spacing(2.75))},"&:hover .react-datepicker__navigation--years-previous":{borderLeftColor:t.palette.text.secondary,borderBottomColor:t.palette.text.secondary}}},"& .react-datepicker__month":{marginTop:t.spacing(3)},[t.breakpoints.down("sm")]:{"& .react-datepicker__month":{marginLeft:0,marginRight:0,marginBottom:0}},"& .react-datepicker__month, & .react-datepicker__year":{"& .react-datepicker__month-text, & .react-datepicker__year-text, & .react-datepicker__quarter-text":{height:"2rem",alignItems:"center",display:"inline-flex",justifyContent:"center","&:hover":{borderRadius:t.shape.borderRadius},"&:focus, &:active":{outline:0}},"& .react-datepicker__quarter--selected, & .react-datepicker__year-text--selected, & .react-datepicker__month--selected, & .react-datepicker__quarter-text--keyboard-selected, & .react-datepicker__month-text--keyboard-selected, & .react-datepicker__year-text--keyboard-selected":{color:t.palette.common.white,borderRadius:t.shape.borderRadius,backgroundColor:"".concat(t.palette.primary.main," !important")},"& .react-datepicker__week-number":{fontWeight:600,color:t.palette.text.primary}},"& .react-datepicker__year-wrapper":{maxWidth:205,justifyContent:"center"},"& .react-datepicker__input-time-container":{display:"flex",alignItems:"center",..."rtl"===t.direction?{flexDirection:"row-reverse"}:{}},"& .react-datepicker__today-button":{borderRadius:"1rem",margin:"0 1rem 0.3rem",color:t.palette.common.white,backgroundColor:t.palette.primary.main},"& .react-datepicker__time-container":{borderLeftColor:t.palette.divider},"&.react-datepicker--time-only, & .react-datepicker__time-container":{width:"7rem",padding:t.spacing(1.2,0),"& .react-datepicker-time__header":{marginBottom:t.spacing(3),color:t.palette.text.primary,fontSize:t.typography.body2.fontSize},"& .react-datepicker__time":{background:t.palette.background.paper,"& .react-datepicker__time-box .react-datepicker__time-list-item--disabled":{color:t.palette.text.disabled}},"& .react-datepicker__time-list-item":{lineHeight:1.75,height:"auto !important",marginLeft:t.spacing(3.2),marginRight:t.spacing(1.2),color:t.palette.text.primary,borderRadius:t.shape.borderRadius,"&:focus, &:active":{outline:0},"&:hover":{backgroundColor:"".concat(t.palette.action.hover," !important")},"&.react-datepicker__time-list-item--selected":{color:"".concat(t.palette.common.white," !important"),backgroundColor:"".concat(t.palette.primary.main," !important")}},"& .react-datepicker__time-box":{width:"100%"},"& .react-datepicker__time-list":{"&::-webkit-scrollbar":{width:8},"&::-webkit-scrollbar-track":{background:t.palette.background.paper},"&::-webkit-scrollbar-thumb":{background:"#aaa",borderRadius:"10px"},"&::-webkit-scrollbar-thumb:hover":{background:"#999"}}},"&.react-datepicker--time-only .react-datepicker__time-container":{width:"calc(7rem - 2px)"},"& .react-datepicker__day:hover, & .react-datepicker__month-text:hover, & .react-datepicker__quarter-text:hover, & .react-datepicker__year-text:hover":{backgroundColor:t.palette.action.hover}},"& .react-datepicker__close-icon":{paddingRight:t.spacing(4),..."rtl"===t.direction?{right:0,left:"auto"}:{},"&:after":{width:"unset",height:"unset",fontSize:"1.5rem",color:t.palette.text.primary,backgroundColor:"transparent !important"}}}});var it=n(39200),il=n.n(it),ii=n(5232),ir=n(20243),is=n(9778),ia=n(46813),io=n(50133);let id=e=>{var t;let{session:n,onChange:i=()=>{}}=e,{i18n:r}=(0,m.B)(),s=(0,b.A)(),a=(0,g.useRef)(null),o=(0,g.useRef)(null),[d,c]=(0,g.useState)(null!=(t=n.sessionInfo)?t:{day:"*",hour:"*",minute:"0"});(0,g.useEffect)(()=>{"object"==typeof n.sessionInfo&&null!==n.sessionInfo&&c(structuredClone(n.sessionInfo))},[n.sessionInfo]);let u=(e,t)=>{null!==a.current&&window.clearTimeout(a.current),c(n=>{let l=structuredClone(n);do{let n=e.match(/^(day|hour|minute)\-type$/);if(n){if("all"===t){l[n[1]]="*";break}if("modulo"===t){l[n[1]]="%2";break}if("list"===t){l[n[1]]="day"===n[1]?"1":"0";break}if("day"===n[1]&&"dayofweek"===t){l[n[1]]="w1";break}}if(["day","hour","minute"].includes(e)){if(Array.isArray(t)){(t=t.map(e=>parseInt(e,10)).filter(e=>Number.isInteger(e)&&e>=0)).length&&(l[e]="w"===l[e][0]?"w".concat(t.join(",")):t.join(","));break}if("%"===l[e][0]){let n="day"===e?31:"hour"===e?23:59;(!Number.isInteger(t=parseInt(t,10))||t<2)&&(t=2),t>n&&(t=n),l[e]="%".concat(t)}}}while(!1);return a.current=window.setTimeout(async()=>{i(l),a.current=null},450),l})},p=e=>{let t=[];for(let n of o.current.querySelectorAll("[name=".concat(e,"][type=checkbox]")))n.checked&&t.push(n.value);u(e,t)},x=[{key:"day",label:r.t("Days"),icon:(0,l.jsx)(is.A,{})},{key:"hour",label:r.t("Hours"),icon:(0,l.jsx)(io.A,{})},{key:"minute",label:r.t("Minutes"),icon:(0,l.jsx)(ia.A,{})}],h=[r.t("Monday"),r.t("Tuesday"),r.t("Wednesday"),r.t("Thursday"),r.t("Friday"),r.t("Saturday"),r.t("Sunday")];return(0,l.jsx)(k.A,{ref:o,children:x.map(e=>{let t=null,n=(()=>{var n;let l=null!=(n=d[e.key])?n:"";if("*"===l)return"all";if("%"===l[0]){let e=Math.abs(parseInt(l.substring(1),10));if(Number.isInteger(e)&&e>=2)return t=e,"modulo"}if(l.match(/^\d+(?:,\d+)*?$/)){let e=l.split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e));if(e.length)return t=e,"list"}if("day"===e.key&&l.match(/^w\d+(?:,\d+)*?$/)){let e=l.substring(1).split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e)&&e>=1&&e<=7);if(e.length)return t=e,"dayofweek"}})();return(0,l.jsxs)(k.A,{sx:{mb:4,width:"100%"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",width:"100%"},children:[(0,l.jsxs)(eZ.A,{fullWidth:!0,children:[(0,l.jsx)(ir.A,{sx:{px:2,background:s.palette.background.paper,ml:-1},children:e.label}),(0,l.jsxs)(la.A,{name:"".concat(e.key,"-type"),value:null!=n?n:"",required:!0,startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:-1},children:e.icon}),onChange:t=>u("".concat(e.key,"-type"),t.target.value),fullWidth:!0,children:[(0,l.jsx)(eN.A,{value:"all",children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?r.t("Every day"):"hour"===e.key?r.t("Every hour"):r.t("Every minute")})}),(0,l.jsx)(eN.A,{value:"modulo",children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?r.t("Every n days of the month"):"hour"===e.key?r.t("Every n hours"):r.t("Every n minutes")})}),(0,l.jsx)(eN.A,{value:"list",children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?r.t("Specific days of the month"):"hour"===e.key?r.t("Specific hours"):r.t("Specific minutes")})}),"day"===e.key?(0,l.jsx)(eN.A,{value:"dayofweek",children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:r.t("Specific days of the week")})}):null]})]}),"modulo"===n?(0,l.jsx)(eS.A,{fullWidth:!0,sx:{ml:3},name:e.key,type:"number",inputMode:"numeric",onChange:t=>u(e.key,t.target.value),inputProps:{min:2,max:"day"===e.key?31:"hour"===e.key?23:59},value:t}):null]}),"all"===n?(0,l.jsx)("input",{type:"hidden",name:e.key,value:"*"}):null,"list"===n?(0,l.jsx)(k.A,{sx:{px:4,mb:4},children:[...Array("day"===e.key?31:"hour"===e.key?24:60).keys()].map(n=>{let i="day"===e.key?n+1:n,r="day"===e.key?"".concat(i):"".concat(i).padStart(2,"0");return(0,l.jsx)(lr.A,{label:r,sx:{mr:4,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi,sans-serif"}},control:(0,l.jsx)(ls.A,{inputProps:{name:e.key},value:i,checked:(Array.isArray(t)?t:[]).includes(i),onChange:()=>p(e.key)})},"".concat(e.key,"-").concat(i))})}):null,"dayofweek"===n?(0,l.jsx)(k.A,{sx:{px:4,mb:4},children:[...Array(7).keys()].map(n=>{let i=n+1,r=h[n];return(0,l.jsx)(lr.A,{label:r,sx:{mr:4,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi,sans-serif",userSelect:"none"}},control:(0,l.jsx)(ls.A,{inputProps:{name:e.key},value:i,checked:(Array.isArray(t)?t:[]).includes(i),onChange:()=>p(e.key)})},"".concat(e.key,"-").concat(i))})}):null]},e.key)})})},ic=e=>{let{agentId:t,session:n,fetchAll:i=()=>{}}=e,r=async e=>{var l;"string"==typeof t&&(await (null==(l=window.sdk)?void 0:l.ipc.session.updateInfo(t,n.sessionId,e)),await i())},s=async e=>{await r({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes()})},a=async e=>{await r(e)};return(0,l.jsx)(k.A,{sx:{width:"100%"},children:"schedule"===n.sessionType?(0,l.jsx)(ie,{children:(0,l.jsx)(il(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:new Date(n.sessionInfo.year,n.sessionInfo.month-1,n.sessionInfo.day,n.sessionInfo.hour,n.sessionInfo.minute),minDate:new Date,dateFormat:"MMMM d @ HH:mm",onChange:e=>s(e),customInput:(0,l.jsx)(eS.A,{fullWidth:!0,InputProps:{id:"session-info",startAdornment:(0,l.jsx)(ek.A,{position:"start",children:(0,l.jsx)(ii.A,{sx:{mr:-3}})})}})})}):(0,l.jsx)(id,{session:n,onChange:e=>a(e)})})},iu=e=>{var t;let{agentId:n,session:i,fetchAll:r=()=>{}}=e,s=(0,g.useRef)(null),a=(0,g.useRef)(null),o=async e=>{null!==s.current&&window.clearTimeout(s.current),s.current=window.setTimeout(async()=>{var t;if("string"!=typeof n||"string"!=typeof(null==i?void 0:i.sessionId))return;let l=await (null==(t=window.sdk)?void 0:t.ipc.session.updateName(n,i.sessionId,e));a.current.value=l,await r(),s.current=null},450)};return(0,l.jsx)(k.A,{sx:{width:"100%"},children:(0,l.jsx)(eS.A,{inputRef:a,id:"session-name",InputLabelProps:{shrink:!0},InputProps:{startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:-1},children:(0,l.jsx)(eH.A,{})})},onChange:e=>o(e.target.value),type:"string",fullWidth:!0,inputMode:"text",inputProps:{maxLength:32},defaultValue:null!=(t=null==i?void 0:i.sessionName)?t:""})})},ip=e=>{var t;let{field:n}=e,[i,r]=(0,g.useState)({}),s=i[n.key];return(0,l.jsx)(k.A,{sx:{display:"flex",width:"250px",flex:"0 0 250px",flexDirection:"column",justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"},children:(0,l.jsxs)(k.A,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,l.jsx)(k.A,{sx:{width:"30px",height:"30px",mr:2},children:n.desc?(0,l.jsx)(eT.A,{size:"small",onClick:()=>(e=>{r(t=>({...t,[e]:!t[e]}))})(n.key),children:s?(0,l.jsx)(nG.A,{fontSize:"small"}):(0,l.jsx)(ti.A,{fontSize:"small"})}):null}),(0,l.jsx)(li.A,{htmlFor:"session-".concat(n.key),sx:{cursor:"name"===(null==n?void 0:n.key)?"pointer":"default"},children:(0,l.jsx)(S.A,{variant:"body2",children:null!=(t=n.name)?t:n.key})})]}),n.desc&&s?(0,l.jsx)(S.A,{variant:"caption",component:"pre",sx:{wordBreak:"break-word",whiteSpace:"preserve",fontFamily:"Yaldevi,sans-serif",mt:2,pl:2},children:n.desc}):null]})})},ix=e=>{let{agents:t,sessionType:n="schedule"}=e,{getAgentId:i,onAgentId:r,onMachineStatus:s,getMachineStatus:o}=(0,x.P)(),{i18n:d}=(0,m.B)(),[c,u]=(0,g.useState)(!1),[h,f]=(0,g.useState)(null),[y,A]=(0,g.useState)(null),[j,v]=(0,g.useState)(null),[w,b]=(0,g.useState)(""),[I,T]=(0,g.useState)(10),[z,D]=(0,g.useState)(!1),[E,_]=(0,g.useState)(null),[P,N]=(0,g.useState)([]),L=(0,g.useRef)(null),O=(0,g.useRef)(null),F=async()=>{var e;if("string"!=typeof(null==E?void 0:E.id))return;let t=await (null==(e=window.sdk)?void 0:e.ipc.session.readAll(E.id,n));N((Array.isArray(t)?t:[]).map(e=>"object"!=typeof e||"object"!=typeof(null==e?void 0:e.sessionInfo)?null:(e.sessionDescription=((e,t,n)=>{if("schedule"===t){if(!Number.isInteger(e.year)||!Number.isInteger(e.month)||!Number.isInteger(e.day)||!Number.isInteger(e.hour)||!Number.isInteger(e.minute))return n.t("Does not run");let t=new Date(e.year,e.month-1,e.day,e.hour,e.minute).getTime(),l=no(t,"en",{month:"long",day:"numeric"}),i=no(t,"en",{hour:"2-digit",minute:"2-digit",hour12:!1});return"".concat(l," @ ").concat(i)}let l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=null;do{if("string"!=typeof e)break;if("*"===e){l=t?n.t("every hour"):n.t("every minute");break}if("%"===e[0]){let i=Math.abs(parseInt(e.substring(1),10));i>=2&&i<=1e3&&(l=t?n.t("every {{numModulo}} hours",{numModulo:i}):n.t("every {{numModulo}} minutes",{numModulo:i}));break}if(e.match(/^\d+(?:,\d+)*?$/)){let i=e.split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e)).map(e=>"".concat(e).padStart(2,"0"));i.length&&(l=t?i.length>1?n.t("hours {{list}}",{list:i.join(", ")}):n.t("hour {{value}}",{value:i[0]}):i.length>1?n.t("minutes {{list}}",{list:i.join(", ")}):n.t("minute {{value}}",{value:i[0]}));break}}while(!1);return l},i=[(e=>{let t=null;do{if("string"!=typeof e)break;if("*"===e){t=n.t("Every day");break}if("%"===e[0]){let l=Math.abs(parseInt(e.substring(1),10));l>=2&&l<=1e3&&(t=n.t("Every {{numModulo}} days of the month",{numModulo:l}));break}if(e.match(/^\d+(?:,\d+)*?$/)){let l=e.split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e));l.length&&(t=1===l.length?n.t("Day {{n}} of every month",{n:l[0]}):n.t("Days {{list}} of every month",{list:l.join(", ")}));break}if(e.match(/^w\d+(?:,\d+)*?$/)){let l=e.substring(1).split(",").map(e=>Math.abs(parseInt(e.trim(),10))).filter(e=>Number.isInteger(e)&&e>=1&&e<=7),i={1:n.t("Monday"),2:n.t("Tuesday"),3:n.t("Wednesday"),4:n.t("Thursday"),5:n.t("Friday"),6:n.t("Saturday"),7:n.t("Sunday")};l.length&&(t=l.map(e=>i[e]).join(", "));break}}while(!1);return t})(e.day),l(e.hour,!0),l(e.minute)].filter(e=>"string"==typeof e);return 3===i.length?i.join(" @ "):n.t("Does not run")})(e.sessionInfo,n,d),e)).filter(Boolean))};(0,g.useEffect)(()=>{_((0,a.fD)(t,i()));let e=r(e=>{D(!1),u(!1),A(null),v(null),b(""),_((0,a.fD)(t,e))});return()=>{e()}},[t]),(0,g.useEffect)(()=>{L.current=null,O.current=null,D(!1),u(!1),A(null),v(null),b(""),"string"==typeof(null==E?void 0:E.id)&&(async()=>{let{status:e,sessionId:t,sessionType:l}=o(E.id);f(p.A.STATUS_STOPPED!==e&&"string"==typeof t&&l===n?t:null),await F(),window.setTimeout(()=>D(!0),200)})();let e=s(e=>{let{agentId:t,status:l,sessionId:i,sessionType:r}=e;E.id===t&&(f(p.A.STATUS_STOPPED!==l&&"string"==typeof i&&r===n?i:null),window.setTimeout(()=>{F()},750))});return()=>{e()}},[E]);let U=[{field:"sessionReady",width:50,renderHeader:()=>"",headerName:d.t("Status"),renderCell:e=>{let{row:t}=e,n=t.sessionReady?h===t.sessionId?d.t("Running..."):d.t("Ready"):d.t("This session will not run because inputs are missing");return(0,l.jsx)(R.A,{title:n,placement:"top",children:h===t.sessionId?(0,l.jsx)(nU.A,{color:"primary",className:"rotate-360",sx:{ml:-1}}):(0,l.jsx)(l8.A,{color:t.sessionReady?t.sessionEnabled?"success":"disabled":"warning",sx:{ml:-1},fontSize:"small"})})},valueGetter:e=>{let{row:t}=e;return+!!t.sessionReady}},{field:"sessionEnabled",width:100,headerName:d.t("Enabled"),hideable:!1,renderCell:e=>{let{row:t}=e;return t.sessionReady?(0,l.jsx)(k.A,{sx:{display:"flex",justifyContent:"start",width:"100%"},children:(0,l.jsx)(R.A,{title:t.sessionEnabled?d.t("Disable this session"):d.t("Enable this session"),placement:"top",children:(0,l.jsx)(k.A,{children:(0,l.jsx)(e7.A,{size:"small",disabled:!t.sessionReady,checked:!!t.sessionEnabled,sx:{opacity:t.sessionReady?1:.3},onClick:e=>{e.preventDefault(),e.stopPropagation(),Y(t.sessionId,!t.sessionEnabled)}})})})}):(0,l.jsx)(S.A,{variant:"caption",children:d.t("Not ready")})},valueGetter:e=>{let{row:t}=e;return+!!t.sessionEnabled}},{field:"sessionRuns",minWidth:80,headerName:d.t("Run count"),renderCell:e=>{var t;let{row:n}=e,i=n.sessionRuns?1===n.sessionRuns?d.t("Ran once"):d.t("Ran {{count}} times",{count:n.sessionRuns}):d.t("No runs");return(0,l.jsx)(R.A,{title:i,placement:"top",children:(0,l.jsx)(S.A,{variant:"caption",children:null!=(t=n.sessionRuns)?t:d.t("No runs")})})},valueGetter:e=>{var t;let{row:n}=e;return null!=(t=n.sessionRuns)?t:0}},{field:"sessionName",width:150,headerName:d.t("Session name"),renderCell:e=>{let{row:t}=e;return(0,l.jsx)(R.A,{title:t.sessionName,placement:"top",children:(0,l.jsx)(S.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:er(t.sessionName,w,i())})})},valueGetter:e=>{let{row:t}=e;return t.sessionName}},{field:"sessionDescription",flex:1,headerName:"schedule"===n?d.t("Session date and time"):d.t("Session cadence"),hideable:!1,renderCell:e=>{let{row:t}=e;return(0,l.jsx)(R.A,{title:t.sessionDescription,placement:"top",children:(0,l.jsx)(S.A,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:er(t.sessionDescription,w,i())})})},valueGetter:e=>{let{row:t}=e;return t.sessionDescription}},{width:40,field:"actions",hideable:!1,filterable:!1,headerName:d.t("Actions"),renderHeader:()=>"",renderCell:e=>{let{row:t}=e;return(0,l.jsx)(R.A,{title:d.t("Delete session"),placement:"top",children:(0,l.jsx)(k.A,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsx)(eT.A,{size:"small",onClick:e=>{e.preventDefault(),e.stopPropagation(),v(t.sessionId)},children:(0,l.jsx)(eF.A,{fontSize:"small"})})})})}}],H=async()=>{var e;if("string"!=typeof(null==E?void 0:E.id))return;D(!1);let t=await (null==(e=window.sdk)?void 0:e.ipc.session.create(E.id,E.installedModuleId,n));"string"==typeof t&&(await F(),A(t)),D(!0)},q=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u(!1),v(null),"string"==typeof(null==E?void 0:E.id)&&(D(!1),await (null==(e=window.sdk)?void 0:e.ipc.session.delete(E.id,n,t)),await F(),D(!0))},Y=async(e,t)=>{var n;"string"==typeof(null==E?void 0:E.id)&&await (null==(n=window.sdk)?void 0:n.ipc.session.updateEnabled(E.id,e,t))&&await F()},K="string"==typeof y?P.reduce((e,t)=>t.sessionId===y?t:e,null):null;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.A,{sx:{p:4},children:[(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",justifyContent:"end",alignItems:"center",mb:4},children:[z&&P.length?(0,l.jsx)(k.A,{sx:{width:"200px",height:"30px",mt:"2px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,l.jsx)(nn.A,{fontSize:"small",color:"disabled"}),(0,l.jsx)(eS.A,{inputRef:O,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"}},InputProps:{endAdornment:(0,l.jsx)(ek.A,{position:"end",children:(0,l.jsx)(k.A,{sx:{width:30,height:30},children:w.length?(0,l.jsx)(R.A,{title:d.t("Clear filter"),placement:"top",children:(0,l.jsx)(eT.A,{sx:{width:30,height:30},onClick:()=>{b(""),null!==O.current&&(O.current.value="")},children:(0,l.jsx)(ez.A,{fontSize:"small"})})}):null})})},placeholder:d.t("Filter"),variant:"standard",disabled:!z,onChange:e=>{var t;return t=e.target.value.toLowerCase(),void(null!==L.current&&window.clearTimeout(L.current),L.current=window.setTimeout(()=>{b(t),L.current=null},450))}})]})}):null,(0,l.jsx)(C.A,{size:"small",startIcon:(0,l.jsx)(ev.A,{}),sx:{height:"32px"},variant:!z||P.length?"outlined":"contained",onClick:H,children:d.t("Add")}),z?P.length?(0,l.jsx)(R.A,{title:d.t("Delete all sessions"),placement:"top",children:(0,l.jsx)(eT.A,{disabled:!z||!P.length,sx:{width:"30px",height:"30px",mx:3},onClick:()=>u(!0),children:(0,l.jsx)(eF.A,{fontSize:"small"})})}):null:(0,l.jsx)(V.A,{spacing:0,rounded:!0,sx:{width:"30px",height:"30px",mx:3}})]}),(0,l.jsx)(lG,{sx:{"& .MuiDataGrid-row":{cursor:"pointer"}},onPageSizeChange:e=>T(e),onRowClick:e=>{let{row:t}=e;return A(t.sessionId)},rowsPerPageOptions:[10,25,50,100],disableSelectionOnClick:!0,getRowId:e=>e.sessionId,pageSize:I,columns:U,loading:!z,rows:"string"==typeof w&&w.length?P.filter(e=>Object.values(e).some(e=>"string"==typeof e&&e.toLowerCase().includes(w.toLowerCase()))):P,autoHeight:!0})]}),(0,l.jsxs)(M.Ay,{open:!!(z&&y),anchor:"right",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{top:49,bottom:49,left:251},"& .MuiDrawer-paper":{width:"calc(100% - 51px)"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute"}},onClose:()=>A(null),children:[(0,l.jsx)(B,{icon:"schedule"===n?(0,l.jsx)(nB.A,{}):(0,l.jsx)(nR.A,{}),title:"schedule"===n?d.t("Edit session for scheduled run"):d.t("Edit session for recurring runs"),handleClose:()=>A(null)}),y&&null!==K?(0,l.jsx)(W,{sx:{px:0},children:(0,l.jsxs)(k.A,{sx:{position:"relative",width:"100%"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",my:4,px:3},children:[(0,l.jsx)(ip,{field:{key:"name",name:d.t("Session name"),desc:d.t("A name to identify this session later")}}),(0,l.jsx)(iu,{agentId:null==E?void 0:E.id,session:K,fetchAll:F})]}),(0,l.jsxs)(k.A,{sx:{display:"flex",my:4,px:3},children:[(0,l.jsx)(ip,{field:{key:"info",name:"schedule"===n?d.t("Session date and time"):d.t("Session cadence"),desc:"schedule"===n?d.t("When to start this session"):d.t("How often to start this session")}}),(0,l.jsx)(ic,{agentId:null==E?void 0:E.id,session:K,fetchAll:F})]}),(0,l.jsx)(l7,{agents:t,sessionId:y,sessionChange:F})]})}):null,(0,l.jsx)(lj,{children:(0,l.jsx)(C.A,{color:"secondary",onClick:()=>A(null),children:d.t("Close")})})]}),z&&c?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>u(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:d.t("Delete all sessions")}),(0,l.jsx)(eM.A,{children:(0,l.jsx)(eC.A,{severity:"warning",children:"schedule"===n?d.t("Are you sure you want to delete all sessions for scheduled runs?"):d.t("Are you sure you want to delete all sessions for recurring runs?")})}),(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>u(!1),children:d.t("Cancel")}),(0,l.jsx)(C.A,{color:"error",onClick:()=>q(),startIcon:(0,l.jsx)(eF.A,{}),children:d.t("Delete all")})]})]}):null,z&&null!==j?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>v(null),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:d.t("Delete session")}),(0,l.jsx)(eM.A,{children:(0,l.jsx)(eC.A,{severity:"warning",children:"schedule"===n?d.t("Are you sure you want to delete this session for a scheduled run?"):d.t("Are you sure you want to delete this session for recurring runs?")})}),(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>v(null),children:d.t("Cancel")}),(0,l.jsx)(C.A,{color:"error",onClick:()=>q(j),startIcon:(0,l.jsx)(eF.A,{}),children:d.t("Delete")})]})]}):null]})},ih=e=>{let{agents:t}=e,{getAgentId:n,onAgentId:i,getInputs:r,onInputs:s,getSource:o,onSource:d}=(0,x.P)(),[c,u]=(0,g.useState)([]),[p,h]=(0,g.useState)({}),[m,f]=(0,g.useState)(null),[y,A]=(0,g.useState)("");(0,g.useEffect)(()=>{null!==m&&(async()=>{var e;let t=await o(n(),!0);u(null!=(e=null==t?void 0:t.srcInputs)?e:[]),h(await r(m.id))})();let e=d(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==m?void 0:m.id)){var l;u(null!=(l=null==n?void 0:n.srcInputs)?l:[])}}),t=s(e=>{let{agentId:t,inputs:n,inputSessionId:l}=e;(null==m?void 0:m.id)===t&&null===l&&h(n)});return()=>{e(),t()}},[m]),(0,g.useEffect)(()=>{f((0,a.fD)(t,n()));let e=i(e=>f((0,a.fD)(t,e)));return()=>e()},[t]);let j={"":{label:"Manual run",icon:(0,l.jsx)(nF.A,{}),content:(0,l.jsx)(l7,{agents:t}),hasPop:!(0,a.qH)(c,p)},cron:{label:"Recurring runs",icon:(0,l.jsx)(nR.A,{}),content:(0,l.jsx)(ix,{agents:t,sessionType:"cron"})},schedule:{label:"Scheduled runs",icon:(0,l.jsx)(nB.A,{}),content:(0,l.jsx)(ix,{agents:t,sessionType:"schedule"})}};return(0,l.jsx)(k.A,{sx:{width:"100%",height:"100%",position:"relative"},children:(0,l.jsx)(X,{tabs:j,hash:y,setHash:A,sticky:!0,bordered:!0})})};var im=n(56829),ig=n(48305),iy=n(12629);let iA=e=>{let{runsAll:t=[],runsFiltered:n=[],runsExcluded:i=[],open:r=!1,loaded:s=!1,onClose:o=()=>{},onDelete:d=async()=>{}}=e,{setFiltersRuns:c,getAgentId:u}=(0,x.P)(),{i18n:p}=(0,m.B)(),h=(0,b.A)(),g=0===i.length?ig.A:n.length>=t.length?im.A:iy.A,f=e=>{i.includes(e)?i=i.filter(t=>t!==e):i.push(e),c(u(),i)},y=async e=>{"function"==typeof d&&await d(e),i=i.filter(t=>t!==e),c(u(),i)};return(0,l.jsx)(M.Ay,{open:r,anchor:"left",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{position:"absolute"}},PaperProps:{sx:{position:"absolute"}},onClose:o,children:(0,l.jsxs)(k.A,{sx:{width:250,flexDirection:"column",position:"relative",zIndex:1,height:"100%",ml:1},children:[(0,l.jsxs)(k.A,{sx:{px:1,width:"100%",height:50,display:"flex",justifyContent:"space-between",alignItems:"center",background:h.palette.background.paper,zIndex:1},children:[(0,l.jsx)(R.A,{title:0===i.length?p.t("Deselect all"):p.t("Select all"),placement:"right",children:(0,l.jsx)(k.A,{children:(0,l.jsx)(eT.A,{disabled:!s,onClick:()=>{if(0===i.length)return void c(u(),t.filter(e=>!n.includes(e)));c(u(),[])},sx:{width:40,height:40},children:(0,l.jsx)(g,{})})})}),(0,l.jsx)(R.A,{title:p.t("Close"),placement:"right",children:(0,l.jsx)(eT.A,{onClick:o,sx:{width:40,height:40},children:(0,l.jsx)(L.A,{})})})]}),(0,l.jsx)(k.A,{sx:{width:"100%",minHeight:50,height:"calc(100% - 50px)",p:1,overflowY:"auto"},children:Array.isArray(t)&&t.length?t.map(e=>{let t=(0,a.u0)(e),r=parseInt("".concat(e).trim().split("-").pop(),10),o=n.includes(e)&&!i.includes(e);return(0,l.jsxs)(k.A,{sx:{my:1,display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center","& .MuiIconButton-root":{opacity:0},"&:hover .MuiIconButton-root":{opacity:1}},children:[(0,l.jsx)(R.A,{title:o?p.t("Run excluded by filters"):null,placement:"left",children:(0,l.jsxs)(k.A,{sx:{userSelect:"none",display:"flex",alignItems:"center"},children:[(0,l.jsx)(ls.A,{disabled:!s||o,checked:!n.includes(e),onClick:()=>f(e)}),s?(0,l.jsx)(S.A,{onClick:()=>s&&!o&&f(e),variant:"caption",sx:{fontFamily:"Inconsolata,monospace",...o?{textDecoration:"line-through"}:{cursor:"pointer"}},children:isNaN(r)?e:(0,l.jsx)(ly,{time:r,sessionId:t})}):(0,l.jsx)(k.A,{sx:{width:200,height:20},children:(0,l.jsx)(V.A,{spacing:0})})]})}),(0,l.jsx)(R.A,{title:p.t("Delete run"),placement:"right",children:(0,l.jsx)(eT.A,{onClick:()=>y(e),disabled:!s,sx:{width:40,height:40},children:(0,l.jsx)(eF.A,{fontSize:"small"})})})]},e)}):(0,l.jsx)(eC.A,{variant:"info",children:p.t("No runs found")})})]})})};var ij=n(76090),iv=n(11422),iw=n(41618),ib=n(9004),ik=n(72928),iS=n(39743),iC=n(67922);let iI=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",width:"250px",flex:"0 0 250px",height:"50px",marginLeft:t.spacing(1)}}),iT=(0,w.Ay)(k.A)(()=>({display:"flex",width:"100%"})),iz=(0,w.Ay)(k.A)(e=>{let{theme:t,bordered:n="false"}=e;return{display:"flex",width:"100%",height:"50px",alignItems:"center",borderBottom:"true"===n?"1px solid ".concat(t.palette.divider):null}}),iD=e=>{let{startTime:t=null,endTime:n=null,setStartTime:i=()=>{},setEndTime:r=()=>{},loaded:s=!1,runsToggle:a=()=>{},showFilters:o=!1,runsFiltered:d=0,runsTotal:c=0,runsLoaded:u=0}=e,{getFilters:p,setFiltersFields:h,getAgentId:f}=(0,x.P)(),{i18n:y}=(0,m.B)(),[A,j]=(0,g.useState)("today"),v=p(f()).fields,w=[{value:"today",title:y.t("Today"),Icon:iC.A},{value:"yesterday",title:y.t("Yesterday"),Icon:iv.A},{value:"last-7",title:y.t("Last 7 days"),Icon:iS.A},{value:"last-30",title:y.t("Last 30 days"),Icon:ik.A},{value:"custom",title:y.t("Custom"),Icon:ib.A}],b=u-d.length,I="object"==typeof v&&null!=v?Object.keys(v).length:0;return(0,l.jsxs)(iz,{bordered:u>0?"true":"false",children:[(0,l.jsx)(iI,{sx:{justifyContent:"space-between",alignItems:"center"},children:o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",ml:2},children:(0,l.jsx)(R.A,{title:y.t("Manually exclude runs from the current report"),children:(0,l.jsx)(C.A,{onClick:a,size:"small",startIcon:(0,l.jsx)(iw.A,{fontSize:"small"}),children:y.t("Runs list")})})}),I>0?(0,l.jsx)(R.A,{title:y.t("Clear all filters"),children:(0,l.jsx)(eT.A,{color:"warning",sx:{width:30,height:30},onClick:()=>h(f(),{}),children:(0,l.jsx)(ij.A,{fontSize:"small"})})}):null]}):null}),(0,l.jsxs)(iT,{sx:{justifyContent:"end",alignItems:"center",mr:3},children:[s?(0,l.jsx)(R.A,{title:"".concat(y.t("Runs shown: {{runsShown}} of {{runsLoaded}}",{runsShown:b,runsLoaded:u})).concat(0===I?" "+y.t("(no filters)"):"").concat(c>u?". "+y.t("{{runsTotal}} runs were found for this interval, but only the last {{runsLoaded}} runs are shown.",{runsLoaded:u,runsTotal:c}):""),children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",height:"30px"},children:(0,l.jsxs)(S.A,{sx:{color:c>u?"warning.main":"inherit",userSelect:"none",fontSize:"0.75rem",mr:2},children:["".concat(b," / ").concat(u),c>u?" (".concat(c,")"):""]})})}):null,s&&"custom"===A?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R.A,{title:y.t("Start time"),children:(0,l.jsx)(ie,{children:(0,l.jsx)(il(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:new Date(Number.isInteger(t)?1e3*t:Date.now()-864e5),dateFormat:"yyyy-MM-dd HH:mm",onChange:e=>(e=>{e instanceof Date&&i(Math.floor(e.getTime()/1e3))})(e),customInput:(0,l.jsx)(eS.A,{sx:{width:160,"& .MuiInput-input":{height:50,py:0,px:2,textAlign:"center",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},variant:"standard"})})})}),(0,l.jsx)(S.A,{variant:"caption",children:(0,l.jsx)(ns.A,{fontSize:"small",sx:{mt:2}})}),(0,l.jsx)(R.A,{title:y.t("End time"),children:(0,l.jsx)(ie,{children:(0,l.jsx)(il(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:Number.isInteger(n)?new Date(1e3*n):new Date,dateFormat:"yyyy-MM-dd HH:mm",onChange:e=>(e=>{e instanceof Date&&r(Math.floor(e.getTime()/1e3))})(e),customInput:(0,l.jsx)(eS.A,{sx:{width:160,"& .MuiInput-input":{height:50,py:0,px:2,textAlign:"center",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},variant:"standard"})})})})]}):null,(0,l.jsx)(la.A,{sx:{height:50,ml:5,mr:1,"&.MuiInput-root:before":{display:"none"}},inputProps:{sx:{pl:2}},variant:"standard",onChange:e=>(e=>{j(e);let t=Math.floor(new Date().setHours(0,0,0,0)/1e3);switch(e){case"today":i(t),r(null);break;case"yesterday":i(t-86400),r(t-1);break;case"last-7":i(t-604800),r(null);break;case"last-30":i(t-2592e3),r(null)}})(e.target.value),value:A,children:w.map(e=>{let{value:t,title:n,Icon:i}=e;return(0,l.jsx)(eN.A,{value:t,sx:{py:0},children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",p:0,height:40},children:[void 0!==i?(0,l.jsx)(i,{fontSize:"small",sx:{mr:2}}):null,(0,l.jsx)(S.A,{variant:"caption",color:"inherit",children:n})]})},t)})})]})]})},iE=e=>{let{field:t,loaded:n=!1}=e,{getFilters:i,setFiltersFields:r,getAgentId:s}=(0,x.P)(),{i18n:a}=(0,m.B)(),o=i(s()).fields,d="object"==typeof o&&null!==o&&"boolean"==typeof o[t.key]?o[t.key]:null,c=e=>{if("object"!=typeof o||null===o)return;let n=structuredClone(o);o[t.key]!==e?n[t.key]=!!e:delete n[t.key],r(s(),n)};return"boolean"===t.type?(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(R.A,{title:a.t("Filter by boolean value"),children:(0,l.jsx)(nn.A,{fontSize:"small",sx:{ml:1,mr:2},color:null!==d?"inherit":"disabled"})}),(0,l.jsxs)(lp.A,{size:"small",children:[(0,l.jsx)(C.A,{disabled:!n,onClick:()=>c(!0),variant:!0===d?"contained":"outlined",children:a.t("true")}),(0,l.jsx)(C.A,{disabled:!n,onClick:()=>c(!1),variant:!1===d?"contained":"outlined",children:a.t("false")})]})]}),null!==d?(0,l.jsx)(R.A,{title:a.t("Clear filter"),children:(0,l.jsx)(eT.A,{color:"warning",sx:{width:30,height:30},onClick:()=>{if("object"!=typeof o||null===o||void 0===o[t.key])return;let e=structuredClone(o);delete e[t.key],r(s(),e)},children:(0,l.jsx)(ez.A,{fontSize:"small"})})}):null]}):null},i_=e=>{let{field:t,loaded:n=!1}=e,{getFilters:i,setFiltersFields:r,onFilters:s,getAgentId:a}=(0,x.P)(),{i18n:o}=(0,m.B)(),d=(0,g.useRef)(null),[c,u]=(0,g.useState)(i(a())),[p,h]=(0,g.useState)("");return(0,g.useEffect)(()=>{let e=s(e=>{let{agentId:t,filters:n}=e;a()===t&&u(n)});return()=>{e()}},[]),(0,g.useEffect)(()=>{h("object"==typeof(null==c?void 0:c.fields)&&null!==c.fields&&"string"==typeof c.fields[t.key]?c.fields[t.key]:"")},[c]),"string"===t.type?(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(R.A,{title:o.t("Filter by text value"),children:(0,l.jsx)(nn.A,{fontSize:"small",sx:{ml:1,mr:2},color:p.length?"inherit":"disabled"})}),(0,l.jsx)(eS.A,{sx:{width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},placeholder:o.t("Filter"),variant:"standard",disabled:!n,value:p,onChange:e=>(e=>{h(e),null!==d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{"object"==typeof c.fields&&null!==c.fields&&(r(a(),{...c.fields,[t.key]:e}),d.current=null)},450)})(e.target.value.toLowerCase()),InputProps:{endAdornment:(0,l.jsx)(ek.A,{position:"end",children:(0,l.jsx)(k.A,{sx:{width:30,height:30},children:p.length?(0,l.jsx)(R.A,{title:o.t("Clear filter"),children:(0,l.jsx)(eT.A,{color:"warning",sx:{width:30,height:30},onClick:()=>{if("object"!=typeof c.fields||null===c.fields||void 0===c.fields[t.key])return;h("");let e=structuredClone(c.fields);delete e[t.key],r(a(),e)},children:(0,l.jsx)(ez.A,{fontSize:"small"})})}):null})})}})]})}):null},iM=e=>{let{field:t,loaded:n=!1}=e,{getFilters:i,setFiltersFields:r,onFilters:s,getAgentId:a}=(0,x.P)(),{i18n:o}=(0,m.B)(),d=(0,g.useRef)(null),c=(0,g.useRef)(null),[u,p]=(0,g.useState)(i(a())),[h,f]=(0,g.useState)(""),[y,A]=(0,g.useState)("");(0,g.useEffect)(()=>{let e=s(e=>{let{agentId:t,filters:n}=e;a()===t&&p(n)});return()=>{e()}},[]),(0,g.useEffect)(()=>{let e="object"==typeof(null==u?void 0:u.fields)&&null!==u.fields&&"object"==typeof u.fields[t.key]&&null!==u.fields[t.key]?u.fields[t.key]:{min:"",max:""};f(Number.isInteger(e.min)?e.min:""),A(Number.isInteger(e.max)?e.max:"")},[u]);let j=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"min";Number.isInteger(e=parseInt(e,10))||(e="");let l="min"===n?d:c;("min"===n?f:A)(e),null!==l.current&&window.clearTimeout(l.current),l.current=window.setTimeout(()=>{"object"==typeof u.fields&&null!==u.fields&&(r(a(),{...u.fields,[t.key]:{min:Number.isInteger(h)?h:"",max:Number.isInteger(y)?y:"",[n]:e}}),l.current=null)},250)};return"int"===t.type?(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(R.A,{title:o.t("Filter by minimum and maximum value"),children:(0,l.jsx)(nn.A,{fontSize:"small",sx:{ml:1,mr:2},color:h||y?"inherit":"disabled"})}),["min","max"].map(e=>(0,l.jsx)(eS.A,{type:"number",variant:"standard",disabled:!n,inputMode:"numeric",value:"".concat("min"===e?h:y),placeholder:"min"===e?o.t("Minimum"):o.t("Maximum"),onChange:t=>j(t.target.value.toLowerCase(),e),sx:{width:"100%",ml:2*("min"!==e),"& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}}},e))]}),Number.isInteger(h)||Number.isInteger(y)?(0,l.jsx)(R.A,{title:o.t("Clear filter"),children:(0,l.jsx)(eT.A,{color:"warning",sx:{width:30,height:30},onClick:()=>{if("object"!=typeof u.fields||null===u.fields||void 0===u.fields[t.key])return;f(""),A("");let e=structuredClone(u.fields);delete e[t.key],r(a(),e)},children:(0,l.jsx)(ez.A,{fontSize:"small"})})}):null]}):null};var iP=n(34007),iN=n(52621),iR=n(67362),iL=n(4069),iO=n(25493),iF=n(40570),iB=n(24788),iW=n(88246);let iU=e=>{let{sx:t={}}=e,{i18n:n}=(0,m.B)();return("object"!=typeof t||null===t)&&(t={}),(0,l.jsx)(k.A,{sx:{width:"100%",minHeight:"3rem",display:"flex",alignItems:"start",borderRadius:1,...t},children:(0,l.jsx)(eC.A,{severity:"info",sx:{width:"100%"},children:(0,l.jsx)(S.A,{color:"inherit",variant:"caption",children:n.t("No data")})})})},iH=e=>{let{active:t,payload:n,coordinate:i}=e,{i18n:r}=(0,m.B)();if(!t||!Array.isArray(n)||!n.length)return null;let{value:s,time:a,sessionId:o}=n[0].payload;return void 0===s||void 0===a?null:(0,l.jsx)(k.A,{sx:{position:"absolute",left:i.x,top:i.y-5,pointerEvents:"none"},children:(0,l.jsx)(R.A,{title:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",flexDirection:"column"},children:[null!==a?(0,l.jsx)(ly,{time:a,sessionId:o,inline:!0}):null,(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[null!==s?s?(0,l.jsx)(eQ.A,{fontSize:"small"}):(0,l.jsx)(L.A,{fontSize:"small"}):null,(0,l.jsx)(S.A,{variant:"caption",color:"inherit",sx:{ml:2,fontWeight:"bold"},children:null===s?r.t("No data"):s?r.t("true"):r.t("false")})]})]}),arrow:!0,placement:"top",open:!0,children:(0,l.jsx)("div",{style:{width:"1px",height:"1px"}})})})},iq=e=>{let{runs:t=[],loaded:n=!1}=e,i=(0,b.A)(),r=(Array.isArray(t)?t:[]).map(e=>{let t=parseInt(e.runId.replace(/^.*\-(\d+)$/g,"$1"),10);return{time:Number.isInteger(t)?t:null,norm:e.runData?1.6:.6,value:e.runData,run:nd(1e3*t),sessionId:(0,a.u0)(e.runId)}});return n?r.filter(e=>null!==e.value).length?(0,l.jsx)(k.A,{sx:{width:"100%",height:"100px",paddingTop:"10px"},children:(0,l.jsx)(iP.u,{width:"100%",height:100,children:(0,l.jsxs)(iN.E,{data:r,width:"100%",innerRadius:10,barSize:10,margin:{top:5,left:0,right:0,bottom:0},children:[(0,l.jsx)(iR.m,{content:e=>{let{active:t,payload:n,coordinate:i}=e;return(0,l.jsx)(iH,{active:t,payload:n,coordinate:i})}}),(0,l.jsx)(iL.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,l.jsx)(iO.h,{domain:[0,2],tick:{fontSize:11},ticks:[2,1],hide:!0}),(0,l.jsx)(iF.W,{dataKey:"run",tick:{fontSize:11}}),(0,l.jsx)(iB.y,{radius:15,dataKey:"norm",children:r.map((e,t)=>{let n=10*(null!==e.value);return(0,l.jsx)(iW.f,{height:n,width:n,radius:e.value?n:0,fill:null===e.value?i.palette.text.primary:e.value?i.palette.success.main:i.palette.error.main},"cell-".concat(t))})})]})})}):(0,l.jsx)(iU,{sx:{height:"80px"}}):(0,l.jsx)(k.A,{sx:{width:"100%",height:"100px",alignItems:"center",display:"flex",justifyContent:"center"},children:(0,l.jsx)(tJ.A,{grey:!0,size:50,className:"zoom-in"})})},iY=e=>{let{field:t,runs:n=[],loaded:i=!1}=e,{getFilters:r,getAgentId:s}=(0,x.P)(),o=r(s()),d="object"==typeof(null==o?void 0:o.fields)&&null!==o.fields&&"string"==typeof o.fields[t.key]?o.fields[t.key]:"",c=(()=>{let e=[];if(Array.isArray(n)){for(let t of n)if("string"==typeof t.runData){let n=parseInt(t.runId.replace(/^.*\-(\d+)$/g,"$1"),10),l=(0,a.u0)(t.runId);e.push({time:Number.isInteger(n)?n:null,string:t.runData,sessionId:l})}}return e})();return i?c.length?(0,l.jsx)(k.A,{sx:{display:"flex",flexDirection:"column",py:2,width:"100%",wordWrap:"break-word",overflowWrap:"anywhere",minHeight:250,maxHeight:360,overflowY:"auto"},children:c.map((e,t)=>{let{time:n,string:i,sessionId:r}=e;return(0,l.jsxs)(k.A,{sx:{display:"flex",mb:2,alignItems:"center"},children:[(0,l.jsx)(eH.A,{sx:{mr:2},color:"text.primary",fontSize:"small"}),(0,l.jsx)(ly,{time:n,sessionId:r,sx:{mr:2}}),(0,l.jsx)(S.A,{variant:"caption",sx:{whiteSpaceCollapse:"preserve",wordBreak:"break-word",whiteSpace:"pre-wrap"},children:er(i,d,s())})]},t)})}):(0,l.jsx)(iU,{}):(0,l.jsx)(k.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(tJ.A,{grey:!0,size:50,className:"zoom-in"})})},iK=e=>{let{runs:t=[],loaded:n=!1}=e,{i18n:i}=(0,m.B)(),r=(()=>{let e=[];if(Array.isArray(t))for(let n of t){let t=parseInt(n.runId.replace(/^.*\-(\d+)$/g,"$1"),10),l=(0,a.u0)(n.runId);Array.isArray(n.runData)&&e.push(...n.runData.map(e=>Number.isInteger(t)?{filePath:e,runTime:t,sessionId:l}:e))}return e})();return n?r.length?(0,l.jsx)(l4,{filePaths:r,sx:{minHeight:"250px",maxHeight:"360px",overflowY:"auto"},tooltip:i.t("Up to {{count}} files are shown per run",{count:j().max.sourceCode.ioOutputFileCount})}):(0,l.jsx)(iU,{}):(0,l.jsx)(k.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(tJ.A,{grey:!0,size:50,className:"zoom-in"})})},iG=e=>{var t;let{field:n,runs:i=[],loaded:r=!1}=e,s=(0,g.useMemo)(()=>(Array.isArray(i)?i:[]).map(e=>null==e?void 0:e.runId),[null==i||null==(t=i.map)?void 0:t.call(i,e=>null==e?void 0:e.runId).join(",")]);return r?s.length?(0,l.jsx)(l0,{fieldKey:n.key,fieldName:n.name,fieldColumns:n.columns,runIds:s}):(0,l.jsx)(iU,{}):(0,l.jsx)(k.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(tJ.A,{grey:!0,size:50,className:"zoom-in"})})};var iV=n(1676);let i$=e=>{let{active:t,payload:n,coordinate:i}=e;if(!t||!Array.isArray(n)||!n.length)return null;let{value:r,time:s,sessionId:a}=n[0].payload;return void 0===r||void 0===s?null:(0,l.jsx)(k.A,{sx:{position:"absolute",left:i.x,top:i.y-5,pointerEvents:"none"},children:(0,l.jsx)(R.A,{title:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",flexDirection:"column"},children:[null!==s?(0,l.jsx)(ly,{time:s,sessionId:a,inline:!0}):null,(0,l.jsx)(S.A,{variant:"caption",color:"inherit",sx:{fontWeight:"bold"},children:new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)})]}),arrow:!0,placement:"top",open:!0,children:(0,l.jsx)("div",{style:{width:"1px",height:"1px"}})})})},iJ=e=>{let{runs:t=[],loaded:n=!1}=e,i=(0,b.A)(),r={min:0,max:0},s=(Array.isArray(t)?t:[]).map(e=>{let t=parseInt(e.runId.replace(/^.*\-(\d+)$/g,"$1"),10);return r.min>e.runData&&(r.min=e.runData),r.max<e.runData&&(r.max=e.runData),{time:Number.isInteger(t)?t:null,value:e.runData,run:nd(1e3*t),sessionId:(0,a.u0)(e.runId)}});return n?s.filter(e=>null!==e.value).length?(0,l.jsx)(iP.u,{width:"100%",height:250,children:(0,l.jsxs)(iN.E,{data:s,width:"100%",innerRadius:10,barSize:5,margin:{top:10,left:0,right:0,bottom:0},children:[(0,l.jsx)(iR.m,{content:e=>{let{active:t,payload:n,coordinate:i}=e;return(0,l.jsx)(i$,{active:t,payload:n,coordinate:i})}}),(0,l.jsx)(iL.d,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,l.jsx)(iF.W,{dataKey:"run",tick:{fontSize:11}}),(0,l.jsx)(iO.h,{domain:[r.min,r.max],tick:{fontSize:11}}),(0,l.jsx)(iV.e,{y:0,stroke:i.palette.divider}),(0,l.jsx)(iB.y,{radius:10,dataKey:"value",fill:i.palette.text.primary})]})}):(0,l.jsx)(iU,{}):(0,l.jsx)(k.A,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(tJ.A,{grey:!0,size:50,className:"zoom-in"})})},iX=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",width:"250px",flex:"0 0 250px",paddingTop:t.spacing(2),paddingBottom:t.spacing(2),justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"}}),iZ=(0,w.Ay)(k.A)(()=>({display:"flex",width:"100%",wordWrap:"break-word",overflowWrap:"anywhere"})),iQ=e=>{var t;let{field:n,loaded:i=!1}=e,[r,s]=(0,g.useState)("table"===n.type);return(0,l.jsx)(iX,{children:(0,l.jsxs)(k.A,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"start",alignItems:"center",mb:2},children:[(0,l.jsx)(k.A,{sx:{width:"30px",height:"30px",mr:1},children:n.desc?(0,l.jsx)(eT.A,{size:"small",onClick:()=>(n.key,s(e=>!e)),children:r?(0,l.jsx)(nG.A,{fontSize:"small"}):(0,l.jsx)(ti.A,{fontSize:"small"})}):null}),(0,l.jsx)(S.A,{variant:"body2",children:null!=(t=n.name)?t:n.key})]}),"int"===n.type?(0,l.jsx)(iM,{field:n,loaded:i}):null,"string"===n.type?(0,l.jsx)(i_,{field:n,loaded:i}):null,"boolean"===n.type?(0,l.jsx)(iE,{field:n,loaded:i}):null,n.desc&&r?(0,l.jsx)(S.A,{variant:"caption",component:"pre",sx:{mt:2,pl:2,wordBreak:"break-all",whiteSpace:"preserve",fontFamily:"Yaldevi,sans-serif"},children:n.desc}):null]})})},i0=e=>{let{field:t,runs:n=[],loaded:i=!1}=e;return(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex",mb:3},children:[(0,l.jsx)(iQ,{field:t,loaded:i}),(0,l.jsxs)(iZ,{children:["int"===t.type?(0,l.jsx)(iJ,{runs:n,loaded:i}):null,"string"===t.type?(0,l.jsx)(iY,{field:t,runs:n,loaded:i}):null,"boolean"===t.type?(0,l.jsx)(iq,{runs:n,loaded:i}):null,"files"===t.type?(0,l.jsx)(iK,{runs:n,loaded:i}):null,"table"===t.type?(0,l.jsx)(iG,{field:t,runs:n,loaded:i}):null]})]})},i1=(0,w.Ay)(k.A)(()=>({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",zIndex:0})),i2=e=>{var t,n,i,r;let{agents:s}=e,{getAgentId:o,onAgentId:d,getSource:c,onSource:u,onMachineStatus:p,onFilters:h,getFilters:f,onOutputs:y}=(0,x.P)(),{i18n:A}=(0,m.B)(),j=(0,g.useRef)([]),v=(0,g.useRef)({}),w=(0,g.useRef)([]),[b,S]=(0,g.useState)((0,a.fD)(s,o())),[C,I]=(0,g.useState)(!1),[T,z]=(0,g.useState)(null),[D,E]=(0,g.useState)([]),[_,M]=(0,g.useState)(null),[P,N]=(0,g.useState)(null),[R,L]=(0,g.useState)(!0),[O,F]=(0,g.useState)({});(0,g.useEffect)(()=>{S((0,a.fD)(s,o()));let e=d(e=>{L(!1),S((0,a.fD)(s,e))});return()=>e()},[s]),(0,g.useEffect)(()=>{j.current=[],v.current={},w.current=[],"string"==typeof(null==b?void 0:b.id)&&(async()=>{var e,t;w.current=null!=(t=null==(e=await c(b.id,!0))?void 0:e.srcOutputs)?t:[],E(w.current)})();let e=u(e=>{let{agentId:t,sourceCode:n}=e;if(t===(null==b?void 0:b.id)){var l,i;JSON.stringify(w.current)!==JSON.stringify(null!=(l=null==n?void 0:n.srcOutputs)?l:[])&&(w.current=null!=(i=null==n?void 0:n.srcOutputs)?i:[],E(w.current))}});return()=>e()},[b]),(0,g.useEffect)(()=>{let e=h(e=>{let{agentId:t,filters:n}=e;t===(null==b?void 0:b.id)&&W(n)});U();let t=p(e=>{let{agentId:t,status:n}=e;t===(null==b?void 0:b.id)&&1!==n&&(null===P||P>Math.floor(new Date().getTime()/1e3))&&U(!1)}),n=y(e=>{e===o()&&(null===P||P>Math.floor(new Date().getTime()/1e3))&&U(!1)});return()=>{e(),t(),n()}},[b,_,P]);let B=async e=>{var t;await (null==(t=window.sdk)?void 0:t.ipc.diskStorage.runDelete(o(),e)),await U()},W=async e=>{var t,n,l,i;j.current=[];let r=await c(o(),!0),s=null!=(i=null==r?void 0:r.srcOutputs)?i:[],a="object"==typeof(null==(t=v.current)?void 0:t.fields)&&null!==(null==(n=v.current)?void 0:n.fields)?null==(l=v.current)?void 0:l.fields:{};if("object"==typeof(null==e?void 0:e.fields)&&null!==(null==e?void 0:e.fields))for(let t of s){if(void 0===e.fields[t.key]||!Array.isArray(a[t.key]))continue;let n=e.fields[t.key];a[t.key].map(e=>{let l=!0;do{if(void 0===e.runData)break;if("int"===t.type&&(Number.isInteger(n.min)&&e.runData<n.min||Number.isInteger(n.max)&&e.runData>n.max)||"string"===t.type&&-1==="".concat(e.runData).toLowerCase().indexOf(n)||"boolean"===t.type&&!!e.runData!==n){l=!1;break}}while(!1);l||j.current.push(e.runId)})}if(Array.isArray(null==e?void 0:e.runs))for(let t of e.runs)"string"==typeof t&&j.current.push(t);j.current=[...new Set(j.current)];let d={};for(let e of s)d[e.key]=(Array.isArray(a[e.key])?a[e.key]:[]).filter(e=>!j.current.includes(e.runId));F(d)},U=async function(){var e,t;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if("string"!=typeof o())return;let l=await c(o(),!0);(null!=(t=null==l?void 0:l.srcOutputs)?t:[]).length&&(n&&L(!1),v.current=await (null==(e=window.sdk)?void 0:e.ipc.diskStorage.outputsQuery(o(),null==b?void 0:b.installedModuleId,_,P)),await W(f(o())),n?L(!0):z(new Date().getTime()))},H=Array.isArray(null==(t=v.current)?void 0:t.runIds)?null==(n=v.current)?void 0:n.runIds:[],q=null!=(r=null==(i=v.current)?void 0:i.runIdsTotal)?r:0,Y=H.length>0,K=j.current,G=f(o()).runs;return(0,l.jsx)(i1,{children:(0,l.jsx)(k.A,{sx:{height:"100%",width:"100%"},children:Array.isArray(D)&&D.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(iD,{startTime:_,endTime:P,setStartTime:M,setEndTime:N,loaded:R,runsFiltered:K,runsTotal:q,runsLoaded:H.length,runsToggle:()=>I(e=>!e),showFilters:Y}),Y?(0,l.jsx)(iA,{runsAll:H,runsFiltered:K,runsExcluded:G,open:C,loaded:R,onClose:()=>I(!1),onDelete:B}):null,(0,l.jsx)(k.A,{sx:{height:"calc(100% - 50px)",width:"100%",display:"flex",flexDirection:"column",overflowX:"hidden",p:3},children:Y?D.map(e=>(0,l.jsx)(i0,{field:e,loaded:R,runs:Array.isArray(O[e.key])?O[e.key]:[]},"".concat(e.id,"-").concat(e.type))):R?(0,l.jsx)(l6.default,{title:A.t("No data"),message:A.t("No runs were executed in the specified interval"),sx:{"&.content-center":{minHeight:"100%",overflow:"hidden"}}}):(0,l.jsx)(k.A,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,l.jsx)(tJ.A,{grey:!0,size:128,className:"zoom-in"})})})]}):R?(0,l.jsx)(l6.default,{title:A.t("No outputs"),message:A.t("This module has no results to capture and analyze"),sx:{"&.content-center":{minHeight:"100%"}}}):null})},T)},i5=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{background:t.palette.background.paper,position:"relative",overflowY:"auto",height:"100%",width:"100%",zIndex:0}});function i3(e){let{agents:t,agentsReady:n}=e,{getAgentTab:i,onAgentTab:r}=(0,x.P)(),[s,a]=(0,g.useState)("");return(0,g.useEffect)(()=>{a(i());let e=r(e=>a(e));return()=>e()},[t]),s.length?n?(0,l.jsxs)(i5,{children:["settings"===s?(0,l.jsx)(ih,{agents:t}):null,"results"===s?(0,l.jsx)(i2,{agents:t}):null]}):null:(0,l.jsx)(ll,{agents:t,agentsReady:n})}var i4=n(97578);let i6=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{width:"100%",height:"50px",position:"relative",display:"flex",alignItems:"center",justifyContent:"start",paddingLeft:t.spacing(4),paddingRight:t.spacing(4),borderRadius:0,textTransform:"none",textAlign:"left"}}),i9=(0,w.Ay)(S.A)(e=>{let{theme:t}=e;return{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"}}),i7=()=>{var e;let{isLlmReady:t,onLlmStatus:n,onUpdaterInfo:i,getUpdaterInfo:r,onUpdaterStatus:s,getUpdaterStatus:a}=(0,x.P)(),{i18n:d}=(0,m.B)(),[c,u]=(0,g.useState)(!1),[p,h]=(0,g.useState)(null),[f,y]=(0,g.useState)(null),[A,j]=(0,g.useState)(!1),[v,w]=(0,g.useState)(!1);(0,g.useEffect)(()=>{u(t());let e=n(()=>u(t()));y(r());let l=i(e=>{let{info:t}=e;return y(t)});h(a());let o=s(e=>{let{status:t}=e;return h(t)});return(async()=>{var e;return w("linux"===await (null==(e=window.sdk)?void 0:e.ipc.device.getOS()))})(),()=>{e(),l(),o()}},[]),(0,g.useEffect)(()=>{var e;c&&(null==(e=window.sdk)||e.ipc.updater.check())},[c]),(0,g.useEffect)(()=>{!(null==p?void 0:p.working)&&(null==p?void 0:p.error)&&o.o.error("".concat(d.t("Update cancelled.")," ").concat(p.error),{duration:5e3})},[p]);let b=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),j(!0)},I=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.updater.install()),j(!1)};return(0,l.jsxs)(l.Fragment,{children:[c&&(null==f?void 0:f.version)?(0,l.jsxs)(i6,{children:[!(null==f?void 0:f.filePath)||(null==p?void 0:p.working)?(0,l.jsx)(k.A,{sx:{mr:4},children:(null==p?void 0:p.working)?(0,l.jsx)(nU.A,{className:"rotate-360"}):(0,l.jsx)(tS.A,{color:"primary"})}):null,(0,l.jsx)(k.A,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"start"},children:!(null==f?void 0:f.filePath)||(null==p?void 0:p.working)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i9,{variant:"caption",color:"inherit",children:(null==p?void 0:p.working)?d.t("Updating to v.{{version}}...",{version:f.version}):d.t("Downloading v.{{version}}...",{version:f.version})}),(0,l.jsx)(nY.A,{color:"primary",sx:{mt:1},variant:(null==p?void 0:p.working)?"indeterminate":"determinate",value:(null==p?void 0:p.working)?null:null!=(e=null==f?void 0:f.progress)?e:0})]}):(0,l.jsx)(R.A,{title:d.t("Update to version {{version}}",{version:f.version}),placement:"top",children:(0,l.jsx)(C.A,{fullWidth:!0,size:"small",variant:"outlined",startIcon:(0,l.jsx)(tS.A,{}),onClick:()=>b(),children:d.t("Update")})})})]}):null,c&&(null==f?void 0:f.version)&&A?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>!(null==p?void 0:p.working)&&j(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:1}},children:[(0,l.jsx)(eP.A,{children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(S.A,{variant:"h3",sx:{ml:4},children:(null==p?void 0:p.working)?d.t("Updating to v.{{version}}...",{version:f.version}):d.t("Install update")})})}),(0,l.jsx)(eM.A,{children:(null==p?void 0:p.working)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eC.A,{severity:"warning",sx:{mb:4},children:d.t("Please do not close this window until the update is complete.")}),(0,l.jsx)(V.A,{sx:{mb:-4}})]}):(0,l.jsx)(eC.A,{severity:"info",icon:(0,l.jsx)(i4.A,{}),children:v?d.t("Updating to version {{version}} requires root privileges. Please enter your root password in the next dialog.",{version:f.version}):d.t("Update to version {{version}} and restart the application.",{version:f.version})})}),(null==p?void 0:p.working)?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",variant:"text",onClick:()=>j(!1),children:d.t("Cancel")}),(0,l.jsx)(C.A,{size:"small",className:"pop",startIcon:(0,l.jsx)(tS.A,{}),color:"primary",onClick:()=>I(),variant:"contained",children:d.t("Update and restart")})]})]}):null]})};var i8=n(54989);let re=e=>{let{isOpen:t=!1,isFirst:n=!1,onOpen:i=()=>{},onClose:r=()=>{},onAgentCreate:s=()=>{}}=e,{i18n:a}=(0,m.B)(),o=(0,g.useRef)(null),[d,c]=(0,g.useState)(!1),[u,p]=(0,g.useState)(n),[x,h]=(0,g.useState)(!1),f={name:eJ.Yj().required(a.t("Agent name is required")).min(3,()=>a.t("Must be at least {{n}} characters long",{n:3})).max(64,()=>a.t("Must be at most {{n}} characters long",{n:64}))},{reset:y,control:A,handleSubmit:j,formState:{errors:v}}=(0,eV.mN)({defaultValues:{name:""},mode:"onChange",resolver:(0,e$.t)(eJ.Ik().shape(f))}),w=async e=>{let{name:t}=e;h(!0),await s(t),h(!1),r()};(0,g.useEffect)(()=>{t&&"function"==typeof i&&i()},[t]);let b=()=>{t&&"function"==typeof r&&r(),y()},I=()=>{o.current&&o.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return t?(0,l.jsxs)(eL.A,{open:!0,onClose:x?()=>{}:b,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[x?null:(0,l.jsxs)(eP.A,{children:[n?a.t("Add your first agent"):a.t("Add agent"),(0,l.jsx)(eT.A,{"aria-label":a.t("More information"),sx:{ml:2},color:"default",onClick:()=>p(!u),size:"large",children:u?(0,l.jsx)(nG.A,{}):(0,l.jsx)(ti.A,{})})]}),(0,l.jsxs)(eM.A,{children:[!x&&u?(0,l.jsx)(eC.A,{severity:"success",sx:{mb:6},icon:(0,l.jsx)(i8.A,{className:"zoom-in"}),children:(0,l.jsx)(S.A,{color:"inherit",variant:"body2",children:a.t("Agents are browser instances that use a bit of AI magic to automate repetitive web tasks that are just too boring for humans.")})}):null,(0,l.jsx)("form",{onSubmit:j(w),ref:o,children:x?(0,l.jsx)(k.A,{sx:{mt:6},children:(0,l.jsx)(V.A,{})}):(0,l.jsxs)(eZ.A,{fullWidth:!0,sx:{my:3},error:!!v.name,children:[(0,l.jsx)(eV.xI,{name:"name",control:A,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eS.A,{disabled:x,autoFocus:!0,required:!0,value:t,onChange:e=>{c(e.target.value.length>=3),n(e)},onKeyDown:e=>"Enter"===e.key&&I(),spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:0},children:(0,l.jsx)(nr.A,{})})},label:a.t("Agent name"),placeholder:a.t("Agent name"),error:!!v.name})}}),v.name&&(0,l.jsx)(eX.A,{sx:{color:"error.main"},children:v.name.message})]})})]}),x?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:b,children:a.t("Cancel")}),d?(0,l.jsx)(C.A,{variant:"contained",className:"pop",onClick:I,endIcon:(0,l.jsx)(ns.A,{}),children:a.t("Next")}):null]})]}):null},rt=e=>{var t;let{agents:n,isOpen:i=!1,onOpen:r=()=>{},onClose:s=()=>{},onAgentUpdate:o=()=>{}}=e,{i18n:d}=(0,m.B)(),{getAgentId:c,onAgentId:u}=(0,x.P)(),p=(0,g.useRef)(null),[h,f]=(0,g.useState)(!1),[y,A]=(0,g.useState)(!1),[j,w]=(0,g.useState)(!1),[b,I]=(0,g.useState)(!1),[T,z]=(0,g.useState)((0,a.fD)(n,c())),D={name:eJ.Yj().required(d.t("Agent name is required")).min(3,()=>d.t("Must be at least {{n}} characters long",{n:3})).max(64,()=>d.t("Must be at most {{n}} characters long",{n:64}))},E={name:null!=(t=null==T?void 0:T.name)?t:""},{reset:_,control:M,handleSubmit:P,formState:{errors:N}}=(0,eV.mN)({defaultValues:E,mode:"onChange",resolver:(0,e$.t)(eJ.Ik().shape(D))}),R=async e=>{let{name:t}=e;I(!0);try{var n;await (null==(n=window.sdk)?void 0:n.ipc.main.setOnTop());let e=await v.A.put("agents/".concat(T.id),{name:t});await o(e.data)}catch(e){}I(!1),s()};(0,g.useEffect)(()=>{z((0,a.fD)(n,c()));let e=u(e=>z((0,a.fD)(n,e)));return()=>e()},[n]),(0,g.useEffect)(()=>{i&&"function"==typeof r&&r()},[i]);let L=()=>{i&&"function"==typeof s&&s(),_()},O=()=>{p.current&&p.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return i?(0,l.jsxs)(eL.A,{open:!0,onClose:b?()=>{}:L,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[b?null:(0,l.jsx)(eP.A,{children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(na,{agent:T,title:d.t("Rename agent")}),(0,l.jsx)(eT.A,{"aria-label":d.t("More information"),sx:{ml:2},color:"default",onClick:()=>A(!y),size:"large",children:y?(0,l.jsx)(nG.A,{}):(0,l.jsx)(ti.A,{})})]})}),(0,l.jsxs)(eM.A,{children:[!b&&y?(0,l.jsx)(eC.A,{severity:"success",sx:{mb:6},icon:(0,l.jsx)(eH.A,{}),children:(0,l.jsx)(S.A,{color:"inherit",variant:"body2",children:d.t("Keep agent names short and meaningful.")})}):null,(0,l.jsx)("form",{onSubmit:P(R),ref:p,children:b?(0,l.jsx)(k.A,{sx:{mt:6},children:(0,l.jsx)(V.A,{})}):(0,l.jsxs)(eZ.A,{fullWidth:!0,sx:{my:3},error:!!N.name,children:[(0,l.jsx)(eV.xI,{name:"name",control:M,render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eS.A,{disabled:b,autoFocus:!0,required:!0,value:t,onChange:e=>{f(e.target.value.length>=3),w(e.target.value!==T.name),n(e)},onKeyDown:e=>"Enter"===e.key&&O(),spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:0},children:(0,l.jsx)(nr.A,{})})},label:d.t("Agent name"),placeholder:d.t("Agent name"),error:!!N.name})}}),N.name&&(0,l.jsx)(eX.A,{sx:{color:"error.main"},children:N.name.message})]})})]}),b?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:L,children:d.t("Cancel")}),h&&j?(0,l.jsx)(C.A,{variant:"contained",onClick:O,startIcon:(0,l.jsx)(eQ.A,{}),children:d.t("Save")}):null]})]}):null},rn=e=>{let{agents:t,isOpen:n=!1,onOpen:i=()=>{},onClose:r=()=>{},onAgentDelete:s=()=>{}}=e,{i18n:o}=(0,m.B)(),{getAgentId:d,onAgentId:c}=(0,x.P)(),[u,p]=(0,g.useState)(!1),[h,f]=(0,g.useState)(!1),[y,A]=(0,g.useState)((0,a.fD)(t,d()));(0,g.useEffect)(()=>{n&&"function"==typeof i&&i()},[n]);let j=()=>{n&&"function"==typeof r&&r()};(0,g.useEffect)(()=>{A((0,a.fD)(t,d()));let e=c(e=>A((0,a.fD)(t,e)));return()=>e()},[t]);let v=e=>{p((null==y?void 0:y.name)===e.target.value)},w=async()=>{if(u){f(!0),p(!1);try{await s(null==y?void 0:y.id)}catch(e){}f(!1),await j()}};return n?(0,l.jsxs)(eL.A,{open:!0,onClose:h?()=>{}:j,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{children:(0,l.jsx)(na,{agent:y,title:o.t("Delete agent")})}),(0,l.jsx)(eM.A,{children:h?(0,l.jsx)(V.A,{}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(eC.A,{severity:"warning",sx:{mb:6},children:[o.t("Are you sure you want to delete this agent?")," ",o.t("This action is irreversible!"),(0,l.jsx)("br",{}),o.t('To confirm deleting your agent, please type "{{name}}" below:',{name:null==y?void 0:y.name})]}),(0,l.jsx)(eS.A,{autoFocus:!0,fullWidth:!0,spellCheck:!1,autoComplete:"off",required:!0,inputProps:{tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{mr:0},children:(0,l.jsx)(nr.A,{})})},type:"text",color:u?"primary":"error",label:o.t("Agent name"),placeholder:o.t("Agent name"),onChange:v,onKeyUp:v,onKeyDown:e=>"Enter"===e.key&&w()})]})}),h?null:(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:j,children:o.t("Cancel")}),(0,l.jsx)(C.A,{color:"error",onClick:w,disabled:!u,startIcon:(0,l.jsx)(eF.A,{}),children:o.t("Delete agent")})]})]}):null};var rl=n(16084),ri=n(77648),rr=n(32136),rs=n(7827),ra=n(51018);function ro(){let e=(0,t_._)(["0% { opacity: 0 } 100% { opacity: 1 }"]);return ro=function(){return e},e}function rd(){let e=(0,t_._)(["0% { opacity: 0; transform: scale(1.5); } 100% { opacity: 1; transform: scale(1); }"]);return rd=function(){return e},e}let rc=(0,tM.i7)(ro()),ru=(0,tM.i7)(rd()),rp=(0,w.Ay)(k.A)(e=>{let{theme:t,color:n}=e;return{display:"flex",position:"absolute",justifyContent:"flex-end",alignItems:"end",top:0,left:0,width:"100%",height:200,zIndex:0,"&:before":{content:'""',display:"block",position:"absolute",background:n,width:"100%",height:"100%",opacity:0,animation:null!==n?"".concat(rc," 1250ms forwards linear"):"none"},"&:after":{content:'""',display:"block",position:"absolute",width:"100%",height:"100%",opacity:0,transform:"scale(1.5)",animation:null!==n?"".concat(ru," 250ms forwards linear"):"none",background:"url(/img/pages/circles-profile-".concat(t.palette.mode,".svg)"),backgroundSize:"auto",backgroundRepeat:"no-repeat",[t.breakpoints.up("xs")]:{backgroundPosition:"50% -600px",transformOrigin:"50% 100%"},[t.breakpoints.up("md")]:{backgroundPosition:"-680px -600px",transformOrigin:"100px 100%"}}}}),rx=e=>{var t,n;let{isOpen:i=!1,onOpen:r=()=>{},onClose:s=()=>{}}=e,{settings:a}=(0,nQ.t)(),{i18n:o}=(0,m.B)(),d=(0,h.A)(),c=(0,rl.G)(),u=(0,b.A)(),p=c.getUserData(),[x,f]=(0,g.useState)(null),[y,A]=(0,g.useState)(!0),[j,w]=(0,g.useState)(!1),[I,T]=(0,g.useState)(null),[z,D]=(0,g.useState)(!1);(0,g.useEffect)(()=>{i&&"function"==typeof r&&r()},[i]);let E=()=>{i&&"function"==typeof s&&s()},{control:_,setValue:M,handleSubmit:P,formState:{errors:N}}=(0,eV.mN)({defaultValues:{userName:null!=(t=null==p?void 0:p.userName)?t:o.t("User name")},mode:"onChange",resolver:(0,e$.t)(eJ.Ik().shape({userName:eJ.Yj().min(3,()=>o.t("Must be at least {{n}} characters long",{n:3})).max(64,()=>o.t("Must be at most {{n}} characters long",{n:64})).required()}))});(0,g.useEffect)(()=>{M("userName",null==p?void 0:p.userName),T(null);let e=setTimeout(async()=>{"string"==typeof u.palette.customColors.userColors.gradient[null==p?void 0:p.userColor]&&T(u.palette.customColors.userColors.gradient[null==p?void 0:p.userColor])},150);return()=>clearTimeout(e)},[a.mode,null==p?void 0:p.userColor,null==p?void 0:p.userName]);let L=e=>{"string"==typeof(null==e?void 0:e.userName)&&(M("userName",e.userName),d.setUser({...d.user,userName:e.userName,userColor:e.userColor,userAvatarId:e.userAvatarId}))},O=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),D(!0)},F=async()=>{E(),d.logout()},B=async e=>{if(y){A(!1);try{var t;let n=await v.A.post("account",e);L(null!=(t=null==n?void 0:n.data)?t:{})}catch(e){}A(!0),w(!1)}},W=async e=>{if(y){A(!1);try{var t;let n=await v.A.post("account",{userColor:e});L(null!=(t=null==n?void 0:n.data)?t:{})}catch(e){}A(!0)}};return i?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eL.A,{open:!0,onClose:E,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:750,p:0}},children:(0,l.jsx)(es.Ay,{container:!0,spacing:6,children:(0,l.jsx)(es.Ay,{item:!0,xs:12,children:(0,l.jsxs)(ec.A,{sx:{position:"relative"},children:[(0,l.jsx)(rp,{color:I}),(0,l.jsx)(ri.A,{sx:{zIndex:10,position:"relative"},action:(0,l.jsxs)(k.A,{sx:{display:"flex"},children:[j&&y?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(R.A,{title:o.t("Profile color"),children:(0,l.jsx)(eT.A,{sx:{zIndex:10,background:"light"===u.palette.mode?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)","&:hover":{background:u.palette.background.paper}},onClick:e=>f(e.currentTarget),children:(0,l.jsx)(rs.A,{color:"info"})})}),(0,l.jsx)(eO.A,{keepMounted:!0,anchorEl:x,open:!!x,onClose:()=>f(null),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{ml:"2px",mt:2},PaperProps:{style:{minWidth:20}},children:Object.keys(u.palette.customColors.userColors.solid).map(e=>(0,l.jsx)(eN.A,{selected:(null==p?void 0:p.userColor)==e,onClick:()=>{f(null),W(e)},children:(0,l.jsx)(k.A,{sx:{width:15,height:15,borderRadius:"50%",background:u.palette.customColors.userColors.solid[e]}})},"user-color-".concat(e)))})]}):null,(0,l.jsx)(R.A,{title:j?o.t("Exit edit mode"):o.t("Edit profile"),children:(0,l.jsx)(eT.A,{sx:{ml:2,background:"light"===u.palette.mode?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)","&:hover":{background:u.palette.background.paper}},variant:"contained",color:"inherit",onClick:()=>{if(!j)return void w(!0);M("userName",p.userName),w(!1)},children:j?(0,l.jsx)(rr.A,{}):(0,l.jsx)(eB.A,{})})})]})}),(0,l.jsxs)(ed.A,{sx:{zIndex:10},children:[(0,l.jsx)("form",{onSubmit:P(B),autoComplete:"off",children:(0,l.jsx)(es.Ay,{container:!0,spacing:7,sx:{justifyContent:"left"},children:(0,l.jsx)(es.Ay,{item:!0,xs:12,sx:{my:4,display:"flex"},children:(0,l.jsxs)(k.A,{sx:{display:"flex",width:"100%",alignItems:{xs:"center",md:"flex-end"},flexDirection:{xs:"column",md:"row"}},children:[(0,l.jsx)(e5,{crop:"fill",borderColor:u.palette.background.paper,backgroundColor:u.palette.background.paper,inputName:"avatar",uploadPath:"account/avatar",active:j,label:o.t("Select avatar"),radius:"50%",onChange:async()=>{var e;let t=await v.A.get("account");"string"==typeof(null==(e=t.data)?void 0:e.id)&&d.setUser(t.data)},alt:null!=(n=null==p?void 0:p.userName)?n:o.t("User name"),getSrc:()=>{var e;let t=new Date().toJSON().slice(0,10),n="".concat(eo.A.s3Url,"/users/").concat(null==p?void 0:p.id,"/?cb=").concat(t);return(null==(e=d.user)?void 0:e.id)==(null==p?void 0:p.id)&&(n="string"==typeof(null==p?void 0:p.userAvatarId)?"".concat(eo.A.s3Url,"/users/").concat(p.id,"/").concat(p.userAvatarId,".png"):"/img/placeholder/user.png"),n}}),(0,l.jsx)(k.A,{sx:{ml:{xs:0,md:6},width:"100%",position:"relative"},children:j?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.A,{sx:{width:"100%",display:"flex"},children:[(0,l.jsx)(eV.xI,{name:"userName",control:_,fullWidth:!0,rules:{required:!0},render:e=>{let{field:{value:t,onChange:n}}=e;return(0,l.jsx)(eS.A,{sx:{textAlign:"center"},fullWidth:!0,required:!0,spellCheck:!1,autoComplete:"off",autoFocus:!0,disabled:!y,value:t,label:o.t("User name"),onChange:n,placeholder:"John Doe"})}}),(0,l.jsx)(C.A,{variant:"contained",startIcon:(0,l.jsx)(eQ.A,{}),sx:{ml:3},type:"submit",disabled:!y,children:o.t("Save")})]}),N.userName&&(0,l.jsx)(eX.A,{sx:{color:"error.main",position:"absolute",bottom:-25},children:N.userName.message})]}):(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(R.A,{title:(null==p?void 0:p.createdAt)?"".concat(o.t("Member since")," ").concat(no(p.createdAt,a.lang,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})):null,children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"start",flexDirection:"column"},children:[(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(S.A,{variant:"h6",children:p.userName})}),(0,l.jsx)(S.A,{variant:"caption",children:null==p?void 0:p.userEmail})]})})})})]})})})}),(0,l.jsxs)(k.A,{sx:{display:"flex",justifyContent:"end",width:"100%",mt:2},children:[(0,l.jsx)(C.A,{startIcon:(0,l.jsx)(ra.A,{}),onClick:O,color:"error",sx:{mr:2},children:o.t("Log out")}),(0,l.jsx)(C.A,{color:"secondary",onClick:E,children:o.t("Close")})]})]})]})})})}),z?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>D(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{children:o.t("Log out")}),(0,l.jsx)(eM.A,{children:(0,l.jsxs)(eC.A,{severity:"warning",children:[o.t("Are you sure you want to log out of this computer?"),(0,l.jsx)("br",{}),o.t("You can reconnect this computer to your account at any time.")]})}),(0,l.jsxs)(e_.A,{children:[(0,l.jsx)(C.A,{color:"secondary",onClick:()=>D(!1),children:o.t("Cancel")}),(0,l.jsx)(C.A,{variant:"text",color:"error",onClick:()=>F(),startIcon:(0,l.jsx)(ra.A,{}),children:o.t("Log out")})]})]}):null]}):null},rh=e=>{let{isOpen:t=!1,onOpen:n=()=>{},onClose:i=()=>{}}=e,{i18n:r}=(0,m.B)();(0,g.useEffect)(()=>{t&&"function"==typeof n&&n()},[t]);let s=()=>{t&&"function"==typeof i&&i()};return t?(0,l.jsxs)(eL.A,{open:!0,onClose:s,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(eP.A,{children:r.t("Window restored")}),(0,l.jsx)(eM.A,{children:(0,l.jsx)(eC.A,{children:r.t("This window must remain visible for the application to function correctly.")})}),(0,l.jsx)(e_.A,{children:(0,l.jsx)(C.A,{color:"secondary",onClick:s,children:r.t("OK")})})]}):null},rm=e=>{let{isOpen:t=!1,onOpen:n=()=>{}}=e;return(0,g.useEffect)(()=>{t&&"function"==typeof n&&n()},[t]),t?(0,l.jsx)(eL.A,{open:!0,sx:{"& .MuiPaper-root":{background:"transparent",boxShadow:"none"}},children:(0,l.jsx)(eM.A,{children:(0,l.jsx)(k.A,{sx:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",opacity:.9},children:(0,l.jsx)(tJ.A,{size:192,animate:!0,grey:!0,dark:!1,className:"rotate"})})})}):null},rg=e=>{let{agents:t,onAgentCreate:n,onAgentUpdate:i,onAgentDelete:r}=e,{getAgentId:s,setPageTitle:o,setPageSubtitle:d,getDialogVisible:c,setDialogVisible:u,onDialogVisible:p}=(0,x.P)(),{i18n:h}=(0,m.B)(),[f,y]=(0,g.useState)(!1),[A,v]=(0,g.useState)(!1),[w,b]=(0,g.useState)(!1),[k,S]=(0,g.useState)(!1),[C,I]=(0,g.useState)(!1),[T,z]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{y(c("agentCreate")),v(c("agentUpdate")),b(c("agentDelete")),S(c("restored")),I(c("loading")),z(c("profile"));let e=p(e=>{let{dialog:t,visible:n}=e;switch(t){case"agentCreate":y(n);break;case"agentUpdate":v(n);break;case"agentDelete":b(n);break;case"restored":S(n);break;case"loading":I(n);break;case"profile":z(n);break;case"repo":d(n?h.t("Agent module"):null)}});return()=>{e()}},[]),(0,g.useEffect)(()=>{let e=null;return C&&(e=window.setTimeout(()=>u("loading",!1),7500)),()=>null!==e&&window.clearTimeout(e)},[C]),(0,g.useEffect)(()=>{var e;let n=(0,a.fD)(t,s());o(T?h.t("User Profile"):(null==n?void 0:n.name)?"".concat(null!=(e=null==n?void 0:n.name)?e:""):null)},[T]),(0,l.jsxs)(l.Fragment,{children:[C?(0,l.jsx)(rm,{isOpen:!0}):null,f&&t.length<j().max.agentsCount?(0,l.jsx)(re,{isOpen:!0,isFirst:0===t.length,onAgentCreate:n,onClose:()=>u("agentCreate",!1)}):null,A?(0,l.jsx)(rt,{isOpen:!0,agents:t,onAgentUpdate:i,onClose:()=>u("agentUpdate",!1)}):null,w?(0,l.jsx)(rn,{isOpen:!0,agents:t,onAgentDelete:r,onClose:()=>u("agentDelete",!1)}):null,T?(0,l.jsx)(rx,{isOpen:!0,onClose:()=>u("profile",!1)}):null,k?(0,l.jsx)(rh,{isOpen:!0,onClose:()=>u("restored",!1),onOpen:(0,nw.A)("notification")}):null]})};rg.guestGuard=!0;var rf=n(23229),ry=n(85143),rA=n(13082),rj=n(65122),rv=n(15483),rw=n(26423),rb=n(1477);let rk=()=>{let{getLlmStatus:e,onLlmStatus:t,isLlmReady:n,onLlmInfo:i,showLlmInfo:r}=(0,x.P)(),{i18n:s}=(0,m.B)(),a=(0,g.useRef)(!1),[d,c]=(0,g.useState)(!1),[u,p]=(0,g.useState)(!1),[h,f]=(0,g.useState)({});(0,g.useEffect)(()=>{f(e());let n=t(e=>{let{status:t}=e;f(t),!a.current&&"".concat(null==t?void 0:t.code).match(/^(?:download|unpack)/gi)&&(a.current=!0),a.current&&"finish"===(null==t?void 0:t.code)&&r(!0)}),l=i(e=>{let{show:t}=e;if(c(t),t){var n;null==(n=window.sdk)||n.ipc.main.setOnTop()}});return()=>{n(),l()}},[]),(0,g.useEffect)(()=>{let e=null;return n()&&(e=window.setTimeout(async()=>{d&&(ei(".MuiDialog-root"),o.o.success(s.t("Large language model installed successfully!"),{duration:5e3})),e=null},250)),()=>{null!==e&&(window.clearTimeout(e),e=null)}},[h,d]);let y=async function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null==(e=window.sdk)||e.ipc.llm.install(t)},A=[{code:"download:ollama",Icon:rw.A,title:s.t("Downloading Ollama")},{code:"unpack:ollama",Icon:rw.A,title:s.t("Unpacking Ollama")},{code:"download:models",Icon:rb.A,title:s.t("Downloading large language model")},{code:"unpack:models",Icon:rb.A,title:s.t("Unpacking large language model")},{code:"serve",Icon:tf.A,title:s.t("Launching server")},{code:"finish",Icon:ry.A,title:h.success?s.t("LLM server running"):s.t("LLM server failed to start")}],j=A.reduce((e,t)=>t.code===h.code?t:e,null),v=A.findIndex(e=>e.code===h.code);return(0,l.jsxs)(l.Fragment,{children:[null===j||n()?null:(0,l.jsx)(R.A,{title:h.success?j.title:s.t("Error installing LLM"),placement:"top",children:(0,l.jsxs)(C.A,{onClick:()=>r(!0),sx:{width:"100%",height:"50px",position:"relative",display:"flex",alignItems:"center",justifyContent:"start",px:4,borderRadius:0,textTransform:"none",textAlign:"left"},children:[(0,l.jsx)(k.A,{sx:{mr:4},children:(0,l.jsx)(j.Icon,{fontSize:"small",color:h.success?"primary":"warning"})}),(0,l.jsxs)(k.A,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"start"},children:[(0,l.jsx)(S.A,{variant:"caption",color:h.success?"inherit":"error",sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"},children:h.success?j.title:s.t("Error installing LLM")}),Number.isInteger(h.progressBar)||h.progressBar?(0,l.jsx)(nY.A,{color:h.success?"primary":"warning",sx:{mt:1},variant:Number.isInteger(h.progressBar)?"determinate":"indeterminate",value:Number.isInteger(h.progressBar)?h.progressBar:null}):null]})]})}),d?(0,l.jsxs)(eL.A,{open:!0,onClose:()=>c(!1),sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:1}},children:[(0,l.jsx)(eP.A,{children:(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(S.A,{variant:"h3",sx:{ml:4},children:s.t("Large language model setup")}),(0,l.jsx)(eT.A,{"aria-label":s.t("More information"),sx:{ml:2},color:"default",onClick:()=>p(!u),size:"large",children:u?(0,l.jsx)(nG.A,{}):(0,l.jsx)(ti.A,{})})]})}),(0,l.jsxs)(eM.A,{children:[u?(0,l.jsx)(eC.A,{severity:"info",sx:{mb:2},children:(0,l.jsxs)(S.A,{color:"inherit",variant:"body2",children:[s.t("To ensure complete privacy of your data, this application uses a large language model that runs locally on your machine."),(0,l.jsx)("br",{}),s.t("Downloading and extracting the LLM typically takes less than 10 minutes, depending on your internet connection speed and system performance.")]})}):null,A.map((e,t)=>(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center",my:2,opacity:t<=v?1:.4,userSelect:t<=v?"auto":"none"},children:[(0,l.jsx)(k.A,{sx:{height:"100%",display:"flex",alignItems:"center"},children:v>=0&&t<=v?t===v?h.success?n()?(0,l.jsx)(rf.A,{color:"primary"}):(0,l.jsx)(rA.A,{color:"primary",className:"rotate-360"}):(0,l.jsx)(rj.A,{color:"warning"}):(0,l.jsx)(t7.A,{}):(0,l.jsx)(nt.A,{})}),(0,l.jsxs)(k.A,{sx:{width:"100%",height:40,display:"flex",alignItems:"start",justifyContent:"center",flexDirection:"column"},children:[(0,l.jsxs)(k.A,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(e.Icon,{sx:{mx:3},color:t===v?h.success?"primary":"warning":"inherit"}),(0,l.jsx)(S.A,{color:t===v?h.success?"primary":"warning":"inherit",variant:"body2",children:e.title})]}),t===v&&(Number.isInteger(h.progressBar)||h.progressBar)?(0,l.jsx)(nY.A,{color:h.success?"primary":"warning",sx:{mt:2,mx:3},variant:Number.isInteger(h.progressBar)?"determinate":"indeterminate",value:Number.isInteger(h.progressBar)?h.progressBar:null}):null]})]},t)),h.success?null:(0,l.jsxs)(eC.A,{severity:"warning",children:[h.message.length?h.message:s.t("An error occured during the installation of the large language model."),(0,l.jsx)("br",{}),"serve"!==h.code?s.t("Press the reinstall button below to begin a fresh install."):s.t("Press the restart button below to reload the large language model.")]})]}),(0,l.jsxs)(e_.A,{children:[h.success?null:(0,l.jsx)(C.A,{className:"pop",startIcon:"serve"!==h.code?(0,l.jsx)(N.A,{}):(0,l.jsx)(rv.A,{}),color:"primary",onClick:()=>y("serve"!==h.code),variant:"contained",children:"serve"!==h.code?s.t("Reinstall"):s.t("Restart")}),(0,l.jsx)(C.A,{color:h.success&&n()?"primary":"secondary",variant:h.success&&n()?"contained":"text",className:h.success&&n()?"pop":null,onClick:()=>c(!1),children:h.success&&n()?s.t("Let's go!"):s.t("OK")})]})]}):null]})};var rS=n(40577),rC=n(61548),rI=n(10957);function rT(){let e=(0,t_._)(["\n0%   { transform: translateY(-50px); }\n100% { transform: translateY(0px); }"]);return rT=function(){return e},e}let rz=(0,tM.i7)(rT()),rD=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{width:"2px",height:"20px",position:"relative",borderRight:"1px solid ".concat((0,s.A)(t)),marginLeft:t.spacing(2)}});function rE(e){let{agents:t}=e,{getAgentActive:n,onAgentActive:i,getAgentId:r,onAgentId:o,getNavVisible:d,onNavVisible:c,setNavVisible:u,getNavUrl:p,onNavUrl:h,getNavInfo:f,onNavInfo:y,log:A}=(0,x.P)(),j=(0,b.A)(),v=(0,g.useRef)(null),{i18n:w}=(0,m.B)(),C=(0,g.useRef)(null),[I,T]=(0,g.useState)(null),[z,D]=(0,g.useState)(!1),[E,_]=(0,g.useState)(!1),[M,P]=(0,g.useState)({status:-1});(0,g.useEffect)(()=>{D(n(r()));let e=i(e=>{let{agentId:t,active:n}=e;t===r()&&D(n)});_(d());let t=c(e=>{_(e)});null!==v.current&&(v.current.value=p(r()));let l=h(e=>{let{agentId:t,url:n}=e;t===r()&&null!==v.current&&(v.current.value=n)});P(f(r()));let s=y(e=>{let{agentId:t,info:n}=e;t===r()&&P(n)});return()=>{e(),t(),l(),s()}},[I]),(0,g.useEffect)(()=>{T((0,a.fD)(t,r()));let e=o(e=>T((0,a.fD)(t,e)));return()=>e()},[t]),(0,g.useEffect)(()=>{E&&null!==v.current&&(v.current.value=p(r()))},[E]);let N=async e=>{var t,n;if(!z){P({...M,status:-1}),null==(t=window.sdk)||t.ipc.main.setOnTop();try{await (null==(n=window.sdk)?void 0:n.ipc.target.loadUrl(r(),e))}catch(e){A(r(),"Navigation error: ".concat(e.message),"error")}}},O=async()=>{var e,t;if(!z){P({...M,status:-1}),null==(e=window.sdk)||e.ipc.main.setOnTop();try{await (null==(t=window.sdk)?void 0:t.ipc.target.reload(r(),!0))}catch(e){A(r(),"Navigation error: ".concat(e.message),"error")}}},F=async()=>{if(!z)try{var e;await (null==(e=window.sdk)?void 0:e.ipc.target.goBack(r()))}catch(e){A(r(),"Navigation error: ".concat(e.message),"error")}},B=async()=>{if(!z)try{var e;await (null==(e=window.sdk)?void 0:e.ipc.target.goForward(r()))}catch(e){A(r(),"Navigation error: ".concat(e.message),"error")}},W=async()=>{u(!1)},U="1px solid ".concat(z?j.palette.primary.main:(0,s.A)(j));return I&&E?(0,l.jsx)(k.A,{sx:{borderBottom:U,zIndex:20,position:"fixed",display:"flex",flexDirection:"column",left:"250px",top:"50px",width:"calc(100vw - 250px)",overflow:"hidden",background:j.palette.background.default,animation:"".concat(rz," 100ms ease-in-out forwards")},children:(0,l.jsxs)(k.A,{sx:{height:"49px",alignItems:"center",display:"flex"},children:[z?(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",ml:4,mr:2,flex:"0 0 auto",userSelect:"none"},children:(0,l.jsx)(S.A,{variant:"caption",color:j.palette.action.active,children:w.t("Controlled by agent")})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",mx:2,ml:4},children:(0,l.jsx)(eT.A,{onClick:F,disabled:-1===M.status||!M.canGoBack,children:(0,l.jsx)(rC.A,{fontSize:"small"})})}),(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",mr:2},children:(0,l.jsx)(eT.A,{onClick:B,disabled:-1===M.status||!M.canGoForward,children:(0,l.jsx)(rS.A,{fontSize:"small"})})}),(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(eT.A,{onClick:O,disabled:-1===M.status,children:(0,l.jsx)(rI.A,{fontSize:"small"})})})]}),(0,l.jsx)(rD,{sx:{mr:2}}),(0,l.jsx)(eS.A,{inputRef:v,variant:"standard",fullWidth:!0,disabled:z||-1===M.status,sx:{"& .MuiInput-root:before":{display:"none"}},onKeyDown:e=>{var t;return"Enter"===e.key&&(t=e.target.value,void(null!==C.current&&window.clearTimeout(C.current),C.current=window.setTimeout(async()=>{if(C.current=null,!t.match(RegExp("\\.[\\p{L}\\d]|about:home|localhost","u"))){v.current.value=p(r());return}if(!t.match(/^(https?\:\/\/|about:home)\b/gi)){let e=t.match(/^((127|0)\.\d+|localhost)/gi)?"http":"https";t="".concat(e,"://").concat(t.replace(/^\w+\:\/\//gi,"")),v.current.value=t}await N(t)},250)))},inputProps:{sx:{fontSize:"0.75rem",px:"0 !important"}},placeholder:w.t("Type URL and press Enter"),InputProps:{startAdornment:(0,l.jsx)(ek.A,{position:"start",sx:{userSelect:"none"},children:(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",mx:2},children:(0,l.jsx)(k.A,{sx:{height:"20px"},children:-1===M.status?(0,l.jsx)(nU.A,{fontSize:"small",className:"rotate-360"}):0===M.status?(0,l.jsx)(R.A,{title:w.t("Failed to load"),placement:"left",children:(0,l.jsx)(ty.A,{fontSize:"small",color:"warning"})}):z?(0,l.jsx)(tA.A,{fontSize:"small",color:"action"}):(0,l.jsx)(ex.A,{fontSize:"small"})})})})}}),(0,l.jsx)(k.A,{sx:{display:"flex",alignItems:"center",mx:4},children:(0,l.jsx)(R.A,{title:w.t("Close"),placement:"bottom",children:(0,l.jsx)(eT.A,{onClick:W,sx:{mr:"2px"},children:(0,l.jsx)(L.A,{fontSize:"small"})})})})]})}):null}function r_(e){var t,n;let{count:i=0,onAgentAdd:r=()=>{}}=e,{getSubscription:s,onSubscription:a}=(0,x.P)(),{i18n:o}=(0,m.B)(),d=(0,h.A)(),[c,u]=(0,g.useState)(0),[p,f]=(0,g.useState)(0);return(0,g.useEffect)(()=>{var e;let t=s();f(!!t.active),u(null!=(e=t.agentsCount)?e:0);let n=a(e=>{var t;let{info:n}=e;f(!!n.active),u(null!=(t=n.agentsCount)?t:0)});return()=>{n()}},[null==(t=d.user)?void 0:t.computerEnabled]),p&&(null==(n=d.user)?void 0:n.computerEnabled)&&i<c?(0,l.jsx)(k.A,{sx:{px:3,my:3},children:(0,l.jsx)(C.A,{fullWidth:!0,sx:{fontSize:"0.75rem"},startIcon:(0,l.jsx)(ev.A,{color:"inherit"}),onClick:r,children:o.t("Add agent")})}):null}let rM=(0,w.Ay)(k.A)(()=>({display:"flex",width:"100%",height:"calc(100vh - 100px)",position:"relative",zIndex:2})),rP=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",width:"250px",height:"100%",boxShadow:"-1px 0px 0px 0px ".concat((0,s.A)(t)," inset")}}),rN=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",width:"calc(100vw - 250px)",boxShadow:"0px -1px 0px 0px ".concat((0,s.A)(t)," inset"),height:"100%"}}),rR=(0,w.Ay)(k.A)(e=>{let{theme:t}=e;return{display:"flex",width:"100%",height:"50px",background:t.palette.background.default,position:"relative",zIndex:21}}),rL=()=>{var e;let{onAgentId:t,getAgentId:n,setAgentId:i,getAgentActive:o,onAgentActive:d,getAgentTab:c,onAgentTab:A,setHourglass:w,setPageTitle:S,log:C,getLogs:I,getLogsInit:T,setLogsInit:z,setLogsEnabled:D,onLogsVisible:E,getLogsVisible:M,setLogsVisible:P,onNavVisible:N,getNavVisible:R,setNavVisible:L,onMachineStatus:O,getDialogVisible:F,setDialogVisible:B,getSource:W,modulePurge:U,onModuleUpdate:H,onModulePurge:q,agentPurge:Y,setInstalled:K}=(0,x.P)(),{i18n:G}=(0,m.B)(),V=(0,y.useRouter)(),$=(0,b.A)(),J=(0,h.A)(),[X,Z]=(0,g.useState)(!1),[Q,ee]=(0,g.useState)([]);(0,g.useEffect)(()=>{J.user&&(p.A.setI18n(G),(async()=>{var e,t,n;try{let e=await v.A.get("agents");Array.isArray(e.data)&&ee(e.data),e.data.length&&window.setTimeout(async()=>{await et(e.data[0].id)},250)}catch(e){}null==(e=window.sdk)||e.ibc.handle("ibc-source:agent:data",e=>{"object"==typeof e&&"string"==typeof(null==e?void 0:e.id)&&ee(t=>structuredClone(t).map(t=>(null==t?void 0:t.id)===(null==e?void 0:e.id)?e:t))}),null==(t=window.sdk)||t.ibc.handle("ibc-source:module:installed",(e,t,n)=>{"string"==typeof e&&(("object"!=typeof t||"string"!=typeof(null==t?void 0:t.id))&&(t=null),(null===t||"string"!=typeof n)&&(n=null),K(e,t,n,!1))}),null==(n=window.sdk)||n.ibc.handle("ibc-source:module:purge",e=>{"string"==typeof e&&U(e)}),Z(!0)})())},[null==(e=J.user)?void 0:e.id]),(0,g.useEffect)(()=>{let e=e=>{var t;return S((null==e?void 0:e.name)?"".concat(null!=(t=null==e?void 0:e.name)?t:""):null)};e((0,a.fD)(Q,n()));let l=t(t=>{e((0,a.fD)(Q,t))}),i=O(e=>{let{status:t}=e;p.A.STATUS_STARTED===t&&B("repo",!1)}),r=u(Q,n,B),s=f(Q,Y,e=>{!T(e)&&(D(e,!0,!1),z(e,!0),I(e).length||(C(e,G.t("Errors happen, but at least they're detailed and nicely colored"),"error"),C(e,G.t("Messages are temporary - they get cleared when you close the application"),"warning"),C(e,G.t("Only the last {{logsPerAgent}} messages are kept in this console",{logsPerAgent:j().max.logsPerAgent})),C(e,G.t("This is where agents display their messages"),"success")))}),o=H(e=>{let{module:t,sendToSce:n}=e;n&&"string"==typeof(null==t?void 0:t.id)&&t.id.length&&(async()=>{for(let n of structuredClone(Q))if("string"==typeof(null==n?void 0:n.id)&&(null==n?void 0:n.installedModuleId)===t.id){var e;let l=await W(n.id,!0),i={agentData:n,moduleData:t,sourceCode:l};null==(e=window.sdk)||e.ibc.source.send(n.id,"ibc-main:module-repo:data",[i])}})()}),d=q(e=>{"string"==typeof e&&e.length&&(async()=>{for(let n of structuredClone(Q))if("string"==typeof(null==n?void 0:n.id)&&(null==n?void 0:n.installedModuleId)===e){var t;n.installedModuleId=null,n.installedModuleSrcId=null,n.installedModuleAuthorId=null;let e={agentData:structuredClone(n),moduleData:null};null==(t=window.sdk)||t.ibc.source.send(n.id,"ibc-main:module-repo:data",[e]),el(n)}})()});return()=>{o(),d(),r(),l(),i(),s()}},[Q]),(0,g.useEffect)(()=>{var e,t;if("object"!=typeof window.sdk)return void V.replace("/home/");window.setTimeout(()=>{var e;return null==(e=window.sdk)?void 0:e.ipc.main.focus()},750),null==(e=window.sdk)||e.ibc.handle("ibc-source:open",()=>B("loading",!1)),null==(t=window.sdk)||t.ibc.handle("ipc:oglama:restored",async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),B("restored",!0)});let l=async()=>{var e,t;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),await (null==(t=window.sdk)?void 0:t.ipc.target.removeAll())};window.addEventListener("beforeunload",l),V.events.on("routeChangeStart",l);let i=d(e=>{let{agentId:t,active:n}=e;return w(t,n)}),r=E(e=>!e&&ea()),s=N(e=>!e&&ea()),a=A(()=>null!==n()&&et(n()));return()=>{window.removeEventListener("beforeunload",l),V.events.off("routeChangeStart",l),i(),r(),s(),a()}},[]);let et=async function(e){var t,n;let l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"!=typeof e)return;i(e);let r=l||""!==c()||F()||M()||R()||o(e);await (null==(t=window.sdk)?void 0:t.ipc.main.setOnTop(r)),""===c()&&await (null==(n=window.sdk)?void 0:n.ipc.target.select(e))},en=async e=>{var t,n,l;if("string"==typeof(null==(t=J.user)?void 0:t.computerId)){try{let t=await v.A.post("agents",{name:e,computerId:J.user.computerId});"string"==typeof(null==(l=t.data)?void 0:l.id)&&(ee(e=>[...structuredClone(e),t.data]),i(t.data.id),D(t.data.id,!0,!1),B("repo",!0))}catch(e){}await (null==(n=window.sdk)?void 0:n.ipc.main.setOnTop())}},el=e=>{if("object"==typeof e&&null!==e&&"string"==typeof e.id){var t;ee(t=>structuredClone(t).map(t=>t.id===e.id?e:t)),null==(t=window.sdk)||t.ibc.source.send(e.id,"ibc-main:agent:data",[e])}},ei=async e=>{try{await v.A.delete("agents/".concat(e)),ee(t=>{let l=[...structuredClone(t).filter(t=>t.id!==e)];return n()===e&&i(l.length?l[0].id:null),l}),Y(e)}catch(e){}},er=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),B("agentCreate",!0)},es=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),B("profile",!0)},ea=async()=>{""===c()&&await et(n())},eo=async()=>{P(!1),L(!1),await ea()},ed=async()=>{var e;await (null==(e=window.sdk)?void 0:e.ipc.main.setOnTop()),B("loading",!0)};return null===J.user?(0,l.jsx)(nZ.A,{}):(0,l.jsxs)(k.A,{sx:{display:"flex",width:"100vw",height:"100vh",flexDirection:"column"},children:[(0,l.jsx)(r(),{id:"a832ee7090d48c19",children:"body{background:transparent}"}),(0,l.jsx)(nk,{agentsCount:Q.length,agentsReady:X}),(0,l.jsx)(rR,{children:X&&Q.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(rP,{sx:{justifyContent:"space-between",alignItems:"center"},children:(0,l.jsx)(t9,{})}),(0,l.jsxs)(rN,{sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)(nv,{agents:Q,onSelect:et}),(0,l.jsx)(tl,{agents:Q,onSelect:et,onUpdate:()=>B("agentUpdate",!0),onDelete:()=>B("agentDelete",!0),showLoading:ed})]})]}):null}),(0,l.jsx)(rM,{children:X&&Q.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(rP,{sx:{background:$.palette.background.default,flexDirection:"column",position:"relative",zIndex:10},children:(0,l.jsxs)(k.A,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},children:[(0,l.jsxs)(k.A,{children:[Q.map((e,t)=>(0,l.jsx)(nX,{agent:e,index:t,onSelect:et},e.id)),(0,l.jsx)(r_,{count:Q.length,onAgentAdd:er})]}),(0,l.jsx)(i7,{}),(0,l.jsx)(rk,{})]})}),(0,l.jsx)(rN,{sx:{boxShadow:"none"},onMouseOver:ea,onMouseDown:eo,children:(0,l.jsx)(i3,{agents:Q,agentsReady:X})}),(0,l.jsx)(rE,{agents:Q}),(0,l.jsx)(ng,{agents:Q})]}):null}),(0,l.jsxs)(rR,{children:[(0,l.jsx)(rP,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:(0,l.jsx)(lt,{onProfileOpen:es})}),X&&Q.length?(0,l.jsxs)(rN,{sx:{alignItems:"center",boxShadow:"0px 1px 0px 0px ".concat((0,s.A)($)," inset"),justifyContent:"space-between"},children:[(0,l.jsx)(_,{agents:Q}),(0,l.jsx)(nO,{agents:Q})]}):null]}),(0,l.jsx)(e9,{agents:Q,onAgentUpdate:el}),(0,l.jsx)(rg,{agents:Q,onAgentCreate:en,onAgentUpdate:el,onAgentDelete:ei})]})};rL.guestGuard=!0;let rO=rL},42936:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(35342)}])}},e=>{e.O(0,[894,573,483,708,943,347,636,593,792],()=>e(e.s=42936)),_N_E=e.O()}]);