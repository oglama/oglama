/*!
 * @architect Mark Jivko <mark@oglama.com>
 * @copyright Â© 2024-2025 Oglama (https://oglama.com)
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{75557:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(60234)}])},2737:function(e,n,t){"use strict";var r=t(90948),i=t(80822),o=(0,r.ZP)(i.Z)((function(e){var n=e.theme;return{width:"1100px",height:"1100px",left:"50%",top:"50%",marginLeft:"-550px",marginTop:"-550px",position:"absolute",background:"url(/img/pages/circles-".concat(n.palette.mode,".svg)"),backgroundPosition:"50% 50%",backgroundSize:"cover",backgroundRepeat:"no-repeat",zIndex:1}}));n.Z=o},60234:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Hl}});var r=t(47568),i=t(29815),o=t(97582),l=t(85893),a=t(60357),s=t.n(a),u=t(69604),c=t(16046),d=t(5097),p=null,f=function(e){var n,t,l,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(e.isTrusted&&!e.shiftKey&&!e.altKey&&(null===e||void 0===e?void 0:e.ctrlKey)&&"control"!==(null===(n=e.key)||void 0===n?void 0:n.toLowerCase())){var f=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),u("loading",!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),h={"/":function(){var e,n;if(null===(e=window.sdk)||void 0===e?void 0:e.devMode){var t=window.localStorage.getItem("jwt-user"),r=window.localStorage.getItem("jwt-founder");if("string"===typeof t&&"string"===typeof r){var i=window.localStorage.getItem("oglama-auth-jwt");window.localStorage.setItem("oglama-auth-jwt",i===t?r:t),f(),d.A.loading("Switching user..."),null===(n=window.sdk)||void 0===n||n.ipc.source.closeAll(),window.setTimeout((function(){return window.location.reload()}),1500)}else d.A.error("Local storage jwt-user or jwt-founder missing")}},numeric:function(e,n){var t,r=(0,i.Z)(new Set(e.map((function(e){return null===e||void 0===e?void 0:e.id})).filter(Boolean)));"string"===typeof r[n]&&(null===(t=document.querySelector('[data-agent="'.concat(r[n],'"][data-agent-selected="false"]')))||void 0===t||t.click())},".":function(){var e;null===(e=document.querySelector('[data-start-stop="'.concat(s(),'"]')))||void 0===e||e.click()},w:function(){var e;null===(e=document.querySelector('[data-tab="browser"][data-tab-selected="false"]'))||void 0===e||e.click()},e:function(){var e;null===(e=document.querySelector('[data-tab="settings"][data-tab-selected="false"]'))||void 0===e||e.click()},r:function(){var e;null===(e=document.querySelector('[data-tab="results"][data-tab-selected="false"]'))||void 0===e||e.click()},t:function(){var e;null===(e=document.querySelector('[data-tab="triggers"][data-tab-selected="false"]'))||void 0===e||e.click()},l:function(){var e;null===(e=document.querySelector("[data-logs-toggle]"))||void 0===e||e.click()},m:function(){var e;null===(e=document.querySelector("[data-modules-toggle]"))||void 0===e||e.click()},u:(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===window||void 0===window||null===(e=window.sdk)||void 0===e?void 0:e.ipc.source.open(s())];case 1:return n.sent()?[4,f()]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))})),i:function(e){var n,t=(0,c.zu)(e,s());null!==t&&(null===(n=window.sdk)||void 0===n||n.ipc.target.openDevTools(t.id,t.name))}},x=(null===(t=e.key)||void 0===t?void 0:t.toLowerCase().match(/^[1-9]$/))?function(n){return h.numeric(n,parseInt(e.key,10)-1)}:h[null===(l=e.key)||void 0===l?void 0:l.toLowerCase()];"function"===typeof x&&(e.preventDefault(),null!==p&&window.clearTimeout(p),p=window.setTimeout((function(){p=null;try{var e;x(a),null===(e=window.sdk)||void 0===e||e.ipc.main.setOnTop()}catch(n){}}),50))}},h=t(46473),x=t(67817),m=t(20214),v=t(77058),g=t(67294),y=t(11163),Z=t(65782),j=t.n(Z),b=t(87066),w=t(90948),k=t(2734),S=t(80822),C=t(15861),I=t(11057),_=t(82975),A=t(82753),T=(0,w.ZP)(S.Z)((function(e){e.theme;var n=e.open;return{transition:"transform 350ms cubic-bezier(0.48, -0.35, 0.17, 0.95)",transform:void 0!==n&&n?"rotate(180deg)":"rotate(0deg)",justifyContent:"center",alignItems:"center",position:"relative",display:"flex"}})),z=function(e){var n=e.children,t=e.open,r=void 0!==t&&t,i=e.sx,o=void 0===i?{}:i;return"object"===typeof o&&null!==o||(o={}),(0,l.jsx)(T,{sx:o,open:!!r,children:n})};function P(e){var n=e.log;return(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:(0,l.jsx)(C.Z,{variant:"caption",noWrap:!0,align:"left",sx:{textTransform:"none",width:"calc(100% - 75px)"},children:n.m})})}function M(e){var n=e.agents,t=(0,v.$)().i18n,r=(0,x.O)(),i=r.getAgentActive,o=r.onAgentActive,a=r.getAgentId,s=r.onAgentId,u=r.getLogs,c=r.onLog,d=r.getLogsEnabled,p=r.onLogsEnabled,f=r.getLogsVisible,h=r.onLogsVisible,m=r.setLogsVisible,y=(0,g.useState)(null),Z=y[0],j=y[1],b=(0,g.useState)(!1),w=b[0],k=b[1],T=(0,g.useState)(null),M=T[0],D=T[1],E=(0,g.useState)(!1),N=E[0],R=E[1],O=(0,g.useState)(!1),L=O[0],F=O[1];(0,g.useEffect)((function(){var e=u(a());j(Array.isArray(e)&&e.length?e[0]:null);var n=c((function(e){return j(Array.isArray(e)&&e.length?e[0]:null)}));k(i(a()));var t=o((function(e){var n=e.agentId,t=e.active;n===a()&&k(t)}));R(d());var r=p((function(e){return R(e)}));F(f());var l=h((function(e){return F(e)}));return function(){n(),t(),r(),l()}}),[M]),(0,g.useEffect)((function(){D(a());var e=s((function(e){return D(e)}));return function(){return e()}}),[n]);var W="action";return(w&&"string"==typeof(null===Z||void 0===Z?void 0:Z.s)||"error"===(null===Z||void 0===Z?void 0:Z.s))&&(W=Z.s),null!==M&&N?(0,l.jsx)(S.Z,{sx:{minWidth:"maxContent",width:"100%",flexShrink:1,display:"flex",height:"100%",overflow:"hidden"},children:(0,l.jsx)(S.Z,{sx:{width:"100%",height:"100%"},children:(0,l.jsxs)(I.Z,{"data-logs-toggle":!0,onClick:function(){m(!L),window.setTimeout((function(){var e;return null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.focus()}),250)},sx:{width:"100%",height:"100%",alignItems:"center",borderRadius:0,justifyContent:"start",pl:3},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(_.Z,{sx:{mr:2},color:W,fontSize:"small"}),null!==Z?(0,l.jsx)(P,{log:Z}):(0,l.jsx)(C.Z,{variant:"caption",noWrap:!0,align:"left",sx:{textTransform:"none",width:"calc(100% - 75px)"},children:t.t("No messages were recorded for this agent")})]}),(0,l.jsx)(S.Z,{sx:{position:"absolute",top:12,right:6},children:(0,l.jsx)(z,{open:L,children:(0,l.jsx)(A.Z,{color:"action"})})})]})})}):null}var D=t(77533),E=t(43985),N=t(47507),R=t(26042),O=t(34386),L=t(42734),F=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{display:"flex",alignItems:"center",height:"50px",paddingLeft:n.spacing(4),paddingRight:n.spacing(4),justifyContent:"space-between",backgroundColor:n.palette.background.paper,borderBottom:"1px solid ".concat(n.palette.divider),flexShrink:0}})),W=(0,w.ZP)(S.Z)((function(){return{display:"inline-block",maxWidth:"80%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",userSelect:"none",fontSize:"0.85rem",textAlign:"center"}})),U=function(e){var n=e.title,t=e.icon,r=void 0===t?null:t,i=e.handleClose,o=void 0===i?function(){}:i,a=e.sx,s=void 0===a?{}:a,u=(0,v.$)().i18n;return"object"===typeof s&&null!==s||(s={}),(0,l.jsxs)(F,{sx:(0,R.Z)({},s),children:[r,(0,l.jsx)(O.Z,{title:n,children:(0,l.jsx)(W,{children:n})}),(0,l.jsx)(O.Z,{title:u.t("Close"),placement:"left",children:(0,l.jsx)(L.Z,{onClick:o,sx:{cursor:"pointer"}})})]})},B=(0,w.ZP)(S.Z)((function(e){return{padding:e.theme.spacing(4),overflowY:"auto",height:"100%"}})),$=t(2737),H=t(14924),V=t(45670),q=t(55050),K=t(46408),Y=t(40044),G=t(42274),X=(0,w.ZP)(Y.Z)((function(e){var n,t=e.theme;return n={},(0,H.Z)(n,t.breakpoints.down("md"),{minWidth:100}),(0,H.Z)(n,t.breakpoints.down("sm"),{minWidth:67}),n})),J=(0,w.ZP)("span")((function(e){var n=e.theme;return(0,H.Z)({lineHeight:1.71,fontSize:"0.75rem",marginLeft:n.spacing(2.4)},n.breakpoints.down("md"),{display:"none"})})),Q=function(e){var n=e.tabs,t=e.hash,r=e.setHash,i=e.sx,o=void 0===i?{}:i,a=e.tabsReady,s=void 0===a||a,u=e.hideSingleTab,c=void 0===u||u,d=e.prefix,p=void 0===d?null:d,f=e.bordered,h=void 0!==f&&f,x=e.sticky,m=void 0!==x&&x,g=(0,v.$)().i18n,y=(0,k.Z)(),Z={};return Object.keys(n).map((function(e){("undefined"===typeof n[e].visible||n[e].visible)&&(Z[e]=n[e])})),null!==o&&"object"===typeof o||(o={}),(0,l.jsxs)(V.ZP,{value:t,children:[Object.keys(Z).length<=1&&c?null:s?(0,l.jsxs)(S.Z,{sx:(0,R.Z)({display:"flex",alignItems:"center"},h?{borderBottom:"1px solid ".concat(y.palette.divider)}:{},m?{position:"sticky",top:0,background:y.palette.background.paper,zIndex:10}:{}),children:[null!==p?(0,l.jsx)(S.Z,{sx:{pl:3},children:p}):null,(0,l.jsx)(K.Z,{sx:{pl:null!==p?3:0},onChange:function(e,n){return r(n)},"aria-label":"Tabs",children:Object.keys(Z).map((function(e,n){return(0,l.jsx)(X,{value:e,label:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[Z[e].icon,(0,l.jsx)(J,{children:g.t(Z[e].label)})]})},n)}))})]}):(0,l.jsx)(S.Z,{sx:{height:"48px",width:{xs:"100%",md:"50%"}},children:(0,l.jsx)(G.Z,{count:1,columns:3})}),(0,l.jsx)(S.Z,{sx:(0,R.Z)({},o),children:Object.keys(Z).map((function(e,n){return(0,l.jsx)(q.Z,{value:e,sx:{p:0},children:t===e?Z[e].content:null},n)}))})]})},ee=t(56267),ne=t(14678),te=t(24917),re=t(66485),ie=t.n(re),oe=t(44417),le=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",t=document.querySelector("".concat(n," > .confetti-container"));if(null===t){(t=document.createElement("div")).classList.add("confetti-container"),null===(e=document.querySelector(n))||void 0===e||e.appendChild(t);var r=["red","orange","yellow","green","blue","violet"],i=function(){return"".concat(Math.floor(Math.random()*window.innerWidth),"px")},o=function(){return r[Math.floor(Math.random()*r.length)]};t.innerHTML="";for(var l=0;l<200;l++)!function(e){setTimeout((function(){var e=document.createElement("div"),n=Math.random()<.5?"50%":0;e.classList.add("confetti"),e.style.left=i(),e.style.background=o(),e.style.borderRadius=n,t.appendChild(e),e.animate({top:"".concat(window.innerHeight,"px"),left:"".concat(Math.floor(Math.random()*window.innerWidth),"px")},Math.floor(500*Math.random()+1500))}),10*e)}(l);window.setTimeout((function(){var e;null===(e=t.parentNode)||void 0===e||e.removeChild(t)}),4e3)}},ae=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"!==typeof e)return[(0,l.jsx)("span",{children:e},0)];"string"!==typeof n&&(n="");var r=e.toLowerCase().indexOf(n.toLowerCase()),i=0,o=/(https?:\/\/[^\s]+)/gi,a=function(e,n){var r,i;(e.preventDefault(),e.stopPropagation(),ie()(n),"string"===typeof t&&t.length)?null===(r=window.sdk)||void 0===r||r.ipc.target.openInNewWindow(t,n):null===(i=window.sdk)||void 0===i||i.ipc.main.openExternal(n)};return e.split(o).map((function(e){var t=null,s=null,u=!!e.match(o);do{if(r<0)break;if(r>=i&&r<i+e.length){t=r-i,s=Math.min(e.length-t,n.length);break}if(r+n.length>=i&&r+n.length<i+e.length){t=0,s=n.length+r-i;break}}while(0);i+=e.length;var c=null!==t?[e.substring(0,t),(0,l.jsx)("u",{children:e.substring(t,t+s)},t),e.substring(t+s)].filter((function(e){return""!==e})).map((function(e,n){return(0,l.jsx)("span",{children:e},n)})):[(0,l.jsx)("span",{children:e},0)];return u?[(0,l.jsxs)("span",{className:"anchor",onClick:function(n){return a(n,e)},href:e,children:[(0,l.jsx)(oe.Z,{sx:{width:"1rem",height:"1rem",lineHeight:"1rem",display:"inline-block",verticalAlign:"middle",mr:1}}),c]},0)]:c}))},se=t(86886),ue=t(60848),ce=t(32342),de=t(44267),pe=t(66242),fe=t(86822),he=t(87918),xe=t(54356),me=(0,w.ZP)(S.Z)((function(e){return{borderRadius:"5px",position:"absolute",width:"70px",height:"70px",background:e.theme.palette.success.main,inset:0,clipPath:"polygon(0 0, 0 100%, 100% 0)",left:-6,top:-5}})),ve=function(e){var n=e.scale,t=void 0===n?1:n,r=e.label,i=void 0!==r&&r,o=(0,v.$)().i18n;return(0,l.jsx)(O.Z,{title:i?o.t("Installed"):null,children:(0,l.jsxs)(S.Z,{sx:{position:"relative",transform:"scale(".concat(t,")"),transformOrigin:"0 50%"},children:[(0,l.jsx)(he.Z,{variant:i?"contained":"outlined",sx:(0,R.Z)({position:"relative",zIndex:2,textTransform:"uppercase",userSelect:"none"},i?{"& .MuiChip-label":{px:"6px"}}:{px:2}),icon:(0,l.jsx)(xe.Z,{fontSize:i?"medium":"small"}),color:"success",size:"medium",label:i?"":o.t("Installed")}),i?(0,l.jsx)(me,{}):null]})})},ge=(0,w.ZP)("img")((function(e){return{marginBottom:e.theme.spacing(4),width:"96px",height:"96px",transition:"transform 100ms linear",position:"relative",zIndex:1}})),ye=(0,w.ZP)(C.Z)((function(e){return{fontWeight:400,flex:"1 1 100%",overflow:"hidden",fontSize:"0.75rem",whiteSpace:"nowrap",textOverflow:"ellipsis",textTransform:"none",marginBottom:e.theme.spacing(.75),maxWidth:"96px"}})),Ze=function(e){var n,t=e.module,r=void 0===t?null:t,i=e.installedModuleId,o=void 0===i?null:i,a=e.setModuleId,s=void 0===a?function(){}:a,u=e.selected,c=void 0!==u&&u,d=(0,k.Z)(),p=(0,m.a)();return(0,l.jsx)(se.ZP,{item:!0,children:(0,l.jsx)(I.Z,{color:"inherit",variant:"contained",onClick:function(){null!==r&&s(r.id)},sx:{borderRadius:1,p:0,background:c?d.palette.background.selected:"transparent","&:hover":{background:c?d.palette.background.selected:"transparent"},height:"100%"},children:(0,l.jsx)(pe.Z,{sx:{borderRadius:1,background:"transparent",boxShadow:"none",height:"100%"},children:(0,l.jsxs)(de.Z,{sx:{"&.MuiCardContent-root":{p:3},height:"100%",position:"relative",borderRadius:1,border:"1px solid ".concat(c?d.palette.primary.main:d.palette.divider),display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",width:"100%",position:"absolute",left:0,top:0,mt:0,px:1,zIndex:1e3,justifyContent:"space-between"},children:[(0,l.jsx)(S.Z,{children:(null===r||void 0===r?void 0:r.id)===o?(0,l.jsx)(ve,{scale:.8,label:!0}):null}),null===r||p.user.id!==(null===r||void 0===r?void 0:r.authorId)&&"founder"!==(null===(n=p.user)||void 0===n?void 0:n.userRole)?null:(0,l.jsx)(fe.Z,{scale:.8,module:r})]}),(0,l.jsx)(S.Z,{sx:{position:"relative",mt:3,"&:before":{content:'""',display:null!==r?"block":"none",width:"96px",height:"96px",position:"absolute",top:0,left:0,zIndex:1,background:d.palette.background.paper,borderRadius:"50%",opacity:1}},children:null!==r?(0,l.jsx)(ge,{src:null!==r.moduleLogoId?"".concat(ce.Z.s3Url,"/modules/").concat(r.id,"/").concat(r.moduleLogoId,".png"):"/img/placeholder/module.png"}):(0,l.jsx)(S.Z,{sx:{mb:2},children:(0,l.jsx)(G.Z,{rounded:!0,sx:{width:"96px",height:"96px"}})})}),null!==r?(0,l.jsx)(O.Z,{title:r.moduleName,children:(0,l.jsx)(ye,{children:r.moduleName})}):(0,l.jsx)(G.Z,{spacing:0,sx:{my:2,width:"96px",height:"1rem",display:"inline-block"}})]})})})})},je=t(58032),be=t(98763),we=t(65834),ke=function(e){var n=e.modulesLoaded,t=e.setDialogCreate,r=void 0===t?function(){}:t;return(0,l.jsx)(se.ZP,{item:!0,children:(0,l.jsx)(pe.Z,{sx:{boxShadow:"none"},children:(0,l.jsx)(de.Z,{sx:{"&.MuiCardContent-root":{p:3},display:"flex",minHeight:"180px",boxShadow:"none"},children:(0,l.jsx)(S.Z,{sx:{width:"98px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(je.Z,{sx:{"&:hover":{transform:"scale(1.1)"}},size:"large",color:"primary",onClick:function(){return r(!0)},disabled:!n,children:n?(0,l.jsx)(we.Z,{}):(0,l.jsx)(be.Z,{})})})})})})},Se=function(e){var n=e.agent,t=e.moduleId,a=e.setModuleId,s=void 0===a?function(){}:a,u=e.modulesLoaded,c=e.modules,p=e.setModules,f=void 0===p?function(){}:p,h=(0,v.$)().i18n,x=(0,m.a)(),y=(0,g.useState)(!1),Z=y[0],j=y[1],w=function(){var e=(0,r.Z)((function(e,n){var t,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(!x.user)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,b.Z.post("modules",{moduleName:e,moduleDescription:n})];case 2:return r=o.sent(),"string"===typeof(null===(t=r.data)||void 0===t?void 0:t.id)&&(f((0,i.Z)(c).concat([r.data])),s(r.data.id)),le(),d.A.info(h.t("Next, install the module and edit its source code."),{duration:7500}),[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.Z,{sx:{overflowY:"auto",height:"calc(100vh - 110px)",p:4,mt:"5px"},children:(0,l.jsxs)(se.ZP,{container:!0,spacing:3,children:[u?c.map((function(e){return(0,l.jsx)(Ze,{installedModuleId:null===n||void 0===n?void 0:n.installedModuleId,selected:t===e.id,module:e,setModuleId:s},e.id)})):[1,2,3].map((function(e){return(0,l.jsx)(Ze,{},e)})),(0,l.jsx)(ke,{modulesLoaded:u,setDialogCreate:j})]})}),Z?(0,l.jsx)(ue.Z,{isOpen:!0,description:h.t("Create a new module with empty source code."),onCreate:w,onClose:function(){return j(!1)}}):null]})},Ce=t(87109),Ie=t(50135),_e=t(46901),Ae=t(69497),Te=t(93946),ze=t(7902),Pe=function(e){var n=e.agent,t=e.moduleId,r=e.setModuleId,i=void 0===r?function(){}:r,o=e.modulesLoaded,a=e.modules,s=e.searchModuleName,u=e.setSearchModuleName,c=void 0===u?function(){}:u,d=(0,v.$)().i18n,p=(0,g.useRef)(null),f=(0,g.useRef)(null),h=(0,g.useCallback)((function(e){null!==p.current&&window.clearTimeout(p.current),p.current=window.setTimeout((function(){c(e),p.current=null}),450)}),[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",alignItems:"center",my:3,px:4},children:[(0,l.jsx)(Ae.Z,{fontSize:"small",color:"disabled",sx:{ml:1}}),(0,l.jsx)(Ie.Z,{inputRef:f,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},InputProps:{endAdornment:(0,l.jsx)(Ce.Z,{position:"end",children:(0,l.jsx)(S.Z,{sx:{width:30,height:30},children:s.length?(0,l.jsx)(O.Z,{title:d.t("Clear search term"),placement:"left",children:(0,l.jsx)(Te.Z,{sx:{width:30,height:30},onClick:function(){c(""),null!==f.current&&(f.current.value="")},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})}):null})})},placeholder:d.t("Search"),variant:"standard",onChange:function(e){return h(e.target.value.toLowerCase())}})]}),(0,l.jsxs)(S.Z,{sx:{overflowY:"auto",height:"calc(100vh - 172px)",px:4},children:[o&&!a.length?(0,l.jsx)(_e.Z,{severity:"info",children:d.t("No modules matched your search criteria")}):null,(0,l.jsx)(se.ZP,{container:!0,spacing:3,children:o?a.map((function(e){return(0,l.jsx)(Ze,{installedModuleId:null===n||void 0===n?void 0:n.installedModuleId,selected:t===e.id,module:e,setModuleId:i},e.id)})):[1,2,3,4].map((function(e){return(0,l.jsx)(Ze,{},e)}))})]})]})},Me=t(87536),De=t(47533),Ee=t(5082),Ne=t(74231),Re=t(56815),Oe=t(31425),Le=t(6514),Fe=t(37645),We=t(94054),Ue=t(23599),Be=t(67720),$e=t(50657),He=t(38333),Ve=t(38299),qe=t(3690),Ke=t(46160),Ye=t(97943),Ge=t(38047),Xe=t(37936),Je=t(69396),Qe=t(38074),en=t(96544),nn=(0,w.ZP)("img")((function(){return{width:200,height:200}})),tn=function(e){var n=e.uploadPath,t=e.getSrc,i=e.onChange,a=void 0===i?(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return[2]}))})):i,s=e.crop,u=void 0===s?"fit":s,c=e.backgroundColor,p=void 0===c?null:c,f=e.borderColor,h=void 0===f?null:f,x=e.borderWidth,m=void 0===x?null:x,y=e.previewWidth,Z=void 0===y?200:y,j=e.previewHeight,w=void 0===j?200:j,I=e.radius,_=void 0===I?5:I,A=e.alt,T=void 0===A?"Logo":A,z=e.inputName,P=void 0===z?"logo":z,M=e.label,D=void 0===M?"Select logo":M,E=e.active,N=void 0!==E&&E,O=e.width,L=void 0===O?256:O,F=e.height,W=void 0===F?256:F;"function"!==typeof t&&(t=function(){return"/img/logo/192.png"});var U=(0,k.Z)(),B=(0,g.useState)(t()),$=B[0],H=B[1],V=(0,g.useState)(!1),q=V[0],K=V[1],Y=(0,v.$)().i18n,X=null!==h&&null!==m?"solid":null,J=(0,Qe.uI)({multiple:!1,accept:{"image/png":[".png"],"image/jpg":[".jpg",".jpeg"],"image/webp":[".webp"]},onDrop:function(e){var t=document.createElement("img");t.onload=function(){K(!0),setTimeout((function(){var e=t.width,i=t.height,l=0,s=0;if(e>i)if("fill"===u)i=W,e*=W/t.height,l=parseInt((L-e)/2,10);else e=L,i*=L/t.width,s=parseInt((W-i)/2,10);else if("fill"===u)e=L,i*=L/t.width,s=parseInt((W-i)/2,10);else i=W,e*=W/t.height,l=parseInt((L-e)/2,10);var c=document.createElement("canvas");c.width=L,c.height=W,c.getContext("2d").drawImage(t,l,s,e,i),c.toBlob((function(e){var t=new FormData;t.append(P,e),(0,r.Z)((function(){var r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),[4,b.Z.post(n,t,{headers:{"Content-Type":"multipart/form-data"}})];case 1:return r=i.sent(),H(URL.createObjectURL(e)),"function"!==typeof a?[3,3]:[4,a(r.data,URL.createObjectURL(e))];case 2:i.sent(),i.label=3;case 3:return K(!1),[3,5];case 4:return i.sent(),K(!1),[3,5];case 5:return[2]}}))}))()}),"png"),c.remove(),t.remove()}),ee.Z.delay.request)},t.onerror=function(){d.A.error(Y.t("The selected file is not a valid image"),{duration:5e3,ariaProps:{role:"alert"}})},t.src=URL.createObjectURL(Object.assign(e[0]))},validator:function(){}}),Q=J.getRootProps,ne=J.getInputProps;return(0,l.jsx)(S.Z,{children:q?(0,l.jsx)(S.Z,{sx:{width:Z,height:w,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,l.jsx)(G.Z,{count:1,spacing:0,rounded:!0,sx:{p:5,width:Z,height:w}})}):N?(0,l.jsxs)(S.Z,(0,Je.Z)((0,R.Z)({},Q({className:"dropzone"})),{sx:{position:"relative",alignItems:"center",justifyContent:"center",display:"flex",flexDirection:"column"},children:[(0,l.jsx)("input",(0,R.Z)({},ne())),(0,l.jsx)(nn,{src:$,alt:"logo",sx:{m:0,pointerEvents:"none",borderRadius:_,backgroundColor:p,borderStyle:X,borderWidth:m,borderColor:h,width:Z,height:w}}),(0,l.jsxs)(S.Z,{sx:{cursor:"pointer",position:"absolute",width:"70%",height:"70%",background:"dark"===U.palette.mode?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.6)",borderRadius:"50%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center","&:hover > p":{display:"none"},"&:hover > svg":{transform:"scale(2)"}},children:[(0,l.jsx)(en.Z,{}),(0,l.jsx)(C.Z,{size:"large",color:"inherit",sx:{mt:2,textAlign:"center"},children:D})]})]})):(0,l.jsx)(S.Z,{sx:{position:"relative",width:Z,height:w,"&:before":{content:'""',display:"block",width:Z,height:w,position:"absolute",top:0,left:0,zIndex:1,background:U.palette.background.paper,borderRadius:_}},children:(0,l.jsx)(nn,{src:$,sx:{position:"relative",zIndex:1,width:Z,height:w,borderRadius:_,backgroundColor:"transparent",borderWidth:m,borderColor:h},alt:T})})})},rn=function(e){var n,t=e.agent,i=e.onAgentUpdate,a=void 0===i?function(){}:i,s=e.privateModules,u=void 0===s?[]:s,c=e.setPrivateModules,p=void 0===c?function(){}:c,f=e.publicModules,h=void 0===f?[]:f,y=e.setPublicModules,Z=void 0===y?function(){}:y,j=e.moduleId,w=e.onClose,_=void 0===w?function(){}:w,A=(0,x.O)(),T=A.setSource,z=A.setSourceModified,P=A.setInstalled,M=A.moduleUpdate,D=A.setAgentTab,R=A.modulePurge,L=A.agentPurge,F=A.getFirstPlay,W=(0,v.$)().i18n,U=(0,g.useRef)(null),B=(0,m.a)(),$=(0,k.Z)(),H=(0,g.useState)(null),V=H[0],q=H[1],K=(0,g.useState)(!1),Y=K[0],X=K[1],J=(0,g.useState)(!1),Q=J[0],ne=J[1],te=(0,g.useState)(null),re=te[0],ie=te[1],oe=(0,g.useState)(!1),ae=oe[0],se=oe[1],ue=(0,g.useState)(!1),de=ue[0],pe=ue[1],xe=(0,g.useState)(!1),me=xe[0],ge=xe[1],ye={name:Ne.Z_().required(W.t("Module name is required")).min(3,(function(){return W.t("Must be at least {{n}} characters long",{n:3})})).max(64,(function(){return W.t("Must be at most {{n}} characters long",{n:64})})),description:Ne.Z_().max(1024,(function(){return W.t("Must be at most {{n}} characters long",{n:1024})}))},Ze=(0,Me.cI)({defaultValues:{name:"",description:""},mode:"onChange",resolver:(0,De.X)(Ne.Ry().shape(ye))}),je=Ze.setValue,be=Ze.control,we=Ze.handleSubmit,ke=Ze.formState.errors,Se=function(){q(null)},Ae=function(){var e=(0,r.Z)((function(){var e,n,r,i,l,s,u,c,p,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:X(!1),o.label=1;case 1:return o.trys.push([1,7,,8]),i=!1,[4,b.Z.put("agents/".concat(t.id,"/modules/").concat(j))];case 2:return l=o.sent(),t.id===(null===(e=l.data)||void 0===e?void 0:e.id)&&a(l.data),[4,b.Z.get("agents/".concat(t.id,"/src"))];case 3:return s=o.sent(),Array.isArray(null===(n=s.data)||void 0===n?void 0:n.srcStateMachine)?[4,L(t.id)]:[3,5];case 4:o.sent(),T(t.id,s.data,!0),i=Array.isArray(s.data[Ee.ModuleSrc.K_SRC_INPUTS])&&s.data[Ee.ModuleSrc.K_SRC_INPUTS].length>0,z(t.id,!1),o.label=5;case 5:return[4,b.Z.get("modules/".concat(j))];case 6:return u=o.sent(),"string"===typeof(null===(r=u.data)||void 0===r?void 0:r.id)&&P(t.id,u.data,l.data.installedModuleSrcId),F(t.id)&&le(),d.A.success(i?W.t("Let's configure this module!"):W.t("Let's run this module!"),{duration:5e3}),window.setTimeout((function(){X(!0),_(),i&&D("settings")}),250),[3,8];case 7:return c=o.sent(),404===(null===(p=c.response)||void 0===p?void 0:p.status)&&R(j),d.A.error("".concat(W.t("Install error"),": ").concat(null!==(f=c.message)&&void 0!==f?f:c),{duration:5e3,ariaProps:{role:"alert"}}),[3,8];case 8:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),ze=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(ie(e),Array.isArray(n)&&n.length){var t=function(t){if((null===t||void 0===t?void 0:t.id)===j){var r=!0,i=!1,o=void 0;try{for(var l,a=n[Symbol.iterator]();!(r=(l=a.next()).done);r=!0){var s=l.value;t[s]=e[s]}}catch(u){i=!0,o=u}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}return t};Z(structuredClone(h).map(t)),p(structuredClone(u).map(t))}M(e)},Pe=function(){var e=(0,r.Z)((function(e){var n,t,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(n=e.name,t=e.description,!B.user.id===(null===re||void 0===re?void 0:re.authorId))return[2];ne(!1),X(!1),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,b.Z.put("modules/".concat(j),{moduleName:n,moduleDescription:t})];case 2:return i=o.sent(),j===(null===(r=i.data)||void 0===r?void 0:r.id)&&ze(i.data,["moduleName","moduleDescription"]),[3,4];case 3:return o.sent(),[3,4];case 4:return X(!0),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Je=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:if(!B.user.id===(null===re||void 0===re?void 0:re.authorId))return[2];X(!1),se(!0),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,b.Z.delete("modules/".concat(j))];case 2:return e.sent(),R(j),[3,4];case 3:return e.sent(),[3,4];case 4:return Z(structuredClone(h).filter((function(e){return(null===e||void 0===e?void 0:e.id)!==j}))),p(structuredClone(u).filter((function(e){return(null===e||void 0===e?void 0:e.id)!==j}))),X(!0),se(!1),pe(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Qe=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:if(!B.user.id===(null===re||void 0===re?void 0:re.authorId))return[2];X(!1),se(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,b.Z.put("modules/".concat(j),{isPublic:!re.isPublic})];case 2:return n=t.sent(),j===(null===(e=n.data)||void 0===e?void 0:e.id)&&ze(n.data,["isPublic","isPending","isApproved"]),[3,4];case 3:return t.sent(),[3,4];case 4:return X(!0),se(!1),ge(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){if(ne(!1),null!==j){X(!1);var e=window.setTimeout((0,r.Z)((function(){var e,n,t,r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,b.Z.get("modules/".concat(j))];case 1:return n=i.sent(),ie(j===(null===(e=n.data)||void 0===e?void 0:e.id)?n.data:null),[3,3];case 2:return t=i.sent(),ie(null),404===(null===(r=t.response)||void 0===r?void 0:r.status)&&R(j),[3,3];case 3:return X(!0),[2]}}))})),ee.Z.delay.request);return function(){return window.clearTimeout(e)}}ie(null)}),[j]),(0,g.useEffect)((function(){null!==re&&(je("name",re.moduleName),je("description",re.moduleDescription))}),[re]);var en=function(){U.current&&U.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return(0,l.jsxs)(S.Z,{sx:{display:"flex",position:"relative",flexDirection:"column",alignItems:"center",width:"100%",height:"calc(100vh - 80px)"},children:[(0,l.jsxs)(S.Z,{sx:{position:"absolute",top:0,right:-6,zIndex:11,width:"100%",display:"flex",justifyContent:"space-between"},children:[(0,l.jsx)(S.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:!Q&&Y&&null!==re?(null===t||void 0===t?void 0:t.installedModuleId)!==(null===re||void 0===re?void 0:re.id)?(0,l.jsx)(I.Z,{"data-install":!0,variant:"contained",sx:{borderRadius:"1rem"},startIcon:(0,l.jsx)(N.Z,{}),size:"small",onClick:Ae,className:null===(null===t||void 0===t?void 0:t.installedModuleId)?"pop pop-rounded":null,children:W.t("Install module")}):(0,l.jsx)(ve,{}):null}),!Y||B.user.id!==(null===re||void 0===re?void 0:re.authorId)&&"founder"!==(null===(n=B.user)||void 0===n?void 0:n.userRole)?null:Q?(0,l.jsx)(I.Z,{onClick:en,sx:{mr:2,justifySelf:"end",mt:"5px"},variant:"contained",size:"small",color:"success",startIcon:(0,l.jsx)(Xe.Z,{}),children:W.t("Save")}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.Z,{sx:{mr:2,display:"flex",alignItems:"center"},children:[null!==re?(0,l.jsx)(fe.Z,{module:re,propagateModule:ze}):null,(0,l.jsx)(Te.Z,{sx:{width:"40px",height:"40px",ml:2},onClick:function(e){q(e.currentTarget)},children:(0,l.jsx)(Ke.Z,{fontSize:"small"})})]}),(0,l.jsxs)(He.Z,{anchorOrigin:{vertical:"bottom",horizontal:"left"},anchorEl:V,open:Boolean(V),onClose:Se,children:[(0,l.jsx)(Ue.Z,{onClick:function(){Se(),ne(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(S.Z,{sx:{display:"flex"},children:[(0,l.jsx)(qe.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:W.t("Edit module")})]})}),(0,l.jsx)(Ue.Z,{onClick:function(){Se(),ge(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(S.Z,{sx:{display:"flex"},children:[re.isPublic?(0,l.jsx)(Ye.Z,{fontSize:"small"}):(0,l.jsx)(Ge.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:re.isPublic?W.t("Unpublish module"):W.t("Publish module")})]})}),(0,l.jsx)(Be.Z,{}),(0,l.jsx)(Ue.Z,{onClick:function(){Se(),pe(!0)},sx:{justifyContent:"space-between"},children:(0,l.jsxs)(S.Z,{sx:{display:"flex"},children:[(0,l.jsx)(Ve.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:W.t("Delete module")})]})})]})]})]}),(0,l.jsx)(S.Z,{sx:{height:180,mt:10},children:Y?(0,l.jsx)(tn,{crop:"fill",previewWidth:180,previewHeight:180,borderWidth:0,borderColor:$.palette.background.paper,backgroundColor:$.palette.background.paper,inputName:"logo",uploadPath:"modules/".concat(j,"/logo"),active:Q,label:W.t("Select logo"),onChange:function(e){ze(e,["moduleLogoId"])},alt:W.t("Module logo"),getSrc:function(){return"string"===typeof(null===re||void 0===re?void 0:re.moduleLogoId)?"".concat(ce.Z.s3Url,"/modules/").concat(j,"/").concat(re.moduleLogoId,".png"):"/img/placeholder/module.png"}}):(0,l.jsx)(G.Z,{rounded:!0,sx:{width:"180px",height:"180px"}})}),(0,l.jsx)("form",{onSubmit:we(Pe),ref:U,style:{width:"100%",flexGrow:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:(0,l.jsxs)(l.Fragment,{children:[Y?Q?(0,l.jsxs)(We.Z,{fullWidth:!0,sx:{my:2,px:2},error:!!ke.name,children:[(0,l.jsx)(Me.Qr,{name:"name",control:be,render:function(e){var n=e.field,t=n.value,r=n.onChange;return(0,l.jsx)(Ie.Z,{autoFocus:!0,required:!0,value:t,onChange:r,onKeyDown:function(e){return"Enter"===e.key&&en()},spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{sx:{borderRadius:1},startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{mr:-2},children:(0,l.jsx)(E.Z,{fontSize:"small"})})},label:W.t("Module name"),placeholder:W.t("Module name"),error:Boolean(ke.name)})}}),ke.name&&(0,l.jsx)(Re.Z,{sx:{color:"error.main"},children:ke.name.message})]}):(0,l.jsxs)(S.Z,{sx:{my:4,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,l.jsx)(C.Z,{variant:"h4",sx:{textAlign:"center"},children:null!==re?re.moduleName:W.t("Module not found")}),(0,l.jsx)(S.Z,{children:(0,l.jsx)(O.Z,{title:Array.isArray(null===re||void 0===re?void 0:re.moduleReleases)&&re.moduleReleases.length?W.t("Latest release"):null,children:(0,l.jsx)(he.Z,{size:"small",variant:Array.isArray(null===re||void 0===re?void 0:re.moduleReleases)&&re.moduleReleases.length?"filled":"outlined",sx:{flexGrow:0,userSelect:"none"},label:Array.isArray(null===re||void 0===re?void 0:re.moduleReleases)&&re.moduleReleases.length?"v".concat(re.moduleReleases[re.moduleReleases.length-1].srcVersion):W.t("No releases")})})})]}):(0,l.jsx)(S.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,l.jsx)(G.Z,{spacing:0,sx:{width:"15rem",my:5,height:"0.75rem",display:"inline-block"}})}),(0,l.jsx)(S.Z,{sx:{overflowY:"auto",mr:"1px",px:2,pt:2},children:Y?(0,l.jsxs)(S.Z,{children:[null===re||!re.isPublic||re.isPending||re.isApproved||Q?null:(0,l.jsx)(_e.Z,{severity:"error",sx:{mb:2},children:(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",children:"string"===typeof re.reason&&re.reason.length?"".concat(W.t("Module rejected"),": ").concat(re.reason):W.t("Module rejected")})}),Q?(0,l.jsxs)(We.Z,{fullWidth:!0,error:!!ke.description,children:[(0,l.jsx)(Me.Qr,{name:"description",control:be,render:function(e){var n=e.field,t=n.value,r=n.onChange;return(0,l.jsx)(Ie.Z,{multiline:!0,minRows:6,maxRows:12,value:t,onChange:r,spellCheck:!1,autoComplete:"off",onKeyDown:function(e){return"Enter"===e.key&&e.ctrlKey&&en()},inputProps:{maxLength:1024,tabIndex:2,sx:{fontSize:"0.75rem"}},InputProps:{sx:{p:1,borderRadius:1}},label:W.t("Module description"),placeholder:W.t("Module description"),error:Boolean(ke.description)})}}),ke.description&&(0,l.jsx)(Re.Z,{sx:{color:"error.main"},children:ke.description.message})]}):(null===re||void 0===re?void 0:re.moduleDescription.length)?(0,l.jsx)(_e.Z,{severity:"info",sx:{whiteSpace:"pre-wrap",fontSize:"0.75rem"},children:re.moduleDescription}):(0,l.jsx)(_e.Z,{severity:"warning",sx:{height:"auto",fontSize:"0.75rem"},children:W.t("No description provided")})]}):(0,l.jsx)(G.Z,{sx:{mt:-2},count:3})})]})}),de?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return ae?pe(!1):null},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[ae?null:(0,l.jsx)(Fe.Z,{children:W.t("Delete module")}),(0,l.jsx)(Le.Z,{children:ae?(0,l.jsx)(G.Z,{}):(0,l.jsx)(_e.Z,{severity:"warning",children:W.t("Are you sure you want to delete this module?")})}),ae?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return pe(!1)},children:W.t("Cancel")}),(0,l.jsx)(I.Z,{color:"error",onClick:Je,startIcon:(0,l.jsx)(Ve.Z,{}),children:W.t("Delete module")})]})]}):null,me?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return ae?ge(!1):null},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[ae?null:(0,l.jsx)(Fe.Z,{children:(null===re||void 0===re?void 0:re.isPublic)?W.t("Unpublish module"):W.t("Publish module")}),(0,l.jsx)(Le.Z,{children:ae?(0,l.jsx)(G.Z,{}):re.isPublic||Array.isArray(null===re||void 0===re?void 0:re.moduleReleases)&&re.moduleReleases.length?(0,l.jsx)(_e.Z,{severity:"warning",children:re.isPublic?W.t("Are you sure you want to unpublish this module? It will no longer be available for install in the module repository."):W.t("This action will make your module public. Once approved, it will be available to others in the module repository.")}):(0,l.jsx)(_e.Z,{severity:"error",children:W.t("You cannot publish a module before releasing its source code.")})}),ae?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return ge(!1)},children:Array.isArray(null===re||void 0===re?void 0:re.moduleReleases)&&re.moduleReleases.length?W.t("Cancel"):W.t("OK")}),re.isPublic||Array.isArray(null===re||void 0===re?void 0:re.moduleReleases)&&re.moduleReleases.length?(0,l.jsx)(I.Z,{color:re.isPublic?"error":"primary",onClick:Qe,startIcon:re.isPublic?(0,l.jsx)(Ye.Z,{fontSize:"small"}):(0,l.jsx)(Ge.Z,{fontSize:"small"}),children:(null===re||void 0===re?void 0:re.isPublic)?W.t("Unpublish module"):W.t("Publish module")}):null]})]}):null]})},on=function(e){var n=e.agent,t=e.onClose,i=void 0===t?function(){}:t,a=e.onAgentUpdate,s=void 0===a?function(){}:a,u=(0,v.$)().i18n,c=(0,k.Z)(),p=(0,g.useState)(!1),f=p[0],h=p[1],x=(0,g.useState)(!1),m=x[0],y=x[1],Z=(0,g.useState)(""),j=Z[0],w=Z[1],C=(0,g.useState)([]),I=C[0],_=C[1],A=(0,g.useState)([]),T=A[0],z=A[1],P=(0,g.useState)(null),M=P[0],D=P[1],E=(0,g.useState)(""),N=E[0],R=E[1];(0,g.useEffect)((function(){var e;h(!1),D(null!==(e=null===n||void 0===n?void 0:n.installedModuleId)&&void 0!==e?e:null);var t=window.setTimeout((0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,b.Z.get("modules")];case 1:return e=n.sent(),Array.isArray(e.data)&&_(e.data),h(!0),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))})),2*ee.Z.delay.request);return function(){window.clearTimeout(t)}}),[]),(0,g.useEffect)((function(){y(!1);var e=window.setTimeout((0,r.Z)((function(){var e,n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:if(j.length>0&&j.length<3)return d.A.error(u.t("Search term must be at least 3 characters long")),y(!0),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),n="string"===typeof j&&j.length?{moduleName:j}:{},[4,b.Z.get("repo",{params:n})];case 2:return t=r.sent(),Array.isArray(null===(e=t.data)||void 0===e?void 0:e.modules)&&z(t.data.modules),[3,4];case 3:return r.sent(),[3,4];case 4:return y(!0),[2]}}))})),ee.Z.delay.request);return function(){window.clearTimeout(e)}}),[j]);var O={"":{label:"Repository",icon:(0,l.jsx)(te.Z,{}),content:(0,l.jsx)(Pe,{agent:n,moduleId:M,setModuleId:D,modulesLoaded:m,modules:T,searchModuleName:j,setSearchModuleName:w})},dev:{label:"My modules",icon:(0,l.jsx)(ne.Z,{}),content:(0,l.jsx)(Se,{agent:n,moduleId:M,setModuleId:D,modulesLoaded:f,modules:I,setModules:_})}};return(0,l.jsxs)(S.Z,{sx:{display:"flex",height:"100%"},children:[(0,l.jsx)(S.Z,{sx:{width:"100%",height:"100%",position:"relative"},children:(0,l.jsx)(Q,{tabs:O,hash:N,setHash:R})}),M?(0,l.jsx)(S.Z,{sx:{width:"375px",height:"100%",p:2,flexShrink:0,borderLeft:"1px solid ".concat(c.palette.divider)},children:(0,l.jsx)(rn,{agent:n,onClose:i,onAgentUpdate:s,publicModules:T,setPublicModules:z,privateModules:I,setPrivateModules:_,moduleId:M})}):null]})},ln=function(e){var n=e.agents,t=e.onAgentUpdate,r=void 0===t?function(){}:t,i=e.onOpen,o=void 0===i?function(){}:i,a=(0,x.O)(),s=a.getAgentId,u=a.onAgentId,d=a.getDialogVisible,p=a.setDialogVisible,f=a.onDialogVisible,h=(0,v.$)().i18n,m=(0,g.useState)((0,c.zu)(n,s())),y=m[0],Z=m[1],j=(0,g.useState)("string"===typeof(null===y||void 0===y?void 0:y.installedModuleId)),b=j[0],w=j[1],k=(0,g.useState)(!1),C=k[0],_=k[1];(0,g.useEffect)((function(){C&&"function"===typeof o&&o()}),[C]);var A,T=function(){p("repo",!1)};return(0,g.useEffect)((function(){w("string"===typeof(null===y||void 0===y?void 0:y.installedModuleId))}),[y]),(0,g.useEffect)((function(){Z((0,c.zu)(n,s()));var e=u((function(e){return Z((0,c.zu)(n,e))}));_(d("repo"));var t=f((function(e){var n=e.dialog,t=e.visible;return"repo"===n&&_(t)}));return function(){e(),t()}}),[n]),(0,l.jsxs)(D.ZP,{open:C,onClose:T,anchor:"right",sx:{"&.MuiDrawer-root":{top:0,bottom:0,left:250},"& .MuiBackdrop-root":{position:"absolute"},"& .MuiDrawer-paper":{width:"100%"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute",boxShadow:"none"}},children:[(0,l.jsx)(U,{sx:{position:"relative",zIndex:1,background:"transparent",px:4},icon:(0,l.jsx)(E.Z,{}),title:"".concat(h.t("Agent module")," - ").concat(null!==(A=null===y||void 0===y?void 0:y.name)&&void 0!==A?A:""),handleClose:T}),null!==(null===y||void 0===y?void 0:y.installedModuleId)||b?null:(0,l.jsxs)(S.Z,{sx:{position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"hidden",zIndex:0},children:[(0,l.jsx)($.Z,{className:"zoom-in"}),(0,l.jsx)($.Z,{className:"zoom-in",sx:{animationDelay:"2s"}})]}),(0,l.jsx)(B,{sx:{position:"relative",zIndex:1,p:0},children:b?(0,l.jsx)(on,{agent:y,onAgentUpdate:r,onClose:T}):(0,l.jsxs)(S.Z,{sx:{position:"relative",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",flexDirection:"column"},children:[(0,l.jsx)(E.Z,{sx:{width:"192px",height:"192px",mt:6},className:"rotate"}),(0,l.jsx)(I.Z,{sx:{mt:12},size:"large",autoFocus:!0,startIcon:(0,l.jsx)(N.Z,{}),onClick:function(){return w(!0)},variant:"contained",className:"pop",children:h.t("Install module")})]})})]})},an=t(72852),sn=t(53917),un=t(77849),cn=t(23488),dn=t(49897),pn=function(e,n){return!!(null===e||void 0===e?void 0:e.installedModuleId)||Array.isArray(null===n||void 0===n?void 0:n.srcInputs)&&n.srcInputs.length>0||Array.isArray(null===n||void 0===n?void 0:n.srcOutputs)&&n.srcOutputs.length>0||Array.isArray(null===n||void 0===n?void 0:n.srcFunctions)&&n.srcFunctions.length>0||Array.isArray(null===n||void 0===n?void 0:n.srcStateMachine)&&n.srcStateMachine.length>0};function fn(e){var n=e.agents,t=e.onSelect,i=void 0===t?function(){}:t,a=e.onUpdate,s=void 0===a?function(){}:a,u=e.onDelete,d=void 0===u?function(){}:u,p=e.showLoading,f=void 0===p?async function(){}:p,h=(0,v.$)().i18n,m=(0,x.O)(),y=m.getAgentId,Z=m.onAgentId,j=m.getLogsEnabled,b=m.onLogsEnabled,w=m.setLogsEnabled,k=m.getSource,A=m.onSource,T=m.onDialogVisible,z=m.getDialogVisible,P=m.setDialogVisible,M=m.onModuleUpdate,D=m.getInstalled,N=(0,g.useState)(!0),R=N[0],L=N[1],F=(0,g.useState)(!1),W=F[0],U=F[1],B=(0,g.useState)(null),$=B[0],H=B[1],V=(0,g.useState)(null),q=V[0],K=V[1],Y=(0,g.useState)(!0),G=Y[0],X=Y[1],J=(0,g.useState)(null),Q=J[0],ee=J[1],ne=(0,g.useState)(!1),te=ne[0],re=ne[1];(0,g.useEffect)((function(){re(j());var e=b((function(e){return re(e)}));if(null!==Q){(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,k(y(),!0)];case 1:return e=t.sent(),U((null!==(n=null===e||void 0===e?void 0:e.srcStateMachine)&&void 0!==n?n:[]).length>0),L(pn(Q,e)),[2]}}))}))();var n,t=D(Q.id),i=t.module,l=t.moduleVersion;H((0,c.kq)(null!==(n=null===i||void 0===i?void 0:i.moduleName)&&void 0!==n?n:null,l))}var a=A((function(e){var n,t=e.agentId,r=e.sourceCode;t===(null===Q||void 0===Q?void 0:Q.id)&&(U((null!==(n=null===r||void 0===r?void 0:r.srcStateMachine)&&void 0!==n?n:[]).length>0),L(pn(Q,r)))})),s=M((function(e){var n=e.module;if("string"===typeof(null===Q||void 0===Q?void 0:Q.installedModuleId)&&(null===Q||void 0===Q?void 0:Q.installedModuleId)===(null===n||void 0===n?void 0:n.id)){var t,r=D(Q.id).moduleVersion;H((0,c.kq)(null!==(t=n.moduleName)&&void 0!==t?t:null,r))}}));X(!z());var u=T((function(){X(!z())}));return function(){e(),a(),s(),u()}}),[Q]),(0,g.useEffect)((function(){ee((0,c.zu)(n,y()));var e=Z((function(e){return ee((0,c.zu)(n,e))}));return function(){e()}}),[n]);var ie=function(){K(null)},oe=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return null===Q?[3,3]:[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.source.open(Q.id)];case 1:return n.sent()?[4,f()]:[3,3];case 2:n.sent(),n.label=3;case 3:return ie(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),le=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){return e.preventDefault(),e.stopPropagation(),w(null===Q||void 0===Q?void 0:Q.id,!te),ie(),[2]}))}));return function(n){return e.apply(this,arguments)}}();return null!==Q?(0,l.jsxs)(S.Z,{children:[(0,l.jsx)(O.Z,{title:h.t("Agent module"),placement:"left",children:(0,l.jsx)(I.Z,{color:"inherit",size:"small",startIcon:(0,l.jsx)(E.Z,{sx:{width:"24px",height:"24px"}}),sx:{textTransform:"none",mr:2},className:G&&!R?"pop pop-inset":null,"data-modules-toggle":!0,onClick:function(){null!==Q&&(P("repo",!z("repo")),i(Q.id,!0)),window.setTimeout((function(){var e;return null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.focus()}),250)},children:(0,l.jsx)(C.Z,{variant:"caption",sx:{color:"inherit",maxWidth:"200px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"0.75rem",fontFamily:"Yaldevi,sans-serif"},children:null===$?R?h.t("No module installed"):h.t("Install module"):$})})}),(0,l.jsxs)(Te.Z,{sx:{width:"40px",height:"40px",mr:2,position:"relative"},onClick:function(e){K(e.currentTarget),null!==Q&&i(Q.id,!0)},children:[(0,l.jsx)(Ke.Z,{}),null===$||W||q?null:(0,l.jsx)(cn.Z,{sx:{position:"absolute",top:-1,right:-8},color:"warning"})]}),(0,l.jsxs)(He.Z,{anchorEl:q,open:Boolean(q),onClose:ie,children:[(0,l.jsx)(O.Z,{title:h.t("Toggle the capturing of agent logs on this device"),placement:"left",children:(0,l.jsxs)(Ue.Z,{onClick:le,sx:{justifyContent:"space-between"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex"},children:[(0,l.jsx)(_.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:h.t("Agent logs")})]}),(0,l.jsx)(an.Z,{size:"small",sx:{ml:3},checked:te,defaultValue:te})]})}),(0,l.jsx)(O.Z,{title:W?null:h.t("Add one state to make this agent playable"),placement:"left",children:(0,l.jsxs)(Ue.Z,{onClick:oe,className:null===$||W?null:"pop pop-inset",sx:{"&.pop:after":{inset:"5px"}},children:[(0,l.jsx)(sn.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:h.t("Source code")})]})}),(0,l.jsxs)(Ue.Z,{onClick:function(){var e;null!==Q&&(null===(e=window.sdk)||void 0===e||e.ipc.target.openDevTools(Q.id,Q.name));ie()},children:[(0,l.jsx)(dn.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:h.t("Developer tools")})]}),(0,l.jsx)(Be.Z,{}),(0,l.jsxs)(Ue.Z,{onClick:function(){s(),ie()},children:[(0,l.jsx)(un.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:h.t("Rename agent")})]}),(0,l.jsxs)(Ue.Z,{onClick:function(){d(),ie()},children:[(0,l.jsx)(Ve.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:h.t("Delete agent")})]})]})]}):null}var hn,xn=t(74496),mn=t(34733),vn=t(98005),gn=t(87422),yn=t(28832),Zn=t(91711),jn=t(34253),bn=t(39748),wn=(0,w.ZP)(S.Z)((function(e){var n,t=e.theme,r=e.color,i=void 0===r?"primary":r,o=e.percent,l=void 0===o?0:o;return{position:"absolute",top:"5px",left:"5px",borderRadius:"5px",width:"5px",height:"40px",background:t.palette.divider,"&:before":{content:'""',display:"block",position:"absolute",borderRadius:"5px",bottom:0,left:0,width:"100%",height:"".concat(l,"%"),minHeight:"5px",transformOrigin:"50% 100%",background:null!==(hn=null===(n=t.palette[i])||void 0===n?void 0:n.main)&&void 0!==hn?hn:t.palette.primary.main,transition:"transform 200ms linear"}}})),kn=function(e){var n=e.type,t=void 0===n?"chip":n,r=(0,x.O)(),i=r.onSubscription,o=r.getSubscription,a=(0,g.useState)({}),s=a[0],u=a[1],c=(0,v.$)().i18n,d=(0,m.a)();(0,g.useEffect)((function(){u(o());var e=i((function(e){var n=e.info;u(n)}));return function(){e()}}),[]);var p,f=s.active&&"pilot"===s.status&&s.pilotTotal>0&&100*s.pilotLeft/s.pilotTotal<=33;if("chip"===t){var h,y,Z,j,b,w=(null===(h=d.user)||void 0===h?void 0:h.computerEnabled)?s.active?"pilot"===s.status?f?c.t("Your free trial is almost over"):c.t("Free trial"):c.t("Active subscription"):null:c.t("Computer disabled");return s.ready?(0,l.jsx)(O.Z,{title:w,placement:"right",children:(0,l.jsx)(he.Z,{size:"small",color:(null===(y=d.user)||void 0===y?void 0:y.computerEnabled)?s.active?"pilot"===s.status?f?"warning":"success":ce.Z.billing.subscriptionStatus.pastDue===s.status?"warning":"default":"warning":"error",label:(null===(Z=d.user)||void 0===Z?void 0:Z.computerEnabled)?s.active?"pilot"===s.status?c.t("Free trial"):null!==(b=null===(j=s.pricePlan)||void 0===j?void 0:j.productName)&&void 0!==b?b:"Zen":c.t("Locked"):c.t("Disabled"),variant:s.active&&!["pilot",ce.Z.billing.subscriptionStatus.pastDue].includes(s.status)?"outlined":"filled",sx:{height:"1.2rem",fontSize:"0.75rem",fontFamily:"Yaldevi,sans-serif",textTransform:"none"}})}):null}if("progress"===t)return(null===(p=d.user)||void 0===p?void 0:p.computerEnabled)&&s.ready&&s.active&&"pilot"===s.status&&Number.isInteger(s.pilotTotal)&&s.pilotTotal>0?(0,l.jsx)(wn,{color:f?"warning":"success",percent:Math.round(100*s.pilotLeft/s.pilotTotal)}):null;if("label"===t){var k,I,_,A,T,z,P=(T={},(0,H.Z)(T,ce.Z.billing.subscriptionStatus.active,c.t("active")),(0,H.Z)(T,ce.Z.billing.subscriptionStatus.cancelled,c.t("cancelled")),(0,H.Z)(T,ce.Z.billing.subscriptionStatus.onTrial,c.t("on trial")),(0,H.Z)(T,ce.Z.billing.subscriptionStatus.pastDue,c.t("past due")),(0,H.Z)(T,ce.Z.billing.subscriptionStatus.unpaid,c.t("unpaid")),(0,H.Z)(T,ce.Z.billing.subscriptionStatus.paused,c.t("paused")),(0,H.Z)(T,ce.Z.billing.subscriptionStatus.expired,c.t("expired")),T);return(0,l.jsx)(O.Z,{title:(null===(k=d.user)||void 0===k?void 0:k.computerEnabled)?s.active?"pilot"===s.status?c.t("Review pricing plans before your trial expires"):ce.Z.billing.subscriptionStatus.pastDue===s.status?c.t("Click to fix billing issue"):null:c.t("Unlock by upgrading to a paid plan"):c.t("Click to enable this computer"),placement:"bottom",children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(null===(I=d.user)||void 0===I?void 0:I.computerEnabled)?s.active?"pilot"===s.status?(0,l.jsx)(bn.Z,{fontSize:"small",color:f?"warning":"inherit"}):ce.Z.billing.subscriptionStatus.pastDue===s.status?(0,l.jsx)(Zn.Z,{fontSize:"small",color:"warning"}):(0,l.jsx)(yn.Z,{fontSize:"small"}):(0,l.jsx)(gn.Z,{fontSize:"small",color:"warning"}):(0,l.jsx)(jn.Z,{color:"error"}),(0,l.jsx)(C.Z,{color:(null===(_=d.user)||void 0===_?void 0:_.computerEnabled)?s.active?"pilot"===s.status?"inherit":ce.Z.billing.subscriptionStatus.pastDue===s.status?"warning.main":"inherit":"warning.main":"error.main",variant:"caption",sx:{ml:3},children:(null===(A=d.user)||void 0===A?void 0:A.computerEnabled)?s.active?"pilot"===s.status?c.t("Expires in: {{time}}",{time:["".concat(Math.floor(s.pilotLeft/3600),"h"),"".concat(Math.floor(s.pilotLeft%3600/60),"m")].join(", ")}):ce.Z.billing.subscriptionStatus.pastDue===s.status?c.t("Pay overdue invoice"):"".concat(c.t("Manage billing")," (").concat(null!==(z=P[s.status])&&void 0!==z?z:s.status,")"):c.t("Purchase to unlock"):c.t("Computer disabled")})]})})}return null},Sn=function(e){return e&&("TEXTAREA"===e.nodeName||"INPUT"===e.nodeName)},Cn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,g.useRef)(null),t=function(){e.onSuccess&&e.onSuccess(),e.selectOnCopy&&Sn(n.current)&&n.current.select()},r=function(){e.onError&&e.onError(),!1!==e.selectOnError&&Sn(n.current)&&n.current.select()},i=function(e){ie()(e).then(t).catch(r)},o=(0,g.useCallback)((function(e){"string"===typeof e?i(e):n.current&&i(n.current.value)}),[]);return{copy:o,target:n}},In=t(87086),_n=t(39918),An=t(44737),Tn=t(73993),zn=t(73896),Pn=t(58086),Mn=t(58929),Dn=t(90738),En=t(78687),Nn=t(66140),Rn=t(61730),On=(0,w.ZP)(S.Z)((function(e){var n=e.theme,t=e.size,r=void 0===t?"small":t;return{background:n.palette.background.paper,justifyContent:"center",alignItems:"center",display:"flex",boxShadow:n.shadows[3],borderRadius:"small"===r?"0.4rem":"1rem",fontSize:"small"===r?"0.85rem":"3rem",marginRight:"small"===r?"0px":"2px",marginLeft:"small"===r?"1px":"2px",height:"small"===r?"2rem":"5rem",width:"small"===r?"1.1rem":"3rem"}}));function Ln(e){var n=e.subInfo,t=void 0===n?{}:n,r=e.sx,o=void 0===r?{}:r,a=e.small,s=void 0!==a&&a,u=(0,k.Z)(),c=(0,Rn.Z)(u.breakpoints.up("sm")),d=(0,g.useState)(null),p=d[0],f=d[1];"object"===typeof o&&null!==o||(o={}),(0,g.useEffect)((function(){var e=null;return Number.isInteger(t.pilotLeft)&&t.pilotLeft>0&&(f(t.pilotLeft),e=setInterval((function(){f((function(e){return e-1}))}),1e3)),function(){return null!==e&&clearInterval(e)}}),[t.pilotLeft]);var h=t.pilotLeft>0&&(t.planComputersCount>0&&t.computersCount>t.planComputersCount||t.planAgentsCount>0&&t.agentsCount>t.planAgentsCount),x=(c||!s?"00:00:00":"00:00").split("");return"number"===typeof p&&p>0&&(x=[Math.floor(p/3600),Math.floor(p%3600/60)].concat((0,i.Z)(c||!s?[Math.floor(p%60)]:[])).map((function(e){return"".concat(e).padStart(2,"0")})).join(":").split("")),t.active&&"pilot"===t.status||h?(0,l.jsx)(S.Z,{sx:(0,R.Z)({display:"flex",justifyContent:"space-between"},o),children:x.map((function(e,n){return(0,l.jsx)(On,{size:s?"small":"large",children:e},n)}))}):null}var Fn=(0,w.ZP)(S.Z)((function(e){e.theme;return{position:"absolute",left:"-2rem",bottom:"-5rem",width:"25rem",height:"25rem",zIndex:1,opacity:.1,"&>svg":{position:"relative",width:"100%",height:"100%"}}})),Wn=(0,w.ZP)("pre")((function(e){var n=e.theme;return{backgroundColor:n.palette.divider,padding:n.spacing(2),marginTop:0,marginBottom:0,color:n.palette.text.primary,marginRight:n.spacing(2),borderRadius:n.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}}));function Un(e){var n,t,a,s,u,c,p=e.isOpen,f=void 0!==p&&p,h=e.onClose,y=void 0===h?function(){}:h,Z=(0,x.O)(),b=Z.onSubscription,w=Z.getSubscription,k=(0,v.$)().i18n,_=Cn(),A=(0,m.a)(),T=(0,g.useState)(null),z=T[0],P=T[1],M=(0,g.useState)({}),D=M[0],E=M[1],N=(0,g.useState)(!1),R=N[0],L=N[1];(0,g.useEffect)((function(){E(w());var e=b((function(e){var n=e.info;E(n)}));return(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.device.getSerialNumber()];case 1:return P.apply(void 0,[n.sent()]),[2]}}))}))(),L(!0),function(){return e()}}),[]);var F=function(){f&&"function"===typeof y&&y()},W=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){return d.A.info(k.t("Copied computer serial number to clipboard"),null,!1),_.copy(e),[2]}))}));return function(n){return e.apply(this,arguments)}}(),U=function(){var e=(0,r.Z)((function(){var e,n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return F(),d.A.info((null===(e=A.user)||void 0===e?void 0:e.computerEnabled)?k.t("Navigating to billing page..."):k.t("Navigating to my computers..."),null,!1),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.main.openExternal((null===(t=A.user)||void 0===t?void 0:t.computerEnabled)?"".concat(ce.Z.siteUrl,"/profile/#/tab:billing"):"".concat(ce.Z.siteUrl,"/#/tab:computers"))];case 1:return r.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),B=[{key:"computersCount",labelSingular:k.t("computer"),labelPlural:k.t("computers"),count:D.computersCount,max:j().max.computersCount,boostedCount:D.planComputersCount,boostedTooltip:k.t("You can use this extra computer until the trial ends"),Icon:En.Z},{key:"agentsCount",labelSingular:k.t("agent per computer"),labelPlural:k.t("agents per computer"),count:D.agentsCount,max:j().max.agentsCount,boostedCount:D.planAgentsCount,boostedTooltip:k.t("You can use this extra agent until the trial ends"),Icon:Tn.Z}],$=Math.max(j().max.computersCount,j().max.agentsCount),H=D.pilotLeft>0&&(D.planComputersCount>0&&D.computersCount>D.planComputersCount||D.planAgentsCount>0&&D.agentsCount>D.planAgentsCount),V=!(null===(n=A.user)||void 0===n?void 0:n.computerEnabled)||!D.active||ce.Z.billing.subscriptionStatus.pastDue===D.status;return f&&R?(0,l.jsxs)($e.Z,{open:!0,onClose:F,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(Fn,{className:"rotate",children:(null===(t=A.user)||void 0===t?void 0:t.computerEnabled)?D.active?"pilot"===D.status?(0,l.jsx)(Mn.Z,{color:"info"}):ce.Z.billing.subscriptionStatus.pastDue===D.status?(0,l.jsx)(An.Z,{color:"warning"}):H?(0,l.jsx)(_n.Z,{color:"success"}):(0,l.jsx)(In.Z,{color:"success"}):(0,l.jsx)(Nn.Z,{color:"warning"}):(0,l.jsx)(jn.Z,{})}),(0,l.jsxs)(Fe.Z,{children:[(null===(a=A.user)||void 0===a?void 0:a.computerEnabled)?D.active?"pilot"===D.status?k.t("Free trial"):ce.Z.billing.subscriptionStatus.pastDue===D.status?k.t("Invoice past due"):k.t("Active subscription"):k.t("Subscription required"):k.t("Computer disabled"),H?" (".concat(k.t("boosted"),")"):null]}),(0,l.jsx)(Le.Z,{sx:{my:6,position:"relative",zIndex:2},children:(null===(s=A.user)||void 0===s?void 0:s.computerEnabled)?D.active?(0,l.jsxs)(S.Z,{children:["pilot"!==D.status&&ce.Z.billing.subscriptionStatus.pastDue===D.status?(0,l.jsx)(_e.Z,{severity:"warning",sx:{mb:6},children:k.t("Invoice past due. Please fix this issue to avoid service interruption.")}):null,"pilot"===D.status||H?(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",userSelect:"none",mb:6},children:[(0,l.jsx)(Ln,{subInfo:D,sx:{mb:6}}),(0,l.jsx)(C.Z,{variant:"body2",children:k.t("Free trial limits expire soon")})]}):null,B.map((function(e){return(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:3},children:[(0,l.jsx)(S.Z,{sx:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",mr:6},children:(0,i.Z)(Array($).keys()).map((function(n){var t=H&&n>=e.boostedCount;return n<e.count?(0,l.jsx)(O.Z,{placement:"top",title:t?e.boostedTooltip:null,children:(0,l.jsx)(e.Icon,{className:t?"zoom-in":null,color:t?"success":"inherit"})},n):(0,l.jsx)(Pn.Z,{sx:{opacity:n<e.max?1:0}},n)}))}),(0,l.jsx)(S.Z,{sx:{minWidth:"10rem",textAlign:"right"},children:(0,l.jsxs)(C.Z,{variant:"body2",color:"text.secondary",children:[(0,l.jsx)("b",{children:e.count})," ",1===e.count?e.labelSingular:e.labelPlural]})})]},e.key)}))]}):(0,l.jsx)(_e.Z,{icon:(0,l.jsx)(zn.Z,{}),severity:"warning",variant:"filled",children:k.t("To continue using the software, please upgrade to a paid plan.")}):(0,l.jsxs)(_e.Z,{severity:"info",icon:(0,l.jsx)(jn.Z,{}),sx:{"&>.MuiAlert-message":{width:"100%"}},children:[(0,l.jsx)(C.Z,{variant:"body2",sx:{color:"inherit",width:"100%"},children:k.t("Please go to your dashboard and enable computer with serial number:")}),(0,l.jsxs)(S.Z,{display:"flex",sx:{width:"100%",justifyContent:"center",alignItems:"center",my:3},children:[(0,l.jsx)(O.Z,{title:k.t("The computer serial number is an anonymized unique hash that you can use to identify this computer in your online dashboard."),placement:"top",children:(0,l.jsx)(Wn,{children:z})}),(0,l.jsx)(O.Z,{title:k.t("Click to copy"),placement:"top",children:(0,l.jsx)(Te.Z,{onClick:function(){return W(z)},children:(0,l.jsx)(Dn.Z,{fontSize:"small"})})})]})]})}),(0,l.jsxs)(Oe.Z,{sx:{position:"relative",zIndex:2},children:[(0,l.jsx)(I.Z,{startIcon:(null===(u=A.user)||void 0===u?void 0:u.computerEnabled)?(0,l.jsx)(yn.Z,{}):(0,l.jsx)(En.Z,{}),onClick:U,color:D.active?"primary":"warning",className:V?"pop":null,variant:"contained",children:(null===(c=A.user)||void 0===c?void 0:c.computerEnabled)?k.t("Go to billing"):k.t("Go to my computers")}),(0,l.jsx)(I.Z,{color:"secondary",onClick:F,children:k.t("Close")})]})]}):null}var Bn=t(7297),$n=t(70917),Hn=t(94399);function Vn(){var e=(0,Bn.Z)(["\n0%   { transform: scale(0.2); opacity: 0; }\n100% { transform: scale(1); opacity: 1; }"]);return Vn=function(){return e},e}var qn=(0,$n.F4)(Vn()),Kn=(0,w.ZP)(Hn.Z)((function(e){e.theme;return{position:"absolute",right:"-10rem",bottom:"-10rem",width:"35rem",height:"35rem",zIndex:1,opacity:.1}})),Yn=(0,w.ZP)("pre")((function(e){var n=e.theme;return{backgroundColor:n.palette.divider,padding:n.spacing(2),marginTop:0,marginBottom:0,marginRight:n.spacing(2),borderRadius:n.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}})),Gn=(0,w.ZP)(se.ZP)((function(e){e.theme;var n=e.index,t=void 0===n?0:n;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(qn," 750ms ease-in-out forwards"),animationDelay:"".concat(100*t,"ms")}})),Xn=function(e){var n=e.isOpen,t=void 0!==n&&n,r=e.onOpen,i=void 0===r?function(){}:r,o=e.onClose,a=void 0===o?function(){}:o,s=(0,v.$)().i18n;(0,g.useEffect)((function(){t&&"function"===typeof i&&i()}),[t]);var u=function(){t&&"function"===typeof a&&a()},c=[{key:"w",name:s.t("Web browser tab")},{key:"[1...9]",name:s.t("Select agent")},{key:"e",name:s.t("Settings tab")},{key:".",name:s.t("Start/Stop current agent")},{key:"r",name:s.t("Results tab")},{key:"u",name:s.t("Source code")},{key:"t",name:s.t("Triggers tab")},{key:"i",name:s.t("Developer tools")},{key:"m",name:s.t("Module panel")},{key:"l",name:s.t("Logs panel")},{key:"Esc",name:s.t("Close dialogs")}];return t?(0,l.jsxs)($e.Z,{open:!0,onClose:u,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(Kn,{color:"action",className:"rotate"}),(0,l.jsx)(Fe.Z,{sx:{position:"relative",zIndex:2},children:s.t("Keyboard shortcuts")}),(0,l.jsx)(Le.Z,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(se.ZP,{container:!0,children:c.map((function(e,n){return(0,l.jsx)(Gn,{xs:6,item:!0,index:n,children:(0,l.jsxs)(S.Z,{sx:{display:"flex",mb:2,alignItems:"center"},children:[(0,l.jsxs)(Yn,{children:["Esc"!==e.key?"Ctrl+":"",1===e.key.length?e.key.toUpperCase():e.key]}),(0,l.jsx)(C.Z,{variant:"body2",sx:{mx:2},children:e.name})]})},"".concat(n,"-").concat(e.key))}))})}),(0,l.jsx)(Oe.Z,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(I.Z,{color:"secondary",onClick:u,children:s.t("Close")})})]}):null},Jn=t(70891),Qn=t(78462),et=t(14347),nt=t(34869),tt=t(71639),rt=t(46628),it=t(1878),ot=t(65025),lt=t(84885),at=t(77381);function st(){var e=(0,Bn.Z)(["\n0%   { transform: scale(0.2); opacity: 0; }\n100% { transform: scale(1); opacity: 1; }"]);return st=function(){return e},e}function ut(){var e=(0,Bn.Z)(["\n0%   { transform: scale(0.1) translateY(10rem); opacity: 0; }\n100% { transform: scale(1) translateY(0); opacity: 1; }"]);return ut=function(){return e},e}var ct=(0,$n.F4)(st()),dt=(0,$n.F4)(ut()),pt=(0,w.ZP)(ot.Z)((function(e){e.theme;return{position:"absolute",right:"-10rem",bottom:"-10rem",width:"35rem",height:"35rem",zIndex:1,opacity:.1}})),ft=(0,w.ZP)("pre")((function(e){var n=e.theme;return{backgroundColor:n.palette.divider,padding:n.spacing(2),marginTop:0,marginBottom:0,marginRight:n.spacing(2),borderRadius:n.shape.borderRadius,fontSize:"0.85rem",lineHeight:"0.85rem",fontFamily:"Inconsolata,monospace"}})),ht=(0,w.ZP)(I.Z)((function(e){e.theme;var n=e.index,t=void 0===n?0:n;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(dt," 750ms ease-in-out forwards"),animationDelay:"".concat(100*t,"ms")}})),xt=(0,w.ZP)(Jn.ZP)((function(e){e.theme;var n=e.index,t=void 0===n?0:n;return{transformOrigin:"0% 50%",opacity:0,animation:"".concat(ct," 750ms ease-in-out forwards"),animationDelay:"".concat(100*t,"ms")}})),mt=function(e){var n=e.isOpen,t=void 0!==n&&n,i=e.onOpen,a=void 0===i?function(){}:i,s=e.onClose,u=void 0===s?function(){}:s,c=(0,v.$)().i18n,p=Cn(),f=(0,g.useState)({}),h=f[0],x=f[1];(0,g.useEffect)((function(){t&&"function"===typeof a&&a()}),[t]),(0,g.useEffect)((function(){var e=setTimeout((0,r.Z)((function(){var e,n,t,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=ce.Z.version,[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.getProcessVersions()];case 1:return r=o.sent(),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.device.getSerialNumber()];case 2:return i=o.sent(),x((0,Je.Z)((0,R.Z)({},r),{app:t,serialNumber:i})),[2]}}))})),150);return function(){return clearTimeout(e)}}),[]);var m,y,Z,j,b,w=function(){t&&"function"===typeof u&&u()},k=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return d.A.info(c.t("Navigating to licenses..."),null,!1),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.openExternal("https://github.com/oglama/oglama/blob/main/NOTICE.md")];case 1:return n.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return d.A.info(c.t("Navigating to status page..."),null,!1),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.openExternal("https://status.oglama.com/")];case 1:return n.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return d.A.info(c.t("Navigating to Terms of Service..."),null,!1),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.openExternal("".concat(ce.Z.siteUrl,"/terms-of-service/"))];case 1:return n.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),A=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return d.A.info(c.t("Navigating to my computers..."),null,!1),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.openExternal("".concat(ce.Z.siteUrl,"/#/tab:computers"))];case 1:return n.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),T=[{icon:(0,l.jsx)(En.Z,{color:"inherit",fontSize:"large"}),key:"serialNumber",name:c.t("Serial Number"),version:null!==(m=h.serialNumber)&&void 0!==m?m:null,tooltip:c.t("The computer serial number is an anonymized unique hash that you can use to identify this computer in your online dashboard.")},{icon:(0,l.jsx)(rt.Z,{color:"warning",fontSize:"large"}),key:"chrome",name:"Chromium",version:null!==(y=h.chrome)&&void 0!==y?y:null},{icon:(0,l.jsx)(nt.Z,{color:"primary",fontSize:"large"}),key:"electron",name:"Electron.js",version:null!==(Z=h.electron)&&void 0!==Z?Z:null},{icon:(0,l.jsx)(lt.Z,{color:"success",fontSize:"large"}),key:"node",name:"Node.js",version:null!==(j=h.node)&&void 0!==j?j:null},{icon:(0,l.jsx)(at.Z,{size:35,animate:!0}),key:"oglama",name:"Oglama",version:null!==(b=h.app)&&void 0!==b?b:null}];return t?(0,l.jsxs)($e.Z,{open:!0,onClose:w,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2,overflow:"hidden"}},children:[(0,l.jsx)(pt,{color:"action",className:"rotate"}),(0,l.jsx)(Fe.Z,{sx:{position:"relative",zIndex:2},children:c.t("About Oglama")}),(0,l.jsx)(Le.Z,{sx:{position:"relative",zIndex:2},children:(0,l.jsx)(Qn.Z,{children:T.map((function(e,n){var t;return(0,l.jsxs)(xt,{index:n,children:[e.icon,(0,l.jsx)(C.Z,{variant:"body2",sx:{mx:2},children:e.name}),e.version?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.Z,{title:null!==(t=e.tooltip)&&void 0!==t?t:null,placement:"top",children:(0,l.jsx)(ft,{children:e.version})}),(0,l.jsx)(O.Z,{title:c.t("Click to copy"),placement:"top",children:(0,l.jsx)(Te.Z,{onClick:function(){return n=e.key,t=e.name,r=e.version,d.A.info("serialNumber"===n?c.t("Copied computer serial number to clipboard"):c.t("Copied {{name}} version to clipboard",{name:t}),null,!1),void p.copy("serialNumber"===n?r:"".concat(t," v").concat(r));var n,t,r},children:(0,l.jsx)(Dn.Z,{fontSize:"small"})})}),"serialNumber"===e.key?(0,l.jsx)(O.Z,{title:c.t("Go to my computers"),placement:"top",children:(0,l.jsx)(Te.Z,{onClick:function(){return A()},children:(0,l.jsx)(oe.Z,{fontSize:"small"})})}):null]}):(0,l.jsx)(G.Z,{sx:{width:"15rem",mt:2},spacing:0})]},"".concat(n,"-").concat(e.key))}))})}),(0,l.jsxs)(Oe.Z,{sx:{position:"relative",zIndex:2},children:[(0,l.jsx)(ht,{index:5,onClick:k,startIcon:(0,l.jsx)(it.Z,{}),children:c.t("Licenses")}),(0,l.jsx)(ht,{index:6,onClick:S,startIcon:(0,l.jsx)(et.Z,{}),children:c.t("Contact & Status")}),(0,l.jsx)(ht,{index:7,onClick:_,startIcon:(0,l.jsx)(tt.Z,{}),children:c.t("Terms")}),(0,l.jsx)(I.Z,{color:"secondary",onClick:w,children:c.t("Close")})]})]}):null},vt=(0,w.ZP)(He.Z)((function(e){var n=e.theme;return{"& .MuiMenu-paper":(0,H.Z)({width:280,overflow:"hidden",marginTop:n.spacing(4)},n.breakpoints.down("sm"),{width:"100%"}),"& .MuiMenu-list":{padding:0}}})),gt=function(){var e=(0,x.O)().checkSubscription,n=(0,v.$)().i18n,t=(0,m.a)(),i=(0,g.useState)(!1),a=i[0],s=i[1],u=(0,g.useState)(!1),c=u[0],d=u[1],p=(0,g.useState)(!1),f=p[0],h=p[1],y=(0,g.useState)(null),Z=y[0],j=y[1],b=(0,g.useState)(0),w=b[0],k=b[1],_=function(){var n=(0,r.Z)((function(n){var r,i;return(0,o.__generator)(this,(function(o){return null===(r=window.sdk)||void 0===r||r.ipc.main.setOnTop(),j(n.currentTarget),(i=Math.floor((new Date).getTime()/1e3))-w>=5&&(k(i),e(t,!0)),[2]}))}));return function(e){return n.apply(this,arguments)}}(),A=function(){return j(null)},T=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return A(),s(!0),[2]}))}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return A(),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),h(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return A(),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),d(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}();return t.user?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(I.Z,{onClick:_,fullWidth:!0,sx:{userSelect:"none",transition:"none",borderRadius:0,justifyContent:"space-between",alignItems:"center",height:"100%",position:"relative"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 25px)"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[(0,l.jsx)(at.Z,{size:24,sx:{mx:1,transition:"all 200ms linear"}}),(0,l.jsx)(C.Z,{variant:"body2",sx:{textTransform:"none",mx:2},children:ee.Z.moduleName})]}),(0,l.jsx)(kn,{type:"chip"})]}),(0,l.jsx)(kn,{type:"progress"}),(0,l.jsx)(z,{sx:{flexShrink:0},open:!!Z,children:(0,l.jsx)(vn.Z,{color:"action"})})]}),(0,l.jsxs)(vt,{sx:{mt:-2,width:"250px"},anchorEl:Z,"aria-disabled":"true",open:Boolean(Z),onClose:function(){return A()},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[(0,l.jsx)(Ue.Z,{onClick:function(){return T()},children:(0,l.jsx)(kn,{type:"label"})}),(0,l.jsx)(Ue.Z,{onClick:function(){return M()},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(0,l.jsx)(mn.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{variant:"caption",sx:{ml:3},children:n.t("Keyboard shortcuts")})]})}),(0,l.jsx)(Ue.Z,{onClick:function(){return P()},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%",py:2},children:[(0,l.jsx)(xn.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{variant:"caption",sx:{ml:3},children:n.t("About")})]})})]}),a?(0,l.jsx)(Un,{isOpen:!0,onClose:function(){return s(!1)}}):null,c?(0,l.jsx)(Xn,{isOpen:!0,onClose:function(){return d(!1)}}):null,f?(0,l.jsx)(mt,{isOpen:!0,onClose:function(){return h(!1)}}):null]}):null},yt=t(99041),Zt=t(56744),jt=t(80187),bt=t(90617),wt=t(83295),kt=t(22410),St=t(24850),Ct=t(35248),It=t(5368);function _t(e){var n=e.agent,t=e.title,r=void 0===t?null:t,i=e.iconSx,o=void 0===i?{}:i,a=e.nameSx,s=void 0===a?{}:a,u=(0,v.$)().i18n,c="string"===typeof(null===n||void 0===n?void 0:n.name)?"".concat(u.t("Agent")," ").concat(null===n||void 0===n?void 0:n.name):u.t("Agent");return(0,l.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",userSelect:"none",fontSize:"inherit",fontFamily:"Inter, sans-serif"},children:[(0,l.jsx)(O.Z,{title:c,children:(0,l.jsxs)(S.Z,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",userSelect:"none"},children:[(0,l.jsx)(Ct.Z,{sx:(0,R.Z)({mr:2},o)}),(0,l.jsx)(S.Z,{sx:(0,R.Z)({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"},s),children:"string"===typeof(null===n||void 0===n?void 0:n.name)?n.name:null}),r?(0,l.jsx)(It.Z,{}):null]})}),null!==r&&void 0!==r?r:null]})}var At=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{month:"long",day:"numeric",year:"numeric"};return e?new Intl.DateTimeFormat(n,t).format(new Date(e)):e},Tt=function(e){return At(e,"en-GB",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!0})},zt=function(e){var n=Math.floor(e/3600),t=Math.floor(e%3600/60),r=e%60,i=String(n).padStart(2,"0"),o=String(t).padStart(2,"0"),l=String(r).padStart(2,"0");return"".concat(i,":").concat(o,":").concat(l)},Pt=function(e){var n=document.createElement("div");n.textContent=e;var t=n.innerHTML;return n.remove(),t},Mt=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";if(Array.isArray(e)){var i=0,o=!0,l=!1,a=void 0;try{for(var s,u=e[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value;if(!t&&i>=j().max.logsOnRender)break;var d=c.s;["info","success","warning","error"].includes(d)||(d="info");var p,f="number"===typeof c.t?At(1e3*c.t,"en-US",{day:"numeric",month:"short",hour:"numeric",minute:"numeric",second:"numeric"}):"today",h=Pt(null!==(p=c.m)&&void 0!==p?p:"");if("string"===typeof n&&n.length){var x=Pt(n),m=h.toLowerCase().indexOf(x);-1!==m&&(h=h.substring(0,m)+"<u>".concat(h.substring(m,m+x.length),"</u>")+h.substring(m+x.length))}r+='<p><i class="'.concat(d,'"></i><span>').concat(h,"</span><b>").concat(f,"</b></p>"),i++}}catch(v){l=!0,a=v}finally{try{o||null==u.return||u.return()}finally{if(l)throw a}}}return r};function Dt(e){var n=e.agent,t=e.filterText,r=e.filterStatuses,i=(0,v.$)().i18n,o=(0,x.O)(),a=o.onLog,s=o.getLogs,u=(0,g.useState)(s(null===n||void 0===n?void 0:n.id)),c=u[0],d=u[1],p=(0,g.useState)(!1),f=p[0],h=p[1];(0,g.useEffect)((function(){d(s(null===n||void 0===n?void 0:n.id));var e=a((function(e){return d(e)}));return function(){return e()}}),[null===n||void 0===n?void 0:n.id]),(0,g.useEffect)((function(){h(!1)}),[c]);var m=[{slug:"info",label:i.t("Information")},{slug:"success",label:i.t("Success")},{slug:"warning",label:i.t("Warning")},{slug:"error",label:i.t("Error")}],y=Array.isArray(c)&&c.length?c.filter((function(e){var n=!0;return r.length!==m.length&&(n=r.includes(e.s)),n&&t.length&&(n="".concat(e.m).toLowerCase().includes(t)),n})):[],Z=y.length<=j().max.logsOnRender||f?y.length:j().max.logsOnRender;return(0,l.jsx)(l.Fragment,{children:y.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.Z,{sx:{overflowY:"auto",mr:"1px"},children:(0,l.jsx)(S.Z,{className:"log-box",dangerouslySetInnerHTML:{__html:Mt(y,t,f)}})}),(0,l.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"end",height:"25px",pr:5,alignItems:"center",flexShrink:0},children:[!f&&Array.isArray(c)&&c.length>j().max.logsOnRender?(0,l.jsx)(S.Z,{sx:{display:"flex",flexGrow:1,justifyContent:"center"},children:(0,l.jsx)(I.Z,{size:"small",onClick:function(){return h(!0)},sx:{width:"100%",height:"25px",borderRadius:0},children:i.t("Load all")})}):null,(0,l.jsxs)(S.Z,{sx:{display:"flex",flexGrow:0,flexShrink:0,ml:2},children:[(0,l.jsxs)(C.Z,{variant:"caption",children:[Z," ",1===Z?i.t("message"):i.t("messages")]}),(0,l.jsx)(C.Z,{variant:"caption",sx:{ml:1},children:"(".concat(Array.isArray(c)?c.length:0," ").concat(i.t("total"),")")})]})]})]}):(0,l.jsx)(_e.Z,{variant:"standard",severity:"info",sx:{mx:2,mt:1},children:(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",children:m.length!==r.length||t.length?i.t("No messages matched your search criteria"):i.t("No messages were recorded for this agent")})})})}function Et(){var e=(0,Bn.Z)(["\n0%   { transform: translateY(100vh); }\n100% { transform: translateY(0); }"]);return Et=function(){return e},e}var Nt=(0,$n.F4)(Et()),Rt=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{width:"2px",height:"20px",position:"relative",borderLeft:"1px solid ".concat((0,u.k)(n)),marginLeft:n.spacing(2),marginRight:n.spacing(2)}}));function Ot(e){var n=e.agents,t=(0,v.$)().i18n,r=(0,x.O)(),o=r.getAgentActive,a=r.onAgentActive,s=r.getAgentId,d=r.onAgentId,p=r.getLogsEnabled,f=r.onLogsEnabled,h=r.getNavVisible,m=r.onNavVisible,y=r.getLogsVisible,Z=r.onLogsVisible,j=r.setLogsVisible,b=r.clearLogs,w=(0,k.Z)(),C=(0,g.useRef)(null),_=(0,g.useRef)(null),A=[{slug:"info",label:t.t("Information")},{slug:"success",label:t.t("Success")},{slug:"warning",label:t.t("Warning")},{slug:"error",label:t.t("Error")}],T=(0,g.useState)(null),z=T[0],P=T[1],M=(0,g.useState)(!1),D=M[0],E=M[1],N=(0,g.useState)(!1),R=N[0],F=N[1],W=(0,g.useState)(!1),U=W[0],B=W[1],$=(0,g.useState)(!1),H=$[0],V=$[1],q=(0,g.useState)(!1),K=q[0],Y=q[1],G=(0,g.useState)([]),X=G[0],J=G[1],Q=(0,g.useState)(""),ee=Q[0],ne=Q[1],te=(0,g.useState)(!1),re=te[0],ie=te[1],oe=(0,g.useState)(!1),le=oe[0],ae=oe[1];(0,g.useEffect)((function(){J((function(){return A.map((function(e){return e.slug}))})),E(o(s()));var e=a((function(e){var n=e.agentId,t=e.active;n===s()&&E(t)}));F(p());var n=f((function(e){return F(e)}));B(y());var t=Z((function(e){return B(e)}));Y(h());var r=m((function(e){return Y(e)}));return function(){e(),n(),t(),r()}}),[z]),(0,g.useEffect)((function(){P((0,c.zu)(n,s()));var e=d((function(e){return P((0,c.zu)(n,e))}));return function(){return e()}}),[n]);var se=D?"0px -1px 0px 0px #38b7d7":null,ue="1px solid ".concat((0,u.k)(w));return z&&R&&U?(0,l.jsxs)(S.Z,{sx:{boxShadow:se,borderTop:ue,zIndex:20,position:"fixed",display:"flex",flexDirection:"column",left:"250px",bottom:"50px",width:"calc(100vw - 250px)",height:re?K?"calc(100vh - 149px)":"calc(100vh - 99px)":"calc(50vh - 49px)",overflow:"hidden",opacity:le?.2:1,"&:hover":{opacity:le?.8:1},background:w.palette.background.default,transition:"opacity 100ms linear",animation:"".concat(Nt," 200ms ease-in-out forwards")},children:[(0,l.jsxs)(S.Z,{sx:{height:"50px",p:2,px:4,alignItems:"center",display:"flex"},children:[(0,l.jsx)(O.Z,{title:t.t("Clear agent logs"),placement:"bottom-end",children:(0,l.jsx)(Te.Z,{onClick:function(){return V(!0)},sx:{width:"2rem",height:"2rem"},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})})}),(0,l.jsx)(Rt,{}),(0,l.jsx)(wt.Z,{fontSize:"small",sx:{mx:2},color:"action"}),(0,l.jsx)(Ie.Z,{inputRef:C,variant:"standard",placeholder:t.t("Filter"),onChange:function(e){return n=e.target.value.toLowerCase(),null!==_.current&&window.clearTimeout(_.current),void(_.current=window.setTimeout((function(){ne(n),_.current=null}),450));var n},sx:{width:"100%","& input":{px:"0 !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},InputProps:{endAdornment:ee?(0,l.jsx)(Ce.Z,{position:"end",children:(0,l.jsx)(S.Z,{sx:{width:30,height:30},children:(0,l.jsx)(O.Z,{title:t.t("Clear filter"),children:(0,l.jsx)(Te.Z,{size:"small",sx:{width:30,height:30},onClick:function(){ne(""),null!==C.current&&(C.current.value="")},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})})})}):null}}),(0,l.jsx)(S.Z,{sx:{display:"flex",ml:2},children:A.map((function(e){return(0,l.jsx)(O.Z,{title:"".concat(t.t("Toggle log level"),": ").concat(e.label),children:(0,l.jsx)(Te.Z,{sx:{width:"2rem",height:"2rem",mr:1},onClick:function(){return function(e){var n=(0,i.Z)(X);X.includes(e)?n=n.filter((function(n){return n!==e})):n.push(e),J(n)}(e.slug)},children:X.includes(e.slug)?(0,l.jsx)(yt.Z,{color:e.slug,fontSize:"small"}):(0,l.jsx)(bt.Z,{color:e.slug,fontSize:"small"})})},e.slug)}))}),(0,l.jsx)(Rt,{}),(0,l.jsx)(O.Z,{title:t.t("Toggle translucence"),children:(0,l.jsx)(Te.Z,{onClick:function(){return ae(!le)},sx:{width:"2rem",height:"2rem",mr:1},children:le?(0,l.jsx)(St.Z,{fontSize:"small"}):(0,l.jsx)(kt.Z,{fontSize:"small"})})}),(0,l.jsx)(O.Z,{title:re?t.t("Restore"):t.t("Maximize"),children:(0,l.jsx)(Te.Z,{onClick:function(){return ie(!re)},sx:{width:"2rem",height:"2rem",mr:1},children:re?(0,l.jsx)(jt.Z,{fontSize:"small"}):(0,l.jsx)(Zt.Z,{fontSize:"small"})})}),(0,l.jsx)(O.Z,{title:t.t("Close"),children:(0,l.jsx)(Te.Z,{onClick:function(){j(!1),ne(""),J(A.map((function(e){return e.slug})))},sx:{width:"2rem",height:"2rem",mr:1},children:(0,l.jsx)(L.Z,{fontSize:"small"})})})]}),(0,l.jsx)(Dt,{agent:z,filterText:ee,filterStatuses:X}),null!==z&&H?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return V(!1)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{children:(0,l.jsx)(_t,{agent:z,title:t.t("Clear agent logs")})}),(0,l.jsx)(Le.Z,{children:(0,l.jsx)(_e.Z,{severity:"warning",children:t.t("Are you sure you want to delete all messages for this agent?")})}),(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return V(!1)},children:t.t("Cancel")}),(0,l.jsx)(I.Z,{color:"error",onClick:function(){b(null===z||void 0===z?void 0:z.id),V(!1)},startIcon:(0,l.jsx)(Ve.Z,{}),children:t.t("Clear agent logs")})]})]}):null]}):null}var Lt=t(17261),Ft=t(91435),Wt=(0,w.ZP)(Y.Z)((function(e){var n,t=e.theme;return n={},(0,H.Z)(n,t.breakpoints.down("md"),{minWidth:100}),(0,H.Z)(n,t.breakpoints.down("sm"),{minWidth:67}),(0,H.Z)(n,"height","50px"),(0,H.Z)(n,"minHeight","50px"),n})),Ut=(0,w.ZP)("span")((function(e){var n=e.theme;return(0,H.Z)({fontSize:"0.8rem",lineHeight:"0.8rem",textTransform:"none",marginLeft:n.spacing(2.4)},n.breakpoints.down("md"),{display:"none"})})),Bt=function(e){return{inputs:Array.isArray(null===e||void 0===e?void 0:e.srcInputs)&&e.srcInputs.length>0,outputs:Array.isArray(null===e||void 0===e?void 0:e.srcOutputs)&&e.srcOutputs.length>0}};function $t(e){var n,t=e.agents,i=(0,v.$)().i18n,a=(0,x.O)(),s=a.getAgentActive,u=a.onAgentActive,d=a.getAgentId,p=a.onAgentId,f=a.onAgentTab,h=a.getAgentTab,m=a.setAgentTab,y=a.getInputs,Z=a.onInputs,j=a.getSource,b=a.onSource,w=a.onNavVisible,k=a.getNavVisible,C=a.setNavVisible,I=(0,g.useState)({inputs:!1,outputs:!1}),_=I[0],A=I[1],T=(0,g.useState)(!1),P=T[0],M=T[1],D=(0,g.useState)(!1),E=D[0],N=D[1],R=(0,g.useState)(!1),O=R[0],L=R[1],F=(0,g.useState)([]),W=F[0],U=F[1],B=(0,g.useState)({}),$=B[0],H=B[1],q=(0,g.useState)(null),Y=q[0],G=q[1],X=(0,g.useState)(""),J=X[0],Q=X[1],ee={"":{label:"Browser",icon:(0,l.jsx)(rt.Z,{className:O?"rotate-360":null})},settings:{label:"Settings",icon:(0,l.jsx)(Lt.Z,{}),visible:_.inputs,hasPop:!(0,c.AM)(W,$)},results:{label:"Results",icon:(0,l.jsx)(Ft.Z,{}),visible:_.outputs},triggers:{label:"Triggers",icon:(0,l.jsx)(_n.Z,{}),visible:E}};(0,g.useEffect)((function(){null!==Y&&(0,r.Z)((function(){var e,n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,j(d(),!0)];case 1:return e=r.sent(),A(Bt(e)),U(null!==(n=null===e||void 0===e?void 0:e.srcInputs)&&void 0!==n?n:[]),[4,y(Y.id)];case 2:return H.apply(void 0,[r.sent()]),N((null!==(t=null===e||void 0===e?void 0:e.srcStateMachine)&&void 0!==t?t:[]).length>0),[2]}}))}))();var e=b((function(e){var n,t,r=e.agentId,i=e.sourceCode;r===(null===Y||void 0===Y?void 0:Y.id)&&(A(Bt(i)),U(null!==(n=null===i||void 0===i?void 0:i.srcInputs)&&void 0!==n?n:[]),N((null!==(t=null===i||void 0===i?void 0:i.srcStateMachine)&&void 0!==t?t:[]).length>0))}));L(s(d()));var n=u((function(e){var n=e.agentId,t=e.active;n===d()&&L(t)}));Q(h());var t=f((function(e){return Q(e)}));M(k());var i=w((function(e){return M(e)})),l=Z((function(e){var n=e.agentId,t=e.inputs,r=e.inputSessionId;(null===Y||void 0===Y?void 0:Y.id)===n&&null===r&&H(t)}));return function(){e(),t(),i(),n(),l()}}),[Y]),(0,g.useEffect)((function(){G((0,c.zu)(t,d()));var e=p((function(e){return G((0,c.zu)(t,e))}));return function(){return e()}}),[t]),(0,g.useEffect)((function(){var e;(null===(e=ee[J])||void 0===e?void 0:e.visible)||m("")}),[_]);var ne=function(e){""===e&&""===h()&&C(!P),window.setTimeout((function(){var e;return null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.focus()}),250)};return Y?(0,l.jsx)(V.ZP,{value:(null===(n=ee[J])||void 0===n?void 0:n.visible)?J:"",children:(0,l.jsx)(K.Z,{sx:{"& .MuiTabs-indicator":{borderRadius:"5px",marginBottom:"4px",height:"4px"}},onChange:function(e,n){return m(n)},children:Object.keys(ee).filter((function(e){return"undefined"===typeof ee[e].visible||ee[e].visible})).map((function(e,n){return(0,l.jsx)(Wt,{"data-tab":""===e?"browser":e,"data-tab-selected":J===e?"true":"false",icon:ee[e].icon,iconPosition:"start",onClick:function(){return ne(e)},value:e,sx:{px:4},label:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",pr:2},children:[(0,l.jsx)(Ut,{children:i.t(ee[e].label)}),""===e?(0,l.jsx)(S.Z,{sx:{ml:3,mr:-3},children:(0,l.jsx)(z,{open:P,children:(0,l.jsx)(vn.Z,{size:"small"})})}):null,ee[e].hasPop?(0,l.jsx)(cn.Z,{sx:{position:"absolute",top:"0.25rem",right:0},color:"warning"}):null]})},n)}))})}):null}var Ht=t(41807),Vt=t(29691);function qt(e){var n=e.agentsCount,t=void 0===n?0:n,i=e.agentsReady,a=void 0!==i&&i,s=(0,x.O)(),c=s.checkSubscription,d=s.getDialogVisible,p=s.setDialogVisible,f=s.onDialogVisible,h=(0,g.useState)(!1),y=h[0],Z=h[1],j=(0,g.useState)(!1),b=j[0],w=j[1],C=(0,g.useState)(!1),_=C[0],A=C[1],T=(0,v.$)().i18n,z=(0,k.Z)(),P=(0,m.a)();(0,g.useEffect)((function(){a&&!t&&(0,Ht.G)("reveal"),w(d("agentCreate"));var e=f((function(e){var n=e.dialog,t=e.visible;"agentCreate"===n&&w(t)}));return function(){e()}}),[a,t]);var M=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return A(!0),[4,c(P,!0)];case 1:return n=t.sent(),A(!1),(null===(e=P.user)||void 0===e?void 0:e.computerEnabled)&&n.active?p("agentCreate",!0):Z(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}();return a?0===t?(0,l.jsxs)(S.Z,{sx:{position:"absolute",zIndex:100,top:0,left:0,width:"100%",height:"calc(100% - 50px)",overflow:"hidden",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",background:z.palette.background.default,boxShadow:"0px 1px 0px 0px ".concat((0,u.k)(z))},children:[(0,l.jsx)($.Z,{className:"zoom-in"}),(0,l.jsx)($.Z,{className:"zoom-in",sx:{animationDelay:"2s"}}),(0,l.jsxs)(S.Z,{sx:{mt:14,p:5,position:"relative",zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,l.jsx)(at.Z,{size:192,animate:!0,sx:{mb:6},className:"rotate"}),(0,l.jsx)(I.Z,{size:"large",variant:"contained",className:b||y?null:"pop",fullWidth:!0,disabled:_,sx:{fontSize:"0.75rem",opacity:0,animation:"fadeIn 1s linear forwards",animationDelay:"1.5s"},startIcon:(0,l.jsx)(Vt.Z,{color:"inherit",fontSize:"large"}),onClick:M,children:T.t("Let's begin!")})]}),y?(0,l.jsx)(Un,{isOpen:!0,onClose:function(){return Z(!1)}}):null]}):null:(0,l.jsx)(S.Z,{sx:{position:"absolute",zIndex:100,top:0,left:0,display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",background:z.palette.background.default},children:(0,l.jsx)(at.Z,{size:192,animate:!0,grey:!0,className:"rotate"})})}var Kt=t(82330),Yt=t(26406),Gt=t(35054),Xt=t(3922),Jt=t(18578),Qt=t(85443),er=t(8114),nr=t(30874),tr=t(57160),rr=t(38118),ir=t(78729),or=t(70382),lr=t(5816);function ar(e){var n=e.agents,t=(0,x.O)(),r=t.getAgentId,i=t.onAgentId,o=t.onTickCounter,a=t.getTickCounters,s=t.getHourglass,u=t.onHourglass,c=(0,g.useRef)(null),d=(0,k.Z)(),p=(0,g.useState)(null),f=p[0],h=p[1],m=(0,g.useState)({}),v=m[0],y=m[1],Z=(0,g.useState)(!1),j=Z[0],b=Z[1],w=(0,g.useState)(0),I=w[0],_=w[1];(0,g.useEffect)((function(){h(r());var e=i((function(e){return h(e)}));return function(){return e()}}),[n]);var A=function(e){"object"===typeof e&&null!==e&&(b(e.active),_(e.active?e.total+parseInt((new Date).getTime()/1e3,10)-e.start:e.total),e.active&&(c.current=window.setTimeout((function(){A(s(r())),c.current=null}),1e3)))};return(0,g.useEffect)((function(){null!==c.current&&(window.clearTimeout(c.current),c.current=null),y(a(r()));var e=o((function(e){return y(e)}));A(s(r()));var n=u((function(e){var n=e.agentId,t=e.hourglass;n===r()&&A(t)}));return function(){e(),n()}}),[f]),null!==f&&"object"===typeof v&&null!==v?(0,l.jsxs)(S.Z,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"end",px:2,height:"100%"},children:[(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center"},children:Object.keys(v).slice(0,5).map((function(e){var n=!1,t=tr.Z;switch(e){case"post":t=Kt.Z;break;case"view":t=er.Z;break;case"like":t=nr.Z;break;case"repost":t=or.Z;break;case"comment":t=Yt.Z;break;case"upload":t=ir.Z;break;case"download":t=N.Z;break;case"screenshot":t=Xt.Z;break;case"collect":t=lr.Z;break;case"success":t=xe.Z;break;case"warning":t=rr.Z;break;case"contact":t=Jt.Z;break;default:n=!0}return(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",mx:2},children:[(0,l.jsx)(O.Z,{title:e,placement:"left",children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(t,{fontSize:"small",color:"action",sx:{mr:2}}),n?(0,l.jsx)(C.Z,{color:"inherit",sx:{color:d.palette.text.disabled,mr:2,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:50,lineHeight:"1rem",fontSize:"0.75rem"},children:e}):null]})}),(0,l.jsx)(O.Z,{title:v[e],placement:"left",children:(0,l.jsx)(C.Z,{color:"disabled",sx:{display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:40,fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace"},children:v[e]})})]},e)}))}),(0,l.jsx)(O.Z,{title:"Running time",placement:"left",children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[j?(0,l.jsx)(Qt.Z,{fontSize:"small",color:"primary"}):(0,l.jsx)(Gt.Z,{fontSize:"small",color:"action"}),(0,l.jsx)(C.Z,{sx:{mx:2,textAlign:"right",fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace",color:j?d.palette.primary.main:d.palette.text.disabled},children:zt(I)})]})})]}):null}var sr=t(15531),ur=t(64665),cr=t(89778),dr=t(81743),pr=t(53535),fr=t(63203),hr=t(21489),xr=t(25577),mr=t(34354),vr=function(e){var n=e.agent,t=e.isOpen,r=void 0!==t&&t,i=e.onOpen,o=void 0===i?function(){}:i,a=e.onClose,s=void 0===a?function(){}:a,u=e.status,c=void 0===u?-1:u,d=(0,v.$)().i18n,p=(0,x.O)().getAgentBanner,f=(0,g.useState)(!1),m=f[0],y=f[1];(0,g.useEffect)((function(){r&&"function"===typeof o&&o()}),[r]);var Z=function(){r&&"function"===typeof s&&s()},j=p(null===n||void 0===n?void 0:n.id);return r&&null!==j?(0,l.jsxs)($e.Z,{open:!0,onClose:Z,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(_t,{agent:n,title:h.Z.STATUS_PAUSED===c?d.t("Agent paused"):d.t("Agent stopped")}),(0,l.jsx)(Te.Z,{"aria-label":d.t("More information"),sx:{ml:2},color:"default",onClick:function(){return y(!m)},size:"large",children:m?(0,l.jsx)(xr.Z,{}):(0,l.jsx)(xn.Z,{})})]})}),(0,l.jsxs)(Le.Z,{children:[m?(0,l.jsx)(_e.Z,{icon:(0,l.jsx)(mr.Z,{}),sx:{mb:6},children:(0,l.jsxs)(C.Z,{color:"inherit",variant:"body2",children:[d.t("Modules are not allowed to intercept or store any of your cookies, passwords, or other sensitive data.")," ",d.t("As a result, you will need to manually log into any websites that require authentication."),(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),d.t("All of your data is securely and exclusively stored on this computer.")]})}):null,(0,l.jsx)(_e.Z,{severity:"info",icon:(0,l.jsx)(hr.Z,{}),children:j.message||(j.url?d.t("Please log in before continuing."):d.t("Your attention is required."))})]}),(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:Z,children:d.t("OK")}),j.url?(0,l.jsx)(I.Z,{className:"pop",onClick:function(){return function(e){var t;null===(t=window.sdk)||void 0===t||t.ipc.target.openInNewWindow(null===n||void 0===n?void 0:n.id,e),Z()}(j.url)},variant:"contained",children:d.t("Open window")}):null]})]}):null};function gr(e){var n=e.agent,t=e.status,r=(0,x.O)(),i=r.onAgentBanner,o=r.getAgentBanner,a=(0,g.useState)(null!==o(null===n||void 0===n?void 0:n.id)),s=a[0],u=a[1],c=(0,v.$)().i18n;return(0,g.useEffect)((function(){u(null!==o(null===n||void 0===n?void 0:n.id));var e=i((function(e){var t=e.agentId,r=e.banner;(null===n||void 0===n?void 0:n.id)===t&&u(null!==r)}));return function(){e()}}),[null===n||void 0===n?void 0:n.id]),(0,l.jsx)(S.Z,{sx:{display:"flex",position:"relative",zIndex:2,alignItems:"center",width:"calc( 100% - 45px )",height:"100%",p:0,ml:1},children:(0,l.jsx)(O.Z,{title:s?null:null===n||void 0===n?void 0:n.name,enterDelay:500,enterNextDelay:500,componentsProps:{tooltip:{sx:{maxWidth:"248px"}}},children:(0,l.jsx)(C.Z,{sx:{mt:1,fontSize:"0.8rem",fontFamily:"Yaldevy,sans-serif",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"calc( 100% - 20px )",color:s||h.Z.STATUS_PAUSED===t?"warning.main":"text.main"},variant:"caption",children:s?h.Z.STATUS_PAUSED===t?c.t("Unpause when ready"):c.t("Start when ready"):null===n||void 0===n?void 0:n.name})})})}function yr(e){var n,t,i,a=e.agent,s=e.index,u=void 0===s?0:s,p=e.onSelect,f=void 0===p?async function(){}:p,y=(0,v.$)().i18n,Z=(0,k.Z)(),j=(0,m.a)(),w=(0,x.O)(),C=w.onAgentId,_=w.getAgentId,A=w.getAgentBanner,T=w.onAgentBanner,z=w.setAgentTab,P=w.onSource,M=w.getSource,D=w.setSource,E=w.setSourceModified,N=w.onInputs,R=w.getInputs,L=w.getMachine,F=w.onMachineStatus,W=w.onMachineBusy,U=w.onSubscription,B=w.getSubscription,$=w.onDialogVisible,H=w.getDialogVisible,V=w.onFirstPlay,q=w.getFirstPlay,K=w.setFirstPlay,Y=w.getInstalled,G=w.setInstalled,X=w.modulePurge,J=(0,g.useState)(h.Z.STATUS_STOPPED),Q=J[0],ee=J[1],ne=(0,g.useState)(0),te=ne[0],re=ne[1],ie=(0,g.useState)(null),oe=ie[0],le=ie[1],ae=(0,g.useState)(!1),se=ae[0],ue=ae[1],ce=(0,g.useState)(!1),de=ce[0],pe=ce[1],fe=(0,g.useState)(!1),he=fe[0],xe=fe[1],me=(0,g.useState)(!1),ve=me[0],ge=me[1],ye=(0,g.useState)(!0),Ze=ye[0],je=ye[1],be=(0,g.useState)(!1),we=be[0],ke=be[1],Se=(0,g.useState)([]),Ce=Se[0],Ie=Se[1],_e=(0,g.useState)({}),Ae=_e[0],ze=_e[1],Pe=(0,g.useState)(!1),Me=Pe[0],De=Pe[1],Ee=(0,g.useState)(null),Ne=Ee[0],Re=Ee[1],Oe=(0,g.useRef)(h.Z.STATUS_STOPPED),Le=(0,g.useRef)([]),Fe=function(){xe(!0),setTimeout((function(){var e;return null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()}),250)},We=function(){var e=(0,r.Z)((function(e){var n,t,r,i,l,s=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:null,t=s.length>2&&void 0!==s[2]?s[2]:null,n!==(null===a||void 0===a?void 0:a.installedModuleId))return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,null===(r=window.sdk)||void 0===r?void 0:r.ipc.diskStorage.runInit(a.id,n,e,t)];case 2:return l=null===(i=o.sent())||void 0===i?void 0:i.runId,L(a).start(n,l),[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Ue=function(){var e=(0,r.Z)((function(){var e,n,t,r,i,l,s,u,p,f,h,x;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(e=Y(a.id),n=e.module,t=e.moduleSrcId,(null===n||void 0===n?void 0:n.id)===a.installedModuleId&&t===a.installedModuleSrcId)return[3,5];if(r=null,i=null,"string"!==typeof a.installedModuleId)return[3,5];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,b.Z.get("modules/".concat(a.installedModuleId))];case 2:return p=o.sent(),"string"!==typeof(null===(l=p.data)||void 0===l?void 0:l.id)?[2]:(r=p.data,i=a.installedModuleSrcId,[4,b.Z.get("agents/".concat(a.id,"/src"))]);case 3:return f=o.sent(),Array.isArray(null===(s=f.data)||void 0===s?void 0:s.srcStateMachine)&&(D(a.id,f.data,!0),E(a.id,!1)),null===(u=window.sdk)||void 0===u||u.ipc.source.close(a.id),d.A.info("".concat(a.name,": ").concat(y.t("Module updated to version {{version}}",{version:(0,c.hj)(r,i)})),{duration:5e3}),G(a.id,r,i),[3,5];case 4:return h=o.sent(),404===(null===(x=h.response)||void 0===x?void 0:x.status)&&X(a.installedModuleId),[3,5];case 5:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){le(_());var e=C((function(e){le(e),null!==A(null===a||void 0===a?void 0:a.id)&&(null===a||void 0===a?void 0:a.id)===e&&Fe()})),n=T((function(e){var n=e.agentId;null!==e.banner&&_()===n&&(null===a||void 0===a?void 0:a.id)===n&&Fe()}));je(!H("repo"));var t=$((function(e){var n=e.dialog,t=e.visible;"repo"===n&&je(!t)})),r=setInterval((function(){var e=Math.floor((new Date).getTime()/1e3);0===e%60&&Re(e)}),1e3);return function(){Le.current=[],t(),clearInterval(r),e(),n()}}),[]),(0,g.useEffect)((function(){if("string"===typeof(null===a||void 0===a?void 0:a.id)){(0,r.Z)((function(){var e,n,t,r,i,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,Ue()];case 1:return o.sent(),[4,M(a.id)];case 2:if(null!==(n=o.sent()))return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,b.Z.get("agents/".concat(a.id,"/src"))];case 4:return r=o.sent(),Array.isArray(null===(t=r.data)||void 0===t?void 0:t.srcStateMachine)&&(n=r.data,D(a.id,r.data)),[3,6];case 5:return o.sent(),[3,6];case 6:return Ie(null!==(i=null===n||void 0===n?void 0:n.srcInputs)&&void 0!==i?i:[]),[4,R(a.id)];case 7:return ze.apply(void 0,[o.sent()]),ke((null!==(l=null===n||void 0===n?void 0:n.srcStateMachine)&&void 0!==l?l:[]).length>0),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.target.add(a.id,"about:home",a.id===_())];case 8:return o.sent(),[2]}}))}))();var e=W((function(e){var n=e.agentId,t=e.busy;a.id===n&&De(t)})),n=F((function(e){var n=e.agentId,t=e.status;a.id===n&&(Oe.current=t,ee(t))})),t=P((function(e){var n,t,r=e.agentId,i=e.sourceCode;a.id===r&&(Ie(null!==(n=null===i||void 0===i?void 0:i.srcInputs)&&void 0!==n?n:[]),ke((null!==(t=null===i||void 0===i?void 0:i.srcStateMachine)&&void 0!==t?t:[]).length>0))})),i=N((function(e){var n=e.agentId,t=e.inputs,r=e.inputSessionId;(null===a||void 0===a?void 0:a.id)===n&&null===r&&ze(t)}));ue(q(a.id));var l,s=V((function(e){var n=e.agentId,t=e.firstPlay;a.id===n&&ue(t)})),u=B();pe(!!u.active),re(null!==(l=u.agentsCount)&&void 0!==l?l:0);var c=U((function(e){var n,t=e.info;pe(!!t.active),re(null!==(n=t.agentsCount)&&void 0!==n?n:0)})),d=function(){return L(a).stop()};return window.addEventListener("offline",d),function(){var r,o;e(),n(),t(),i(),s(),c(),window.removeEventListener("offline",d,!1),L(a).shutDown(),null===(r=window.sdk)||void 0===r||r.ipc.target.remove(a.id),null===(o=window.sdk)||void 0===o||o.ipc.source.close(a.id)}}}),[null===a||void 0===a?void 0:a.id]),(0,g.useEffect)((function(){var e;(!(null===(e=j.user)||void 0===e?void 0:e.computerEnabled)||!de||u>te-1)&&L(a).stop()}),[de,te,null===(n=j.user)||void 0===n?void 0:n.computerEnabled]),(0,g.useEffect)((function(){if(h.Z.STATUS_STOPPED===Q&&Le.current.length){var e=Le.current.shift(),n=e.sessionId,t=e.moduleId,r=e.time;We(n,t,r)}}),[Q]),(0,g.useEffect)((function(){window.setTimeout((0,r.Z)((function(){var e,n,t,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return Number.isInteger(Ne)?"string"!==typeof(null===a||void 0===a?void 0:a.id)?[3,5]:[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.session.getAt(a.id,Ne)]:[3,5];case 1:return"object"!==typeof(n=o.sent())||null===n?[3,5]:(t=n.sessionId,r=n.moduleId,i=n.sessionType,"string"!==typeof t?[3,5]:("string"!==typeof r&&null!==r&&(r=null),h.Z.STATUS_STOPPED!==Oe.current?[3,3]:[4,We(t,r,Ne)]));case 2:return o.sent(),[3,5];case 3:"schedule"===i?Le.current.unshift({moduleId:r,sessionId:t,time:Ne}):Le.current.push({moduleId:r,sessionId:t,time:Ne}),"schedule"===i&&L(a).stop(),o.label=4;case 4:0,o.label=5;case 5:return[2]}}))})),250*u)}),[Ne]);var Be=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return e.stopPropagation(),[4,f(null===a||void 0===a?void 0:a.id)];case 1:return n.sent(),null!==A(null===a||void 0===a?void 0:a.id)&&Fe(),window.setTimeout((function(){var e;return null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.focus()}),250),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),$e=function(){var e=(0,r.Z)((function(e){var n,t,r,i,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return e.stopPropagation(),"string"!==typeof(null===a||void 0===a?void 0:a.id)||ve?[2]:!de||u>te-1?[2]:(se||K(a.id,!0),"string"===typeof oe?[3,2]:[4,f(a.id)]);case 1:o.sent(),o.label=2;case 2:return o.trys.push([2,3,,5]),ge(!0),setTimeout((function(){return ge(!1)}),2500),h.Z.STATUS_STARTED===Q?L(a).stop():(oe===(null===a||void 0===a?void 0:a.id)&&(null===(n=window.sdk)||void 0===n||n.ipc.main.setOnTop()),L(a).start(null!==(t=a.installedModuleId)&&void 0!==t?t:null)),[3,5];case 3:return r=o.sent(),[4,null===(i=window.sdk)||void 0===i?void 0:i.ipc.main.setOnTop()];case 4:return o.sent(),d.A.error("".concat(y.t("Agent toggle error"),": ").concat(null!==(l=r.message)&&void 0!==l?l:r),{duration:5e3,ariaProps:{role:"alert"}}),[3,5];case 5:return window.setTimeout((function(){var e;z(""),null===(e=window.sdk)||void 0===e||e.ipc.main.focus()}),350),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),He=null;switch(Q){case h.Z.STATUS_STOPPED:He=Me?y.t("Working"):y.t("Start");break;case h.Z.STATUS_PAUSED:He=he?null:y.t("Unpause");break;case h.Z.STATUS_STARTED:He=y.t("Stop")}var Ve,qe,Ke=(0,c.AM)(Ce,Ae),Ye=!(null===(t=j.user)||void 0===t?void 0:t.computerEnabled)||!de||u>te-1,Ge=null!==A(null===a||void 0===a?void 0:a.id),Xe=Ye||ve||h.Z.STATUS_STOPPED===Q&&Me;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.Z,{sx:{width:"100%",ml:"-1px",height:"50px",position:"relative"},children:[(0,l.jsxs)(I.Z,{startIcon:h.Z.STATUS_STOPPED===Q?(0,l.jsx)(Ct.Z,{color:Ge?"warning":"action",sx:{ml:2}}):(0,l.jsx)(sr.Z,{color:h.Z.STATUS_PAUSED===Q||Ge?"warning":"primary",sx:{ml:2}}),"data-agent":"".concat(null!==(Ve=null===a||void 0===a?void 0:a.id)&&void 0!==Ve?Ve:""),"data-agent-selected":oe===(null===a||void 0===a?void 0:a.id)?"true":"false",variant:"text",sx:{"&.MuiButton-root":{background:oe===(null===a||void 0===a?void 0:a.id)?Z.palette.background.selected:null},borderRadius:0,width:"100%",transition:"none",height:"50px",position:"relative",zIndex:2},onClick:Be,children:[(0,l.jsx)(gr,{agent:a,status:Q}),(0,l.jsx)(S.Z,{sx:{position:"absolute",top:"5px",left:"5px",borderRadius:"5px",width:"5px",height:"40px",background:oe===(null===a||void 0===a?void 0:a.id)?h.Z.STATUS_PAUSED===Q||Ge?Z.palette.warning.main:Z.palette.primary.main:"transparent",transform:"scaleY(".concat(oe===(null===a||void 0===a?void 0:a.id)?"100":"0","%)"),transition:"transform 200ms linear"}})]}),Ke&&Ze&&we?(0,l.jsx)(O.Z,{title:Ye?(null===(i=j.user)||void 0===i?void 0:i.computerEnabled)?y.t("Locked by billing"):y.t("Computer disabled"):Xe?null:He,placement:"left",children:(0,l.jsx)(S.Z,{sx:{position:"absolute",right:"5px",top:"5px",zIndex:2},children:(0,l.jsx)(Te.Z,{className:se||oe!==(null===a||void 0===a?void 0:a.id)?null:"pop pop-rounded pop-inset",disabled:Xe,"data-start-stop":"".concat(null!==(qe=null===a||void 0===a?void 0:a.id)&&void 0!==qe?qe:""),onClick:$e,children:Ye?(0,l.jsx)(ur.Z,{fontSize:"small",color:"inherit"}):h.Z.STATUS_STARTED===Q?(0,l.jsx)(dr.Z,{color:Xe?"disabled":"primary"}):h.Z.STATUS_STOPPED===Q&&Me?(0,l.jsx)(cr.Z,{className:"rotate-360"}):(0,l.jsx)(pr.Z,{color:Xe?"disabled":h.Z.STATUS_PAUSED===Q||Ge?"warning":"primary"})})})}):null,Ge?(0,l.jsx)(fr.Z,{color:"warning",variant:"indeterminate",sx:{position:"absolute",bottom:0,left:0,height:"2px",zIndex:3}}):null]}),he?(0,l.jsx)(vr,{agent:a,isOpen:!0,onClose:function(){return xe(!1)},status:Q}):null]})}var Zr=t(36403),jr=t(88073),br=t(19529),wr=t(41372),kr=t(13310),Sr=t(55553),Cr=(0,g.forwardRef)((function(e,n){var t=e.tooltipPlacement,r=void 0===t?"bottom":t,i=e.tooltipShown,o=void 0===i||i,a=(0,jr.r)(),s=a.settings,u=a.saveSettings,c=(0,g.useState)(!1),d=c[0],p=c[1],f=(0,v.$)().i18n,h=(0,k.Z)(),x="boolean"!==typeof(null===s||void 0===s?void 0:s.sound)||s.sound;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(O.Z,{title:o?x?f.t("Sound on"):f.t("Sound off"):null,placement:r,children:(0,l.jsx)(an.Z,{ref:n,color:"default",inputProps:{"aria-label":"sound",name:"sound"},checked:x,disabled:d,sx:{mx:1,height:"38px","& .MuiSwitch-track":{background:"transparent",opacity:1,border:"1px solid ".concat(h.palette.divider)}},icon:(0,l.jsx)(Sr.Z,{fontSize:"small",color:"disabled"}),checkedIcon:(0,l.jsx)(kr.Z,{fontSize:"small",color:"info",sx:{color:"#ff9b00"}}),onClick:function(){d||(p(!0),setTimeout((function(){return p(!1)}),500),u({sound:!x}),!x&&(0,Ht.G)("toastInfo"))}})})})})),Ir=Cr,_r=t(84165),Ar=t(21946),Tr=function(){var e=(0,k.Z)();return{primaryFilled:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main},primaryLight:{color:e.palette.primary.main,backgroundColor:(0,Ar.E)(e.palette.primary.main,.12)},secondaryFilled:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main},secondaryLight:{color:e.palette.secondary.main,backgroundColor:(0,Ar.E)(e.palette.secondary.main,.12)},successFilled:{color:e.palette.success.contrastText,backgroundColor:e.palette.success.main},successLight:{color:e.palette.success.main,backgroundColor:(0,Ar.E)(e.palette.success.main,.12)},errorFilled:{color:e.palette.error.contrastText,backgroundColor:e.palette.error.main},errorLight:{color:e.palette.error.main,backgroundColor:(0,Ar.E)(e.palette.error.main,.12)},warningFilled:{color:e.palette.warning.contrastText,backgroundColor:e.palette.warning.main},warningLight:{color:e.palette.warning.main,backgroundColor:(0,Ar.E)(e.palette.warning.main,.12)},infoFilled:{color:e.palette.info.contrastText,backgroundColor:e.palette.info.main},infoLight:{color:e.palette.info.main,backgroundColor:(0,Ar.E)(e.palette.info.main,.12)}}},zr=t(41796),Pr=t(69661),Mr=(0,g.forwardRef)((function(e,n){var t,r=e.user,i=e.sx,o=e.skin,a=e.color,s=(0,k.Z)(),u=Tr(),c=(0,m.a)(),d=(new Date).toJSON().slice(0,10),p="".concat(ce.Z.s3Url,"/users/").concat(r.id,"/?cb=").concat(d);(null===(t=c.user)||void 0===t?void 0:t.id)==r.id&&(p="string"===typeof(null===r||void 0===r?void 0:r.userAvatarId)?"".concat(ce.Z.s3Url,"/users/").concat(r.id,"/").concat(r.userAvatarId,".png"):"/img/placeholder/user.png");var f,h=function(e,n){return"light"===e?(0,R.Z)({},u["".concat(n,"Light")]):"light-static"===e?{color:u["".concat(n,"Light")].color,backgroundColor:(0,zr.$n)(s.palette[n].main,.88)}:(0,R.Z)({},u["".concat(n,"Filled")])};i.backgroundColor=s.palette.background.default,i.border="2px solid ".concat(null!==(f=s.palette.customColors.userColors.solid[r.userColor])&&void 0!==f?f:s.palette.divider);var x={primary:h(o,"primary"),secondary:h(o,"secondary"),success:h(o,"success"),error:h(o,"error"),warning:h(o,"warning"),info:h(o,"info")},v={sx:i,skin:o,color:a,src:p,alt:"avatar"};return(0,l.jsx)(Pr.Z,(0,Je.Z)((0,R.Z)({ref:n},v),{sx:!p&&o&&a?Object.assign(x[a],i):i}))}));Mr.defaultProps={skin:"filled",color:"primary"};var Dr=Mr,Er=(0,w.ZP)(He.Z)((function(e){var n=e.theme;return{"& .MuiMenu-paper":(0,H.Z)({width:280,overflow:"hidden",marginTop:n.spacing(4)},n.breakpoints.down("sm"),{width:"100%"}),"& .MuiMenu-list":{padding:0}}})),Nr=function(e){var n=e.onProfileOpen,t=void 0===n?function(){}:n,i=(0,jr.r)().settings,a=(0,v.$)().i18n,s=(0,k.Z)(),u=(0,m.a)(),c=(0,g.useState)(!1),d=c[0],p=c[1],f=(0,g.useState)(null),h=f[0],x=f[1],y=(0,g.useRef)(null),Z=(0,g.useRef)(null),j=function(){return x(null)},b=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return j(),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),p(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}();return u.user?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(I.Z,{onClick:function(e){x(e.currentTarget)},fullWidth:!0,sx:{borderRadius:0,justifyContent:"space-between",alignItems:"center",height:"100%"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"calc(100% - 30px)"},children:[(0,l.jsx)(br.Z,{"aria-disabled":"true",overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(Dr,{user:u.user,sx:{width:24,height:24,ml:1}})}),(0,l.jsx)(C.Z,{variant:"caption",sx:{textTransform:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",ml:3},children:u.user.userName})]}),(0,l.jsx)(z,{sx:{flexShrink:0},open:!!h,children:(0,l.jsx)(A.Z,{color:"action"})})]}),(0,l.jsxs)(Er,{sx:{mt:-6,width:"250px"},anchorEl:h,"aria-disabled":"true",open:Boolean(h),onClose:function(){return j()},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},children:[(0,l.jsx)(Ue.Z,{onClick:function(){j(),t()},sx:{p:3,textDecoration:"none"},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(br.Z,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,l.jsx)(Dr,{user:u.user,sx:{width:"2rem",height:"2rem",ml:1}})}),(0,l.jsxs)(S.Z,{"aria-disabled":"true",sx:{display:"flex",ml:3,alignItems:"flex-start",flexDirection:"column"},children:[(0,l.jsx)(O.Z,{title:u.user.userName,placement:"top",children:(0,l.jsx)(C.Z,{sx:{fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"145px"},children:u.user.userName})}),(0,l.jsx)(O.Z,{title:u.user.userEmail,placement:"bottom",children:(0,l.jsx)(C.Z,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"145px"},children:u.user.userEmail})})]})]})}),(0,l.jsx)(Be.Z,{}),(0,l.jsx)(Ue.Z,{onClick:function(e){e.stopPropagation(),j(),Z.current&&Z.current.click()},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(S.Z,{sx:{ml:"-19px",mr:"-3px"},children:(0,l.jsx)(_r.Z,{ref:Z,tooltipShown:!1})}),(0,l.jsx)(C.Z,{variant:"body2",children:"dark"===s.palette.mode?a.t("Dark mode"):a.t("Light mode")})]})}),(0,l.jsx)(Ue.Z,{onClick:function(e){e.stopPropagation(),j(),y.current&&y.current.click()},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(S.Z,{sx:{ml:"-19px",mr:"-3px"},children:(0,l.jsx)(Ir,{ref:y,tooltipShown:!1})}),(0,l.jsx)(C.Z,{variant:"body2",children:i.sound?a.t("Sound on"):a.t("Sound off")})]})}),(0,l.jsx)(Be.Z,{}),(0,l.jsxs)(Ue.Z,{sx:{py:3,fontWeight:400},"aria-disabled":"true",onClick:b,children:[(0,l.jsx)(wr.Z,{sx:{mr:5},color:"action"}),(0,l.jsx)(C.Z,{variant:"body2",children:a.t("Disconnect")})]})]}),d?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return p(!1)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{children:a.t("Disconnect")}),(0,l.jsx)(Le.Z,{children:(0,l.jsx)(_e.Z,{severity:"warning",children:a.t("Are you sure you want to log out of this computer?")})}),(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return p(!1)},children:a.t("Cancel")}),(0,l.jsx)(I.Z,{variant:"text",color:"error",onClick:function(){return u.logout()},startIcon:(0,l.jsx)(wr.Z,{}),children:a.t("Disconnect")})]})]}):null]}):null},Rr=t(51233);function Or(e){var n=e.agents,t=e.agentsReady,r=void 0!==t&&t,i=(0,x.O)(),o=i.getAgentActive,a=i.onAgentActive,s=i.getAgentId,u=i.onAgentId,c=i.onTickArea,d=i.onVmouseMove,p=i.onVmouseClick,f=i.getVmouse,h=i.onDownloadInfo,m=i.getDownloadInfo,v=(0,k.Z)(),y=(0,g.useRef)(null),Z=(0,g.useRef)(null),j=(0,g.useRef)(null),b=(0,g.useRef)(null),w=(0,g.useState)(!1),I=w[0],_=w[1],A=(0,g.useState)(null),T=A[0],z=A[1],P=(0,g.useState)(!1),M=P[0],D=P[1],E=(0,g.useState)(null),N=E[0],O=E[1],L=(0,g.useState)({}),F=L[0],W=L[1],U=(0,g.useState)(null),B=U[0],$=U[1];return(0,g.useEffect)((function(){_(o(s()));var e=a((function(e){var n=e.agentId,t=e.active;n===s()&&_(t)}));z(null);var n=c((function(e){var n=e.agentId,t=e.area;if(n===s()&&Array.isArray(t)){var r=t.map((function(e){return parseInt(e,10)})).filter((function(e){return Number.isInteger(e)}));4===r.length&&(z(null),null!==j.current&&(window.clearTimeout(j.current),j.current=null),j.current=window.setTimeout((function(){z(r),j.current=null,null!==b.current&&(window.clearTimeout(b.current),b.current=null),b.current=window.setTimeout((function(){z(null),b.current=null}),1e3)}),50))}}));$(f(s()));var t=d((function(e){var n=e.agentId,t=e.vmouse;n===s()&&$(t)}));W(m(s()));var r=h((function(e){var n=e.agentId,t=e.info;n===s()&&W(t)})),i=p((function(e){var n=e.agentId,t=e.vmouse;n===s()&&["click","double-click"].includes(null===t||void 0===t?void 0:t.name)&&(D(!0),window.setTimeout((function(){return D(!1)}),250),O(null),null!==y.current&&(window.clearTimeout(y.current),y.current=null),y.current=window.setTimeout((function(){O(t),y.current=null,null!==Z.current&&(window.clearTimeout(Z.current),Z.current=null),Z.current=window.setTimeout((function(){O(null),Z.current=null}),300)}),50))}));return function(){n(),r(),t(),e(),i()}}),[]),(0,g.useEffect)((function(){var e=u((function(e){y.current=null,Z.current=null,j.current=null,b.current=null,W(m(e)),_(o(e)),z(null)}));return function(){return e()}}),[n]),r?I?(0,l.jsxs)(S.Z,{sx:{position:"relative",width:"100%",height:"100%",boxShadow:"none",overflow:"hidden"},children:[(0,l.jsx)(S.Z,{className:"agent-overlay",children:(0,l.jsx)(S.Z,{sx:{width:"350px",height:"100%",right:"0px",position:"absolute",overflowY:"auto",mr:2,display:"flex",flexDirection:"column",justifyContent:"end",zIndex:12},children:Object.keys(F).map((function(e){var n="string"===typeof F[e].error?"error":F[e].done?"success":"primary",t="string"===typeof F[e].error?(0,l.jsx)(rr.Z,{}):F[e].done?(0,l.jsx)(xe.Z,{}):(0,l.jsx)(cr.Z,{className:"rotate-360"}),r="string"===typeof F[e].error?F[e].error:"".concat(F[e].fileName).concat(F[e].totalBytes>0?" (".concat((F[e].totalBytes/1048576).toFixed(3),"MB)"):"");return(0,l.jsx)(Rr.Z,{sx:{mb:2},children:(0,l.jsxs)(_e.Z,{variant:"filled",color:n,sx:{px:2,"& .MuiAlert-message":{width:"100%"},boxShadow:v.shadows[3]},icon:t,children:[(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",children:r}),"string"===typeof F[e].error||F[e].done?null:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%",height:"1rem"},children:[(0,l.jsx)(fr.Z,{color:"primary",value:parseFloat(F[e].progress),variant:F[e].totalBytes>0?"determinate":"indeterminate"}),F[e].totalBytes>0?(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",sx:{ml:3},children:"".concat(F[e].progress,"%")}):null]})]})},e)}))})}),Array.isArray(T)?(0,l.jsx)(S.Z,{className:"tick-area",sx:{left:T[0],top:T[1],width:T[2],height:T[3]}}):null,null!==N?(0,l.jsx)(S.Z,{className:"mouse-ripple",sx:{left:"".concat(N.x-25,"px"),top:"".concat(N.y-25,"px"),animationIterationCount:"double-click"===N.name?2:1}}):null,null!==B?(0,l.jsx)(S.Z,{className:"mouse-pointer","data-tapped":"".concat(M),sx:(0,R.Z)({transform:"translate(".concat(B.x,"px, ").concat(B.y,"px)")},Number.isInteger(B.duration)?{transitionDuration:"".concat(B.duration,"ms")}:{})}):null]}):null:(0,l.jsx)(S.Z,{sx:{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(at.Z,{size:128,animate:!0,grey:!0,className:"rotate"})})}var Lr=t(82670),Fr=t(40476),Wr=t(50480),Ur=t(69368),Br=t(18360),$r=function(e){var n=e.field,t=e.refFirstEmpty,r=e.firstValue,o=void 0===r?[]:r,a=e.actionSet,s=void 0===a?function(){}:a,u=(0,v.$)().i18n;"object"===typeof n&&null!==n||(n={});var c=(0,g.useState)(Array.isArray(o)?o:[]),d=c[0],p=c[1];(0,g.useEffect)((function(){p(Array.isArray(o)?o:[])}),[o]);var f;return(0,l.jsx)("form",{"data-scalar":n.key,onSubmit:function(e){return e.preventDefault()},children:Array.isArray(n.options)&&n.options.length?n.options.length>1&&n.isList?(0,l.jsx)(S.Z,{className:t.current===n.id?"pop":"",sx:{width:"100%",borderRadius:"0.25rem",p:1,position:"relative"},children:n.options.map((function(e){var t=d.includes(e)&&d.length<=1&&n.default===e;return(0,l.jsx)(O.Z,{title:t?u.t("Enable another option before disabling this one"):null,children:(0,l.jsx)(S.Z,{sx:{m:1,display:"inline-block"},children:(0,l.jsx)(Wr.Z,{label:e,sx:{mr:6,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi,sans-serif"}},control:(0,l.jsx)(Ur.Z,{inputProps:{name:n.key},value:e,color:t?"default":"primary",checked:d.includes(e),onChange:function(t){return function(e,t){p((function(r){var o=e.target.checked?(0,i.Z)(new Set((0,i.Z)(r).concat([t]))):r.filter((function(e){return e!==t}));return o.length||(o=[n.default]),JSON.stringify(r)!==JSON.stringify(o)&&s(),o}))}(t,e)}})})})},e)}))}):(0,l.jsx)(Br.Z,{fullWidth:!0,displayEmpty:!0,renderValue:function(e){return e||(0,l.jsx)(C.Z,{variant:"caption",children:u.t("Select an option")})},name:n.key,defaultValue:null!==o&&void 0!==o?o:"",className:t.current===n.id?"pop":"",inputProps:{id:"field-".concat(n.id)},onChange:function(e){return s()},children:n.options.map((function(e){return(0,l.jsx)(Ue.Z,{value:e,children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center"},children:e})},e)}))}):(0,l.jsx)(O.Z,{title:"int"===n.type?(0,i.Z)(Number.isInteger(n.min)?[u.t("Minimum: {{n}}",{n:n.min})]:[]).concat((0,i.Z)(Number.isInteger(n.max)?[u.t("Maximum: {{n}}",{n:n.max})]:[])).join(", "):(0,i.Z)(Number.isInteger(n.min)?[1===n.min?u.t("Required"):u.t("Minimum length: {{n}}",{n:n.min})]:[]).concat((0,i.Z)(Number.isInteger(n.max)?[u.t("Maximum length: {{n}}",{n:n.max})]:[])).join(", "),children:(0,l.jsx)(Ie.Z,{id:"field-".concat(n.id),className:t.current===n.id?"pop":"",name:n.key,InputLabelProps:{shrink:!0},sx:{width:"100%","& .MuiInputBase-multiline":{py:3},"& textarea":{p:"0 !important"}},defaultValue:o,placeholder:"".concat(null!==(f=n.default)&&void 0!==f?f:""),onChange:function(e){return s(450)},type:"int"===n.type?"number":"string",inputMode:"int"===n.type?"numeric":"text",multiline:"string"===n.type,onKeyDown:function(e){return"Enter"===e.key&&e.ctrlKey&&s()},maxRows:9,inputProps:(0,R.Z)({},"int"===n.type?{min:n.min,max:n.max}:{minLength:n.min,maxLength:n.max})})})})},Hr=function(e){var n=e.field,t=e.firstValue,r=e.actionSet,i=void 0===r?function(){}:r;return"object"===typeof n&&null!==n||(n={}),(0,l.jsx)("form",{"data-scalar":n.key,onSubmit:function(e){return e.preventDefault()},children:(0,l.jsx)(an.Z,{id:"field-".concat(n.id),name:n.key,defaultChecked:!!t,onChange:function(e){return i()}})})},Vr=t(57460),qr=t.n(Vr),Kr=t(68540),Yr=t(10633),Gr=t(39244),Xr=t(22394),Jr=t(45430),Qr=t(95653),ei=t(1938),ni=function(e){var n=e.time,t=e.sx,r=void 0===t?{}:t,i=e.tooltip,o=void 0===i||i;return"object"===typeof r&&null!==r||(r={}),Number.isInteger(n)?(0,l.jsx)(O.Z,{placement:"left",title:o?At(1e3*n,"en",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}):null,children:(0,l.jsx)(he.Z,{size:"small",variant:"outlined",label:Tt(1e3*n),sx:(0,R.Z)({fontFamily:"Inconsolata,sans-serif"},r)})}):null},ti=t(84323),ri=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{display:"flex",alignItems:"center",justifyContent:"end",padding:n.spacing(2),"& > button":{marginLeft:n.spacing(2)}}})),ii=t(59798),oi=t(37132),li=t(76419),ai=t(15027),si=t(59925),ui=t(77465),ci=t(4554),di=t(32882),pi=t(82624),fi=t(83212),hi=t(65014),xi=t(39289),mi=t(56658),vi=t(65188),gi=t(37230),yi=t(73586),Zi=t(44123),ji=t(51582),bi=t(58505),wi=t(50092),ki=t(22954),Si=t(95115),Ci=t(93898),Ii={en:ii._,cs:oi.l,nl:li.R,fr:ai.g,de:si.y,el:ui.z,hu:ci.s,it:di.K,pt:pi.F,pl:fi.s,ro:hi.C,ru:xi.n,es:mi._,sv:vi.I,tr:gi.X,uk:yi.m,ar:Zi.S,zh:ji.U,he:bi.A,ja:wi.j,ko:ki.u,fa:Si.T,vi:Ci.I},_i=t(97865),Ai=function(e){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)},Ti=function(e){var n=function(){var e=(0,jr.r)().settings,n=("undefined"!==typeof Ii[null===e||void 0===e?void 0:e.lang]?Ii[e.lang]:Ii.en).components.MuiDataGrid.defaultProps.localeText;return n.MuiTablePagination.labelDisplayedRows=function(e){var n=e.from,t=e.to,r=e.count;return"".concat(n," - ").concat(t," / ").concat(r)},n}(),t=(0,k.Z)(),r=(0,g.useState)(Ai(3)),i=r[0],o=r[1],a=(0,g.useState)(Ai(3)),s=a[0],u=a[1];return(0,g.useEffect)((function(){var e=document.documentElement,n=new ResizeObserver((function(){u(Ai(3)),o(Ai(3))}));return n.observe(e),function(){return n.disconnect()}}),[]),(0,l.jsx)(S.Z,{sx:{border:"1px solid ".concat(t.palette.divider),borderRadius:"8px"},children:(0,l.jsx)(_i._,(0,Je.Z)((0,R.Z)({},e),{showColumnRightBorder:!0,hideFooterSelectedRowCount:!0,dataGridLocale:n,rowHeight:s,columnHeaderHeight:i}))})},zi=t(40876),Pi=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{border:"1px solid ".concat(n.palette.divider),borderRadius:n.spacing(2),width:"100%",overflowX:"auto",paddingBottom:n.spacing(1)}})),Mi=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{height:"35px",width:"100%",display:"flex",alignItems:"center",padding:n.spacing(2),marginBottom:n.spacing(1)}})),Di=(0,w.ZP)(S.Z)((function(e){var n=e.theme,t=e.removed,r=void 0!==t&&t,i=e.excluded,o=void 0!==i&&i;return{border:"1px solid ".concat(n.palette.divider),borderRadius:n.spacing(1),width:"115px",flexShrink:0,flexGrow:0,marginRight:n.spacing(1),height:"35px",padding:n.spacing(2),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"0.75rem",lineHeight:"18px",verticalAlign:"middle",textDecoration:r?"line-through":"none",background:o?n.palette.divider:"transparent",userSelect:r||o?"none":"text"}})),Ei=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{"&:before":{position:"absolute",content:'""',display:"block",top:0,left:0,width:"5px",height:"100%",background:n.palette.divider,borderRadius:n.spacing(1)},marginBottom:n.spacing(4),position:"relative",paddingLeft:n.spacing(4),whiteSpaceCollapse:"preserve",wordBreak:"break-word",whiteSpace:"pre-wrap",width:"100%","&>span":{display:"inline-block",width:"100%",marginTop:n.spacing(2),marginBottom:n.spacing(2)}}})),Ni=5e3,Ri=function(){var e=(0,r.Z)((function(e){var n,t,i,l,a=arguments;return(0,o.__generator)(this,(function(s){return n=a.length>1&&void 0!==a[1]?a[1]:4,t=a.length>2&&void 0!==a[2]?a[2]:null,i=a.length>3&&void 0!==a[3]?a[3]:2,l=[],[2,new Promise((function(a,s){var u=new FileReader;u.onload=function(e){var u=e.target.result;qr().parse(u,{header:!1,skipEmptyLines:!0,dynamicTyping:!0,comments:"#",worker:!1,step:function(){var e=(0,r.Z)((function(e,r){return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return e.data.filter((function(e){return null!==e})).length?(l.push(e.data),"function"!==typeof t?(l.length>=n&&(a(l),l=[],r.abort()),[2]):l.length>=i?(r.pause(),[4,t(l)]):[3,2]):[2];case 1:o.sent(),l=[],r.resume(),o.label=2;case 2:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),complete:(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return"function"!==typeof t?(a(l),[2]):l.length>0?[4,t(l)]:[3,2];case 1:e.sent(),e.label=2;case 2:return a(!0),[2]}}))})),error:s})},u.onerror=s,u.readAsText(e)}))]}))}));return function(n){return e.apply(this,arguments)}}(),Oi=(0,g.memo)((function(e){var n,t=e.fieldKey,a=e.fieldName,s=e.fieldColumns,u=void 0===s?[]:s,c=e.runIds,p=void 0===c?null:c,f=e.pop,h=void 0!==f&&f,m=e.sessionId,y=void 0===m?null:m,Z=(0,x.O)(),b=Z.getAgentId,w=Z.refetchInputs,k=(0,v.$)().i18n,_=(0,g.useRef)(null),A=(0,g.useRef)(null),T=(0,g.useRef)(null);Array.isArray(u)||(u=[]);var z=(0,g.useState)(10),P=z[0],M=z[1],E=(0,g.useState)(1),N=E[0],R=E[1],L=(0,g.useState)(1),F=L[0],W=L[1],$=(0,g.useState)(""),H=$[0],V=$[1],q=(0,g.useState)(!1),K=q[0],Y=q[1],X=(0,g.useState)([]),J=X[0],Q=X[1],ee=(0,g.useState)(null),ne=ee[0],te=ee[1],re=(0,g.useState)(!1),ie=re[0],oe=re[1],le=(0,g.useState)(!1),se=le[0],ue=le[1],ce=(0,g.useState)(!1),de=ce[0],pe=ce[1],fe=(0,g.useState)(!1),xe=fe[0],me=fe[1],ve=(0,g.useState)(null),ge=ve[0],ye=ve[1],Ze=(0,g.useState)([]),je=Ze[0],be=Ze[1],ke=(0,g.useState)(!1),Se=ke[0],Ae=ke[1],Pe=(0,g.useState)([]),Me=Pe[0],De=Pe[1],Ee=function(){var e=(0,r.Z)((function(){var e,n,r,i,l,a=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e=!(a.length>0&&void 0!==a[0])||a[0],Y(!1),o.label=1;case 1:return o.trys.push([1,6,,7]),Array.isArray(p)?[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.diskStorage.outputTableQuery(b(),p.slice(-j().max.diskStorage.outputRunsCount),t,F,Ni)]:[3,3];case 2:return l=o.sent(),[3,5];case 3:return[4,null===(r=window.sdk)||void 0===r?void 0:r.ipc.diskStorage.inputTableQuery(b(),t,F,Ni,y)];case 4:l=o.sent(),o.label=5;case 5:return"object"===typeof(i=l)&&null!==i&&(R(Math.ceil(i.total/Ni)),Q(i.rows)),[3,7];case 6:return o.sent(),[3,7];case 7:return e?[4,w(b(),y)]:[3,9];case 8:o.sent(),o.label=9;case 9:return Y(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ne=function(){return ie?(n=Math).max.apply(n,(0,i.Z)((Array.isArray(je)?je:[]).map((function(e){return e.length}))).concat([u.length])):0};(0,g.useEffect)((function(){var e=setTimeout((function(){return Ee(!1)}),100);return function(){return window.clearTimeout(e)}}),[t,u,F,p]),(0,g.useEffect)((function(){ie&&De((0,i.Z)(u).concat((0,i.Z)(new Array(Ne()-u.length).fill(""))))}),[ie,u,je]);var Re=function(){var e=(0,r.Z)((function(e){var n,r,i,l,a,s,c,d,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(Array.isArray(p))return[2];pe(!0),r=new FormData(e.target),i={},l=!0,a=!1,s=void 0;try{for(c=u[Symbol.iterator]();!(l=(d=c.next()).done);l=!0)f=d.value,i[f]=r.get(f)}catch(h){a=!0,s=h}finally{try{l||null==c.return||c.return()}finally{if(a)throw s}}return[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.diskStorage.inputTableAdd(b(),t,[i],y)];case 1:return o.sent(),pe(!1),me(!1),[4,Ee()];case 2:return o.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),We=function(){var e=(0,r.Z)((function(e,n){var r,i,l,a,s,c,d,f,h;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(Array.isArray(p))return[2];pe(!0),i=new FormData(e.target),l={},a=!0,s=!1,c=void 0;try{for(d=u[Symbol.iterator]();!(a=(f=d.next()).done);a=!0)h=f.value,l[h]=i.get(h)}catch(x){s=!0,c=x}finally{try{a||null==d.return||d.return()}finally{if(s)throw c}}return[4,null===(r=window.sdk)||void 0===r?void 0:r.ipc.diskStorage.inputTableUpdate(b(),t,n,l,y)];case 1:return o.sent(),pe(!1),me(!1),[4,Ee()];case 2:return o.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Be=function(){var e=(0,r.Z)((function(e){var n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return me(!1),Array.isArray(p)?[2]:(Y(!1),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.diskStorage.inputTableDelete(b(),t,e,y)]);case 1:return r.sent(),[4,Ee()];case 2:return r.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),qe=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return ue(!1),Array.isArray(p)?[2]:(Y(!1),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.diskStorage.inputTableDelete(b(),t,null,y)]);case 1:return n.sent(),[4,Ee()];case 2:return n.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ke=function(){var e=(0,r.Z)((function(){var e,n,i;return(0,o.__generator)(this,(function(l){switch(l.label){case 0:if(!Array.isArray(Me)||!Me.length||!u.length)return Ge(),[2];pe(!0),e=!1,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Ri(ge,4,function(){var n=(0,r.Z)((function(n){var r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return i=n.map((function(e){for(var n={},t=0;t<Me.length;t++)Me[t].length&&(n[Me[t]]="undefined"===typeof e[t]?null:e[t]);return n})),!e&&Se&&(e=!0,i.shift()),[4,null===(r=window.sdk)||void 0===r?void 0:r.ipc.diskStorage.inputTableAdd(b(),t,i,y)];case 1:return o.sent(),[2]}}))}));return function(e){return n.apply(this,arguments)}}(),100)];case 2:return l.sent(),[3,4];case 3:return n=l.sent(),d.A.error("".concat(k.t("Error importing CSV"),": ").concat(null!==(i=n.message)&&void 0!==i?i:n)),[3,4];case 4:return Ge(),[4,Ee()];case 5:return l.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),Ye=function(){var e=(0,r.Z)((function(e){var n,t,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(n=Array.isArray(e)&&e.length?e[0]:null,t=[],null===n)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Ri(n,4)];case 2:return t=o.sent(),[3,4];case 3:return r=o.sent(),d.A.error("".concat(k.t("Error parsing CSV"),": ").concat(null!==(i=r.message)&&void 0!==i?i:r)),[3,4];case 4:return Array.isArray(t)&&t.length?(ye(n),be(t),[2]):(d.A.error(k.t("The CSV file is empty")),[2])}}))}));return function(n){return e.apply(this,arguments)}}(),Ge=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return oe(!1),pe(!1),ye(null),be([]),Ae(!1),De([]),[2]}))}));return function(){return e.apply(this,arguments)}}(),Xe=function(){me(!1)},Je=function(){A.current&&A.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))},Qe=(0,i.Z)(null!==p?[{width:160,hideable:!1,field:"_date_",filterable:!1,headerName:k.t("Run"),renderCell:function(e){var n=e.row;return(0,l.jsx)(ni,{time:n._time})},valueGetter:function(e){return e.row._time}}]:[]).concat((0,i.Z)(u.map((function(e,n){return{flex:1,hideable:null!==p||0!==n,field:e,renderCell:function(n){var t=n.row;return(0,l.jsx)(O.Z,{title:t[e],children:(0,l.jsx)(C.Z,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:ae(t[e],H,b())})})},valueGetter:function(n){return n.row[e]}}}))),(0,i.Z)(null===p?[{width:40,field:"_actions_",hideable:!1,filterable:!1,headerName:k.t("Actions"),renderHeader:function(){return""},renderCell:function(e){var n=e.row;return(0,l.jsx)(S.Z,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsx)(O.Z,{title:k.t("Delete row"),placement:"left",children:(0,l.jsx)(Te.Z,{size:"small",onClick:function(e){e.preventDefault(),e.stopPropagation(),Be(n._id)},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})})})})}}]:[])),en=ie&&null!==ge?Me.length<=4?550:Me.length>=9?1150:550+120*(Me.length-4):750;return(0,l.jsxs)(S.Z,{sx:{width:"100%"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:4,height:"30px"},children:[K&&u.length&&N>1?(0,l.jsx)(S.Z,{sx:{display:"flex",width:"280px",justifyContent:"start",flexShrink:0},children:(0,l.jsx)(Yr.Z,{size:"small",count:N,page:F,onChange:function(){var e=(0,r.Z)((function(e,n){return(0,o.__generator)(this,(function(e){return[2,W(n)]}))}));return function(n,t){return e.apply(this,arguments)}}()})}):null,(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",justifyContent:"end",alignItems:"center"},children:[K&&J.length?(0,l.jsx)(S.Z,{sx:{width:"200px",height:"30px",mt:"2px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,l.jsx)(wt.Z,{fontSize:"small",color:"disabled"}),(0,l.jsx)(Ie.Z,{inputRef:T,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"}},InputProps:{endAdornment:(0,l.jsx)(Ce.Z,{position:"end",children:(0,l.jsx)(S.Z,{sx:{width:30,height:30},children:H.length?(0,l.jsx)(O.Z,{title:k.t("Clear filter"),children:(0,l.jsx)(Te.Z,{sx:{width:30,height:30},onClick:function(){V(""),null!==T.current&&(T.current.value="")},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})}):null})})},placeholder:k.t("Filter"),variant:"standard",disabled:!K,onChange:function(e){return n=e.target.value.toLowerCase(),null!==_.current&&window.clearTimeout(_.current),void(_.current=window.setTimeout((function(){V(n),_.current=null}),450));var n}})]})}):null,null===p&&u.length?(0,l.jsxs)(l.Fragment,{children:[K?(0,l.jsx)(S.Z,{sx:{ml:3,borderRadius:1,height:"30px",width:"80px",position:"relative"},className:!h||xe||ie||se||null!=ne?null:"pop",children:(0,l.jsxs)(Kr.Z,{size:"small",disabled:!K,children:[(0,l.jsx)(I.Z,{sx:{px:"0 !important",height:"30px"},variant:J.length?"outlined":"contained",onClick:function(){me(!0),te(null)},children:(0,l.jsx)(we.Z,{})}),(0,l.jsx)(I.Z,{sx:{px:"0 !important",height:"30px"},variant:J.length?"outlined":"contained",onClick:function(e){return te(e.currentTarget)},children:(0,l.jsx)(vn.Z,{})})]})}):(0,l.jsx)(G.Z,{spacing:0,sx:{width:"90px",height:"20px",mr:3,my:"5px"}}),K?J.length?(0,l.jsx)(O.Z,{title:k.t("Clear table"),placement:"left",children:(0,l.jsx)(Te.Z,{sx:{width:"30px",height:"30px",mx:3},onClick:function(){return ue(!0)},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})})}):null:(0,l.jsx)(G.Z,{spacing:0,rounded:!0,sx:{width:"30px",height:"30px",mr:2}})]}):null]})]}),(0,l.jsx)(Ti,{sx:{"& .MuiDataGrid-row":{cursor:"pointer"}},onPageSizeChange:function(e){return M(e)},onRowClick:function(e){var n=e.row;return me(n)},rowsPerPageOptions:[10,25,50,100],disableSelectionOnClick:!0,getRowId:function(e){return e._id},pageSize:P,columns:Qe,loading:!K,rows:"string"===typeof H&&H.length?J.filter((function(e){return Object.values(e).some((function(e){return"string"===typeof e&&e.toLowerCase().includes(H.toLowerCase())}))})):J,autoHeight:!0}),K&&u.length?(0,l.jsxs)(D.ZP,{open:!!xe,anchor:"right",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{top:50,bottom:50,left:250},"& .MuiDrawer-paper":{width:"45%",minWidth:"400px",maxWidth:"1200"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute"}},onClose:function(){return Xe()},children:[de?null:(0,l.jsx)(U,{icon:null!==p||"object"!==typeof xe&&!0!==xe?(0,l.jsx)(Qr.Z,{}):"object"===typeof xe?(0,l.jsx)(Jr.Z,{}):(0,l.jsx)(Gr.Z,{}),title:"".concat(a,": ").concat(null===p?"object"===typeof xe?k.t("Edit row"):k.t("Add row"):Number.isInteger(null===xe||void 0===xe?void 0:xe._time)?Tt(1e3*(null===xe||void 0===xe?void 0:xe._time)):"---"),handleClose:function(){return Xe()}}),(0,l.jsx)(B,{children:de?(0,l.jsx)(G.Z,{}):(0,l.jsx)("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),null===p&&("object"===typeof xe?We(e,xe._id):Re(e))},ref:A,children:u.map((function(e,n){var t,r="object"===typeof xe&&null!==xe?null!==(t=xe[e])&&void 0!==t?t:"":null;return(0,l.jsx)(S.Z,{sx:{width:"100%",display:"flex"},children:null===p?(0,l.jsx)(Ie.Z,{variant:"outlined",autoFocus:0===n,defaultValue:r,multiline:!0,maxRows:9,minRows:1,InputProps:{startAdornment:(0,l.jsx)(Ce.Z,{position:"start",children:(0,l.jsx)(ei.Z,{fontSize:"small"})})},label:e,sx:{width:"100%",mb:4,"& .MuiInputBase-multiline":{py:3},"& textarea":{p:"0 !important"}},id:"cell-".concat(e),name:e,onKeyDown:function(e){return"Enter"===e.key&&e.ctrlKey&&Je()}}):(0,l.jsxs)(Ei,{children:[(0,l.jsx)(he.Z,{label:e,size:"small",variant:"outlined"}),(0,l.jsx)(C.Z,{variant:"caption",component:"span",children:ae(r,H,b())})]})},e)}))})}),de?null:(0,l.jsxs)(ri,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return me(!1)},sx:{mr:2},children:null===p?k.t("Cancel"):k.t("Close")}),null===p?(0,l.jsx)(I.Z,{variant:"contained",onClick:Je,children:"object"===typeof xe?k.t("Save"):k.t("Add row")}):null]})]}):null,K&&null===p&&u.length&&J.length&&se?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return ue(!1)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsxs)(Fe.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[a,(0,l.jsx)(It.Z,{}),k.t("Clear table")]}),(0,l.jsx)(Le.Z,{children:(0,l.jsx)(_e.Z,{severity:"warning",children:k.t("Are you sure you want to delete all data in this table?")})}),(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return ue(!1)},children:k.t("Cancel")}),(0,l.jsx)(I.Z,{color:"error",onClick:qe,startIcon:(0,l.jsx)(Ve.Z,{}),children:k.t("Clear table")})]})]}):null,K&&null===p&&u.length&&ie?(0,l.jsxs)($e.Z,{open:!0,onClose:de?function(){}:Ge,fullWidth:!0,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:en,p:2}},children:[de?null:(0,l.jsxs)(Fe.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[a,(0,l.jsx)(It.Z,{}),k.t("Import csv file")]}),(0,l.jsx)(Le.Z,{children:de?(0,l.jsx)(G.Z,{}):null===ge?(0,l.jsx)(zi.Z,{handleFiles:Ye,extensions:["csv"],maxSize:j().max.sourceCode.ioFieldTableSize}):(0,l.jsxs)(S.Z,{children:[(0,l.jsx)(_e.Z,{severity:"info",sx:{mb:3},children:k.t("Use this preview to match each column with the correct entries")}),(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",p:2,mb:3},children:[(0,l.jsx)(an.Z,{id:"skip-first-row",value:Se,onChange:function(e){return Ae(e.target.checked)}}),(0,l.jsx)(S.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",wordWrap:"break-word",overflowWrap:"anywhere",ml:2},children:(0,l.jsxs)(Fr.Z,{htmlFor:"skip-first-row",sx:{cursor:"pointer",userSelect:"none"},children:[(0,l.jsx)(C.Z,{variant:"body2",children:k.t("Do not import the first row")}),(0,l.jsx)(C.Z,{variant:"caption",children:k.t("Check this if the first row in your csv file is a header row")})]})})]}),(0,l.jsxs)(Pi,{children:[(0,l.jsx)(ti.Z,{tooltip:!0,tooltipEmpty:k.t("Column not imported"),tooltipPrefix:k.t("Column imported as"),highlight:!0,maxContent:!0,items:Me,setItems:De,sx:{width:"115px",minWidth:"115px",mr:1}}),(Array.isArray(je)?je:[]).map((function(e,n){return Array.isArray(e)?(0,l.jsx)(O.Z,{title:Se&&0===n?k.t("Row not imported"):null,placement:"left",children:(0,l.jsx)(Mi,{children:(0,i.Z)(e).concat((0,i.Z)(new Array(Ne()-e.length).fill(""))).map((function(e,t){return(0,l.jsx)(Di,{removed:Se&&0===n,excluded:Se&&0===n||!Me[t],children:e},t)}))})},n):null}))]})]})}),de?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:Ge,children:k.t("Cancel")}),null!==ge?(0,l.jsx)(I.Z,{variant:"contained",onClick:Ke,startIcon:(0,l.jsx)(Xr.Z,{}),children:k.t("Import csv file")}):null]})]}):null,(0,l.jsx)(He.Z,{anchorEl:ne,open:Boolean(ne),onClose:function(){return te(null)},children:(0,l.jsxs)(Ue.Z,{onClick:function(){oe(!0),te(null)},children:[(0,l.jsx)(Xr.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{sx:{ml:3},variant:"body2",children:k.t("Import csv")})]})})]})})),Li=Oi,Fi=t(76530),Wi=t(82032),Ui=t(828),Bi=function(e){var n=e.sx,t=(e.container,(0,g.useRef)(null)),r=(0,g.useState)(!1),i=r[0],o=r[1];"object"===typeof n&&null!==n||(n={}),(0,g.useEffect)((function(){var e,n=null!==(e=null===n||void 0===n?void 0:n.current)&&void 0!==e?e:null,r=new IntersectionObserver((function(e){(0,Ui.Z)(e,1)[0].isIntersecting&&(o(!0),r.disconnect())}),{root:n,threshold:.1});return r.observe(t.current),function(){return r.disconnect()}}),[]);var a=i&&"string"===typeof n.backgroundImage?n.backgroundImage:"none";return(0,l.jsx)(S.Z,{ref:t,sx:(0,Je.Z)((0,R.Z)({},n),{backgroundImage:a})})},$i=["png","apng","jpg","jpeg","gif","svg","webp","avif","bmp","tif","tiff","ico"],Hi=function(e){var n=e.onDelete,t=e.filePaths,i=void 0===t?[]:t,a=e.sx,s=void 0===a?{}:a,u=e.children,c=void 0===u?null:u,d=e.maxCount,p=void 0===d?null:d,f=e.tooltip,h=void 0===f?null:f,x=(0,g.useRef)(null),m=(0,v.$)().i18n,y=(0,k.Z)();"object"===typeof s&&null!==s||(s={});var Z=function(){var e=(0,r.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.device.showFileInFolder(e)];case 1:return t.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),j=function(){var e=(0,r.Z)((function(e,t){return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return e.preventDefault(),e.stopPropagation(),"function"!==typeof n?[3,2]:[4,n(t)];case 1:r.sent(),r.label=2;case 2:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}();return(0,l.jsxs)(S.Z,{sx:(0,R.Z)({border:"1px solid ".concat(y.palette.divider),borderRadius:1,p:3,position:"relative",width:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},s),children:[Array.isArray(i)&&i.length?(0,l.jsx)(se.ZP,{container:!0,spacing:4,ref:x,children:i.map((function(e,t){var r="string"===typeof e?e:null===e||void 0===e?void 0:e.filePath,i="object"===typeof e?null===e||void 0===e?void 0:e.runTime:null,o=r.replace(/[\\\/]+$/g,"").replace(/[\\\/]+/g,"/").split("/").pop(),a=o.replace(/^.*\./g,"").toLowerCase();return(0,l.jsx)(se.ZP,{item:!0,children:(0,l.jsx)(O.Z,{title:r,enterDelay:250,enterNextDelay:250,children:(0,l.jsxs)(S.Z,{sx:{width:120,display:"flex",alignItems:"center",flexDirection:"column"},children:[(0,l.jsxs)(I.Z,{onClick:function(){return Z(r)},sx:{width:"100%",height:120,overflow:"hidden",position:"relative",zIndex:0,"&>.delete":{opacity:0,transform:"scale(0.1)"},"&:hover>.delete":{opacity:1,transform:"scale(1)"}},children:["function"===typeof n?(0,l.jsx)(Te.Z,{className:"delete",component:"div",onClick:function(e){return j(e,r)},sx:{position:"absolute",top:2,right:2,"&:hover":{color:y.palette.error.main},transition:"all 100ms linear"},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})}):null,$i.includes(a)?(0,l.jsx)(Bi,{sx:{width:"100%",height:"100%",backgroundImage:"url('".concat((0,Fi.qm)(r),"')"),backgroundSize:"contain",backgroundPosition:"50%",backgroundRepeat:"no-repeat"},container:x}):(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[(0,l.jsx)(Wi.Z,{fontSize:"large",sx:{mb:2}}),(0,l.jsx)(C.Z,{variant:"caption",color:"primary",sx:{fontSize:"0.9rem",lineHeight:"0.9rem",fontFamily:"Inconsolata,monospace"},children:a})]})]}),(0,l.jsxs)(C.Z,{variant:"caption",sx:{mt:1,userSelect:"none",fontFamily:"Yaldevi, sans-serif",textAlign:"center",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",whiteSpace:"normal",wordBreak:"break-word",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%",lineHeight:"1rem",maxHeight:"3rem"},children:[null!==i?(0,l.jsx)(ni,{time:i,tooltip:!1}):null,o]})]})})},t)}))}):(0,l.jsx)(S.Z,{sx:{userSelect:"none",display:"flex",ml:3,mt:3,width:"100%",height:25,alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(C.Z,{variant:"caption",children:m.t("No files selected")})}),c&&(!Number.isInteger(p)||i.length<p)?(0,l.jsx)(S.Z,{sx:{mt:3},children:c}):null,(0,l.jsx)(S.Z,{sx:{mt:3,display:"flex",justifyContent:"end",position:"sticky",bottom:"8px",right:0},children:(0,l.jsx)(O.Z,{title:h,placement:"left",children:(0,l.jsx)(he.Z,{variant:"outlined",sx:{"&:hover":{background:y.palette.background.paper}},label:(0,l.jsx)(C.Z,{variant:"caption",children:Number.isInteger(p)?"".concat(i.length," / ").concat(p," ").concat(m.t("files")):"".concat(i.length," ").concat(1===i.length?m.t("file"):m.t("files"))})})})})]})},Vi=t(92090),qi=function(e){var n,t=e.field,r=(0,g.useState)({}),i=r[0],o=r[1],a="table"===t.type&&"undefined"===typeof i[t.key]||i[t.key];return(0,l.jsx)(S.Z,{sx:{display:"flex",width:"250px",flex:"0 0 250px",flexDirection:"column",justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"},children:(0,l.jsxs)(S.Z,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,l.jsx)(S.Z,{sx:{width:"30px",height:"30px",mr:2},children:t.desc?(0,l.jsx)(Te.Z,{size:"small",onClick:function(){return e=t.key,n=t.type,void o((function(t){var r="table"===n&&"undefined"===typeof t[e]||t[e];return(0,Je.Z)((0,R.Z)({},t),(0,H.Z)({},e,!r))}));var e,n},children:a?(0,l.jsx)(xr.Z,{fontSize:"small"}):(0,l.jsx)(xn.Z,{fontSize:"small"})}):null}),(0,l.jsx)(Fr.Z,{htmlFor:"field-".concat(t.id),sx:{cursor:!["int","string","boolean"].includes(t.type)||Array.isArray(t.options)&&t.options.length?"default":"pointer"},children:(0,l.jsx)(C.Z,{variant:"body2",children:null!==(n=t.name)&&void 0!==n?n:t.key})})]}),t.desc&&a?(0,l.jsx)(C.Z,{variant:"caption",component:"pre",sx:{wordBreak:"break-all",whiteSpace:"preserve",fontFamily:"Yaldevi,sans-serif",mt:2,pl:2},children:t.desc}):null]})})},Ki=function(e){var n=e.agents,t=e.sessionId,i=void 0===t?null:t,a=e.sessionChange,s=void 0===a?function(){}:a,u=(0,x.O)(),d=u.getAgentId,p=u.onAgentId,f=u.getSource,h=u.onSource,m=u.getInputs,y=u.onInputs,Z=u.inputsSetScalars,b=u.inputsAddFiles,w=u.inputsDeleteFile,k=(0,v.$)().i18n,C=(0,g.useRef)(null),I=(0,g.useRef)(null),_=(0,g.useRef)({}),A=(0,g.useRef)([]),T=(0,g.useRef)(null),z=(0,g.useState)((0,c.zu)(n,d())),P=z[0],M=z[1],D=(0,g.useState)(!1),E=D[0],N=D[1],R=(0,g.useState)([]),O=R[0],L=R[1],F=(0,g.useState)({}),W=F[0],U=F[1];(0,g.useEffect)((function(){M((0,c.zu)(n,d()));var e=p((function(e){N(!1),M((0,c.zu)(n,e))}));return function(){e()}}),[n]),(0,g.useEffect)((function(){C.current=null,I.current=null,_.current={},A.current=[],T.current=null,N(!1),"string"===typeof(null===P||void 0===P?void 0:P.id)&&(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,f(P.id)];case 1:return A.current=null!==(n=null===(e=t.sent())||void 0===e?void 0:e.srcInputs)&&void 0!==n?n:[],L(A.current),[4,m(P.id,!0,i)];case 2:return U.apply(void 0,[t.sent()]),window.setTimeout((function(){return N(!0)}),100),[2]}}))}))();var e=h(function(){var e=(0,r.Z)((function(e){var n,t,r,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return n=e.agentId,t=e.sourceCode,n!==(null===P||void 0===P?void 0:P.id)?[3,2]:(_.current={},JSON.stringify(A.current)!==JSON.stringify(null!==(r=null===t||void 0===t?void 0:t.srcInputs)&&void 0!==r?r:[])?(N(!1),A.current=null!==(l=null===t||void 0===t?void 0:t.srcInputs)&&void 0!==l?l:[],L(A.current),[4,m(n,!0,i)]):[3,2]);case 1:U.apply(void 0,[o.sent()]),window.setTimeout((function(){return N(!0)}),100),o.label=2;case 2:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()),n=y((function(e){var n=e.agentId,t=e.inputs,r=e.inputSessionId;n===(null===P||void 0===P?void 0:P.id)&&r===i&&U(t)}));return function(){e(),n()}}),[P]),(0,g.useEffect)((function(){E&&window.setTimeout((function(){return $()}),200)}),[E]),(0,g.useEffect)((function(){if("string"===typeof(null===P||void 0===P?void 0:P.id)){var e=setTimeout((0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return"string"!==typeof i?[3,2]:(n=!0,Array.isArray(O)&&O.length&&(n=O.reduce((function(e,n){if(e){var t=(0,c.Gr)(O,n.key,W),r=t.fieldShown,i=t.fieldEmpty;return!r||!i||"undefined"!==typeof n.default}return e}),!0)),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.session.updateReady(P.id,i,n)]);case 1:t.sent()&&s(),t.label=2;case 2:return[2]}}))})),200);return function(){clearTimeout(e)}}}),[O,W]);var B=function(){var e=(0,r.Z)((function(){var e,n=arguments;return(0,o.__generator)(this,(function(t){return e=n.length>0&&void 0!==n[0]?n[0]:100,null!==C.current&&window.clearTimeout(C.current),C.current=window.setTimeout((function(){C.current=null,$()}),e),[2]}))}));return function(){return e.apply(this,arguments)}}(),$=function(){var e=(0,r.Z)((function(){var e,n,t,r,l,a,s,u,c,d,p,f,h,x;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if("string"!==typeof(null===P||void 0===P?void 0:P.id))return[2];if(!T.current||!E)return[2];e={},n=!0,t=!1,r=void 0;try{for(l=T.current.querySelectorAll("form[data-scalar]")[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)s=a.value,e[s.getAttribute("data-scalar")]=new FormData(s)}catch(m){t=!0,r=m}finally{try{n||null==l.return||l.return()}finally{if(t)throw r}}u={},c=!0,d=!1,p=void 0;try{for(f=O[Symbol.iterator]();!(c=(h=f.next()).done);c=!0)if(x=h.value,!["files","table"].includes(x.type)&&(0,Lr.Z)(e[x.key],FormData))switch(x.type){case"int":case"string":u[x.key]=x.isList?e[x.key].getAll(x.key):e[x.key].get(x.key);break;case"boolean":u[x.key]="on"===e[x.key].get(x.key)}}catch(m){d=!0,p=m}finally{try{c||null==f.return||f.return()}finally{if(d)throw p}}return[4,Z(P.id,u,i)];case 1:return o.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,r.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return Array.isArray(n)&&n.length?[4,b(d(),e,n.map((function(e){return e.path})),i)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),V=function(){var e=(0,r.Z)((function(e,n){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,w(d(),e,n,i)];case 1:return t.sent(),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}();return I.current=null,(0,l.jsx)(S.Z,{children:E?Array.isArray(O)&&O.length?(0,l.jsx)(S.Z,{sx:{p:3,pb:0,flexGrow:1},ref:T,children:O.map((function(e){var n=function(e){var n,t="files"===e.type?[]:null!==(n=e.default)&&void 0!==n?n:"";if("undefined"===typeof _.current[e.key]){var r=W[e.key];switch(e.type){case"int":case"string":e.isList?Array.isArray(r)||(r=null!==t?[t]:[]):("int"!==e.type||Number.isInteger(r)||(r=t),"string"===e.type&&"string"!==typeof r&&(r=t));break;case"boolean":"boolean"!==typeof r&&(r=t);break;case"files":Array.isArray(r)||(r=t)}_.current[e.key]=r}return _.current[e.key]}(e),t=(0,c.Gr)(O,e.key,W),r=t.fieldShown,o=t.fieldEmpty;return r&&o&&"undefined"===typeof e.default&&null===I.current&&(I.current=e.id),(0,l.jsxs)(S.Z,{sx:{display:r?"flex":"none",mb:3},children:[(0,l.jsx)(qi,{field:e}),(0,l.jsx)(S.Z,{sx:{width:"100%"},children:["string","int"].includes(e.type)?(0,l.jsx)($r,{field:e,firstValue:n,actionSet:B,refFirstEmpty:I}):"boolean"===e.type?(0,l.jsx)(Hr,{field:e,firstValue:n,actionSet:B}):"files"===e.type?(0,l.jsx)(Hi,{maxCount:j().max.sourceCode.ioInputFileCount,onDelete:function(n){return V(e.key,n)},filePaths:Array.isArray(W[e.key])?W[e.key]:n,sx:{mb:3},children:(0,l.jsx)(zi.Z,{multiple:!0,pop:I.current===e.id,maxCount:j().max.sourceCode.ioInputFileCount,minSize:null===e||void 0===e?void 0:e.min,maxSize:null===e||void 0===e?void 0:e.max,extensions:Array.isArray(null===e||void 0===e?void 0:e.extensions)?e.extensions:["txt"],withPaths:!0,handleFiles:function(n){return H(e.key,n)}})}):"table"===e.type?(0,l.jsx)(Li,{pop:I.current===e.id,fieldKey:e.key,fieldName:e.name,fieldColumns:e.columns,sessionId:i}):null})]},"".concat(e.id,"-").concat(e.type))}))}):null===i?(0,l.jsx)(S.Z,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(Vi.default,{title:k.t("No inputs"),message:k.t("This module has no settings to configure"),sx:{"&.content-center":{minHeight:"100%"}}})}):null:(0,l.jsx)(S.Z,{sx:{height:"100%",position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,l.jsx)(at.Z,{grey:!0,size:128,className:"zoom-in"})})})},Yi=t(83210),Gi=t(30601),Xi=t(48866),Ji=(0,w.ZP)(S.Z)((function(e){var n,t=e.theme;return{"& .react-datepicker-popper":{zIndex:5},"& .react-datepicker-wrapper":{width:"100%"},"& .react-datepicker":(n={padding:t.spacing(2,0),color:t.palette.text.primary,borderRadius:t.shape.borderRadius,fontFamily:t.typography.fontFamily,backgroundColor:t.palette.background.paper,boxShadow:t.shadows["bordered"===ee.Z.skin?0:7],border:"bordered"===ee.Z.skin?"1px solid ".concat(t.palette.divider):"none","& .react-datepicker__header":{padding:0,border:"none",fontWeight:400,backgroundColor:t.palette.background.paper,"& .react-datepicker__day-name":{margin:0}},"& .react-datepicker-year-header":{lineHeight:2.1,marginBottom:"0.5rem",color:t.palette.text.primary},"& .react-datepicker__triangle":{display:"none"},"& > .react-datepicker__navigation":{top:t.spacing(3),"&.react-datepicker__navigation--previous":{border:"none",backgroundImage:"".concat("url('data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' style=\\'width:24px;height:24px\\' viewBox=\\'0 0 24 24\\'%3E%3Cpath fill=\\'currentColor\\' d=\\'M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z\\' /%3E%3C/svg%3E')".replace("currentColor",t.palette.text.secondary).replace("#","%23")),height:"24px",width:"24px","& .react-datepicker__navigation-icon":{display:"none"}},"&.react-datepicker__navigation--next":{border:"none",backgroundImage:"".concat("url('data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' style=\\'width:24px;height:24px\\' viewBox=\\'0 0 24 24\\'%3E%3Cpath fill=\\'currentColor\\' d=\\'M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z\\' /%3E%3C/svg%3E')".replace("currentColor",t.palette.text.secondary).replace("#","%23")),height:"24px",width:"24px","& .react-datepicker__navigation-icon":{display:"none"}},"&.react-datepicker__navigation--next--with-time":{right:"122px"},"&:focus, &:active":{outline:0}},"& .react-datepicker__current-month":{lineHeight:2.1,fontSize:"1rem",fontWeight:400,letterSpacing:"0.15px",marginBottom:t.spacing(2),color:t.palette.text.primary},"& .react-datepicker__day-name":{lineHeight:1.5,width:"2.25rem",fontSize:"0.75rem",letterSpacing:"0.4px",color:t.palette.text.secondary},"& .react-datepicker__day":{margin:0,width:"2.25rem",lineHeight:2.75,height:"2.25rem",borderRadius:"50%",color:t.palette.text.primary,"&.react-datepicker__day--selected, &.react-datepicker__day--keyboard-selected":{color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&.react-datepicker__day--in-range, &.react-datepicker__day--in-selecting-range":{borderRadius:0,color:t.palette.primary.main,backgroundColor:"".concat((0,Ar.E)(t.palette.primary.main,.06)," !important"),"&:empty":{backgroundColor:"transparent !important"}},"&.react-datepicker__day--selected.react-datepicker__day--in-selecting-range.react-datepicker__day--selecting-range-start, &.react-datepicker__day--selected.react-datepicker__day--range-start.react-datepicker__day--in-range, &.react-datepicker__day--range-start":{borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&.react-datepicker__day--range-end":{borderTopRightRadius:"50%",borderBottomRightRadius:"50%",color:t.palette.common.white,backgroundColor:"".concat(t.palette.primary.main," !important")},"&:focus, &:active":{outline:0},"&.react-datepicker__day--outside-month":{height:"auto"},"&.react-datepicker__day--outside-month, &.react-datepicker__day--disabled:not(.react-datepicker__day--selected)":{color:t.palette.text.disabled,"&:hover":{backgroundColor:"transparent"}},"&.react-datepicker__day--highlighted, &.react-datepicker__day--highlighted:hover":{color:t.palette.success.main,backgroundColor:(0,Ar.E)(t.palette.success.main,.12)},"&.react-datepicker__day--today":{fontWeight:400}},"& .react-datepicker__header__dropdown":{"& .react-datepicker__month-dropdown-container:not(:last-child)":{marginRight:t.spacing(8)},"& .react-datepicker__month-dropdown-container, & .react-datepicker__year-dropdown-container":{marginBottom:t.spacing(4)},"& .react-datepicker__month-read-view--selected-month, & .react-datepicker__year-read-view--selected-year":{fontSize:"0.875rem",marginRight:t.spacing(1),color:t.palette.text.primary},"& .react-datepicker__month-read-view:hover .react-datepicker__month-read-view--down-arrow, & .react-datepicker__year-read-view:hover .react-datepicker__year-read-view--down-arrow":{borderTopColor:t.palette.text.secondary,borderRightColor:t.palette.text.secondary},"& .react-datepicker__month-read-view--down-arrow, & .react-datepicker__year-read-view--down-arrow":{top:4,borderTopColor:t.palette.text.disabled,borderRightColor:t.palette.text.disabled},"& .react-datepicker__month-dropdown, & .react-datepicker__year-dropdown":{paddingTop:t.spacing(1.5),paddingBottom:t.spacing(1.5),borderColor:t.palette.divider,borderRadius:t.shape.borderRadius,backgroundColor:t.palette.background.paper,boxShadow:"light"===t.palette.mode?t.shadows[8]:t.shadows[9]},"& .react-datepicker__month-option, & .react-datepicker__year-option":{paddingTop:t.spacing(.5),paddingBottom:t.spacing(.5),"&:hover":{backgroundColor:t.palette.action.hover}},"& .react-datepicker__month-option.react-datepicker__month-option--selected_month":{backgroundColor:(0,Ar.E)(t.palette.primary.main,.08),"&:hover":{backgroundColor:(0,Ar.E)(t.palette.primary.main,.12)},"& .react-datepicker__month-option--selected":{display:"none"}},"& .react-datepicker__year-option.react-datepicker__year-option--selected_year":{backgroundColor:(0,Ar.E)(t.palette.primary.main,.08),"&:hover":{backgroundColor:(0,Ar.E)(t.palette.primary.main,.12)},"& .react-datepicker__year-option--selected":{display:"none"}},"& .react-datepicker__year-option":{"& .react-datepicker__navigation--years-upcoming":{width:9,height:9,borderStyle:"solid",borderWidth:"3px 3px 0 0",transform:"rotate(-45deg)",borderTopColor:t.palette.text.disabled,borderRightColor:t.palette.text.disabled,margin:"".concat(t.spacing(2.75)," auto ").concat(t.spacing(0))},"&:hover .react-datepicker__navigation--years-upcoming":{borderTopColor:t.palette.text.secondary,borderRightColor:t.palette.text.secondary},"& .react-datepicker__navigation--years-previous":{width:9,height:9,borderStyle:"solid",borderWidth:"0 0 3px 3px",transform:"rotate(-45deg)",borderLeftColor:t.palette.text.disabled,borderBottomColor:t.palette.text.disabled,margin:"".concat(t.spacing(0)," auto ").concat(t.spacing(2.75))},"&:hover .react-datepicker__navigation--years-previous":{borderLeftColor:t.palette.text.secondary,borderBottomColor:t.palette.text.secondary}}},"& .react-datepicker__month":{marginTop:t.spacing(3)}},(0,H.Z)(n,t.breakpoints.down("sm"),{"& .react-datepicker__month":{marginLeft:0,marginRight:0,marginBottom:0}}),(0,H.Z)(n,"& .react-datepicker__month, & .react-datepicker__year",{"& .react-datepicker__month-text, & .react-datepicker__year-text, & .react-datepicker__quarter-text":{height:"2rem",alignItems:"center",display:"inline-flex",justifyContent:"center","&:hover":{borderRadius:t.shape.borderRadius},"&:focus, &:active":{outline:0}},"& .react-datepicker__quarter--selected, & .react-datepicker__year-text--selected, & .react-datepicker__month--selected, & .react-datepicker__quarter-text--keyboard-selected, & .react-datepicker__month-text--keyboard-selected, & .react-datepicker__year-text--keyboard-selected":{color:t.palette.common.white,borderRadius:t.shape.borderRadius,backgroundColor:"".concat(t.palette.primary.main," !important")},"& .react-datepicker__week-number":{fontWeight:600,color:t.palette.text.primary}}),(0,H.Z)(n,"& .react-datepicker__year-wrapper",{maxWidth:205,justifyContent:"center"}),(0,H.Z)(n,"& .react-datepicker__input-time-container",(0,R.Z)({display:"flex",alignItems:"center"},"rtl"===t.direction?{flexDirection:"row-reverse"}:{})),(0,H.Z)(n,"& .react-datepicker__today-button",{borderRadius:"1rem",margin:"0 1rem 0.3rem",color:t.palette.common.white,backgroundColor:t.palette.primary.main}),(0,H.Z)(n,"& .react-datepicker__time-container",{borderLeftColor:t.palette.divider}),(0,H.Z)(n,"&.react-datepicker--time-only, & .react-datepicker__time-container",{width:"7rem",padding:t.spacing(1.2,0),"& .react-datepicker-time__header":{marginBottom:t.spacing(3),color:t.palette.text.primary,fontSize:t.typography.body2.fontSize},"& .react-datepicker__time":{background:t.palette.background.paper,"& .react-datepicker__time-box .react-datepicker__time-list-item--disabled":{color:t.palette.text.disabled}},"& .react-datepicker__time-list-item":{lineHeight:1.75,height:"auto !important",marginLeft:t.spacing(3.2),marginRight:t.spacing(1.2),color:t.palette.text.primary,borderRadius:t.shape.borderRadius,"&:focus, &:active":{outline:0},"&:hover":{backgroundColor:"".concat(t.palette.action.hover," !important")},"&.react-datepicker__time-list-item--selected":{color:"".concat(t.palette.common.white," !important"),backgroundColor:"".concat(t.palette.primary.main," !important")}},"& .react-datepicker__time-box":{width:"100%"},"& .react-datepicker__time-list":{"&::-webkit-scrollbar":{width:8},"&::-webkit-scrollbar-track":{background:t.palette.background.paper},"&::-webkit-scrollbar-thumb":{background:"#aaa",borderRadius:"10px"},"&::-webkit-scrollbar-thumb:hover":{background:"#999"}}}),(0,H.Z)(n,"&.react-datepicker--time-only .react-datepicker__time-container",{width:"calc(7rem - 2px)"}),(0,H.Z)(n,"& .react-datepicker__day:hover, & .react-datepicker__month-text:hover, & .react-datepicker__quarter-text:hover, & .react-datepicker__year-text:hover",{backgroundColor:t.palette.action.hover}),n),"& .react-datepicker__close-icon":(0,Je.Z)((0,R.Z)({paddingRight:t.spacing(4)},"rtl"===t.direction?{right:0,left:"auto"}:{}),{"&:after":{width:"unset",height:"unset",fontSize:"1.5rem",color:t.palette.text.primary,backgroundColor:"transparent !important"}})}})),Qi=t(9198),eo=t.n(Qi),no=t(25919),to=t(47312),ro=t(9479),io=t(76680),oo=t(33619),lo=function(e){var n,t=e.session,a=e.onChange,s=void 0===a?function(){}:a,u=(0,v.$)().i18n,c=(0,k.Z)(),d=(0,g.useRef)(null),p=(0,g.useRef)(null),f=(0,g.useState)(null!==(n=t.sessionInfo)&&void 0!==n?n:{day:"*",hour:"*",minute:"0"}),h=f[0],x=f[1];(0,g.useEffect)((function(){"object"===typeof t.sessionInfo&&null!==t.sessionInfo&&x(structuredClone(t.sessionInfo))}),[t.sessionInfo]);var m=function(e,n){null!==d.current&&window.clearTimeout(d.current),x((function(t){var i=structuredClone(t);do{var l=e.match(/^(day|hour|minute)\-type$/);if(l){if("all"===n){i[l[1]]="*";break}if("modulo"===n){i[l[1]]="%2";break}if("list"===n){i[l[1]]="day"===l[1]?"1":"0";break}if("day"===l[1]&&"dayofweek"===n){i[l[1]]="w1";break}}if(["day","hour","minute"].includes(e)){if(Array.isArray(n)){(n=n.map((function(e){return parseInt(e,10)})).filter((function(e){return Number.isInteger(e)&&e>=0}))).length&&(i[e]="w"===i[e][0]?"w".concat(n.join(",")):n.join(","));break}if("%"===i[e][0]){var a="day"===e?31:"hour"===e?23:59;n=parseInt(n,10),(!Number.isInteger(n)||n<2)&&(n=2),n>a&&(n=a),i[e]="%".concat(n)}}}while(0);return d.current=window.setTimeout((0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return s(i),d.current=null,[2]}))})),450),i}))},y=function(e){var n=[],t=!0,r=!1,i=void 0;try{for(var o,l=p.current.querySelectorAll("[name=".concat(e,"][type=checkbox]"))[Symbol.iterator]();!(t=(o=l.next()).done);t=!0){var a=o.value;a.checked&&n.push(a.value)}}catch(s){r=!0,i=s}finally{try{t||null==l.return||l.return()}finally{if(r)throw i}}m(e,n)},Z=[{key:"day",label:u.t("Days"),icon:(0,l.jsx)(ro.Z,{})},{key:"hour",label:u.t("Hours"),icon:(0,l.jsx)(oo.Z,{})},{key:"minute",label:u.t("Minutes"),icon:(0,l.jsx)(io.Z,{})}],j=[u.t("Monday"),u.t("Tuesday"),u.t("Wednesday"),u.t("Thursday"),u.t("Friday"),u.t("Saturday"),u.t("Sunday")];return(0,l.jsx)(S.Z,{ref:p,children:Z.map((function(e){var n=null,t=function(){var t,r=null!==(t=h[e.key])&&void 0!==t?t:"";if("*"===r)return"all";if("%"===r[0]){var i=Math.abs(parseInt(r.substring(1),10));if(Number.isInteger(i)&&i>=2)return n=i,"modulo"}if(r.match(/^\d+(?:,\d+)*?$/)){var o=r.split(",").map((function(e){return Math.abs(parseInt(e.trim(),10))})).filter((function(e){return Number.isInteger(e)}));if(o.length)return n=o,"list"}if("day"===e.key&&r.match(/^w\d+(?:,\d+)*?$/)){var l=r.substring(1).split(",").map((function(e){return Math.abs(parseInt(e.trim(),10))})).filter((function(e){return Number.isInteger(e)&&e>=1&&e<=7}));if(l.length)return n=l,"dayofweek"}}();return(0,l.jsxs)(S.Z,{sx:{mb:4,width:"100%"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",width:"100%"},children:[(0,l.jsxs)(We.Z,{fullWidth:!0,children:[(0,l.jsx)(to.Z,{sx:{px:2,background:c.palette.background.paper,ml:-1},children:e.label}),(0,l.jsxs)(Br.Z,{name:"".concat(e.key,"-type"),value:null!==t&&void 0!==t?t:"",required:!0,startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{mr:-1},children:e.icon}),onChange:function(n){return m("".concat(e.key,"-type"),n.target.value)},fullWidth:!0,children:[(0,l.jsx)(Ue.Z,{value:"all",children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?u.t("Every day"):"hour"===e.key?u.t("Every hour"):u.t("Every minute")})}),(0,l.jsx)(Ue.Z,{value:"modulo",children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?u.t("Every n days of the month"):"hour"===e.key?u.t("Every n hours"):u.t("Every n minutes")})}),(0,l.jsx)(Ue.Z,{value:"list",children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:"day"===e.key?u.t("Specific days of the month"):"hour"===e.key?u.t("Specific hours"):u.t("Specific minutes")})}),"day"===e.key?(0,l.jsx)(Ue.Z,{value:"dayofweek",children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",fontSize:"1rem"},children:u.t("Specific days of the week")})}):null]})]}),"modulo"===t?(0,l.jsx)(Ie.Z,{fullWidth:!0,sx:{ml:3},name:e.key,type:"number",inputMode:"numeric",onChange:function(n){return m(e.key,n.target.value)},inputProps:{min:2,max:"day"===e.key?31:"hour"===e.key?23:59},value:n}):null]}),"all"===t?(0,l.jsx)("input",{type:"hidden",name:e.key,value:"*"}):null,"list"===t?(0,l.jsx)(S.Z,{sx:{px:4,mb:4},children:(0,i.Z)(Array("day"===e.key?31:"hour"===e.key?24:60).keys()).map((function(t){var r="day"===e.key?t+1:t,i="day"===e.key?"".concat(r):"".concat(r).padStart(2,"0");return(0,l.jsx)(Wr.Z,{label:i,sx:{mr:4,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi,sans-serif"}},control:(0,l.jsx)(Ur.Z,{inputProps:{name:e.key},value:r,checked:(Array.isArray(n)?n:[]).includes(r),onChange:function(){return y(e.key)}})},"".concat(e.key,"-").concat(r))}))}):null,"dayofweek"===t?(0,l.jsx)(S.Z,{sx:{px:4,mb:4},children:(0,i.Z)(Array(7).keys()).map((function(t){var r=t+1,i=j[t];return(0,l.jsx)(Wr.Z,{label:i,sx:{mr:4,"& .MuiFormControlLabel-label":{fontSize:"0.85rem",fontFamily:"Yaldevi,sans-serif",userSelect:"none"}},control:(0,l.jsx)(Ur.Z,{inputProps:{name:e.key},value:r,checked:(Array.isArray(n)?n:[]).includes(r),onChange:function(){return y(e.key)}})},"".concat(e.key,"-").concat(r))}))}):null]},e.key)}))})},ao=function(e){var n=e.agentId,t=e.session,i=e.fetchAll,a=void 0===i?function(){}:i,s=function(){var e=(0,r.Z)((function(e){var r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return"string"!==typeof n?[2]:[4,null===(r=window.sdk)||void 0===r?void 0:r.ipc.session.updateInfo(n,t.sessionId,e)];case 1:return i.sent(),[4,a()];case 2:return i.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),u=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,s({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes()})];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),c=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,s(e)];case 1:return n.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}();return(0,l.jsx)(S.Z,{sx:{width:"100%"},children:"schedule"===t.sessionType?(0,l.jsx)(Ji,{children:(0,l.jsx)(eo(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:new Date(t.sessionInfo.year,t.sessionInfo.month-1,t.sessionInfo.day,t.sessionInfo.hour,t.sessionInfo.minute),minDate:new Date,dateFormat:"MMMM d, yyyy @ h:mm aa",onChange:function(e){return u(e)},customInput:(0,l.jsx)(Ie.Z,{fullWidth:!0,InputProps:{id:"trigger-info",startAdornment:(0,l.jsx)(Ce.Z,{position:"start",children:(0,l.jsx)(no.Z,{sx:{mr:-3}})})}})})}):(0,l.jsx)(lo,{session:t,onChange:function(e){return c(e)}})})},so=function(e){var n,t=e.agentId,i=e.session,a=e.fetchAll,s=void 0===a?function(){}:a,u=(0,g.useRef)(null),c=(0,g.useRef)(null),d=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){return null!==u.current&&window.clearTimeout(u.current),u.current=window.setTimeout((0,r.Z)((function(){var n,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return"string"!==typeof t||"string"!==typeof(null===i||void 0===i?void 0:i.sessionId)?[2]:[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.session.updateName(t,i.sessionId,e)];case 1:return r=o.sent(),c.current.value=r,[4,s()];case 2:return o.sent(),u.current=null,[2]}}))})),450),[2]}))}));return function(n){return e.apply(this,arguments)}}();return(0,l.jsx)(S.Z,{sx:{width:"100%"},children:(0,l.jsx)(Ie.Z,{inputRef:c,id:"trigger-name",InputLabelProps:{shrink:!0},InputProps:{startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{mr:-1},children:(0,l.jsx)(ei.Z,{})})},onChange:function(e){return d(e.target.value)},type:"string",fullWidth:!0,inputMode:"text",inputProps:{maxLength:32},defaultValue:null!==(n=null===i||void 0===i?void 0:i.sessionName)&&void 0!==n?n:""})})},uo=function(e){var n,t=e.field,r=(0,g.useState)({}),i=r[0],o=r[1],a=i[t.key];return(0,l.jsx)(S.Z,{sx:{display:"flex",width:"250px",flex:"0 0 250px",flexDirection:"column",justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"},children:(0,l.jsxs)(S.Z,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"start",alignItems:"center"},children:[(0,l.jsx)(S.Z,{sx:{width:"30px",height:"30px",mr:2},children:t.desc?(0,l.jsx)(Te.Z,{size:"small",onClick:function(){return e=t.key,void o((function(n){return(0,Je.Z)((0,R.Z)({},n),(0,H.Z)({},e,!n[e]))}));var e},children:a?(0,l.jsx)(xr.Z,{fontSize:"small"}):(0,l.jsx)(xn.Z,{fontSize:"small"})}):null}),(0,l.jsx)(Fr.Z,{htmlFor:"trigger-".concat(t.key),sx:{cursor:"name"===(null===t||void 0===t?void 0:t.key)?"pointer":"default"},children:(0,l.jsx)(C.Z,{variant:"body2",children:null!==(n=t.name)&&void 0!==n?n:t.key})})]}),t.desc&&a?(0,l.jsx)(C.Z,{variant:"caption",component:"pre",sx:{wordBreak:"break-all",whiteSpace:"preserve",fontFamily:"Yaldevi,sans-serif",mt:2,pl:2},children:t.desc}):null]})})},co=function(e){var n,t=e.agents,i=e.sessionType,a=void 0===i?"schedule":i,s=(0,x.O)(),u=s.getAgentId,d=s.onAgentId,p=s.onMachineStatus,f=(0,v.$)().i18n,h=(0,g.useState)(!1),m=h[0],y=h[1],Z=(0,g.useState)(null),j=Z[0],b=Z[1],w=(0,g.useState)(null),k=w[0],_=w[1],A=(0,g.useState)(""),T=A[0],z=A[1],P=(0,g.useState)(10),M=P[0],E=P[1],N=(0,g.useState)(!1),R=N[0],L=N[1],F=(0,g.useState)(null),W=F[0],$=F[1],H=(0,g.useState)([]),V=H[0],q=H[1],K=(0,g.useRef)(null),Y=(0,g.useRef)(null),X=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return"string"!==typeof(null===W||void 0===W?void 0:W.id)?[2]:[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.session.readAll(W.id,a)];case 1:return n=t.sent(),q((Array.isArray(n)?n:[]).map((function(e){return"object"!==typeof e||"object"!==typeof(null===e||void 0===e?void 0:e.sessionInfo)?null:(e.sessionDescription=function(e,n,t){if("schedule"===n)return Number.isInteger(e.year)&&Number.isInteger(e.month)&&Number.isInteger(e.day)&&Number.isInteger(e.hour)&&Number.isInteger(e.minute)?At(new Date(e.year,e.month-1,e.day,e.hour,e.minute).getTime(),"en",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}):t.t("Does not run");var r=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null;do{if("string"!==typeof e)break;if("*"===e){r=n?t.t("every hour"):t.t("every minute");break}if("%"===e[0]){var i=Math.abs(parseInt(e.substring(1),10));i>=2&&i<=1e3&&(r=n?t.t("every {{numModulo}} hours",{numModulo:i}):t.t("every {{numModulo}} minutes",{numModulo:i}));break}if(e.match(/^\d+(?:,\d+)*?$/)){var o=e.split(",").map((function(e){return Math.abs(parseInt(e.trim(),10))})).filter((function(e){return Number.isInteger(e)})).map((function(e){return"".concat(e).padStart(2,"0")}));o.length&&(r=n?o.length>1?t.t("hours {{list}}",{list:o.join(", ")}):t.t("hour {{value}}",{value:o[0]}):o.length>1?t.t("minutes {{list}}",{list:o.join(", ")}):t.t("minute {{value}}",{value:o[0]}));break}}while(0);return r},i=[function(e){var n=function(){if("string"!==typeof e)return"break";if("*"===e)return r=t.t("Every day"),"break";if("%"===e[0]){var n=Math.abs(parseInt(e.substring(1),10));return n>=2&&n<=1e3&&(r=t.t("Every {{numModulo}} days of the month",{numModulo:n})),"break"}if(e.match(/^\d+(?:,\d+)*?$/)){var i=e.split(",").map((function(e){return Math.abs(parseInt(e.trim(),10))})).filter((function(e){return Number.isInteger(e)}));return i.length&&(r=1===i.length?t.t("Day {{n}} of every month",{n:i[0]}):t.t("Days {{list}} of every month",{list:i.join(", ")})),"break"}if(e.match(/^w\d+(?:,\d+)*?$/)){var o=e.substring(1).split(",").map((function(e){return Math.abs(parseInt(e.trim(),10))})).filter((function(e){return Number.isInteger(e)&&e>=1&&e<=7})),l={1:t.t("Monday"),2:t.t("Tuesday"),3:t.t("Wednesday"),4:t.t("Thursday"),5:t.t("Friday"),6:t.t("Saturday"),7:t.t("Sunday")};return o.length&&(r=o.map((function(e){return l[e]})).join(", ")),"break"}},r=null;do{if("break"===n())break}while(0);return r}(e.day),r(e.hour,!0),r(e.minute)].filter((function(e){return"string"===typeof e}));return 3===i.length?i.join(" @ "):t.t("Does not run")}(e.sessionInfo,a,f),e)})).filter(Boolean)),[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){$((0,c.zu)(t,u()));var e=d((function(e){L(!1),y(!1),b(null),_(null),z(""),$((0,c.zu)(t,e))}));return function(){e()}}),[t]),(0,g.useEffect)((function(){K.current=null,Y.current=null,L(!1),y(!1),b(null),_(null),z("");var e=p((function(e){var n=e.agentId;W.id===n&&window.setTimeout((function(){X()}),750)}));return"string"===typeof(null===W||void 0===W?void 0:W.id)&&(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,X()];case 1:return e.sent(),window.setTimeout((function(){return L(!0)}),200),[2]}}))}))(),function(){e()}}),[W]);var J=[{field:"ready",width:50,renderHeader:function(){return""},headerName:f.t("Ready"),renderCell:function(e){var n=e.row,t=n.sessionReady?f.t("Ready"):f.t("Inputs missing - will not run");return(0,l.jsx)(O.Z,{title:t,children:(0,l.jsx)(Xi.Z,{color:n.sessionReady?"success":"warning",sx:{ml:-1},fontSize:"small"})})},valueGetter:function(e){return e.row.sessionReady?1:0}},{field:"count",minWidth:80,headerName:f.t("Run count"),renderCell:function(e){var n,t=e.row,r=t.sessionRunCount?1===t.sessionRunCount?f.t("Ran once"):f.t("Ran {{count}} times",{count:t.sessionRunCount}):f.t("No runs");return(0,l.jsx)(O.Z,{title:r,children:(0,l.jsx)(C.Z,{variant:"caption",children:null!==(n=t.sessionRunCount)&&void 0!==n?n:f.t("No runs")})})},valueGetter:function(e){var t=e.row;return null!==(n=t.sessionRunCount)&&void 0!==n?n:0}},{field:"name",width:250,headerName:f.t("Trigger name"),renderCell:function(e){var n=e.row;return(0,l.jsx)(O.Z,{title:n.sessionName,children:(0,l.jsx)(C.Z,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:ae(n.sessionName,T,u())})})},valueGetter:function(e){return e.row.sessionName}},{field:"session",flex:1,headerName:"schedule"===a?f.t("Trigger date and time"):f.t("Trigger cadence"),hideable:!1,renderCell:function(e){var n=e.row;return(0,l.jsx)(O.Z,{title:n.sessionDescription,children:(0,l.jsx)(C.Z,{variant:"caption",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textTransform:"none",maxWidth:"100%"},children:ae(n.sessionDescription,T,u())})})},valueGetter:function(e){return e.row.sessionDescription}},{width:40,field:"_actions_",hideable:!1,filterable:!1,headerName:f.t("Actions"),renderHeader:function(){return""},renderCell:function(e){var n=e.row;return(0,l.jsx)(S.Z,{sx:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsx)(Te.Z,{size:"small",onClick:function(e){e.preventDefault(),e.stopPropagation(),_(n.sessionId)},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})})})}}],Q=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return"string"!==typeof(null===W||void 0===W?void 0:W.id)?[2]:(L(!1),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.session.create(W.id,W.installedModuleId,a)]);case 1:return"string"!==typeof(n=t.sent())?[3,3]:[4,X()];case 2:t.sent(),b(n),t.label=3;case 3:return L(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=(0,r.Z)((function(){var e,n,t=arguments;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return e=t.length>0&&void 0!==t[0]?t[0]:null,y(!1),_(null),"string"!==typeof(null===W||void 0===W?void 0:W.id)?[2]:(L(!1),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.session.delete(W.id,a,e)]);case 1:return r.sent(),[4,X()];case 2:return r.sent(),L(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ne="string"===typeof j?V.reduce((function(e,n){return n.sessionId===j?n:e}),null):null;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.Z,{sx:{p:4},children:[(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",justifyContent:"end",alignItems:"center",mb:4},children:[R&&V.length?(0,l.jsx)(S.Z,{sx:{width:"200px",height:"30px",mt:"2px",display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",alignItems:"center"},children:[(0,l.jsx)(wt.Z,{fontSize:"small",color:"disabled"}),(0,l.jsx)(Ie.Z,{inputRef:Y,sx:{ml:1,width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"}},InputProps:{endAdornment:(0,l.jsx)(Ce.Z,{position:"end",children:(0,l.jsx)(S.Z,{sx:{width:30,height:30},children:T.length?(0,l.jsx)(O.Z,{title:f.t("Clear filter"),children:(0,l.jsx)(Te.Z,{sx:{width:30,height:30},onClick:function(){z(""),null!==Y.current&&(Y.current.value="")},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})}):null})})},placeholder:f.t("Filter"),variant:"standard",disabled:!R,onChange:function(e){return n=e.target.value.toLowerCase(),null!==K.current&&window.clearTimeout(K.current),void(K.current=window.setTimeout((function(){z(n),K.current=null}),450));var n}})]})}):null,(0,l.jsx)(I.Z,{size:"small",startIcon:(0,l.jsx)(we.Z,{}),sx:{height:"32px"},variant:!R||V.length?"outlined":"contained",onClick:Q,children:f.t("Add")}),R?V.length?(0,l.jsx)(O.Z,{title:f.t("Delete all"),children:(0,l.jsx)(Te.Z,{disabled:!R||!V.length,sx:{width:"30px",height:"30px",mx:3},onClick:function(){return y(!0)},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})})}):null:(0,l.jsx)(G.Z,{spacing:0,rounded:!0,sx:{width:"30px",height:"30px",mx:3}})]}),(0,l.jsx)(Ti,{sx:{"& .MuiDataGrid-row":{cursor:"pointer"}},onPageSizeChange:function(e){return E(e)},onRowClick:function(e){var n=e.row;return b(n.sessionId)},rowsPerPageOptions:[10,25,50,100],disableSelectionOnClick:!0,getRowId:function(e){return e.sessionId},pageSize:M,columns:J,loading:!R,rows:"string"===typeof T&&T.length?V.filter((function(e){return Object.values(e).some((function(e){return"string"===typeof e&&e.toLowerCase().includes(T.toLowerCase())}))})):V,autoHeight:!0})]}),(0,l.jsxs)(D.ZP,{open:!(!R||!j),anchor:"right",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{top:49,bottom:49,left:250},"& .MuiDrawer-paper":{width:"calc(100% - 50px)"}},SlideProps:{direction:"left",easing:{enter:"linear"}},PaperProps:{sx:{position:"absolute"}},onClose:function(){return b(null)},children:[(0,l.jsx)(U,{icon:"schedule"===a?(0,l.jsx)(Gi.Z,{}):(0,l.jsx)(Yi.Z,{}),title:"schedule"===a?f.t("Edit scheduled run"):f.t("Edit recurring run"),handleClose:function(){return b(null)}}),j&&null!==ne?(0,l.jsx)(B,{sx:{px:0},children:(0,l.jsxs)(S.Z,{sx:{position:"relative",width:"100%"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",my:4,px:3},children:[(0,l.jsx)(uo,{field:{key:"name",name:f.t("Trigger name")}}),(0,l.jsx)(so,{agentId:null===W||void 0===W?void 0:W.id,session:ne,fetchAll:X})]}),(0,l.jsxs)(S.Z,{sx:{display:"flex",my:4,px:3},children:[(0,l.jsx)(uo,{field:{key:"info",name:"schedule"===a?f.t("Trigger date and time"):f.t("Trigger cadence"),desc:"schedule"===a?f.t("When to start this run"):f.t("How often to start this run")}}),(0,l.jsx)(ao,{agentId:null===W||void 0===W?void 0:W.id,session:ne,fetchAll:X})]}),(0,l.jsx)(Ki,{agents:t,sessionId:j,sessionChange:X})]})}):null,(0,l.jsx)(ri,{children:(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return b(null)},children:f.t("Close")})})]}),R&&m?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return y(!1)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:"schedule"===a?f.t("Delete all scheduled runs"):f.t("Delete all recurring runs")}),(0,l.jsx)(Le.Z,{children:(0,l.jsx)(_e.Z,{severity:"warning",children:"schedule"===a?f.t("Are you sure you want to delete all scheduled runs?"):f.t("Are you sure you want to delete all recurring runs?")})}),(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return y(!1)},children:f.t("Cancel")}),(0,l.jsx)(I.Z,{color:"error",onClick:function(){return ee()},startIcon:(0,l.jsx)(Ve.Z,{}),children:f.t("Delete all")})]})]}):null,R&&null!==k?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return _(null)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:"schedule"===a?f.t("Delete scheduled run"):f.t("Delete recurring run")}),(0,l.jsx)(Le.Z,{children:(0,l.jsx)(_e.Z,{severity:"warning",children:"schedule"===a?f.t("Are you sure you want to delete this scheduled run?"):f.t("Are you sure you want to delete this recurring run?")})}),(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:function(){return _(null)},children:f.t("Cancel")}),(0,l.jsx)(I.Z,{color:"error",onClick:function(){return ee(k)},startIcon:(0,l.jsx)(Ve.Z,{}),children:f.t("Delete")})]})]}):null]})},po=function(e){var n=e.agents,t=(0,g.useState)(""),r=t[0],i=t[1],o={"":{label:"Scheduled runs",icon:(0,l.jsx)(Gi.Z,{}),content:(0,l.jsx)(co,{agents:n,sessionType:"schedule"})},dev:{label:"Recurring runs",icon:(0,l.jsx)(Yi.Z,{}),content:(0,l.jsx)(co,{agents:n,sessionType:"cron"})}};return(0,l.jsx)(S.Z,{sx:{width:"100%",height:"100%",position:"relative"},children:(0,l.jsx)(Q,{tabs:o,hash:r,setHash:i,bordered:!0,sticky:!0})})},fo=t(63635),ho=t(79794),xo=t(52701),mo=function(e){var n=e.runsAll,t=void 0===n?[]:n,i=e.runsFiltered,a=void 0===i?[]:i,s=e.runsExcluded,u=void 0===s?[]:s,c=e.open,d=void 0!==c&&c,p=e.loaded,f=void 0!==p&&p,h=e.onClose,m=void 0===h?function(){}:h,g=e.onDelete,y=void 0===g?(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return[2]}))})):g,Z=(0,x.O)(),j=Z.setFiltersRuns,b=Z.getAgentId,w=(0,v.$)().i18n,I=(0,k.Z)(),_=0===u.length?ho.Z:a.length>=t.length?fo.Z:xo.Z,A=function(e){u.includes(e)?u=u.filter((function(n){return n!==e})):u.push(e),j(b(),u)},T=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return"function"!==typeof y?[3,2]:[4,y(e)];case 1:n.sent(),n.label=2;case 2:return u=u.filter((function(n){return n!==e})),j(b(),u),[2]}}))}));return function(n){return e.apply(this,arguments)}}();return(0,l.jsx)(D.ZP,{open:d,anchor:"left",ModalProps:{disablePortal:!0},sx:{"&.MuiDrawer-root":{position:"absolute"}},PaperProps:{sx:{position:"absolute"}},onClose:m,children:(0,l.jsxs)(S.Z,{sx:{width:250,flexDirection:"column",position:"relative",zIndex:1,height:"100%",ml:1},children:[(0,l.jsxs)(S.Z,{sx:{px:1,width:"100%",height:50,display:"flex",justifyContent:"space-between",alignItems:"center",background:I.palette.background.paper,zIndex:1},children:[(0,l.jsx)(O.Z,{title:0===u.length?w.t("Deselect all"):w.t("Select all"),placement:"right",children:(0,l.jsx)(S.Z,{children:(0,l.jsx)(Te.Z,{disabled:!f,onClick:function(){0!==u.length?j(b(),[]):j(b(),t.filter((function(e){return!a.includes(e)})))},sx:{width:40,height:40},children:(0,l.jsx)(_,{})})})}),(0,l.jsx)(O.Z,{title:w.t("Close"),placement:"right",children:(0,l.jsx)(Te.Z,{onClick:m,sx:{width:40,height:40},children:(0,l.jsx)(L.Z,{})})})]}),(0,l.jsx)(S.Z,{sx:{width:"100%",minHeight:50,height:"calc(100% - 50px)",p:1,overflowY:"auto"},children:Array.isArray(t)&&t.length?t.map((function(e){var n=parseInt("".concat(e).trim().split("-").pop(),10),t=a.includes(e)&&!u.includes(e);return(0,l.jsxs)(S.Z,{sx:{my:1,display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center","& .MuiIconButton-root":{opacity:0},"&:hover .MuiIconButton-root":{opacity:1}},children:[(0,l.jsx)(O.Z,{title:t?w.t("Run excluded by filters"):null,placement:"left",children:(0,l.jsxs)(S.Z,{sx:{userSelect:"none",display:"flex",alignItems:"center"},children:[(0,l.jsx)(Ur.Z,{disabled:!f||t,checked:!a.includes(e),onClick:function(){return A(e)}}),f?(0,l.jsx)(C.Z,{onClick:function(){return f&&!t&&A(e)},variant:"caption",sx:(0,R.Z)({fontFamily:"Inconsolata,monospace"},t?{textDecoration:"line-through"}:{cursor:"pointer"}),children:isNaN(n)?e:(0,l.jsx)(ni,{time:n})}):(0,l.jsx)(S.Z,{sx:{width:200,height:20},children:(0,l.jsx)(G.Z,{spacing:0})})]})}),(0,l.jsx)(O.Z,{title:w.t("Delete run"),placement:"right",children:(0,l.jsx)(Te.Z,{onClick:function(){return T(e)},disabled:!f,sx:{width:40,height:40},children:(0,l.jsx)(Ve.Z,{fontSize:"small"})})})]},e)})):(0,l.jsx)(_e.Z,{variant:"info",children:w.t("No runs found")})})]})})},vo=t(72622),go=t(97395),yo=t(54108),Zo=t(15777),jo=t(3045),bo=t(58754),wo=t(6538),ko=(0,w.ZP)(S.Z)((function(e){return{display:"flex",width:"250px",flex:"0 0 250px",height:"50px",marginLeft:e.theme.spacing(1)}})),So=(0,w.ZP)(S.Z)((function(){return{display:"flex",width:"100%"}})),Co=(0,w.ZP)(S.Z)((function(e){var n=e.theme,t=e.bordered;return{display:"flex",width:"100%",height:"50px",alignItems:"center",borderBottom:"true"===(void 0===t?"false":t)?"1px solid ".concat(n.palette.divider):null}})),Io=function(e){var n=e.startTime,t=void 0===n?null:n,r=e.endTime,i=void 0===r?null:r,o=e.setStartTime,a=void 0===o?function(){}:o,s=e.setEndTime,u=void 0===s?function(){}:s,c=e.loaded,d=void 0!==c&&c,p=e.runsToggle,f=void 0===p?function(){}:p,h=e.showFilters,m=void 0!==h&&h,y=e.runsFiltered,Z=void 0===y?0:y,j=e.runsTotal,b=void 0===j?0:j,w=e.runsLoaded,k=void 0===w?0:w,_=(0,x.O)(),A=_.getFilters,T=_.setFiltersFields,z=_.getAgentId,P=(0,v.$)().i18n,M=(0,g.useState)("today"),D=M[0],E=M[1],N=A(z()).fields,R=[{value:"today",title:P.t("Today"),Icon:wo.Z},{value:"yesterday",title:P.t("Yesterday"),Icon:go.Z},{value:"last-7",title:P.t("Last 7 days"),Icon:bo.Z},{value:"last-30",title:P.t("Last 30 days"),Icon:jo.Z},{value:"custom",title:P.t("Custom"),Icon:Zo.Z}],L=k-Z.length,F="object"===typeof N&&null!=N?Object.keys(N).length:0;return(0,l.jsxs)(Co,{bordered:k>0?"true":"false",children:[(0,l.jsx)(ko,{sx:{justifyContent:"space-between",alignItems:"center"},children:m?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",ml:2},children:(0,l.jsx)(O.Z,{title:P.t("Manually exclude runs from the current report"),children:(0,l.jsx)(I.Z,{onClick:f,size:"small",startIcon:(0,l.jsx)(yo.Z,{fontSize:"small"}),children:P.t("Runs list")})})}),F>0?(0,l.jsx)(O.Z,{title:P.t("Clear all filters"),children:(0,l.jsx)(Te.Z,{color:"warning",sx:{width:30,height:30},onClick:function(){return T(z(),{})},children:(0,l.jsx)(vo.Z,{fontSize:"small"})})}):null]}):null}),(0,l.jsxs)(So,{sx:{justifyContent:"end",alignItems:"center",mr:3},children:[d?(0,l.jsx)(O.Z,{title:"".concat(P.t("Runs shown: {{runsShown}} of {{runsLoaded}}",{runsShown:L,runsLoaded:k})).concat(0===F?" "+P.t("(no filters)"):"").concat(b>k?". "+P.t("{{runsTotal}} runs were found for this interval, but only the last {{runsLoaded}} runs are shown.",{runsLoaded:k,runsTotal:b}):""),children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",height:"30px"},children:(0,l.jsxs)(C.Z,{sx:{color:b>k?"warning.main":"inherit",userSelect:"none",fontSize:"0.75rem",mr:2},children:["".concat(L," / ").concat(k),b>k?" (".concat(b,")"):""]})})}):null,d&&"custom"===D?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.Z,{title:P.t("Start time"),children:(0,l.jsx)(Ji,{children:(0,l.jsx)(eo(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:Number.isInteger(t)?new Date(1e3*t):new Date(Date.now()-864e5),dateFormat:"yyyy-MM-dd HH:mm",onChange:function(e){return function(e){(0,Lr.Z)(e,Date)&&a(Math.floor(e.getTime()/1e3))}(e)},customInput:(0,l.jsx)(Ie.Z,{sx:{width:160,"& .MuiInput-input":{height:50,py:0,px:2,textAlign:"center",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},variant:"standard"})})})}),(0,l.jsx)(C.Z,{variant:"caption",children:(0,l.jsx)(It.Z,{fontSize:"small",sx:{mt:2}})}),(0,l.jsx)(O.Z,{title:P.t("End time"),children:(0,l.jsx)(Ji,{children:(0,l.jsx)(eo(),{showTimeSelect:!0,timeFormat:"HH:mm",timeIntervals:15,selected:Number.isInteger(i)?new Date(1e3*i):new Date,dateFormat:"yyyy-MM-dd HH:mm",onChange:function(e){return function(e){(0,Lr.Z)(e,Date)&&u(Math.floor(e.getTime()/1e3))}(e)},customInput:(0,l.jsx)(Ie.Z,{sx:{width:160,"& .MuiInput-input":{height:50,py:0,px:2,textAlign:"center",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},variant:"standard"})})})})]}):null,(0,l.jsx)(Br.Z,{sx:{height:50,ml:5,mr:1,"&.MuiInput-root:before":{display:"none"}},inputProps:{sx:{pl:2}},variant:"standard",onChange:function(e){return function(e){E(e);var n=Math.floor((new Date).setHours(0,0,0,0)/1e3);switch(e){case"today":a(n),u(null);break;case"yesterday":a(n-86400),u(n-1);break;case"last-7":a(n-604800),u(null);break;case"last-30":a(n-2592e3),u(null)}}(e.target.value)},value:D,children:R.map((function(e){var n=e.value,t=e.title,r=e.Icon;return(0,l.jsx)(Ue.Z,{value:n,sx:{py:0},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",p:0,height:40},children:["undefined"!==typeof r?(0,l.jsx)(r,{fontSize:"small",sx:{mr:2}}):null,(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",children:t})]})},n)}))})]})]})},_o=function(e){var n=e.field,t=e.loaded,r=void 0!==t&&t,i=(0,x.O)(),o=i.getFilters,a=i.setFiltersFields,s=i.getAgentId,u=(0,v.$)().i18n,c=o(s()).fields,d="object"===typeof c&&null!==c&&"boolean"===typeof c[n.key]?c[n.key]:null,p=function(e){if("object"===typeof c&&null!==c){var t=structuredClone(c);c[n.key]!==e?t[n.key]=!!e:delete t[n.key],a(s(),t)}};return"boolean"===n.type?(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(O.Z,{title:u.t("Filter by boolean value"),children:(0,l.jsx)(wt.Z,{fontSize:"small",sx:{ml:1,mr:2},color:null!==d?"inherit":"disabled"})}),(0,l.jsxs)(Kr.Z,{size:"small",children:[(0,l.jsx)(I.Z,{disabled:!r,onClick:function(){return p(!0)},variant:!0===d?"contained":"outlined",children:u.t("true")}),(0,l.jsx)(I.Z,{disabled:!r,onClick:function(){return p(!1)},variant:!1===d?"contained":"outlined",children:u.t("false")})]})]}),null!==d?(0,l.jsx)(O.Z,{title:u.t("Clear filter"),children:(0,l.jsx)(Te.Z,{color:"warning",sx:{width:30,height:30},onClick:function(){if("object"===typeof c&&null!==c&&"undefined"!==typeof c[n.key]){var e=structuredClone(c);delete e[n.key],a(s(),e)}},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})}):null]}):null},Ao=function(e){var n=e.field,t=e.loaded,r=void 0!==t&&t,i=(0,x.O)(),o=i.getFilters,a=i.setFiltersFields,s=i.onFilters,u=i.getAgentId,c=(0,v.$)().i18n,d=(0,g.useRef)(null),p=(0,g.useState)(o(u())),f=p[0],h=p[1],m=(0,g.useState)(""),y=m[0],Z=m[1];(0,g.useEffect)((function(){var e=s((function(e){var n=e.agentId,t=e.filters;u()===n&&h(t)}));return function(){e()}}),[]),(0,g.useEffect)((function(){Z("object"===typeof(null===f||void 0===f?void 0:f.fields)&&null!==f.fields&&"string"===typeof f.fields[n.key]?f.fields[n.key]:"")}),[f]);return"string"===n.type?(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[(0,l.jsx)(O.Z,{title:c.t("Filter by text value"),children:(0,l.jsx)(wt.Z,{fontSize:"small",sx:{ml:1,mr:2},color:y.length?"inherit":"disabled"})}),(0,l.jsx)(Ie.Z,{sx:{width:"100%","& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}},placeholder:c.t("Filter"),variant:"standard",disabled:!r,value:y,onChange:function(e){return t=e.target.value.toLowerCase(),Z(t),null!==d.current&&window.clearTimeout(d.current),void(d.current=window.setTimeout((function(){"object"===typeof f.fields&&null!==f.fields&&(a(u(),(0,Je.Z)((0,R.Z)({},f.fields),(0,H.Z)({},n.key,t))),d.current=null)}),450));var t},InputProps:{endAdornment:(0,l.jsx)(Ce.Z,{position:"end",children:(0,l.jsx)(S.Z,{sx:{width:30,height:30},children:y.length?(0,l.jsx)(O.Z,{title:c.t("Clear filter"),children:(0,l.jsx)(Te.Z,{color:"warning",sx:{width:30,height:30},onClick:function(){if("object"===typeof f.fields&&null!==f.fields&&"undefined"!==typeof f.fields[n.key]){Z("");var e=structuredClone(f.fields);delete e[n.key],a(u(),e)}},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})}):null})})}})]})}):null},To=function(e){var n=e.field,t=e.loaded,r=void 0!==t&&t,i=(0,x.O)(),o=i.getFilters,a=i.setFiltersFields,s=i.onFilters,u=i.getAgentId,c=(0,v.$)().i18n,d=(0,g.useRef)(null),p=(0,g.useRef)(null),f=(0,g.useState)(o(u())),h=f[0],m=f[1],y=(0,g.useState)(""),Z=y[0],j=y[1],b=(0,g.useState)(""),w=b[0],k=b[1];(0,g.useEffect)((function(){var e=s((function(e){var n=e.agentId,t=e.filters;u()===n&&m(t)}));return function(){e()}}),[]),(0,g.useEffect)((function(){var e="object"===typeof(null===h||void 0===h?void 0:h.fields)&&null!==h.fields&&"object"===typeof h.fields[n.key]&&null!==h.fields[n.key]?h.fields[n.key]:{min:"",max:""};j(Number.isInteger(e.min)?e.min:""),k(Number.isInteger(e.max)?e.max:"")}),[h]);return"int"===n.type?(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(O.Z,{title:c.t("Filter by minimum and maximum value"),children:(0,l.jsx)(wt.Z,{fontSize:"small",sx:{ml:1,mr:2},color:Z||w?"inherit":"disabled"})}),["min","max"].map((function(e){return(0,l.jsx)(Ie.Z,{type:"number",variant:"standard",disabled:!r,inputMode:"numeric",value:"".concat("min"===e?Z:w),placeholder:"min"===e?c.t("Minimum"):c.t("Maximum"),onChange:function(t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"min";e=parseInt(e,10),Number.isInteger(e)||(e="");var r="min"===t?d:p;("min"===t?j:k)(e),null!==r.current&&window.clearTimeout(r.current),r.current=window.setTimeout((function(){"object"===typeof h.fields&&null!==h.fields&&(a(u(),(0,Je.Z)((0,R.Z)({},h.fields),(0,H.Z)({},n.key,(0,H.Z)({min:Number.isInteger(Z)?Z:"",max:Number.isInteger(w)?w:""},t,e)))),r.current=null)}),250)}(t.target.value.toLowerCase(),e)},sx:{width:"100%",ml:"min"===e?0:2,"& input":{px:"5px !important",fontSize:"0.75rem"},"& .MuiInput-root:before":{display:"none"}}},e)}))]}),Number.isInteger(Z)||Number.isInteger(w)?(0,l.jsx)(O.Z,{title:c.t("Clear filter"),children:(0,l.jsx)(Te.Z,{color:"warning",sx:{width:30,height:30},onClick:function(){if("object"===typeof h.fields&&null!==h.fields&&"undefined"!==typeof h.fields[n.key]){j(""),k("");var e=structuredClone(h.fields);delete e[n.key],a(u(),e)}},children:(0,l.jsx)(ze.Z,{fontSize:"small"})})}):null]}):null},zo=t(29009),Po=t(86007),Mo=t(26050),Do=t(14195),Eo=t(75358),No=t(3023),Ro=t(82633),Oo=t(43815),Lo=function(e){var n=e.sx,t=void 0===n?{}:n,r=(0,v.$)().i18n;return"object"===typeof t&&null!==t||(t={}),(0,l.jsx)(S.Z,{sx:(0,R.Z)({width:"100%",minHeight:"3rem",display:"flex",alignItems:"start",borderRadius:1},t),children:(0,l.jsx)(_e.Z,{severity:"info",sx:{width:"100%"},children:(0,l.jsx)(C.Z,{color:"inherit",variant:"caption",children:r.t("No data")})})})},Fo=function(e){var n=e.active,t=e.payload,r=e.coordinate,i=(0,v.$)().i18n;if(!n)return null;if(!Array.isArray(t)||!t.length)return null;var o=t[0].payload,a=o.value,s=o.time;return"undefined"===typeof a||"undefined"===typeof s?null:(0,l.jsx)(S.Z,{sx:{position:"absolute",left:r.x,top:r.y-5,pointerEvents:"none"},children:(0,l.jsx)(O.Z,{title:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",flexDirection:"column"},children:[null!==s?(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",sx:{ml:2},children:At(1e3*s,"en",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}):null,(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[a?(0,l.jsx)(Xe.Z,{fontSize:"small"}):(0,l.jsx)(L.Z,{fontSize:"small"}),(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",sx:{ml:2,fontWeight:"bold"},children:null===a?i.t("No data"):a?i.t("true"):i.t("false")})]})]}),arrow:!0,placement:"top",open:!0,children:(0,l.jsx)("div",{style:{width:"1px",height:"1px"}})})})},Wo=function(e){var n=e.runs,t=void 0===n?[]:n,r=e.loaded,i=void 0!==r&&r,o=(0,k.Z)(),a=(Array.isArray(t)?t:[]).map((function(e){var n=parseInt(e.runId.replace(/^.*\-(\d+)$/g,"$1"),10);return{time:Number.isInteger(n)?n:null,norm:e.runData?1.6:.6,value:e.runData,run:Tt(1e3*n)}}));return i?a.filter((function(e){return null!==e.value})).length?(0,l.jsx)(S.Z,{sx:{width:"100%",height:"100px",paddingTop:"10px"},children:(0,l.jsx)(zo.h,{width:"100%",height:100,children:(0,l.jsxs)(Po.v,{data:a,width:"100%",innerRadius:10,barSize:10,margin:{top:5,left:0,right:0,bottom:0},children:[(0,l.jsx)(Mo.u,{content:function(e){var n=e.active,t=e.payload,r=e.coordinate;return(0,l.jsx)(Fo,{active:n,payload:t,coordinate:r})}}),(0,l.jsx)(Do.q,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,l.jsx)(Eo.B,{domain:[0,2],tick:{fontSize:11},ticks:[2,1],hide:!0}),(0,l.jsx)(No.K,{dataKey:"run",tick:{fontSize:11}}),(0,l.jsx)(Ro.$,{radius:15,dataKey:"norm",children:a.map((function(e,n){var t=null===e.value?0:10;return(0,l.jsx)(Oo.b,{height:t,width:t,fill:null===e.value?o.palette.text.primary:e.value?o.palette.success.main:o.palette.error.main},"cell-".concat(n))}))})]})})}):(0,l.jsx)(Lo,{sx:{height:"80px"}}):(0,l.jsx)(S.Z,{sx:{width:"100%",height:"100px",alignItems:"center",display:"flex",justifyContent:"center"},children:(0,l.jsx)(at.Z,{grey:!0,size:50,className:"zoom-in"})})},Uo=function(e){var n=e.field,t=e.runs,r=void 0===t?[]:t,i=e.loaded,o=void 0!==i&&i,a=(0,x.O)(),s=a.getFilters,u=a.getAgentId,c=s(u()),d="object"===typeof(null===c||void 0===c?void 0:c.fields)&&null!==c.fields&&"string"===typeof c.fields[n.key]?c.fields[n.key]:"",p=function(){var e=[];if(Array.isArray(r)){var n=!0,t=!1,i=void 0;try{for(var o,l=r[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var a=o.value;if("string"===typeof a.runData){var s=parseInt(a.runId.replace(/^.*\-(\d+)$/g,"$1"),10);e.push({time:Number.isInteger(s)?s:null,string:a.runData})}}}catch(u){t=!0,i=u}finally{try{n||null==l.return||l.return()}finally{if(t)throw i}}}return e}();return o?p.length?(0,l.jsx)(S.Z,{sx:{display:"flex",flexDirection:"column",py:2,width:"100%",wordWrap:"break-word",overflowWrap:"anywhere",minHeight:250,maxHeight:360,overflowY:"auto"},children:p.map((function(e,n){var t=e.time,r=e.string;return(0,l.jsxs)(S.Z,{sx:{display:"flex",mb:2,alignItems:"center"},children:[(0,l.jsx)(ei.Z,{sx:{mr:2},color:"text.primary",fontSize:"small"}),(0,l.jsx)(ni,{time:t,sx:{mr:2}}),(0,l.jsx)(C.Z,{variant:"caption",sx:{whiteSpaceCollapse:"preserve",wordBreak:"break-word",whiteSpace:"pre-wrap"},children:ae(r,d,u())})]},n)}))}):(0,l.jsx)(Lo,{}):(0,l.jsx)(S.Z,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(at.Z,{grey:!0,size:50,className:"zoom-in"})})},Bo=function(e){var n=e.runs,t=void 0===n?[]:n,r=e.loaded,o=void 0!==r&&r,a=(0,v.$)().i18n,s=function(){var e=[];if(Array.isArray(t)){var n=!0,r=!1,o=void 0;try{for(var l,a=function(){var n,t=l.value,r=parseInt(t.runId.replace(/^.*\-(\d+)$/g,"$1"),10);Array.isArray(t.runData)&&(n=e).push.apply(n,(0,i.Z)(t.runData.map((function(e){return Number.isInteger(r)?{filePath:e,runTime:r}:e}))))},s=t[Symbol.iterator]();!(n=(l=s.next()).done);n=!0)a()}catch(u){r=!0,o=u}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}}return e}();return o?s.length?(0,l.jsx)(Hi,{filePaths:s,sx:{minHeight:"250px",maxHeight:"360px",overflowY:"auto"},tooltip:a.t("Up to {{count}} files are shown per run",{count:j().max.sourceCode.ioOutputFileCount})}):(0,l.jsx)(Lo,{}):(0,l.jsx)(S.Z,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(at.Z,{grey:!0,size:50,className:"zoom-in"})})},$o=function(e){var n,t=e.field,r=e.runs,i=void 0===r?[]:r,o=e.loaded,a=void 0!==o&&o,s=(0,g.useMemo)((function(){return(Array.isArray(i)?i:[]).map((function(e){return null===e||void 0===e?void 0:e.runId}))}),[null===i||void 0===i||null===(n=i.map)||void 0===n?void 0:n.call(i,(function(e){return null===e||void 0===e?void 0:e.runId})).join(",")]);return a?s.length?(0,l.jsx)(Li,{fieldKey:t.key,fieldName:t.name,fieldColumns:t.columns,runIds:s}):(0,l.jsx)(Lo,{}):(0,l.jsx)(S.Z,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(at.Z,{grey:!0,size:50,className:"zoom-in"})})},Ho=t(4545),Vo=function(e){var n=e.active,t=e.payload,r=e.coordinate;if(!n)return null;if(!Array.isArray(t)||!t.length)return null;var i=t[0].payload,o=i.value,a=i.time;return"undefined"===typeof o||"undefined"===typeof a?null:(0,l.jsx)(S.Z,{sx:{position:"absolute",left:r.x,top:r.y-5,pointerEvents:"none"},children:(0,l.jsx)(O.Z,{title:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",flexDirection:"column"},children:[null!==a?(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",children:At(1e3*a,"en",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})}):null,(0,l.jsx)(C.Z,{variant:"caption",color:"inherit",sx:{fontWeight:"bold"},children:new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(o)})]}),arrow:!0,placement:"top",open:!0,children:(0,l.jsx)("div",{style:{width:"1px",height:"1px"}})})})},qo=function(e){var n=e.runs,t=void 0===n?[]:n,r=e.loaded,i=void 0!==r&&r,o=(0,k.Z)(),a={min:0,max:0},s=(Array.isArray(t)?t:[]).map((function(e){var n=parseInt(e.runId.replace(/^.*\-(\d+)$/g,"$1"),10);return a.min>e.runData&&(a.min=e.runData),a.max<e.runData&&(a.max=e.runData),{time:Number.isInteger(n)?n:null,value:e.runData,run:Tt(1e3*n)}}));return i?s.filter((function(e){return null!==e.value})).length?(0,l.jsx)(zo.h,{width:"100%",height:250,children:(0,l.jsxs)(Po.v,{data:s,width:"100%",innerRadius:10,barSize:5,margin:{top:10,left:0,right:0,bottom:0},children:[(0,l.jsx)(Mo.u,{content:function(e){var n=e.active,t=e.payload,r=e.coordinate;return(0,l.jsx)(Vo,{active:n,payload:t,coordinate:r})}}),(0,l.jsx)(Do.q,{strokeDasharray:"3 3",horizontal:!0,vertical:!1}),(0,l.jsx)(No.K,{dataKey:"run",tick:{fontSize:11}}),(0,l.jsx)(Eo.B,{domain:[a.min,a.max],tick:{fontSize:11}}),(0,l.jsx)(Ho.d,{y:0,stroke:o.palette.divider}),(0,l.jsx)(Ro.$,{radius:10,dataKey:"value",fill:o.palette.text.primary})]})}):(0,l.jsx)(Lo,{}):(0,l.jsx)(S.Z,{sx:{width:"100%",height:"250px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(at.Z,{grey:!0,size:50,className:"zoom-in"})})},Ko=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{display:"flex",flexDirection:"column",width:"250px",flex:"0 0 250px",paddingTop:n.spacing(2),paddingBottom:n.spacing(2),justifyContent:"start",wordWrap:"break-word",overflowWrap:"anywhere",position:"relative"}})),Yo=(0,w.ZP)(S.Z)((function(){return{display:"flex",width:"100%",wordWrap:"break-word",overflowWrap:"anywhere"}})),Go=function(e){var n,t=e.field,r=e.loaded,i=void 0!==r&&r,o=(0,g.useState)("table"===t.type),a=o[0],s=o[1];return(0,l.jsx)(Ko,{children:(0,l.jsxs)(S.Z,{sx:{position:"sticky",top:"0.75rem",pr:2},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",justifyContent:"start",alignItems:"center",mb:2},children:[(0,l.jsx)(S.Z,{sx:{width:"30px",height:"30px",mr:1},children:t.desc?(0,l.jsx)(Te.Z,{size:"small",onClick:function(){return t.key,s((function(e){return!e}))},children:a?(0,l.jsx)(xr.Z,{fontSize:"small"}):(0,l.jsx)(xn.Z,{fontSize:"small"})}):null}),(0,l.jsx)(C.Z,{variant:"body2",children:null!==(n=t.name)&&void 0!==n?n:t.key})]}),"int"===t.type?(0,l.jsx)(To,{field:t,loaded:i}):null,"string"===t.type?(0,l.jsx)(Ao,{field:t,loaded:i}):null,"boolean"===t.type?(0,l.jsx)(_o,{field:t,loaded:i}):null,t.desc&&a?(0,l.jsx)(C.Z,{variant:"caption",component:"pre",sx:{mt:2,pl:2,wordBreak:"break-all",whiteSpace:"preserve",fontFamily:"Yaldevi,sans-serif"},children:t.desc}):null]})})},Xo=function(e){var n=e.field,t=e.runs,r=void 0===t?[]:t,i=e.loaded,o=void 0!==i&&i;return(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex",mb:3},children:[(0,l.jsx)(Go,{field:n,loaded:o}),(0,l.jsxs)(Yo,{children:["int"===n.type?(0,l.jsx)(qo,{runs:r,loaded:o}):null,"string"===n.type?(0,l.jsx)(Uo,{field:n,runs:r,loaded:o}):null,"boolean"===n.type?(0,l.jsx)(Wo,{runs:r,loaded:o}):null,"files"===n.type?(0,l.jsx)(Bo,{runs:r,loaded:o}):null,"table"===n.type?(0,l.jsx)($o,{field:n,runs:r,loaded:o}):null]})]})},Jo=(0,w.ZP)(S.Z)((function(){return{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",zIndex:0}})),Qo=function(e){var n,t,a,s=e.agents,u=(0,x.O)(),d=u.getAgentId,p=u.onAgentId,f=u.getSource,h=u.onSource,m=u.onMachineStatus,y=u.onFilters,Z=u.getFilters,j=u.onOutputs,b=(0,v.$)().i18n,w=(0,g.useRef)([]),k=(0,g.useRef)({}),C=(0,g.useRef)([]),I=(0,g.useState)((0,c.zu)(s,d())),_=I[0],A=I[1],T=(0,g.useState)(!1),z=T[0],P=T[1],M=(0,g.useState)(null),D=M[0],E=M[1],N=(0,g.useState)([]),R=N[0],O=N[1],L=(0,g.useState)(null),F=L[0],W=L[1],U=(0,g.useState)(null),B=U[0],$=U[1],H=(0,g.useState)(!1),V=H[0],q=H[1],K=(0,g.useState)({}),Y=K[0],G=K[1];(0,g.useEffect)((function(){A((0,c.zu)(s,d()));var e=p((function(e){q(!1),A((0,c.zu)(s,e))}));return function(){return e()}}),[s]),(0,g.useEffect)((function(){w.current=[],k.current={},C.current=[],"string"===typeof(null===_||void 0===_?void 0:_.id)&&(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,f(_.id,!0)];case 1:return C.current=null!==(n=null===(e=t.sent())||void 0===e?void 0:e.srcOutputs)&&void 0!==n?n:[],O(C.current),[2]}}))}))();var e=h((function(e){var n,t,r=e.agentId,i=e.sourceCode;r===(null===_||void 0===_?void 0:_.id)&&(JSON.stringify(C.current)!==JSON.stringify(null!==(n=null===i||void 0===i?void 0:i.srcOutputs)&&void 0!==n?n:[])&&(C.current=null!==(t=null===i||void 0===i?void 0:i.srcOutputs)&&void 0!==t?t:[],O(C.current)))}));return function(){return e()}}),[_]),(0,g.useEffect)((function(){var e=y((function(e){var n=e.agentId,t=e.filters;n===(null===_||void 0===_?void 0:_.id)&&Q(t)}));ee();var n=m((function(e){var n=e.agentId,t=e.status;n===(null===_||void 0===_?void 0:_.id)&&1!==t&&(null===B||B>Math.floor((new Date).getTime()/1e3))&&ee(!1)})),t=j((function(e){e===d()&&(null===B||B>Math.floor((new Date).getTime()/1e3))&&ee(!1)}));return function(){e(),n(),t()}}),[_,F,B]);var X,J=function(){var e=(0,r.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.diskStorage.runDelete(d(),e)];case 1:return t.sent(),[4,ee()];case 2:return t.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),Q=function(){var e=(0,r.Z)((function(e){var n,t,r,l,a,s,u,c,p,h,x,m,v,g,y,Z,j,b,S,C,I,_,A,T,z,P;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return w.current=[],[4,f(d(),!0)];case 1:if(l=o.sent(),s=null!==(a=null===l||void 0===l?void 0:l.srcOutputs)&&void 0!==a?a:[],u="object"===typeof(null===(n=k.current)||void 0===n?void 0:n.fields)&&null!==(null===(t=k.current)||void 0===t?void 0:t.fields)?null===(r=k.current)||void 0===r?void 0:r.fields:{},"object"===typeof(null===e||void 0===e?void 0:e.fields)&&null!==(null===e||void 0===e?void 0:e.fields)){c=!0,p=!1,h=void 0;try{for(x=function(){var n=v.value;if("undefined"===typeof e.fields[n.key])return"continue";if(!Array.isArray(u[n.key]))return"continue";var t=e.fields[n.key];u[n.key].map((function(e){var r=!0;do{if("undefined"===typeof e.runData)break;if("int"===n.type){if(Number.isInteger(t.min)&&e.runData<t.min){r=!1;break}if(Number.isInteger(t.max)&&e.runData>t.max){r=!1;break}}if("string"===n.type&&-1==="".concat(e.runData).toLowerCase().indexOf(t)){r=!1;break}if("boolean"===n.type&&!!e.runData!==t){r=!1;break}}while(0);r||w.current.push(e.runId)}))},m=s[Symbol.iterator]();!(c=(v=m.next()).done);c=!0)x()}catch(M){p=!0,h=M}finally{try{c||null==m.return||m.return()}finally{if(p)throw h}}}if(Array.isArray(null===e||void 0===e?void 0:e.runs)){g=!0,y=!1,Z=void 0;try{for(j=e.runs[Symbol.iterator]();!(g=(b=j.next()).done);g=!0)"string"===typeof(S=b.value)&&w.current.push(S)}catch(M){y=!0,Z=M}finally{try{g||null==j.return||j.return()}finally{if(y)throw Z}}}w.current=(0,i.Z)(new Set(w.current)),C={},I=!0,_=!1,A=void 0;try{for(T=s[Symbol.iterator]();!(I=(z=T.next()).done);I=!0)P=z.value,C[P.key]=(Array.isArray(u[P.key])?u[P.key]:[]).filter((function(e){return!w.current.includes(e.runId)}))}catch(M){_=!0,A=M}finally{try{I||null==T.return||T.return()}finally{if(_)throw A}}return G(C),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ee=function(){var e=(0,r.Z)((function(){var e,n,t,r,i=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return e=!(i.length>0&&void 0!==i[0])||i[0],"string"!==typeof d()?[2]:[4,f(d(),!0)];case 1:return t=o.sent(),(null!==(r=null===t||void 0===t?void 0:t.srcOutputs)&&void 0!==r?r:[]).length?(e&&q(!1),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.diskStorage.outputsQuery(d(),null===_||void 0===_?void 0:_.installedModuleId,F,B)]):[2];case 2:return k.current=o.sent(),[4,Q(Z(d()))];case 3:return o.sent(),e?q(!0):E((new Date).getTime()),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ne=Array.isArray(null===(n=k.current)||void 0===n?void 0:n.runIds)?null===(t=k.current)||void 0===t?void 0:t.runIds:[],te=null!==(X=null===(a=k.current)||void 0===a?void 0:a.runIdsTotal)&&void 0!==X?X:0,re=ne.length>0,ie=w.current,oe=Z(d()).runs;return(0,l.jsx)(Jo,{children:(0,l.jsx)(S.Z,{sx:{height:"100%",width:"100%"},children:Array.isArray(R)&&R.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Io,{startTime:F,endTime:B,setStartTime:W,setEndTime:$,loaded:V,runsFiltered:ie,runsTotal:te,runsLoaded:ne.length,runsToggle:function(){return P((function(e){return!e}))},showFilters:re}),re?(0,l.jsx)(mo,{runsAll:ne,runsFiltered:ie,runsExcluded:oe,open:z,loaded:V,onClose:function(){return P(!1)},onDelete:J}):null,(0,l.jsx)(S.Z,{sx:{height:"calc(100% - 50px)",width:"100%",display:"flex",flexDirection:"column",overflowX:"hidden",p:3},children:re?R.map((function(e){return(0,l.jsx)(Xo,{field:e,loaded:V,runs:Array.isArray(Y[e.key])?Y[e.key]:[]},"".concat(e.id,"-").concat(e.type))})):V?(0,l.jsx)(Vi.default,{title:b.t("No data"),message:b.t("No runs were executed in the specified interval"),sx:{"&.content-center":{minHeight:"100%",overflow:"hidden"}}}):(0,l.jsx)(S.Z,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,l.jsx)(at.Z,{grey:!0,size:128,className:"zoom-in"})})})]}):V?(0,l.jsx)(Vi.default,{title:b.t("No outputs"),message:b.t("This module has no results to capture and analyze"),sx:{"&.content-center":{minHeight:"100%"}}}):null})},D)},el=(0,w.ZP)(S.Z)((function(e){return{background:e.theme.palette.background.paper,position:"relative",overflowY:"auto",height:"100%",width:"100%",zIndex:0}}));function nl(e){var n=e.agents,t=e.agentsReady,r=(0,x.O)(),i=r.getAgentTab,o=r.onAgentTab,a=(0,g.useState)(""),s=a[0],u=a[1];return(0,g.useEffect)((function(){u(i());var e=o((function(e){return u(e)}));return function(){return e()}}),[n]),s.length?t?(0,l.jsxs)(el,{children:["settings"===s?(0,l.jsx)(Ki,{agents:n}):null,"results"===s?(0,l.jsx)(Qo,{agents:n}):null,"triggers"===s?(0,l.jsx)(po,{agents:n}):null]}):null:(0,l.jsx)(Or,{agents:n,agentsReady:t})}var tl=t(21001),rl=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{width:"100%",height:"50px",position:"relative",display:"flex",alignItems:"center",justifyContent:"start",paddingLeft:n.spacing(4),paddingRight:n.spacing(4),borderRadius:0,textTransform:"none",textAlign:"left"}})),il=(0,w.ZP)(C.Z)((function(e){e.theme;return{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"}})),ol=function(){var e=(0,x.O)(),n=e.isLlmReady,t=e.onLlmStatus,i=e.onUpdaterInfo,a=e.getUpdaterInfo,s=e.onUpdaterStatus,u=e.getUpdaterStatus,c=(0,v.$)().i18n,p=(0,g.useState)(!1),f=p[0],h=p[1],m=(0,g.useState)(null),y=m[0],Z=m[1],j=(0,g.useState)(null),b=j[0],w=j[1],k=(0,g.useState)(!1),_=k[0],A=k[1],T=(0,g.useState)(!1),z=T[0],P=T[1];(0,g.useEffect)((function(){h(n());var e=t((function(){return h(n())}));w(a());var l=i((function(e){var n=e.info;return w(n)}));Z(u());var c=s((function(e){var n=e.status;return Z(n)}));return(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return n="linux",[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.device.getOS()];case 1:return[2,P.apply(void 0,[n===t.sent()])]}}))}))(),function(){e(),l(),c()}}),[]),(0,g.useEffect)((function(){var e;f&&(null===(e=window.sdk)||void 0===e||e.ipc.updater.check())}),[f]),(0,g.useEffect)((function(){!(null===y||void 0===y?void 0:y.working)&&(null===y||void 0===y?void 0:y.error)&&d.A.error("".concat(c.t("Update cancelled.")," ").concat(y.error),{duration:5e3})}),[y]);var M,D=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),A(!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.updater.install()];case 1:return n.sent(),A(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[f&&(null===b||void 0===b?void 0:b.version)?(0,l.jsxs)(rl,{children:[!(null===b||void 0===b?void 0:b.filePath)||(null===y||void 0===y?void 0:y.working)?(0,l.jsx)(S.Z,{sx:{mr:4},children:(null===y||void 0===y?void 0:y.working)?(0,l.jsx)(cr.Z,{className:"rotate-360"}):(0,l.jsx)(Nn.Z,{color:"primary"})}):null,(0,l.jsx)(S.Z,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"start"},children:!(null===b||void 0===b?void 0:b.filePath)||(null===y||void 0===y?void 0:y.working)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(il,{variant:"caption",color:"inherit",children:(null===y||void 0===y?void 0:y.working)?c.t("Updating to v.{{version}}...",{version:b.version}):c.t("Downloading v.{{version}}...",{version:b.version})}),(0,l.jsx)(fr.Z,{color:"primary",sx:{mt:1},variant:(null===y||void 0===y?void 0:y.working)?"indeterminate":"determinate",value:(null===y||void 0===y?void 0:y.working)?null:null!==(M=null===b||void 0===b?void 0:b.progress)&&void 0!==M?M:0})]}):(0,l.jsx)(O.Z,{title:c.t("Update to version {{version}}",{version:b.version}),placement:"top",children:(0,l.jsx)(I.Z,{fullWidth:!0,size:"small",variant:"outlined",startIcon:(0,l.jsx)(Nn.Z,{}),onClick:function(){return D()},children:c.t("Update")})})})]}):null,f&&(null===b||void 0===b?void 0:b.version)&&_?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return!(null===y||void 0===y?void 0:y.working)&&A(!1)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:1}},children:[(0,l.jsx)(Fe.Z,{children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsx)(C.Z,{variant:"h3",sx:{ml:4},children:(null===y||void 0===y?void 0:y.working)?c.t("Updating to v.{{version}}...",{version:b.version}):c.t("Install update")})})}),(0,l.jsx)(Le.Z,{children:(null===y||void 0===y?void 0:y.working)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(_e.Z,{severity:"warning",sx:{mb:4},children:c.t("Please do not close this window until the update is complete.")}),(0,l.jsx)(G.Z,{sx:{mb:-4}})]}):(0,l.jsx)(_e.Z,{severity:"info",icon:(0,l.jsx)(tl.Z,{}),children:z?c.t("Updating to version {{version}} requires root privileges. Please enter your root password in the next dialog.",{version:b.version}):c.t("Update to version {{version}} and restart the application.",{version:b.version})})}),(null===y||void 0===y?void 0:y.working)?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",variant:"text",onClick:function(){return A(!1)},children:c.t("Cancel")}),(0,l.jsx)(I.Z,{size:"small",className:"pop",startIcon:(0,l.jsx)(Nn.Z,{}),color:"primary",onClick:function(){return E()},variant:"contained",children:c.t("Update and restart")})]})]}):null]})},ll=t(52554),al=function(e){var n=e.isOpen,t=void 0!==n&&n,i=e.isFirst,a=void 0!==i&&i,s=e.onOpen,u=void 0===s?function(){}:s,c=e.onClose,d=void 0===c?function(){}:c,p=e.onAgentCreate,f=void 0===p?function(){}:p,h=(0,v.$)().i18n,x=(0,g.useRef)(null),m=(0,g.useState)(!1),y=m[0],Z=m[1],j=(0,g.useState)(a),b=j[0],w=j[1],k=(0,g.useState)(!1),_=k[0],A=k[1],T={name:Ne.Z_().required(h.t("Agent name is required")).min(3,(function(){return h.t("Must be at least {{n}} characters long",{n:3})})).max(64,(function(){return h.t("Must be at most {{n}} characters long",{n:64})}))},z=(0,Me.cI)({defaultValues:{name:""},mode:"onChange",resolver:(0,De.X)(Ne.Ry().shape(T))}),P=z.reset,M=z.control,D=z.handleSubmit,E=z.formState.errors,N=function(){var e=(0,r.Z)((function(e){var n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return n=e.name,A(!0),[4,f(n)];case 1:return t.sent(),A(!1),d(),[2]}}))}));return function(n){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){t&&"function"===typeof u&&u()}),[t]);var R=function(){t&&"function"===typeof d&&d(),P()},O=function(){x.current&&x.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return t?(0,l.jsxs)($e.Z,{open:!0,onClose:_?function(){}:R,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[_?null:(0,l.jsxs)(Fe.Z,{children:[a?h.t("Add your first agent"):h.t("Add agent"),(0,l.jsx)(Te.Z,{"aria-label":h.t("More information"),sx:{ml:2},color:"default",onClick:function(){return w(!b)},size:"large",children:b?(0,l.jsx)(xr.Z,{}):(0,l.jsx)(xn.Z,{})})]}),(0,l.jsxs)(Le.Z,{children:[!_&&b?(0,l.jsx)(_e.Z,{severity:"success",sx:{mb:6},icon:(0,l.jsx)(ll.Z,{className:"zoom-in"}),children:(0,l.jsx)(C.Z,{color:"inherit",variant:"body2",children:h.t("Agents are browser instances that use a bit of AI magic to automate repetitive web tasks that are just too boring for humans.")})}):null,(0,l.jsx)("form",{onSubmit:D(N),ref:x,children:_?(0,l.jsx)(S.Z,{sx:{mt:6},children:(0,l.jsx)(G.Z,{})}):(0,l.jsxs)(We.Z,{fullWidth:!0,sx:{my:3},error:!!E.name,children:[(0,l.jsx)(Me.Qr,{name:"name",control:M,render:function(e){var n=e.field,t=n.value,r=n.onChange;return(0,l.jsx)(Ie.Z,{disabled:_,autoFocus:!0,required:!0,value:t,onChange:function(e){Z(e.target.value.length>=3),r(e)},onKeyDown:function(e){return"Enter"===e.key&&O()},spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{mr:0},children:(0,l.jsx)(Ct.Z,{})})},label:h.t("Agent name"),placeholder:h.t("Agent name"),error:Boolean(E.name)})}}),E.name&&(0,l.jsx)(Re.Z,{sx:{color:"error.main"},children:E.name.message})]})})]}),_?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:R,children:h.t("Cancel")}),y?(0,l.jsx)(I.Z,{variant:"contained",className:"pop",onClick:O,endIcon:(0,l.jsx)(It.Z,{}),children:h.t("Next")}):null]})]}):null},sl=function(e){var n,t=e.agents,i=e.isOpen,a=void 0!==i&&i,s=e.onOpen,u=void 0===s?function(){}:s,d=e.onClose,p=void 0===d?function(){}:d,f=e.onAgentUpdate,h=void 0===f?function(){}:f,m=(0,v.$)().i18n,y=(0,x.O)(),Z=y.getAgentId,j=y.onAgentId,w=(0,g.useRef)(null),k=(0,g.useState)(!1),_=k[0],A=k[1],T=(0,g.useState)(!1),z=T[0],P=T[1],M=(0,g.useState)(!1),D=M[0],E=M[1],N=(0,g.useState)(!1),R=N[0],O=N[1],L=(0,g.useState)((0,c.zu)(t,Z())),F=L[0],W=L[1],U={name:Ne.Z_().required(m.t("Agent name is required")).min(3,(function(){return m.t("Must be at least {{n}} characters long",{n:3})})).max(64,(function(){return m.t("Must be at most {{n}} characters long",{n:64})}))},B={name:null!==(n=null===F||void 0===F?void 0:F.name)&&void 0!==n?n:""},$=(0,Me.cI)({defaultValues:B,mode:"onChange",resolver:(0,De.X)(Ne.Ry().shape(U))}),H=$.reset,V=$.control,q=$.handleSubmit,K=$.formState.errors,Y=function(){var e=(0,r.Z)((function(e){var n,t,r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:n=e.name,O(!0),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,null===(t=window.sdk)||void 0===t?void 0:t.ipc.main.setOnTop()];case 2:return i.sent(),[4,b.Z.put("agents/".concat(F.id),{name:n})];case 3:return r=i.sent(),[4,h(r.data)];case 4:return i.sent(),[3,6];case 5:return i.sent(),[3,6];case 6:return O(!1),p(),[2]}}))}));return function(n){return e.apply(this,arguments)}}();(0,g.useEffect)((function(){W((0,c.zu)(t,Z()));var e=j((function(e){return W((0,c.zu)(t,e))}));return function(){return e()}}),[t]),(0,g.useEffect)((function(){a&&"function"===typeof u&&u()}),[a]);var X=function(){a&&"function"===typeof p&&p(),H()},J=function(){w.current&&w.current.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0}))};return a?(0,l.jsxs)($e.Z,{open:!0,onClose:R?function(){}:X,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[R?null:(0,l.jsx)(Fe.Z,{children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(_t,{agent:F,title:m.t("Rename agent")}),(0,l.jsx)(Te.Z,{"aria-label":m.t("More information"),sx:{ml:2},color:"default",onClick:function(){return P(!z)},size:"large",children:z?(0,l.jsx)(xr.Z,{}):(0,l.jsx)(xn.Z,{})})]})}),(0,l.jsxs)(Le.Z,{children:[!R&&z?(0,l.jsx)(_e.Z,{severity:"success",sx:{mb:6},icon:(0,l.jsx)(ei.Z,{}),children:(0,l.jsx)(C.Z,{color:"inherit",variant:"body2",children:m.t("Keep agent names short and meaningful.")})}):null,(0,l.jsx)("form",{onSubmit:q(Y),ref:w,children:R?(0,l.jsx)(S.Z,{sx:{mt:6},children:(0,l.jsx)(G.Z,{})}):(0,l.jsxs)(We.Z,{fullWidth:!0,sx:{my:3},error:!!K.name,children:[(0,l.jsx)(Me.Qr,{name:"name",control:V,render:function(e){var n=e.field,t=n.value,r=n.onChange;return(0,l.jsx)(Ie.Z,{disabled:R,autoFocus:!0,required:!0,value:t,onChange:function(e){A(e.target.value.length>=3),E(e.target.value!==F.name),r(e)},onKeyDown:function(e){return"Enter"===e.key&&J()},spellCheck:!1,autoComplete:"off",inputProps:{minLength:3,maxLength:64,tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{mr:0},children:(0,l.jsx)(Ct.Z,{})})},label:m.t("Agent name"),placeholder:m.t("Agent name"),error:Boolean(K.name)})}}),K.name&&(0,l.jsx)(Re.Z,{sx:{color:"error.main"},children:K.name.message})]})})]}),R?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:X,children:m.t("Cancel")}),_&&D?(0,l.jsx)(I.Z,{variant:"contained",onClick:J,endIcon:(0,l.jsx)(Xe.Z,{}),children:m.t("Save")}):null]})]}):null},ul=function(e){var n=e.agents,t=e.isOpen,i=void 0!==t&&t,a=e.onOpen,s=void 0===a?function(){}:a,u=e.onClose,d=void 0===u?function(){}:u,p=e.onAgentDelete,f=void 0===p?function(){}:p,h=(0,v.$)().i18n,m=(0,x.O)(),y=m.getAgentId,Z=m.onAgentId,j=(0,g.useState)(!1),b=j[0],w=j[1],k=(0,g.useState)(!1),S=k[0],C=k[1],_=(0,g.useState)((0,c.zu)(n,y())),A=_[0],T=_[1];(0,g.useEffect)((function(){i&&"function"===typeof s&&s()}),[i]);var z=function(){i&&"function"===typeof d&&d()};(0,g.useEffect)((function(){T((0,c.zu)(n,y()));var e=Z((function(e){return T((0,c.zu)(n,e))}));return function(){return e()}}),[n]);var P=function(e){w((null===A||void 0===A?void 0:A.name)===e.target.value)},M=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:if(!b)return[3,6];C(!0),w(!1),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,f(null===A||void 0===A?void 0:A.id)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return C(!1),[4,z()];case 5:e.sent(),e.label=6;case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return i?(0,l.jsxs)($e.Z,{open:!0,onClose:S?function(){}:z,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{children:(0,l.jsx)(_t,{agent:A,title:h.t("Delete agent")})}),(0,l.jsx)(Le.Z,{children:S?(0,l.jsx)(G.Z,{}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(_e.Z,{severity:"warning",sx:{mb:6},children:[h.t("Are you sure you want to delete this agent?")," ",h.t("This action is irreversible!"),(0,l.jsx)("br",{}),h.t('To confirm deleting your agent, please type "{{name}}" below:',{name:null===A||void 0===A?void 0:A.name})]}),(0,l.jsx)(Ie.Z,{autoFocus:!0,fullWidth:!0,spellCheck:!1,autoComplete:"off",required:!0,inputProps:{tabIndex:1},InputProps:{startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{mr:0},children:(0,l.jsx)(Ct.Z,{})})},type:"text",color:b?"primary":"error",label:h.t("Agent name"),placeholder:h.t("Agent name"),onChange:P,onKeyUp:P,onKeyDown:function(e){return"Enter"===e.key&&M()}})]})}),S?null:(0,l.jsxs)(Oe.Z,{children:[(0,l.jsx)(I.Z,{color:"secondary",onClick:z,children:h.t("Cancel")}),(0,l.jsx)(I.Z,{color:"error",onClick:M,disabled:!b,startIcon:(0,l.jsx)(Ve.Z,{}),children:h.t("Delete agent")})]})]}):null},cl=t(83373),dl=t(78445),pl=t(20835),fl=t(55630);function hl(){var e=(0,Bn.Z)(["0% { opacity: 0 } 100% { opacity: 1 }"]);return hl=function(){return e},e}function xl(){var e=(0,Bn.Z)(["0% { opacity: 0; transform: scale(1.5); } 100% { opacity: 1; transform: scale(1); }"]);return xl=function(){return e},e}var ml=(0,$n.F4)(hl()),vl=(0,$n.F4)(xl()),gl=(0,w.ZP)(S.Z)((function(e){var n,t=e.theme,r=e.color;return{display:"flex",position:"absolute",justifyContent:"flex-end",alignItems:"end",top:0,left:0,width:"100%",height:200,zIndex:0,"&:before":{content:'""',display:"block",position:"absolute",background:r,width:"100%",height:"100%",opacity:0,animation:null!==r?"".concat(ml," 1250ms forwards linear"):"none"},"&:after":(n={content:'""',display:"block",position:"absolute",width:"100%",height:"100%",opacity:0,transform:"scale(1.5)",animation:null!==r?"".concat(vl," 250ms forwards linear"):"none",background:"url(/img/pages/circles-profile-".concat(t.palette.mode,".svg)"),backgroundSize:"auto",backgroundRepeat:"no-repeat"},(0,H.Z)(n,t.breakpoints.up("xs"),{backgroundPosition:"50% -600px",transformOrigin:"50% 100%"}),(0,H.Z)(n,t.breakpoints.up("md"),{backgroundPosition:"-680px -600px",transformOrigin:"100px 100%"}),n)}})),yl=function(e){var n=e.isOpen,t=void 0!==n&&n,i=e.onOpen,a=void 0===i?function(){}:i,s=e.onClose,u=void 0===s?function(){}:s,c=(0,jr.r)().settings,d=(0,v.$)().i18n,p=(0,m.a)(),f=(0,cl.W)(),h=(0,k.Z)(),x=f.getUserData(),y=(0,g.useState)(null),Z=y[0],j=y[1],w=(0,g.useState)(!0),_=w[0],A=w[1],T=(0,g.useState)(!1),z=T[0],P=T[1],M=(0,g.useState)(null),D=M[0],E=M[1];(0,g.useEffect)((function(){t&&"function"===typeof a&&a()}),[t]);var N,L=function(){t&&"function"===typeof u&&u()},F=(0,Me.cI)({defaultValues:{userName:null!==(N=null===x||void 0===x?void 0:x.userName)&&void 0!==N?N:d.t("User name")},mode:"onChange",resolver:(0,De.X)(Ne.Ry().shape({userName:Ne.Z_().min(3,(function(){return d.t("Must be at least {{n}} characters long",{n:3})})).max(64,(function(){return d.t("Must be at most {{n}} characters long",{n:64})})).required()}))}),W=F.control,U=F.setValue,B=F.handleSubmit,$=F.formState.errors;(0,g.useEffect)((function(){U("userName",null===x||void 0===x?void 0:x.userName),E(null);var e=setTimeout((0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return"string"===typeof h.palette.customColors.userColors.gradient[null===x||void 0===x?void 0:x.userColor]&&E(h.palette.customColors.userColors.gradient[null===x||void 0===x?void 0:x.userColor]),[2]}))})),150);return function(){return clearTimeout(e)}}),[c.mode,null===x||void 0===x?void 0:x.userColor,null===x||void 0===x?void 0:x.userName]);var H,V=function(e){"string"===typeof(null===e||void 0===e?void 0:e.userName)&&(U("userName",e.userName),p.setUser((0,Je.Z)((0,R.Z)({},p.user),{userName:e.userName,userColor:e.userColor,userAvatarId:e.userAvatarId})))},q=function(){var e=(0,r.Z)((function(e){var n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:if(!_)return[3,5];A(!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,b.Z.post("account",e)];case 2:return n=r.sent(),V(null!==(t=null===n||void 0===n?void 0:n.data)&&void 0!==t?t:{}),[3,4];case 3:return r.sent(),[3,4];case 4:A(!0),P(!1),r.label=5;case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),K=function(){var e=(0,r.Z)((function(e){var n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:if(!_)return[3,5];A(!1),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,b.Z.post("account",{userColor:e})];case 2:return n=r.sent(),V(null!==(t=null===n||void 0===n?void 0:n.data)&&void 0!==t?t:{}),[3,4];case 3:return r.sent(),[3,4];case 4:A(!0),r.label=5;case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}();return t?(0,l.jsx)($e.Z,{open:!0,onClose:L,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:750,p:0}},children:(0,l.jsx)(se.ZP,{container:!0,spacing:6,children:(0,l.jsx)(se.ZP,{item:!0,xs:12,children:(0,l.jsxs)(pe.Z,{sx:{position:"relative"},children:[(0,l.jsx)(gl,{color:D}),(0,l.jsx)(dl.Z,{sx:{zIndex:10,position:"relative"},action:(0,l.jsxs)(S.Z,{sx:{display:"flex"},children:[z&&_?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O.Z,{title:d.t("Profile color"),children:(0,l.jsx)(Te.Z,{sx:{zIndex:10,background:"light"===h.palette.mode?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)","&:hover":{background:h.palette.background.paper}},onClick:function(e){return j(e.currentTarget)},children:(0,l.jsx)(fl.Z,{color:"info"})})}),(0,l.jsx)(He.Z,{keepMounted:!0,anchorEl:Z,open:Boolean(Z),onClose:function(){return j(null)},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},sx:{ml:"2px",mt:2},PaperProps:{style:{minWidth:20}},children:Object.keys(h.palette.customColors.userColors.solid).map((function(e){return(0,l.jsx)(Ue.Z,{selected:(null===x||void 0===x?void 0:x.userColor)==e,onClick:function(){j(null),K(e)},children:(0,l.jsx)(S.Z,{sx:{width:15,height:15,borderRadius:"50%",background:h.palette.customColors.userColors.solid[e]}})},"user-color-".concat(e))}))})]}):null,(0,l.jsx)(O.Z,{title:z?d.t("Exit edit mode"):d.t("Edit profile"),children:(0,l.jsx)(Te.Z,{sx:{ml:2,background:"light"===h.palette.mode?"rgba(255,255,255,0.8)":"rgba(0,0,0,0.6)","&:hover":{background:h.palette.background.paper}},variant:"contained",color:"inherit",onClick:function(){z?(U("userName",x.userName),P(!1)):P(!0)},children:z?(0,l.jsx)(pl.Z,{}):(0,l.jsx)(qe.Z,{})})})]})}),(0,l.jsxs)(de.Z,{sx:{zIndex:10},children:[(0,l.jsx)("form",{onSubmit:B(q),autoComplete:"off",children:(0,l.jsx)(se.ZP,{container:!0,spacing:7,sx:{justifyContent:"left"},children:(0,l.jsx)(se.ZP,{item:!0,xs:12,sx:{my:4,display:"flex"},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",width:"100%",alignItems:{xs:"center",md:"flex-end"},flexDirection:{xs:"column",md:"row"}},children:[(0,l.jsx)(tn,{crop:"fill",borderColor:h.palette.background.paper,backgroundColor:h.palette.background.paper,inputName:"avatar",uploadPath:"account/avatar",active:z,label:d.t("Select avatar"),radius:"50%",onChange:(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,b.Z.get("account")];case 1:return n=t.sent(),"string"===typeof(null===(e=n.data)||void 0===e?void 0:e.id)&&p.setUser(n.data),[2]}}))})),alt:null!==(H=null===x||void 0===x?void 0:x.userName)&&void 0!==H?H:d.t("User name"),getSrc:function(){var e,n=(new Date).toJSON().slice(0,10),t="".concat(ce.Z.s3Url,"/users/").concat(null===x||void 0===x?void 0:x.id,"/?cb=").concat(n);return(null===(e=p.user)||void 0===e?void 0:e.id)==(null===x||void 0===x?void 0:x.id)&&(t="string"===typeof(null===x||void 0===x?void 0:x.userAvatarId)?"".concat(ce.Z.s3Url,"/users/").concat(x.id,"/").concat(x.userAvatarId,".png"):"/img/placeholder/user.png"),t}}),(0,l.jsx)(S.Z,{sx:{ml:{xs:0,md:6},width:"100%",position:"relative"},children:z?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(S.Z,{sx:{width:"100%",display:"flex"},children:[(0,l.jsx)(Me.Qr,{name:"userName",control:W,fullWidth:!0,rules:{required:!0},render:function(e){var n=e.field,t=n.value,r=n.onChange;return(0,l.jsx)(Ie.Z,{sx:{textAlign:"center"},fullWidth:!0,required:!0,spellCheck:!1,autoComplete:"off",autoFocus:!0,disabled:!_,value:t,label:d.t("User name"),onChange:r,placeholder:"John Doe"})}}),(0,l.jsx)(I.Z,{variant:"contained",startIcon:(0,l.jsx)(Xe.Z,{fontSize:"small"}),sx:{ml:3},type:"submit",disabled:!_,children:d.t("Save")})]}),$.userName&&(0,l.jsx)(Re.Z,{sx:{color:"error.main",position:"absolute",bottom:-25},children:$.userName.message})]}):(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(O.Z,{title:(null===x||void 0===x?void 0:x.createdAt)?"".concat(d.t("Member since")," ").concat(At(x.createdAt,c.lang,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})):null,children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"start",flexDirection:"column"},children:[(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(C.Z,{variant:"h6",children:x.userName})}),(0,l.jsx)(C.Z,{variant:"caption",children:null===x||void 0===x?void 0:x.userEmail})]})})})})]})})})}),(0,l.jsx)(S.Z,{sx:{display:"flex",justifyContent:"end",mt:2},children:(0,l.jsx)(I.Z,{color:"secondary",onClick:L,children:d.t("Close")})})]})]})})})}):null},Zl=function(e){var n=e.isOpen,t=void 0!==n&&n,r=e.onOpen,i=void 0===r?function(){}:r;return(0,g.useEffect)((function(){t&&"function"===typeof i&&i()}),[t]),t?(0,l.jsx)($e.Z,{open:!0,sx:{"& .MuiPaper-root":{background:"transparent",boxShadow:"none"}},children:(0,l.jsx)(Le.Z,{children:(0,l.jsx)(S.Z,{sx:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",opacity:.9},children:(0,l.jsx)(at.Z,{size:192,animate:!0,grey:!0,dark:!1,className:"rotate"})})})}):null},jl=function(e){var n=e.isOpen,t=void 0!==n&&n,r=e.onOpen,i=void 0===r?function(){}:r,o=e.onClose,a=void 0===o?function(){}:o,s=(0,v.$)().i18n;(0,g.useEffect)((function(){t&&"function"===typeof i&&i()}),[t]);var u=function(){t&&"function"===typeof a&&a()};return t?(0,l.jsxs)($e.Z,{open:!0,onClose:u,sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:2}},children:[(0,l.jsx)(Fe.Z,{children:s.t("Window restored")}),(0,l.jsx)(Le.Z,{children:(0,l.jsx)(_e.Z,{children:s.t("This window must remain visible for the application to function correctly.")})}),(0,l.jsx)(Oe.Z,{children:(0,l.jsx)(I.Z,{color:"secondary",onClick:u,children:s.t("OK")})})]}):null},bl=function(e){var n=e.agents,t=e.onAgentCreate,r=e.onAgentUpdate,i=e.onAgentDelete,o=(0,x.O)(),a=o.getAgentId,s=o.setPageTitle,u=o.setPageSubtitle,d=o.getDialogVisible,p=o.setDialogVisible,f=o.onDialogVisible,h=(0,v.$)().i18n,m=(0,g.useState)(!1),y=m[0],Z=m[1],b=(0,g.useState)(!1),w=b[0],k=b[1],S=(0,g.useState)(!1),C=S[0],I=S[1],_=(0,g.useState)(!1),A=_[0],T=_[1],z=(0,g.useState)(!1),P=z[0],M=z[1],D=(0,g.useState)(!1),E=D[0],N=D[1];return(0,g.useEffect)((function(){Z(d("agentCreate")),k(d("agentUpdate")),I(d("agentDelete")),T(d("restored")),M(d("loading")),N(d("profile"));var e=f((function(e){var n=e.dialog,t=e.visible;switch(n){case"agentCreate":Z(t);break;case"agentUpdate":k(t);break;case"agentDelete":I(t);break;case"restored":T(t);break;case"loading":M(t);break;case"profile":N(t);break;case"repo":u(t?h.t("Agent module"):null)}}));return function(){e()}}),[]),(0,g.useEffect)((function(){var e=null;return P&&(e=window.setTimeout((function(){return p("loading",!1)}),7500)),function(){return null!==e&&window.clearTimeout(e)}}),[P]),(0,g.useEffect)((function(){var e,t=(0,c.zu)(n,a());s(E?h.t("User Profile"):(null===t||void 0===t?void 0:t.name)?"".concat(null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:""):null)}),[E]),(0,l.jsxs)(l.Fragment,{children:[P?(0,l.jsx)(Zl,{isOpen:!0}):null,y&&n.length<j().max.agentsCount?(0,l.jsx)(al,{isOpen:!0,isFirst:0===n.length,onAgentCreate:t,onClose:function(){return p("agentCreate",!1)}}):null,w?(0,l.jsx)(sl,{isOpen:!0,agents:n,onAgentUpdate:r,onClose:function(){return p("agentUpdate",!1)}}):null,C?(0,l.jsx)(ul,{isOpen:!0,agents:n,onAgentDelete:i,onClose:function(){return p("agentDelete",!1)}}):null,E?(0,l.jsx)(yl,{isOpen:!0,onClose:function(){return p("profile",!1)}}):null,A?(0,l.jsx)(jl,{isOpen:!0,onClose:function(){return p("restored",!1)},onOpen:(0,Ht.G)("notification")}):null]})};bl.guestGuard=!0;var wl=bl,kl=t(52510),Sl=t(95337),Cl=t(36725),Il=t(15510),_l=t(57418),Al=t(57936),Tl=t(34325),zl=function(){var e=(0,x.O)(),n=e.getLlmStatus,t=e.onLlmStatus,i=e.isLlmReady,a=e.onLlmInfo,s=e.showLlmInfo,u=(0,v.$)().i18n,c=(0,g.useRef)(!1),p=(0,g.useState)(!1),f=p[0],h=p[1],m=(0,g.useState)(!1),y=m[0],Z=m[1],j=(0,g.useState)({}),b=j[0],w=j[1];(0,g.useEffect)((function(){w(n());var e=t((function(e){var n=e.status;w(n),!c.current&&"".concat(null===n||void 0===n?void 0:n.code).match(/^(?:download|unpack)/gi)&&(c.current=!0),c.current&&"finish"===(null===n||void 0===n?void 0:n.code)&&s(!0)})),r=a((function(e){var n,t=e.show;(h(t),t)&&(null===(n=window.sdk)||void 0===n||n.ipc.main.setOnTop())}));return function(){e(),r()}}),[]),(0,g.useEffect)((function(){var e=null;return i()&&(e=window.setTimeout((0,r.Z)((function(){return(0,o.__generator)(this,(function(n){return f&&(le(".MuiDialog-root"),d.A.success(u.t("Large language model installed successfully!"),{duration:5e3})),e=null,[2]}))})),250)),function(){null!==e&&(window.clearTimeout(e),e=null)}}),[b,f]);var k=function(){var e=(0,r.Z)((function(){var e,n,t=arguments;return(0,o.__generator)(this,(function(r){return e=t.length>0&&void 0!==t[0]&&t[0],null===(n=window.sdk)||void 0===n||n.ipc.llm.install(e),[2]}))}));return function(){return e.apply(this,arguments)}}(),_=[{code:"download:ollama",Icon:Al.Z,title:u.t("Downloading Ollama")},{code:"unpack:ollama",Icon:Al.Z,title:u.t("Unpacking Ollama")},{code:"download:models",Icon:Tl.Z,title:u.t("Downloading large language model")},{code:"unpack:models",Icon:Tl.Z,title:u.t("Unpacking large language model")},{code:"serve",Icon:_n.Z,title:u.t("Launching server")},{code:"finish",Icon:Sl.Z,title:b.success?u.t("LLM server running"):u.t("LLM server failed to start")}],A=_.reduce((function(e,n){return n.code===b.code?n:e}),null),T=_.findIndex((function(e){return e.code===b.code}));return(0,l.jsxs)(l.Fragment,{children:[null===A||i()?null:(0,l.jsx)(O.Z,{title:b.success?A.title:u.t("Error installing LLM"),placement:"top",children:(0,l.jsxs)(I.Z,{onClick:function(){return s(!0)},sx:{width:"100%",height:"50px",position:"relative",display:"flex",alignItems:"center",justifyContent:"start",px:4,borderRadius:0,textTransform:"none",textAlign:"left"},children:[(0,l.jsx)(S.Z,{sx:{mr:4},children:(0,l.jsx)(A.Icon,{fontSize:"small",color:b.success?"primary":"warning"})}),(0,l.jsxs)(S.Z,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"start"},children:[(0,l.jsx)(C.Z,{variant:"caption",color:b.success?"inherit":"error",sx:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:"180px"},children:b.success?A.title:u.t("Error installing LLM")}),Number.isInteger(b.progressBar)||b.progressBar?(0,l.jsx)(fr.Z,{color:b.success?"primary":"warning",sx:{mt:1},variant:Number.isInteger(b.progressBar)?"determinate":"indeterminate",value:Number.isInteger(b.progressBar)?b.progressBar:null}):null]})]})}),f?(0,l.jsxs)($e.Z,{open:!0,onClose:function(){return h(!1)},sx:{"& .MuiPaper-root":{width:"100%",maxWidth:650,p:1}},children:[(0,l.jsx)(Fe.Z,{children:(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,l.jsx)(C.Z,{variant:"h3",sx:{ml:4},children:u.t("Large language model setup")}),(0,l.jsx)(Te.Z,{"aria-label":u.t("More information"),sx:{ml:2},color:"default",onClick:function(){return Z(!y)},size:"large",children:y?(0,l.jsx)(xr.Z,{}):(0,l.jsx)(xn.Z,{})})]})}),(0,l.jsxs)(Le.Z,{children:[y?(0,l.jsx)(_e.Z,{severity:"info",sx:{mb:2},children:(0,l.jsxs)(C.Z,{color:"inherit",variant:"body2",children:[u.t("To ensure complete privacy of your data, this application uses a large language model that runs locally on your machine."),(0,l.jsx)("br",{}),u.t("Downloading and extracting the LLM typically takes less than 10 minutes, depending on your internet connection speed and system performance.")]})}):null,_.map((function(e,n){return(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center",my:2,opacity:n<=T?1:.4,userSelect:n<=T?"auto":"none"},children:[(0,l.jsx)(S.Z,{sx:{height:"100%",display:"flex",alignItems:"center"},children:T>=0&&n<=T?n===T?b.success?i()?(0,l.jsx)(kl.Z,{color:"primary"}):(0,l.jsx)(Cl.Z,{color:"primary",className:"rotate-360"}):(0,l.jsx)(Il.Z,{color:"warning"}):(0,l.jsx)(yt.Z,{}):(0,l.jsx)(bt.Z,{})}),(0,l.jsxs)(S.Z,{sx:{width:"100%",height:40,display:"flex",alignItems:"start",justifyContent:"center",flexDirection:"column"},children:[(0,l.jsxs)(S.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(e.Icon,{sx:{mx:3},color:n===T?b.success?"primary":"warning":"inherit"}),(0,l.jsx)(C.Z,{color:n===T?b.success?"primary":"warning":"inherit",variant:"body2",children:e.title})]}),n===T&&(Number.isInteger(b.progressBar)||b.progressBar)?(0,l.jsx)(fr.Z,{color:b.success?"primary":"warning",sx:{mt:2,mx:3},variant:Number.isInteger(b.progressBar)?"determinate":"indeterminate",value:Number.isInteger(b.progressBar)?b.progressBar:null}):null]})]},n)})),b.success?null:(0,l.jsxs)(_e.Z,{severity:"warning",children:[b.message.length?b.message:u.t("An error occured during the installation of the large language model."),(0,l.jsx)("br",{}),"serve"!==b.code?u.t("Press the reinstall button below to begin a fresh install."):u.t("Press the restart button below to reload the large language model.")]})]}),(0,l.jsxs)(Oe.Z,{children:[b.success?null:(0,l.jsx)(I.Z,{className:"pop",startIcon:"serve"!==b.code?(0,l.jsx)(N.Z,{}):(0,l.jsx)(_l.Z,{}),color:"primary",onClick:function(){return k("serve"!==b.code)},variant:"contained",children:"serve"!==b.code?u.t("Reinstall"):u.t("Restart")}),(0,l.jsx)(I.Z,{color:b.success&&i()?"primary":"secondary",variant:b.success&&i()?"contained":"text",className:b.success&&i()?"pop":null,onClick:function(){return h(!1)},children:b.success&&i()?u.t("Let's go!"):u.t("OK")})]})]}):null]})},Pl=t(79622),Ml=t(83830),Dl=t(4620);function El(){var e=(0,Bn.Z)(["\n0%   { transform: translateY(-50px); }\n100% { transform: translateY(0px); }"]);return El=function(){return e},e}var Nl=(0,$n.F4)(El()),Rl=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{width:"2px",height:"20px",position:"relative",borderRight:"1px solid ".concat((0,u.k)(n)),marginLeft:n.spacing(2)}}));function Ol(e){var n=e.agents,t=(0,x.O)(),i=t.getAgentActive,a=t.onAgentActive,s=t.getAgentId,d=t.onAgentId,p=t.getNavVisible,f=t.onNavVisible,h=t.setNavVisible,m=t.getNavUrl,y=t.onNavUrl,Z=t.getNavInfo,j=t.onNavInfo,b=t.log,w=(0,k.Z)(),I=(0,g.useRef)(null),_=(0,v.$)().i18n,A=(0,g.useRef)(null),T=(0,g.useState)(null),z=T[0],P=T[1],M=(0,g.useState)(!1),D=M[0],E=M[1],N=(0,g.useState)(!1),F=N[0],W=N[1],U=(0,g.useState)({status:-1}),B=U[0],$=U[1];(0,g.useEffect)((function(){E(i(s()));var e=a((function(e){var n=e.agentId,t=e.active;n===s()&&E(t)}));W(p());var n=f((function(e){W(e)}));null!==I.current&&(I.current.value=m(s()));var t=y((function(e){var n=e.agentId,t=e.url;n===s()&&null!==I.current&&(I.current.value=t)}));$(Z(s()));var r=j((function(e){var n=e.agentId,t=e.info;n===s()&&$(t)}));return function(){e(),n(),t(),r()}}),[z]),(0,g.useEffect)((function(){P((0,c.zu)(n,s()));var e=d((function(e){return P((0,c.zu)(n,e))}));return function(){return e()}}),[n]),(0,g.useEffect)((function(){F&&null!==I.current&&(I.current.value=m(s()))}),[F]);var H=function(){var e=(0,r.Z)((function(e){var n,t,r;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:if(D)return[2];$((0,Je.Z)((0,R.Z)({},B),{status:-1})),null===(n=window.sdk)||void 0===n||n.ipc.main.setOnTop(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,null===(t=window.sdk)||void 0===t?void 0:t.ipc.target.loadUrl(s(),e)];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),b(s(),"Navigation error: ".concat(r.message),"error"),[3,4];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),V=function(){var e=(0,r.Z)((function(){var e,n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:if(D)return[2];$((0,Je.Z)((0,R.Z)({},B),{status:-1})),null===(e=window.sdk)||void 0===e||e.ipc.main.setOnTop(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.target.reload(s(),!0)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),b(s(),"Navigation error: ".concat(t.message),"error"),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:if(D)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.target.goBack(s())];case 2:return t.sent(),[3,4];case 3:return n=t.sent(),b(s(),"Navigation error: ".concat(n.message),"error"),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:if(D)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.target.goForward(s())];case 2:return t.sent(),[3,4];case 3:return n=t.sent(),b(s(),"Navigation error: ".concat(n.message),"error"),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){return h(!1),[2]}))}));return function(){return e.apply(this,arguments)}}(),G="1px solid ".concat(D?w.palette.primary.main:(0,u.k)(w));return z&&F?(0,l.jsx)(S.Z,{sx:{borderBottom:G,zIndex:20,position:"fixed",display:"flex",flexDirection:"column",left:"250px",top:"50px",width:"calc(100vw - 250px)",overflow:"hidden",background:w.palette.background.default,animation:"".concat(Nl," 100ms ease-in-out forwards")},children:(0,l.jsxs)(S.Z,{sx:{height:"49px",alignItems:"center",display:"flex"},children:[D?(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",ml:4,mr:2,flex:"0 0 auto",userSelect:"none"},children:(0,l.jsx)(C.Z,{variant:"caption",color:w.palette.action.active,children:_.t("Controlled by agent")})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",mx:2,ml:4},children:(0,l.jsx)(Te.Z,{onClick:q,disabled:-1===B.status||!B.canGoBack,children:(0,l.jsx)(Ml.Z,{fontSize:"small"})})}),(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",mr:2},children:(0,l.jsx)(Te.Z,{onClick:K,disabled:-1===B.status||!B.canGoForward,children:(0,l.jsx)(Pl.Z,{fontSize:"small"})})}),(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center"},children:(0,l.jsx)(Te.Z,{onClick:V,disabled:-1===B.status,children:(0,l.jsx)(Dl.Z,{fontSize:"small"})})})]}),(0,l.jsx)(Rl,{sx:{mr:2}}),(0,l.jsx)(Ie.Z,{inputRef:I,variant:"standard",fullWidth:!0,disabled:D||-1===B.status,sx:{"& .MuiInput-root:before":{display:"none"}},onKeyDown:function(e){return"Enter"===e.key&&(n=e.target.value,null!==A.current&&window.clearTimeout(A.current),void(A.current=window.setTimeout((0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return A.current=null,n.match(RegExp("\\.[\\p{L}\\d]|about:home|localhost","u"))?(n.match(/^(https?\:\/\/|about:home)\b/gi)||(e=n.match(/^((127|0)\.\d+|localhost)/gi)?"http":"https",n="".concat(e,"://").concat(n.replace(/^\w+\:\/\//gi,"")),I.current.value=n),[4,H(n)]):(I.current.value=m(s()),[2]);case 1:return t.sent(),[2]}}))})),250)));var n},inputProps:{sx:{fontSize:"0.75rem",px:"0 !important"}},placeholder:_.t("Type URL and press Enter"),InputProps:{startAdornment:(0,l.jsx)(Ce.Z,{position:"start",sx:{userSelect:"none"},children:(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",mx:2},children:(0,l.jsx)(S.Z,{sx:{height:"20px"},children:-1===B.status?(0,l.jsx)(cr.Z,{fontSize:"small",className:"rotate-360"}):0===B.status?(0,l.jsx)(O.Z,{title:_.t("Failed to load"),placement:"left",children:(0,l.jsx)(An.Z,{fontSize:"small",color:"warning"})}):D?(0,l.jsx)(Tn.Z,{fontSize:"small",color:"action"}):(0,l.jsx)(xe.Z,{fontSize:"small"})})})})}}),(0,l.jsx)(S.Z,{sx:{display:"flex",alignItems:"center",mx:4},children:(0,l.jsx)(O.Z,{title:_.t("Close"),placement:"bottom",children:(0,l.jsx)(Te.Z,{onClick:Y,sx:{mr:"2px"},children:(0,l.jsx)(L.Z,{fontSize:"small"})})})})]})}):null}function Ll(e){var n,t,r=e.count,i=void 0===r?0:r,o=e.onAgentAdd,a=void 0===o?function(){}:o,s=(0,x.O)(),u=s.getSubscription,c=s.onSubscription,d=(0,v.$)().i18n,p=(0,m.a)(),f=(0,g.useState)(0),h=f[0],y=f[1],Z=(0,g.useState)(0),j=Z[0],b=Z[1];return(0,g.useEffect)((function(){var e,n=u();b(!!n.active),y(null!==(e=n.agentsCount)&&void 0!==e?e:0);var t=c((function(e){var n,t=e.info;b(!!t.active),y(null!==(n=t.agentsCount)&&void 0!==n?n:0)}));return function(){t()}}),[null===(n=p.user)||void 0===n?void 0:n.computerEnabled]),j&&(null===(t=p.user)||void 0===t?void 0:t.computerEnabled)&&i<h?(0,l.jsx)(S.Z,{sx:{px:3,my:3},children:(0,l.jsx)(I.Z,{fullWidth:!0,sx:{fontSize:"0.75rem"},startIcon:(0,l.jsx)(we.Z,{color:"inherit"}),onClick:a,children:d.t("Add agent")})}):null}var Fl=(0,w.ZP)(S.Z)((function(){return{display:"flex",width:"100%",height:"calc(100vh - 100px)",position:"relative",zIndex:2}})),Wl=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{display:"flex",width:"250px",height:"100%",boxShadow:"-1px 0px 0px 0px ".concat((0,u.k)(n)," inset")}})),Ul=(0,w.ZP)(S.Z)((function(e){var n=e.theme;return{display:"flex",width:"calc(100vw - 250px)",boxShadow:"0px -1px 0px 0px ".concat((0,u.k)(n)," inset"),height:"100%"}})),Bl=(0,w.ZP)(S.Z)((function(e){return{display:"flex",width:"100%",height:"50px",background:e.theme.palette.background.default,position:"relative",zIndex:21}})),$l=function(){var e,n=(0,x.O)(),t=n.onAgentId,a=n.getAgentId,d=n.setAgentId,p=n.getAgentActive,Z=n.onAgentActive,w=n.getAgentTab,C=n.onAgentTab,I=n.setHourglass,_=n.setPageTitle,A=n.log,T=n.getLogs,z=n.getLogsInit,P=n.setLogsInit,D=n.setLogsEnabled,E=n.onLogsVisible,N=n.getLogsVisible,R=n.setLogsVisible,O=n.onNavVisible,L=n.getNavVisible,F=n.setNavVisible,W=n.onMachineStatus,U=n.getDialogVisible,B=n.setDialogVisible,$=n.getSource,H=n.modulePurge,V=n.onModuleUpdate,q=n.onModulePurge,K=n.agentPurge,Y=n.setInstalled,G=(0,v.$)().i18n,X=(0,y.useRouter)(),J=(0,k.Z)(),Q=(0,m.a)(),ee=(0,g.useState)(!1),ne=ee[0],te=ee[1],re=(0,g.useState)([]),ie=re[0],oe=re[1];(0,g.useEffect)((function(){Q.user&&(h.Z.setI18n(G),(0,r.Z)((function(){var e,n,t,i;return(0,o.__generator)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,b.Z.get("agents")];case 1:return i=l.sent(),Array.isArray(i.data)&&oe(i.data),i.data.length&&window.setTimeout((0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,le(i.data[0].id)];case 1:return e.sent(),[2]}}))})),250),[3,3];case 2:return l.sent(),[3,3];case 3:return null===(e=window.sdk)||void 0===e||e.ibc.handle("ibc-source:agent:data",(function(e){"object"===typeof e&&"string"===typeof(null===e||void 0===e?void 0:e.id)&&oe((function(n){return structuredClone(n).map((function(n){return(null===n||void 0===n?void 0:n.id)===(null===e||void 0===e?void 0:e.id)?e:n}))}))})),null===(n=window.sdk)||void 0===n||n.ibc.handle("ibc-source:module:installed",(function(e,n,t){"string"===typeof e&&("object"===typeof n&&"string"===typeof(null===n||void 0===n?void 0:n.id)||(n=null),null!==n&&"string"===typeof t||(t=null),Y(e,n,t,!1))})),null===(t=window.sdk)||void 0===t||t.ibc.handle("ibc-source:module:purge",(function(e){"string"===typeof e&&H(e)})),te(!0),[2]}}))}))())}),[null===(e=Q.user)||void 0===e?void 0:e.id]),(0,g.useEffect)((function(){var e,n=function(n){return _((null===n||void 0===n?void 0:n.name)?"".concat(null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:""):null)};n((0,c.zu)(ie,a()));var l=t((function(e){n((0,c.zu)(ie,e))})),s=W((function(e){var n=e.status;h.Z.STATUS_STARTED===n&&B("repo",!1)})),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=function(r){return f(r,e,n,t)};return window.addEventListener("keydown",r),function(){window.removeEventListener("keydown",r)}}(ie,a,B),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=window.setTimeout((function(){if(Array.isArray(e)&&e.length){window.localStorage.removeItem("ally-supports-cache");var r,o=[],l=e.map((function(e){return null!==(r=null===e||void 0===e?void 0:e.id)&&void 0!==r?r:null})).filter(Boolean),a=!0,s=!1,u=void 0;try{for(var c,d=Object.keys(window.localStorage)[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var p=c.value.match(/^oglama\-(\w{24})\-/);p&&!l.includes(p[1])&&o.push(p[1])}}catch(S){s=!0,u=S}finally{try{a||null==d.return||d.return()}finally{if(s)throw u}}var f=!0,h=!1,x=void 0;try{for(var m,v=l[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;t(g)}}catch(S){h=!0,x=S}finally{try{f||null==v.return||v.return()}finally{if(h)throw x}}if(o.length){var y=!0,Z=!1,j=void 0;try{for(var b,w=(0,i.Z)(new Set(o))[Symbol.iterator]();!(y=(b=w.next()).done);y=!0){var k=b.value;n(k)}}catch(S){Z=!0,j=S}finally{try{y||null==w.return||w.return()}finally{if(Z)throw j}}}}}),500);return function(){return window.clearTimeout(r)}}(ie,K,(function(e){z(e)||(D(e,!0,!1),P(e,!0),T(e).length||(A(e,G.t("Errors happen, but at least they're detailed and nicely colored"),"error"),A(e,G.t("Messages are temporary - they get cleared when you close the application"),"warning"),A(e,G.t("Only the last {{logsPerAgent}} messages are kept in this console",{logsPerAgent:j().max.logsPerAgent})),A(e,G.t("This is where agents display their messages"),"success")))})),p=V((function(e){var n=e.module;e.sendToSce&&"string"===typeof(null===n||void 0===n?void 0:n.id)&&n.id.length&&(0,r.Z)((function(){var e,t,r,i,l,a,s,u,c,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e=!0,t=!1,r=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),i=structuredClone(ie)[Symbol.iterator](),o.label=2;case 2:return(e=(l=i.next()).done)?[3,5]:"string"!==typeof(null===(a=l.value)||void 0===a?void 0:a.id)||(null===a||void 0===a?void 0:a.installedModuleId)!==n.id?[3,4]:[4,$(a.id,!0)];case 3:u=o.sent(),c={agentData:a,moduleData:n,sourceCode:u},null===(s=window.sdk)||void 0===s||s.ibc.source.send(a.id,"ibc-main:module-repo:data",[c]),o.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return d=o.sent(),t=!0,r=d,[3,8];case 7:try{e||null==i.return||i.return()}finally{if(t)throw r}return[7];case 8:return[2]}}))}))()})),x=q((function(e){"string"===typeof e&&e.length&&(0,r.Z)((function(){var n,t,r,i,l,a,s,u;return(0,o.__generator)(this,(function(o){n=!0,t=!1,r=void 0;try{for(i=structuredClone(ie)[Symbol.iterator]();!(n=(l=i.next()).done);n=!0)"string"===typeof(null===(a=l.value)||void 0===a?void 0:a.id)&&(null===a||void 0===a?void 0:a.installedModuleId)===e&&(a.installedModuleId=null,a.installedModuleSrcId=null,a.installedModuleAuthorId=null,u={agentData:structuredClone(a),moduleData:null},null===(s=window.sdk)||void 0===s||s.ibc.source.send(a.id,"ibc-main:module-repo:data",[u]),se(a))}catch(c){t=!0,r=c}finally{try{n||null==i.return||i.return()}finally{if(t)throw r}}return[2]}))}))()}));return function(){p(),x(),u(),l(),s(),d()}}),[ie]),(0,g.useEffect)((function(){var e,n;if("object"===typeof window.sdk){window.setTimeout((function(){var e;return null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.focus()}),750),null===(e=window.sdk)||void 0===e||e.ibc.handle("ibc-source:open",(function(){return B("loading",!1)})),null===(n=window.sdk)||void 0===n||n.ibc.handle("ipc:oglama:restored",(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),B("restored",!0),[2]}}))})));var t=function(){var e=(0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return t.sent(),[4,null===(n=window.sdk)||void 0===n?void 0:n.ipc.target.removeAll()];case 2:return t.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}();window.addEventListener("beforeunload",t),X.events.on("routeChangeStart",t);var i=Z((function(e){var n=e.agentId,t=e.active;return I(n,t)})),l=E((function(e){return!e&&pe()})),s=O((function(e){return!e&&pe()})),u=C((function(){return null!==a()&&le(a())}));return function(){window.removeEventListener("beforeunload",t),X.events.off("routeChangeStart",t),i(),l(),s(),u()}}X.replace("/home/")}),[]);var le=function(){var e=(0,r.Z)((function(e){var n,t,r,i,l=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return n=l.length>1&&void 0!==l[1]&&l[1],"string"!==typeof e?[2]:(d(e),r=n||""!==w()||U()||N()||L()||p(e),[4,null===(t=window.sdk)||void 0===t?void 0:t.ipc.main.setOnTop(r)]);case 1:return o.sent(),""!==w()?[3,3]:[4,null===(i=window.sdk)||void 0===i?void 0:i.ipc.target.select(e)];case 2:o.sent(),o.label=3;case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ae=function(){var e=(0,r.Z)((function(e){var n,t,r,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if("string"!==typeof(null===(n=Q.user)||void 0===n?void 0:n.computerId))return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,b.Z.post("agents",{name:e,computerId:Q.user.computerId})];case 2:return l=o.sent(),"string"===typeof(null===(r=l.data)||void 0===r?void 0:r.id)&&(oe((function(e){return(0,i.Z)(structuredClone(e)).concat([l.data])})),d(l.data.id),D(l.data.id,!0,!1),B("repo",!0)),[3,4];case 3:return o.sent(),[3,4];case 4:return[4,null===(t=window.sdk)||void 0===t?void 0:t.ipc.main.setOnTop()];case 5:return o.sent(),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),se=function(e){var n;"object"===typeof e&&null!==e&&"string"===typeof e.id&&(oe((function(n){return structuredClone(n).map((function(n){return n.id===e.id?e:n}))})),null===(n=window.sdk)||void 0===n||n.ibc.source.send(e.id,"ibc-main:agent:data",[e]))},ue=function(){var e=(0,r.Z)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,b.Z.delete("agents/".concat(e))];case 1:return n.sent(),oe((function(n){var t=(0,i.Z)(structuredClone(n).filter((function(n){return n.id!==e})));return a()===e&&d(t.length?t[0].id:null),t})),K(e),[3,3];case 2:return n.sent(),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),ce=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),B("agentCreate",!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),B("profile",!0),[2]}}))}));return function(){return e.apply(this,arguments)}}(),pe=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return""!==w()?[3,2]:[4,le(a())];case 1:e.sent(),e.label=2;case 2:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=(0,r.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return R(!1),F(!1),[4,pe()];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),he=function(){var e=(0,r.Z)((function(){var e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,null===(e=window.sdk)||void 0===e?void 0:e.ipc.main.setOnTop()];case 1:return n.sent(),B("loading",!0),[2]}}))}));return function(){return e.apply(this,arguments)}}();return null===Q.user?(0,l.jsx)(Zr.Z,{}):(0,l.jsxs)(S.Z,{sx:{display:"flex",width:"100vw",height:"100vh",flexDirection:"column"},children:[(0,l.jsx)(s(),{id:"a832ee7090d48c19",children:"body{background:transparent}"}),(0,l.jsx)(qt,{agentsCount:ie.length,agentsReady:ne}),(0,l.jsx)(Bl,{children:ne&&ie.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Wl,{sx:{justifyContent:"space-between",alignItems:"center"},children:(0,l.jsx)(gt,{})}),(0,l.jsxs)(Ul,{sx:{justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsx)($t,{agents:ie,onSelect:le}),(0,l.jsx)(fn,{agents:ie,onSelect:le,onUpdate:function(){return B("agentUpdate",!0)},onDelete:function(){return B("agentDelete",!0)},showLoading:he})]})]}):null}),(0,l.jsx)(Fl,{children:ne&&ie.length?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Wl,{sx:{background:J.palette.background.default,flexDirection:"column",position:"relative",zIndex:10},children:(0,l.jsxs)(S.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},children:[(0,l.jsxs)(S.Z,{children:[ie.map((function(e,n){return(0,l.jsx)(yr,{agent:e,index:n,onSelect:le},e.id)})),(0,l.jsx)(Ll,{count:ie.length,onAgentAdd:ce})]}),(0,l.jsx)(ol,{}),(0,l.jsx)(zl,{})]})}),(0,l.jsx)(Ul,{sx:{boxShadow:"none"},onMouseOver:pe,onMouseDown:fe,children:(0,l.jsx)(nl,{agents:ie,agentsReady:ne})}),(0,l.jsx)(Ol,{agents:ie}),(0,l.jsx)(Ot,{agents:ie})]}):null}),(0,l.jsxs)(Bl,{children:[(0,l.jsx)(Wl,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:(0,l.jsx)(Nr,{onProfileOpen:de})}),ne&&ie.length?(0,l.jsxs)(Ul,{sx:{alignItems:"center",boxShadow:"0px 1px 0px 0px ".concat((0,u.k)(J)," inset"),justifyContent:"space-between"},children:[(0,l.jsx)(M,{agents:ie}),(0,l.jsx)(ar,{agents:ie})]}):null]}),(0,l.jsx)(ln,{agents:ie,onAgentUpdate:se}),(0,l.jsx)(wl,{agents:ie,onAgentCreate:ae,onAgentUpdate:se,onAgentDelete:ue})]})};$l.guestGuard=!0;var Hl=$l}},function(e){e.O(0,[901,884,899,991,857,955,774,888,179],(function(){return n=75557,e(e.s=n);var n}));var n=e.O();_N_E=n}]);